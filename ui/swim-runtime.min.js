// swim-runtime-4.0.0-dev.20210826; copyright 2015-2021 Swim Inc.
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).swim=e.swim||{})}(this,(function(e){"use strict";var t=function(e,t){return e===t||null!=e&&"function"==typeof e.equals&&e.equals(t)};t.is=function(e){return null!=e&&"function"==typeof e.equals};var r=function(e){return void 0===e?0:null===e?1:e.hashCode()};r.is=function(e){return null!=e&&"function"==typeof e.hashCode};var n=function(e,t,r){return e===t||null!=e&&"function"==typeof e.equivalentTo&&e.equivalentTo(t,r)};n.is=function(e){return null!=e&&"function"==typeof e.equivalentTo},n.Epsilon=1e-8;var i=function(e,t){return void 0===e?void 0===t?0:1:null===e?void 0===t?-1:null===t?0:1:"function"==typeof e.compareTo?null==t?-1:e.compareTo(t):NaN};i.is=function(e){return null!=e&&"function"==typeof e.compareTo};var o={is:function(e){return null!=e&&"function"==typeof e.fromAny}},u={is:function(e){return null!=e&&"function"==typeof e.toAny}},s=function(e,t,r){var n=r.writable,i=r.enumerable,o=r.configurable;if(void 0!==r.get){var u=r.get;r.get=function(){var r=u.call(this);return Object.defineProperty(e,t,{value:r,writable:n,enumerable:i,configurable:o}),r}}else{if(void 0===r.value)throw new Error("invalid lazy property descriptor");var s=r.value;r.value=function(){var r=s.call(this);return Object.defineProperty(e,t,{value:function(){return r},writable:n,enumerable:i,configurable:o}),r}}};void 0===String.prototype.codePointAt&&(String.prototype.codePointAt=function(e){var t=this.length;if((e=e?Number(e):0)!=e&&(e=0),e>=0&&e<t){var r=this.charCodeAt(e);if(r<=55295||r>=57344)return r;if(r<=56319&&e+1<t){var n=this.charCodeAt(e+1);if(n>=56320&&n<=57343)return 65536+((1023&r)<<10+n&1023)}}}),void 0===String.prototype.offsetByCodePoints&&(String.prototype.offsetByCodePoints=function(e,t){if(t>0)for(var r=this.length;t>0&&e<r;){if((i=this.charCodeAt(e))<=55295||i>=57344)e+=1;else if(i<=56319&&e+1<r){e+=(n=this.charCodeAt(e+1))>=56320&&n<=57343?2:1}else e+=1;t-=1}else if(t<0)for(;t<0&&e>0;){var n;if((n=this.charCodeAt(e-1))<=55295||n>=57344)e-=1;else if(n>=56320&&n<=57343&&e-1>0){var i;e-=(i=this.charCodeAt(e-2))>=55296&&i<=57343?2:1}else e-=1;t-=1}return e});var a={};"undefined"!=typeof window&&void 0!==window.crypto?a.fillBytes=function(e){window.crypto.getRandomValues(e)}:"undefined"!=typeof window&&void 0!==window.msCrypto?a.fillBytes=function(e){window.msCrypto.getRandomValues(e)}:a.fillBytes=function(e){if(e instanceof Int8Array)for(var t=0;t<e.length;t+=1)e[t]=128-Math.round(256*Math.random());else if(e instanceof Uint8Array)for(t=0;t<e.length;t+=1)e[t]=Math.round(256*Math.random());else if(e instanceof Int16Array)for(t=0;t<e.length;t+=1)e[t]=32768-Math.round(65536*Math.random());else if(e instanceof Uint16Array)for(t=0;t<e.length;t+=1)e[t]=Math.round(65536*Math.random());else if(e instanceof Int32Array)for(t=0;t<e.length;t+=1)e[t]=2147483648-Math.round(4294967296*Math.random());else{if(!(e instanceof Uint32Array))throw new TypeError(""+e);for(t=0;t<e.length;t+=1)e[t]=Math.round(4294967296*Math.random())}};var p={};Object.defineProperty(p,"BigEndian",{value:"BE",enumerable:!0}),Object.defineProperty(p,"LittleEndian",{value:"LE",enumerable:!0}),Object.defineProperty(p,"NativeOrder",{get:function(){var e,t=new ArrayBuffer(2);new Uint16Array(t)[0]=65279;var r=new Uint8Array(t);if(254===r[0]&&255===r[1])e=p.BigEndian;else{if(255!==r[0]||254!==r[1])throw new Error;e=p.LittleEndian}return Object.defineProperty(p,"NativeOrder",{value:e,enumerable:!0}),e},configurable:!0,enumerable:!0});var f,c={mix:function(e,t){return t=3432918353*(65535&t)+((3432918353*(t>>>16)&65535)<<16)&4294967295,e^=t=461845907*(65535&(t=c.rotl(t,15)))+((461845907*(t>>>16)&65535)<<16)&4294967295,e=27492+(65535&(e=5*(65535&(e=c.rotl(e,13)))+((5*(e>>>16)&65535)<<16)&4294967295))+((58964+(e>>>16)&65535)<<16)},mixUint8Array:function(e,t){if(p.NativeOrder===p.BigEndian)return c.mixUint8ArrayBE(e,t);if(p.NativeOrder===p.LittleEndian)return c.mixUInt8ArrayLE(e,t);throw new Error},mixUint8ArrayBE:function(e,t){for(var r=0,n=t.length;r+3<n;){var i=(255&t[r])<<24|(255&t[r+1])<<16|(255&t[r+2])<<8|255&t[r+3];e=c.mix(e,i),r+=4}if(r<n){i=(255&t[r])<<24;r+1<n&&(i|=(255&t[r+1])<<16,r+2<n&&(i|=(255&t[r+2])<<8)),i=3432918353*(65535&i)+((3432918353*(i>>>16)&65535)<<16)&4294967295,e^=i=461845907*(65535&(i=c.rotl(i,15)))+((461845907*(i>>>16)&65535)<<16)&4294967295}return e^n},mixUInt8ArrayLE:function(e,t){for(var r=0,n=t.length;r+3<n;){var i=255&t[r]|(255&t[r+1])<<8|(255&t[r+2])<<16|(255&t[r+3])<<24;e=c.mix(e,i),r+=4}if(r<n){i=255&t[r];r+1<n&&(i|=(255&t[r+1])<<8,r+2<n&&(i|=(255&t[r+2])<<16)),i=3432918353*(65535&i)+((3432918353*(i>>>16)&65535)<<16)&4294967295,e^=i=461845907*(65535&(i=c.rotl(i,15)))+((461845907*(i>>>16)&65535)<<16)&4294967295}return e^n},mixString:function(e,t){if(p.NativeOrder===p.BigEndian)return c.mixStringBE(e,t);if(p.NativeOrder===p.LittleEndian)return c.mixStringLE(e,t);throw new Error},mixStringBE:function(e,t){for(var r=0,n=32,i=0,o=t.length,u=0;i<o;){var s=t.codePointAt(i);void 0===s&&(s=t.charCodeAt(i)),s>=0&&s<=127?(r|=s<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),u+=1):s>=128&&s<=2047?(r|=(192|s>>>6)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=(128|63&s)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),u+=2):s>=2048&&s<=65535||s>=57344&&s<=65535?(r|=(224|s>>>12)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=(128|s>>>6&63)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=(128|63&s)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),u+=3):s>=65536&&s<=1114111?(r|=(240|s>>>18)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=(128|s>>>12&63)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=(128|s>>>6&63)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=(128|63&s)<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),u+=4):(r|=239<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=191<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),r|=189<<(n-=8),0===n&&(e=c.mix(e,r),r=0,n=32),u+=3),i=t.offsetByCodePoints(i,1)}return 32!==n&&(r=3432918353*(65535&r)+((3432918353*(r>>>16)&65535)<<16)&4294967295,e^=r=461845907*(65535&(r=c.rotl(r,15)))+((461845907*(r>>>16)&65535)<<16)&4294967295),e^u},mixStringLE:function(e,t){for(var r=0,n=0,i=0,o=t.length,u=0;i<o;){var s=t.codePointAt(i);void 0===s&&(s=t.charCodeAt(i)),s>=0&&s<=127?(r|=s<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),u+=1):s>=128&&s<=2047?(r|=(192|s>>>6)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=(128|63&s)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),u+=2):s>=2048&&s<=65535||s>=57344&&s<=65535?(r|=(224|s>>>12)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=(128|s>>>6&63)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=(128|63&s)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),u+=3):s>=65536&&s<=1114111?(r|=(240|s>>>18)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=(128|s>>>12&63)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=(128|s>>>6&63)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=(128|63&s)<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),u+=4):(r|=239<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=191<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),r|=189<<n,32===(n+=8)&&(e=c.mix(e,r),r=0,n=0),u+=3),i=t.offsetByCodePoints(i,1)}return 32!==n&&(r=3432918353*(65535&r)+((3432918353*(r>>>16)&65535)<<16)&4294967295,e^=r=461845907*(65535&(r=c.rotl(r,15)))+((461845907*(r>>>16)&65535)<<16)&4294967295),e^u},mash:function(e){return e=2246822507*(65535&(e^=e>>>16))+((2246822507*(e>>>16)&65535)<<16)&4294967295,e=3266489909*(65535&(e^=e>>>13))+((3266489909*(e>>>16)&65535)<<16)&4294967295,(e^=e>>>16)>>>0},rotl:function(e,t){return e<<t|e>>>32-t}},l={};l.compare=function(e,t){if("object"==typeof e&&null!==e){if("object"==typeof t&&null!==t){var r=l.hash(e),n=l.hash(t);return r<n?-1:r>n?1:0}return-1}return null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN},l.hash=(f=-1,function(e){if("object"==typeof e&&null!==e){var t=e._hashCode;return void 0===t&&(t=~~f,f-=1,Object.defineProperty(e,"_hashCode",{value:t,configurable:!0})),t}if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)});var h,d,y,v={compare:function(e,t){return"boolean"==typeof e?"boolean"==typeof t?e&&!t?-1:!e&&t?1:0:-1:null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN},hash:function(e){if(!0===e)return 3;if(!1===e)return 2;if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)}},b={};b.equal=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},b.equivalent=function(e,t,r){return e===t||"number"==typeof e&&"number"==typeof t&&(isNaN(e)&&isNaN(t)||Math.abs(t-e)<(void 0!==r?r:n.Epsilon))},b.compare=function(e,t){return"number"==typeof e?"number"==typeof t?e<t?-1:e>t?1:isNaN(t)?isNaN(e)?0:-1:isNaN(e)?1:0:-1:null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN},b.hash=(h=new ArrayBuffer(8),d=new Float64Array(h),y=new Int32Array(h),function(e){if("number"==typeof e)return e===~~e?~~e:(d[0]=e,y[0]^y[1]);if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)});var m={compare:function(e,t){return"string"==typeof e?"string"==typeof t?e<t?-1:e>t?1:0:-1:null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN},hash:function(e){if("string"==typeof e)return c.mash(c.mixString(0,e));if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)}},g={compare:function(e,t){if("function"==typeof e){if("function"==typeof t){var r=g.hash(e),n=g.hash(t);return r<n?-1:r>n?1:0}return-1}return null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN}};g.hash=function(){var e=-1;return function(t){if("function"==typeof t){var r=t._hashCode;return void 0===r&&(r=~~e,e-=1,Object.defineProperty(t,"_hashCode",{value:r,configurable:!0})),r}if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)}}();var w={compare:function(e,t){if("function"==typeof e){if("function"==typeof t){var r=w.hash(e),n=w.hash(t);return r<n?-1:r>n?1:0}return-1}return null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN},hash:function(e){if("function"==typeof e){var t=e._hashCode;return void 0===t&&(t=c.mash(c.mixString(0,e.name)),Object.defineProperty(e,"_hashCode",{value:t,configurable:!0})),t}if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)}},O={equal:function(e,t){if(e===t)return!0;if("object"==typeof e&&null!==e&&"object"==typeof t&&null!==t){var r=Object.keys(e),n=Object.keys(t),i=r.length;if(i!==n.length)return!1;for(var o=0;o<i;o+=1){var u=r[o];if(u!==n[o]||!P.equal(e[u],t[u]))return!1}return!0}return!1},equivalent:function(e,t,r){if(e===t)return!0;if("object"==typeof e&&null!==e&&"object"==typeof t&&null!==t){var n=Object.keys(e),i=Object.keys(t),o=n.length;if(o!==i.length)return!1;for(var u=0;u<o;u+=1){var s=n[u];if(s!==i[u]||!P.equivalent(e[s],t[s],r))return!1}return!0}return!1},compare:function(e,t){if("object"==typeof e&&null!==e){if("object"==typeof t&&null!==t){if(e!==t){for(var r=Object.keys(e),n=Object.keys(t),i=r.length,o=n.length,u=Math.min(i,o),s=0,a=0;a<u&&0===s;a+=1){var p=r[a],f=n[a];0===(s=m.compare(p,f))&&(s=P.compare(e[p],t[f]))}return 0!==s?s:i>o?1:i<o?-1:0}return 0}return-1}return null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN},hash:function(e){if("object"==typeof e&&null!==e){for(var t=0,r=Object.keys(e),n=0,i=r.length;n<i;n+=1){var o=r[n];t=c.mix(c.mix(t,m.hash(o)),P.hash(e[o]))}return c.mash(t)}if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)}},P={equal:function(e,r){if(e instanceof Date&&(e=e.getTime()),r instanceof Date&&(r=r.getTime()),e===r)return!0;if("number"==typeof e){if("number"==typeof r)return isNaN(e)&&isNaN(r)}else{if(t.is(e))return e.equals(r);if(Array.isArray(e)){if(Array.isArray(r))return x.equal(e,r)}else if("object"==typeof e&&null!==e&&"object"==typeof r&&null!==r)return O.equal(e,r)}return!1},hash:function(e){if(void 0===e)return 0;if(null===e)return 1;if(!1===e)return 2;if(!0===e)return 3;if("number"==typeof e)return b.hash(e);if("string"==typeof e)return m.hash(e);if(r.is(e))return e.hashCode();if("function"==typeof e)return g.hash(e);if(Array.isArray(e))return x.hash(e);if("object"==typeof e)return O.hash(e);throw new TypeError(""+e)},equivalent:function(e,t,r){if(void 0===r&&(r=n.Epsilon),e instanceof Date&&(e=e.getTime()),t instanceof Date&&(t=t.getTime()),e===t)return!0;if("number"==typeof e){if("number"==typeof t)return isNaN(e)&&isNaN(t)||Math.abs(t-e)<r}else{if(n.is(e))return e.equivalentTo(t,r);if(Array.isArray(e)){if(Array.isArray(t))return x.equivalent(e,t,r)}else if("object"==typeof e&&null!==e&&"object"==typeof t&&null!==t)return O.equivalent(e,t,r)}return!1},compare:function(e,t){return e instanceof Date&&(e=e.getTime()),t instanceof Date&&(t=t.getTime()),void 0===e?void 0===t?0:1:null===e?void 0===t?-1:null===t?0:1:"boolean"==typeof e?null==t?-1:"boolean"==typeof t?e&&!t?-1:!e&&t?1:0:1:"number"==typeof e?null==t||"boolean"==typeof t?-1:"number"==typeof t?e<t?-1:e>t?1:isNaN(t)?isNaN(e)?0:-1:isNaN(e)?1:0:1:"string"==typeof e?null==t||"boolean"==typeof t||"number"==typeof t?-1:"string"==typeof t?e<t?-1:e>t?1:0:1:i.is(e)?e.compareTo(t):"function"==typeof e?null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t?-1:"function"==typeof t?g.compare(e,t):1:Array.isArray(e)?null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t?-1:Array.isArray(t)?x.compare(e,t):1:"object"==typeof e?null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"function"==typeof t||Array.isArray(t)?-1:"object"==typeof t?O.compare(e,t):1:NaN}},x={};Object.defineProperty(x,"empty",{value:Object.freeze([]),enumerable:!0,configurable:!0}),x.inserted=function(e,t){for(var r=null!=t?t.length:0,n=new Array(r+1),i=0;i<r;i+=1){var o=t[i];if(o===e)return t;n[i]=o}return n[r]=e,n},x.removed=function(e,t){var r=null!=t?t.length:0;if(0===r)return null!=t?t:x.empty;if(1===r)return t[0]!==e?t:x.empty;for(var n=new Array(r-1),i=0;i<r;){var o=t[i];if(o===e){for(i+=1;i<r;)n[i-1]=t[i],i+=1;return n}n[i]=o,i+=1}return t},x.equal=function(e,t){if(e===t)return!0;if("object"==typeof e&&null!==e&&"object"==typeof t&&null!==t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n+=1)if(!P.equal(e[n],t[n]))return!1;return!0}return!1},x.equivalent=function(e,t,r){if(e===t)return!0;if("object"==typeof e&&null!==e&&"object"==typeof t&&null!==t){var n=e.length;if(n!==t.length)return!1;for(var i=0;i<n;i+=1)if(!P.equivalent(e[i],t[i],r))return!1;return!0}return!1},x.compare=function(e,t){if("object"==typeof e&&null!==e){if("object"==typeof t&&null!==t){if(e!==t){for(var r=e.length,n=t.length,i=0,o=0,u=Math.min(r,n);o<u&&0===i;o+=1)i=P.compare(e[o],t[o]);return 0!==i?i:r>n?1:r<n?-1:0}return 0}return-1}return null===e?void 0===t?-1:null===t?0:1:void 0===e?void 0===t?0:1:NaN},x.hash=function(e){if("object"==typeof e&&null!==e){for(var t=0,r=0,n=e.length;r<n;r+=1)t=c.mix(t,P.hash(e[r]));return c.mash(t)}if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)};var j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function E(e,t,r,n){var i,o=arguments.length,u=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(u=(o<3?i(u):o>3?i(t,r,u):i(t,r))||u);return o>3&&u&&Object.defineProperty(t,r,u),u}function S(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var k=function(){function e(){}return e.prototype.set=function(e){throw new Error("immutable")},e.prototype.delete=function(){throw new Error("immutable")},e.empty=function(){return new M},e.unary=function(e){return new A(e)},e.array=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.length),new D(e,t,r)},E([s],e,"empty",null),e}(),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.isEmpty=function(){return!0},t.prototype.head=function(){throw new Error("empty")},t.prototype.step=function(){throw new Error("empty")},t.prototype.skip=function(e){},t.prototype.hasNext=function(){return!1},t.prototype.nextIndex=function(){return 0},t.prototype.next=function(){return{done:!0}},t.prototype.hasPrevious=function(){return!1},t.prototype.previousIndex=function(){return-1},t.prototype.previous=function(){return{done:!0}},t}(k),A=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t}),Object.defineProperty(r,"index",{value:0,configurable:!0}),r}return C(t,e),t.prototype.isEmpty=function(){return 0!==this.index},t.prototype.head=function(){if(0===this.index)return this.value;throw new Error("empty")},t.prototype.step=function(){if(0!==this.index)throw new Error("empty");Object.defineProperty(this,"index",{value:1,configurable:!0})},t.prototype.skip=function(e){this.index=Math.min(Math.max(0,this.index+e),1)},t.prototype.hasNext=function(){return 0===this.index},t.prototype.nextIndex=function(){return this.index},t.prototype.next=function(){return 0===this.index?(Object.defineProperty(this,"index",{value:1,configurable:!0}),{value:this.value,done:!0}):{done:!0}},t.prototype.hasPrevious=function(){return 1===this.index},t.prototype.previousIndex=function(){return this.index-1},t.prototype.previous=function(){return 1===this.index?(Object.defineProperty(this,"index",{value:0,configurable:!0}),{value:this.value,done:!0}):{done:!0}},t}(k),D=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"array",{value:t}),Object.defineProperty(i,"index",{value:r,configurable:!0}),Object.defineProperty(i,"limit",{value:n}),i}return C(t,e),t.prototype.isEmpty=function(){return this.index>=this.limit},t.prototype.head=function(){if(this.index<this.limit)return this.array[this.index];throw new Error("empty")},t.prototype.step=function(){var e=this.index;if(!(e<this.limit))throw new Error("empty");Object.defineProperty(this,"index",{value:e+1,configurable:!0})},t.prototype.skip=function(e){Object.defineProperty(this,"index",{value:Math.min(this.index+e,this.limit),configurable:!0})},t.prototype.hasNext=function(){return this.index<this.limit},t.prototype.nextIndex=function(){return this.index},t.prototype.next=function(){var e=this.index;return e<this.limit?(Object.defineProperty(this,"index",{value:e+1,configurable:!0}),{value:this.array[e],done:this.index===this.limit}):(Object.defineProperty(this,"index",{value:this.limit,configurable:!0}),{done:!0})},t.prototype.hasPrevious=function(){return this.index>0},t.prototype.previousIndex=function(){return this.index-1},t.prototype.previous=function(){var e=this.index-1;return e>=0?(Object.defineProperty(this,"index",{value:e,configurable:!0}),{value:this.array[e],done:0===e}):(Object.defineProperty(this,"index",{value:0,configurable:!0}),{done:!0})},t}(k),I=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),T=function(e,t){if(!e)throw new I(t)};T.ok=function(e,t){if(!e)throw new I(t)},T.notOk=function(e,t){if(e)throw new I(t)},T.equal=function(e,t,r){if(!P.equal(e,t))throw new I(r)},T.notEqual=function(e,t,r){if(P.equal(e,t))throw new I(r)},T.identical=function(e,t,r){if(e!==t)throw new I(r)},T.notIdentical=function(e,t,r){if(e===t)throw new I(r)},T.instanceOf=function(e,t,r){if(!(e instanceof t))throw new I(r)},T.notInstanceOf=function(e,t,r){if(e instanceof t)throw new I(r)},T.compareLessThan=function(e,t,r){if(!(P.compare(e,t)<0))throw new I(r)},T.compareNotLessThan=function(e,t,r){if(P.compare(e,t)<0)throw new I(r)},T.compareLessThanOrEqual=function(e,t,r){if(!(P.compare(e,t)<=0))throw new I(r)},T.compareNotLessThanOrEqual=function(e,t,r){if(P.compare(e,t)<=0)throw new I(r)},T.compareEqual=function(e,t,r){if(0!==P.compare(e,t))throw new I(r)},T.compareNotEqual=function(e,t,r){if(0===P.compare(e,t))throw new I(r)},T.compareGreaterThanOrEqual=function(e,t,r){if(!(P.compare(e,t)>=0))throw new I(r)},T.compareNotGreaterThanOrEqual=function(e,t,r){if(P.compare(e,t)>=0)throw new I(r)},T.compareGreaterThan=function(e,t,r){if(!(P.compare(e,t)>0))throw new I(r)},T.compareNotGreaterThan=function(e,t,r){if(P.compare(e,t)>0)throw new I(r)};var V,q=function(){function e(e,t){Object.defineProperty(this,"level",{value:e,enumerable:!0,configurable:!0}),Object.defineProperty(this,"label",{value:t,enumerable:!0,configurable:!0})}return e.prototype.isTrace=function(){return this.level===e.TRACE_LEVEL},e.prototype.isDebug=function(){return this.level===e.DEBUG_LEVEL},e.prototype.isInfo=function(){return this.level===e.INFO_LEVEL},e.prototype.isNote=function(){return this.level===e.NOTE_LEVEL},e.prototype.isWarning=function(){return this.level===e.WARNING_LEVEL},e.prototype.isError=function(){return this.level===e.ERROR_LEVEL},e.prototype.isAlert=function(){return this.level===e.ALERT_LEVEL},e.prototype.isFatal=function(){return this.level===e.FATAL_LEVEL},e.prototype.compareTo=function(t){return this===t?0:t instanceof e?this.level<t.level?-1:this.level>t.level?1:this.label.localeCompare(t.label):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.level===t.level&&this.label===t.label)},e.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(e),b.hash(this.level)),m.hash(this.label)))},e.prototype.toString=function(){return this.label},e.create=function(t,r){switch(t){case e.TRACE_LEVEL:return e.trace(r);case e.DEBUG_LEVEL:return e.debug(r);case e.INFO_LEVEL:return e.info(r);case e.NOTE_LEVEL:return e.note(r);case e.WARNING_LEVEL:return e.warning(r);case e.ERROR_LEVEL:return e.error(r);case e.ALERT_LEVEL:return e.alert(r);case e.FATAL_LEVEL:return e.fatal(r);default:throw new Error(""+t)}},e.trace=function(t){return void 0===t&&(t="trace"),"trace"===t?(void 0===e._trace&&(e._trace=new e(e.TRACE_LEVEL,t)),e._trace):new e(e.TRACE_LEVEL,t)},e.debug=function(t){return void 0===t&&(t="debug"),"debug"===t?(void 0===e._debug&&(e._debug=new e(e.DEBUG_LEVEL,t)),e._debug):new e(e.DEBUG_LEVEL,t)},e.info=function(t){return void 0===t&&(t="info"),"info"===t?(void 0===e._info&&(e._info=new e(e.INFO_LEVEL,t)),e._info):new e(e.INFO_LEVEL,t)},e.note=function(t){return void 0===t&&(t="note"),"note"===t?(void 0===e._note&&(e._note=new e(e.NOTE_LEVEL,t)),e._note):new e(e.NOTE_LEVEL,t)},e.warning=function(t){return void 0===t&&(t="warning"),"warning"===t?(void 0===e._warning&&(e._warning=new e(e.WARNING_LEVEL,t)),e._warning):new e(e.WARNING_LEVEL,t)},e.error=function(t){return void 0===t&&(t="error"),"error"===t?(void 0===e._error&&(e._error=new e(e.ERROR_LEVEL,t)),e._error):new e(e.ERROR_LEVEL,t)},e.alert=function(t){return void 0===t&&(t="alert"),"alert"===t?(void 0===e._alert&&(e._alert=new e(e.ALERT_LEVEL,t)),e._alert):new e(e.ALERT_LEVEL,t)},e.fatal=function(t){return void 0===t&&(t="fatal"),"fatal"===t?(void 0===e._fatal&&(e._fatal=new e(e.FATAL_LEVEL,t)),e._fatal):new e(e.FATAL_LEVEL,t)},e.TRACE_LEVEL=0,e.DEBUG_LEVEL=1,e.INFO_LEVEL=2,e.NOTE_LEVEL=3,e.WARNING_LEVEL=4,e.ERROR_LEVEL=5,e.ALERT_LEVEL=6,e.FATAL_LEVEL=7,e}(),R=function(){function e(e){this.buckets=new Array(e),this.gen4Hits=0,this.gen3Hits=0,this.gen2Hits=0,this.gen1Hits=0,this.misses=0}return e.prototype.get=function(e){if(0!==this.buckets.length){var t=Math.abs(P.hash(e))%this.buckets.length,r=this.buckets[t];if(void 0!==r){var n=r.gen4Key;if(void 0!==n&&P.equal(e,n)){var i=r.gen4Val;if(void 0!==i)return this.gen4Hits+=1,r.gen4Weight++,i;r.gen4Key=void 0}var o=r.gen3Key;if(void 0!==o&&P.equal(e,o)){var u=r.gen3Val;if(void 0!==u)return this.gen3Hits+=1,r.gen3Weight++>r.gen4Weight&&(this.buckets[t]=new U(r.gen3Key,r.gen3Val,r.gen3Weight,r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight)),u;r.gen3Key=void 0}var s=r.gen2Key;if(void 0!==s&&P.equal(e,s)){var a=r.gen2Val;if(void 0!==a)return this.gen2Hits+=1,r.gen2Weight++>r.gen3Weight&&(this.buckets[t]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight)),a;r.gen2Key=void 0}var p=r.gen1Key;if(void 0!==p&&P.equal(e,p)){var f=r.gen1Val;if(void 0!==f)return this.gen1Hits+=1,r.gen1Weight++>r.gen2Weight&&(this.buckets[t]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight,r.gen2Key,r.gen2Val,r.gen2Weight)),f;r.gen1Key=void 0}this.misses+=1}}},e.prototype.put=function(e,t){if(0===this.buckets.length)return t;var r=Math.abs(P.hash(e))%this.buckets.length,n=this.buckets[r]||new U,i=n.gen4Key;if(void 0!==i&&P.equal(e,i)){var o=n.gen4Val;if(void 0!==o)return this.gen4Hits+=1,n.gen4Weight++,o;n.gen4Key=void 0,i=void 0}var u=n.gen3Key;if(void 0!==u&&P.equal(e,u)){var s=n.gen3Val;if(void 0!==s)return this.gen3Hits+=1,n.gen3Weight++>n.gen4Weight&&(this.buckets[r]=new U(n.gen3Key,n.gen3Val,n.gen3Weight,n.gen4Key,n.gen4Val,n.gen4Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen1Key,n.gen1Val,n.gen1Weight)),s;n.gen3Key=void 0,u=void 0}var a=n.gen2Key;if(void 0!==a&&P.equal(e,a)){var p=n.gen2Val;if(void 0!==p)return this.gen2Hits+=1,n.gen2Weight++>n.gen3Weight&&(this.buckets[r]=new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen1Key,n.gen1Val,n.gen1Weight)),p;n.gen2Key=void 0,a=void 0}var f=n.gen1Key;if(void 0!==f&&P.equal(e,f)){var c=n.gen1Val;if(void 0!==c)return this.gen1Hits+=1,n.gen1Weight++>n.gen2Weight&&(this.buckets[r]=new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen1Key,n.gen1Val,n.gen1Weight,n.gen2Key,n.gen2Val,n.gen2Weight)),c;n.gen1Key=void 0,f=void 0}return this.misses+=1,this.buckets[r]=void 0===i?new U(n.gen3Key,n.gen3Val,n.gen3Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen1Key,n.gen1Val,n.gen1Weight,e,t,1):void 0===u?new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen1Key,n.gen1Val,n.gen1Weight,e,t,1):void 0===a?new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen1Key,n.gen1Val,n.gen1Weight,e,t,1):void 0===f?new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen2Key,n.gen2Val,n.gen2Weight,e,t,1):new U(n.gen4Key,n.gen4Val,n.gen4Weight-1,n.gen3Key,n.gen3Val,n.gen3Weight-1,n.gen1Key,n.gen1Val,n.gen1Weight,e,t,1),t},e.prototype.remove=function(e){if(0!==this.buckets.length){var t=Math.abs(P.hash(e))%this.buckets.length,r=this.buckets[t];if(void 0!==r){var n=r.gen4Key;if(void 0!==n&&P.equal(e,n)){var i=r.gen4Val;return this.buckets[t]=new U(r.gen3Key,r.gen3Val,r.gen3Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight,void 0,void 0,0),i}var o=r.gen3Key;if(void 0!==o&&P.equal(e,o)){var u=r.gen3Val;return this.buckets[t]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight,void 0,void 0,0),u}var s=r.gen2Key;if(void 0!==s&&P.equal(e,s)){var a=r.gen2Val;return this.buckets[t]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight,void 0,void 0,0),a}var p=r.gen1Key;if(void 0!==p&&P.equal(e,p)){var f=r.gen1Val;return this.buckets[t]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen2Key,r.gen2Val,r.gen2Weight,void 0,void 0,0),f}}}},e.prototype.clear=function(){for(var e=0;e<this.buckets.length;e+=1)this.buckets[e]=void 0},e.prototype.hits=function(){return this.gen4Hits+this.gen3Hits+this.gen2Hits+this.gen1Hits},e.prototype.hitRatio=function(){var e=this.hits();return e/(e+this.misses)},e}(),U=function(e,t,r,n,i,o,u,s,a,p,f,c){void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===c&&(c=0),this.gen4Key=e,this.gen4Val=t,this.gen4Weight=r,this.gen3Key=n,this.gen3Val=i,this.gen3Weight=o,this.gen2Key=u,this.gen2Val=s,this.gen2Weight=a,this.gen1Key=p,this.gen1Val=f,this.gen1Weight=c},N=function(){function e(e){this.buckets=new Array(e),this.gen4Hits=0,this.gen3Hits=0,this.gen2Hits=0,this.gen1Hits=0,this.misses=0}return e.prototype.put=function(e){if(0===this.buckets.length)return e;var t=Math.abs(P.hash(e))%this.buckets.length,r=this.buckets[t]||new z,n=r.gen4Val;if(void 0!==n&&P.equal(e,n))return this.gen4Hits+=1,r.gen4Weight++,n;var i=r.gen3Val;if(void 0!==i&&P.equal(e,i))return this.gen3Hits+=1,r.gen3Weight++>r.gen4Weight&&(this.buckets[t]=new z(r.gen3Val,r.gen3Weight,r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight)),i;var o=r.gen2Val;if(void 0!==o&&P.equal(e,o))return this.gen2Hits+=1,r.gen2Weight++>r.gen3Weight&&(this.buckets[t]=new z(r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight)),o;var u=r.gen1Val;return void 0!==u&&P.equal(e,u)?(this.gen1Hits+=1,r.gen1Weight++>r.gen2Weight&&(this.buckets[t]=new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight,r.gen2Val,r.gen2Weight)),u):(this.misses+=1,this.buckets[t]=void 0===n?new z(r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,e,1):void 0===i?new z(r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,e,1):void 0===o?new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight,e,1):void 0===u?new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,e,1):new z(r.gen4Val,r.gen4Weight-1,r.gen3Val,r.gen3Weight-1,r.gen1Val,r.gen1Weight,e,1),e)},e.prototype.remove=function(e){if(0===this.buckets.length)return!1;var t=Math.abs(P.hash(e))%this.buckets.length,r=this.buckets[t];if(void 0===r)return!1;var n=r.gen4Val;if(void 0!==n&&P.equal(e,n))return this.buckets[t]=new z(r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,void 0,0),!0;var i=r.gen3Val;if(void 0!==i&&P.equal(e,i))return this.buckets[t]=new z(r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,void 0,0),!0;var o=r.gen2Val;if(void 0!==o&&P.equal(e,o))return this.buckets[t]=new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight,void 0,0),!0;var u=r.gen1Val;return!(void 0===u||!P.equal(e,u))&&(this.buckets[t]=new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,void 0,0),!0)},e.prototype.clear=function(){for(var e=0;e<this.buckets.length;e+=1)this.buckets[e]=void 0},Object.defineProperty(e.prototype,"hits",{get:function(){return this.gen4Hits+this.gen3Hits+this.gen2Hits+this.gen1Hits},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hitRatio",{get:function(){var e=this.hits;return e/(e+this.misses)},enumerable:!1,configurable:!0}),e}(),z=function(e,t,r,n,i,o,u,s){void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=0),this.gen4Val=e,this.gen4Weight=t,this.gen3Val=r,this.gen3Weight=n,this.gen2Val=i,this.gen2Weight=o,this.gen1Val=u,this.gen1Weight=s},F=function(){},L=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"offset",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(o,"line",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(o,"column",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(o,"note",{value:i,enumerable:!0,configurable:!0}),o}return C(t,e),t.prototype.withNote=function(e){return this.note!==e?t.at(this.offset,this.line,this.column,e):this},t.prototype.min=function(e){return this.offset<=e.offset?this:e},t.prototype.max=function(e){return this.offset>=e.offset?this:e},Object.defineProperty(t.prototype,"start",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this},enumerable:!1,configurable:!0}),t.prototype.union=function(e){if(e instanceof t)return this.offset===e.offset&&this.line===e.line&&this.column===e.column?this:K.from(this,e);if(e instanceof K){var r=this.min(e.start),n=this.max(e.end);return r===e.start&&n===e.end?e:K.from(r,n)}throw new Error(e.toString())},t.prototype.shift=function(e){var r=this.offset+(this.offset-e.offset),n=this.line+(this.line-e.line),i=this.column;return 1===n&&(i+=this.column-e.column),r===this.offset&&n===this.line&&i===this.column?this:t.at(r,n,i,this.note)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.offset===e.offset&&this.line===e.line&&this.column===e.column&&this.note===e.note)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.offset)),b.hash(this.line)),b.hash(this.column)),m.hash(this.note)))},t.prototype.display=function(e){return e=(e=ne.displayNumber(e,this.line)).write(58),e=ne.displayNumber(e,this.column),void 0!==this.note&&(e=e.write(58).write(32).write(this.note)),e},t.prototype.debug=function(e){return e=e.write("Mark").write(".").write("at").write("("),e=(e=ne.debugNumber(e,this.offset)).write(", "),e=(e=ne.debugNumber(e,this.line)).write(", "),e=ne.debugNumber(e,this.column),void 0!==this.note&&(e=e.write(", "),e=ne.debugString(e,this.note)),e=e.write(")")},t.prototype.toString=function(){return ne.display(this)},Object.defineProperty(t,"zero",{get:function(){return new t(0,1,1,void 0)},enumerable:!1,configurable:!0}),t.at=function(e,r,n,i){return new t(e,r,n,i)},E([s],t,"zero",null),t}(F),K=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"start",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(n,"end",{value:r,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.union=function(e){if(e instanceof L){var r=this.start.min(e),n=this.end.max(e);return r===this.start&&n===this.end?this:t.from(r,n)}if(e instanceof t){r=this.start.min(e.start),n=this.end.max(e.end);return r===this.start&&n===this.end?this:t.from(r,n)}throw new Error(e.toString())},t.prototype.shift=function(e){var r=this.start.shift(e),n=this.end.shift(e);return r===this.start&&n===this.end?this:t.from(r,n)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.start.equals(e.start)&&this.end.equals(e.end))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.start.hashCode()),this.end.hashCode()))},t.prototype.display=function(e){return void 0!==this.start.note&&(e=e.write(this.start.note).write(58).write(32)),e=(e=ne.displayNumber(e,this.start.line)).write(58),e=(e=ne.displayNumber(e,this.start.column)).write(45),e=(e=ne.displayNumber(e,this.end.line)).write(58),e=ne.displayNumber(e,this.end.column),void 0!==this.end.note&&(e=e.write(58).write(32).write(this.end.note)),e},t.prototype.debug=function(e){return e=e.write("Span").write(".").write("from").write("("),e=(e=this.start.debug(e)).write(", "),e=(e=this.end.debug(e)).write(")")},t.prototype.toString=function(){return ne.display(this)},t.from=function(e,r){if(e.offset>r.offset){var n=e;e=r,r=n}return new t(e,r)},t}(F),B={reset:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(109)),e},bold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(109)),e},faint:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(50).write(109)),e},black:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(48).write(109)),e},red:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(49).write(109)),e},green:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(50).write(109)),e},yellow:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(51).write(109)),e},blue:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(52).write(109)),e},magenta:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(53).write(109)),e},cyan:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(54).write(109)),e},gray:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(48).write(59).write(51).write(55).write(109)),e},blackBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(48).write(109)),e},redBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(49).write(109)),e},greenBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(50).write(109)),e},yellowBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(51).write(109)),e},blueBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(52).write(109)),e},magentaBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(53).write(109)),e},cyanBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(54).write(109)),e},grayBold:function(e){return e.settings.isStyled()&&(e=e.write(27).write(91).write(49).write(59).write(51).write(55).write(109)),e}},W=function(){function e(e,t,r,n){Object.defineProperty(this,"lineSeparator",{value:e,enumerable:!0}),Object.defineProperty(this,"pretty",{value:t,enumerable:!0}),Object.defineProperty(this,"styled",{value:r,enumerable:!0}),Object.defineProperty(this,"precision",{value:n,enumerable:!0})}return e.prototype.withLineSeparator=function(e){return this.copy(e,this.pretty,this.styled,this.precision)},e.prototype.isPretty=function(){return this.pretty},e.prototype.asPretty=function(e){return this.copy(this.lineSeparator,e,this.styled,this.precision)},e.prototype.isStyled=function(){return this.styled},e.prototype.asStyled=function(e){return this.copy(this.lineSeparator,this.pretty,e,this.precision)},e.prototype.withPrecision=function(e){return this.copy(this.lineSeparator,this.pretty,this.styled,e)},e.prototype.copy=function(t,r,n,i){return e.create(t,r,n,i)},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this.lineSeparator===t.lineSeparator&&this.pretty===t.pretty&&this.styled===t.styled&&this.precision===t.precision)},e.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(w.hash(e),m.hash(this.lineSeparator)),v.hash(this.pretty)),v.hash(this.styled)),b.hash(this.precision)))},e.prototype.debug=function(e){return e=e.write("OutputSettings").write(46),e=(e=this.pretty||this.styled?this.pretty&&!this.styled?e.write("pretty"):!this.pretty&&this.styled?e.write("styled"):e.write("prettyStyled"):e.write("standard")).write(40).write(41),this.lineSeparator!==ne.lineSeparator&&(e=e.write(46).write("lineSeparator").write(40).display(this.lineSeparator).write(41)),-1!==this.precision&&(e=e.write(46).write("precision").write(40).display(this.precision).write(41)),e},e.prototype.toString=function(){return ne.debug(this)},e.standard=function(){return new e(ne.lineSeparator,!1,!1,-1)},e.pretty=function(){return new e(ne.lineSeparator,!0,!1,-1)},e.styled=function(){return new e(ne.lineSeparator,!1,!0,-1)},e.prettyStyled=function(){return new e(ne.lineSeparator,!0,!0,-1)},e.create=function(t,r,n,i){return"string"!=typeof t&&(t=ne.lineSeparator),"boolean"!=typeof r&&(r=!1),"boolean"!=typeof n&&(n=!1),"number"!=typeof i&&(i=-1),t===ne.lineSeparator&&-1===i?r||n?r&&!n?e.pretty():!r&&n?e.styled():e.prettyStyled():e.standard():new e(t,r,n,i)},e.fromInit=function(t){return e.create(t.lineSeparator,t.isPretty,t.isStyled,t.precision)},e.fromAny=function(t){return t instanceof e?t:"object"==typeof t&&null!==t?e.fromInit(t):e.standard()},E([s],e,"standard",null),E([s],e,"pretty",null),E([s],e,"styled",null),E([s],e,"prettyStyled",null),e}(),H=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),X=function(){function e(e){Object.defineProperty(this,"stripped",{value:e,enumerable:!0})}return e.prototype.isStripped=function(){return this.stripped},e.prototype.asStripped=function(e){return this.copy(e)},e.prototype.copy=function(t){return e.create(t)},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this.stripped===t.stripped)},e.prototype.hashCode=function(){return c.mash(c.mix(w.hash(e),v.hash(this.stripped)))},e.prototype.debug=function(e){return e=e.write("InputSettings").write(46),e=(e=this.stripped?e.write("stripped"):e.write("standard")).write(40).write(41)},e.prototype.toString=function(){return ne.debug(this)},e.standard=function(){return new e(!1)},e.stripped=function(){return new e(!0)},e.create=function(t){return t?e.stripped():e.standard()},e.fromAny=function(t){return t instanceof e?t:"object"==typeof t&&null!==t?e.create(t.isStripped):e.standard()},E([s],e,"standard",null),E([s],e,"stripped",null),e}(),Y=function(){function e(){}return e.prototype.trap=function(){throw new H},e.empty=function(){return new ue(void 0,L.zero,X.standard())},e.done=function(){return new se(void 0,L.zero,X.standard())},e.error=function(e){return new G(e,void 0,L.zero,X.standard())},E([s],e,"empty",null),E([s],e,"done",null),e}(),G=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"error",{value:t,enumerable:!0}),Object.defineProperty(o,"id",{value:r,enumerable:!0}),Object.defineProperty(o,"mark",{value:n,enumerable:!0}),Object.defineProperty(o,"settings",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isEmpty=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!0},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},t.prototype.head=function(){throw new H},t.prototype.step=function(){return new t(new H("error step"),this.id,this.mark,this.settings)},t.prototype.trap=function(){return this.error},t.prototype.seek=function(e){return new t(new H("error seek"),this.id,this.mark,this.settings)},t.prototype.withId=function(e){return new t(this.error,e,this.mark,this.settings)},t.prototype.withMark=function(e){return new t(this.error,this.id,e,this.settings)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return e=X.fromAny(e),new t(this.error,this.id,this.mark,e)},t.prototype.clone=function(){return this},t}(Y),_=function(e){function t(t,r,n,i,o,u,s,a){var p=e.call(this)||this;return Object.defineProperty(p,"string",{value:t,enumerable:!0}),Object.defineProperty(p,"index",{value:s,enumerable:!0,configurable:!0}),Object.defineProperty(p,"part",{value:a,enumerable:!0,configurable:!0}),Object.defineProperty(p,"id",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(p,"offset",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(p,"line",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(p,"column",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(p,"settings",{value:u,enumerable:!0,configurable:!0}),p}return C(t,e),t.prototype.isCont=function(){return this.index<this.string.length},t.prototype.isEmpty=function(){return this.part&&this.index>=this.string.length},t.prototype.isDone=function(){return!this.part&&this.index>=this.string.length},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return this.part},t.prototype.asPart=function(e){return Object.defineProperty(this,"part",{value:e,enumerable:!0,configurable:!0}),this},t.prototype.head=function(){var e=this.string,t=this.index;if(t<e.length){var r=e.codePointAt(t);return void 0!==r?r:e.charCodeAt(t)}throw new H},t.prototype.step=function(){var e=this.string,t=this.index;if(t<e.length){var r=e.codePointAt(t);return Object.defineProperty(this,"index",{value:e.offsetByCodePoints(t,1),enumerable:!0,configurable:!0}),Object.defineProperty(this,"offset",{value:this.offset+(this.index-t),enumerable:!0,configurable:!0}),10===r?(Object.defineProperty(this,"line",{value:this.line+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{value:1,enumerable:!0,configurable:!0})):Object.defineProperty(this,"column",{value:this.column+1,enumerable:!0,configurable:!0}),this}var n=new H("invalid step");return new G(n,this.id,this.mark,this.settings)},t.prototype.seek=function(e){if(void 0!==e){var t=this.index+(e.offset-this.offset);if(0<=t&&t<=this.string.length)return Object.defineProperty(this,"index",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(this,"offset",{value:e.offset,enumerable:!0,configurable:!0}),Object.defineProperty(this,"line",{value:e.line,enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{value:e.column,enumerable:!0,configurable:!0}),this;var r=new H("invalid seek to "+e);return new G(r,this.id,this.mark,this.settings)}return Object.defineProperty(this,"index",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"offset",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"line",{value:1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{value:1,enumerable:!0,configurable:!0}),this},t.prototype.withId=function(e){return Object.defineProperty(this,"id",{value:e,enumerable:!0,configurable:!0}),this},Object.defineProperty(t.prototype,"mark",{get:function(){return L.at(this.offset,this.line,this.column)},enumerable:!1,configurable:!0}),t.prototype.withMark=function(e){return Object.defineProperty(this,"offset",{value:e.offset,enumerable:!0,configurable:!0}),Object.defineProperty(this,"line",{value:e.line,enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{value:e.column,enumerable:!0,configurable:!0}),this},t.prototype.withSettings=function(e){return e=X.fromAny(e),Object.defineProperty(this,"settings",{value:e,enumerable:!0,configurable:!0}),this},t.prototype.clone=function(){return new t(this.string,this.id,this.offset,this.line,this.column,this.settings,this.index,this.part)},t.create=function(e){return new t(e,void 0,0,1,1,X.standard(),0,!1)},t}(Y),Q=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),Z=function(){function e(){}return e.prototype.writeln=function(e){return"string"==typeof e&&this.write(e),this.write(this.settings.lineSeparator)},e.prototype.display=function(e){return ne.displayAny(this,e)},e.prototype.debug=function(e){return ne.debugAny(this,e)},e.prototype.flush=function(){return this},e.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length,n=0;n<r;n+=1)this.write(e[n])},e.prototype.trap=function(){throw new Q},e.prototype.clone=function(){throw new Error},e.full=function(){return new le(W.standard())},e.done=function(){return new he(W.standard())},e.error=function(e){return new de(e,W.standard())},E([s],e,"full",null),E([s],e,"done",null),e}(),J=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"string",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(n,"settings",{value:r,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.isCont=function(){return!0},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},t.prototype.write=function(e){if("number"==typeof e)if(e>=0&&e<=55295||e>=57344&&e<=65535)e=String.fromCharCode(e);else if(e>=65536&&e<=1114111){var t=e-65536;e=String.fromCharCode(55296|t>>>10,56320|1023&t)}else e="ï¿½";return Object.defineProperty(this,"string",{value:this.string+e,enumerable:!0,configurable:!0}),this},t.prototype.writeln=function(e){return void 0===e?(Object.defineProperty(this,"string",{value:this.string.concat(this.settings.lineSeparator),enumerable:!0,configurable:!0}),this):(Object.defineProperty(this,"string",{value:this.string.concat(e).concat(this.settings.lineSeparator),enumerable:!0,configurable:!0}),this)},t.prototype.withSettings=function(e){return e=W.fromAny(e),Object.defineProperty(this,"settings",{value:e,enumerable:!0,configurable:!0}),this},t.prototype.bind=function(){return this.string},t.prototype.clone=function(){return new t(this.string,this.settings)},t.prototype.toString=function(){return this.string},t}(Z),$=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),ee=function(){function e(){}return e.prototype.isCont=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.feed=function(e){throw new $},e.prototype.fork=function(e){return this},e.prototype.bind=function(){throw new $},e.prototype.trap=function(){throw new $},e.prototype.asDone=function(){throw new $},e.prototype.asError=function(){throw new $},e.prototype.andThen=function(e){return new Ee(this,e)},e.end=function(){return new xe},e.done=function(e){return new je(e)},e.error=function(e){return new Ce(e)},E([s],e,"end",null),e}(),te=function(e){function t(t,r,n){void 0===n&&(n=0);var i=e.call(this)||this;return Object.defineProperty(i,"value",{value:t,enumerable:!0}),Object.defineProperty(i,"input",{value:r,enumerable:!0}),Object.defineProperty(i,"index",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.feed=function(e){return new t(e,""+e)},t.prototype.pull=function(e){return t.write(e,this.value,this.input,this.index)},t.write=function(e,r,n,i){void 0===i&&(i=0);for(var o=n.length;i<o&&e.isCont();){var u=n.codePointAt(i);void 0===u&&(u=n.charCodeAt(i)),e=e.write(u),i=n.offsetByCodePoints(i,1)}return i===o?ee.done(r):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i)},t}(ee),re={stringInput:function(e){return _.create(e)},stringOutput:function(e,t){return void 0===t&&"string"!=typeof e?(t=e,e=""):"string"!=typeof e&&(e=""),t=W.fromAny(t),new J(e,t)},stringWriter:function(e){return void 0===e?new te(void 0,""):new te(e,""+e)},writeString:function(e,t){return te.write(e,void 0,""+t)},isAlpha:function(e){return e>=65&&e<=90||e>=97&&e<=122},isDigit:function(e){return e>=48&&e<=57},isSpace:function(e){return 32===e||9===e},isNewline:function(e){return 10===e||13===e},isWhitespace:function(e){return re.isSpace(e)||re.isNewline(e)}},ne={};Object.defineProperty(ne,"lineSeparator",{get:function(){var e;if("undefined"!=typeof global&&"function"==typeof global.require){var t=global.require("os");"object"==typeof t&&null!==t&&(e=t.EOL)}return void 0===e&&(e="\n"),Object.defineProperty(ne,"lineSeparator",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),ne.display=function(e,t){if(void 0===e)return"undefined";if(null===e)return"null";if("number"==typeof e)return""+e;if("string"==typeof e)return e;if("function"==typeof e.display){var r=re.stringOutput(t);return(r=e.display(r)).bind()}return""+e},ne.debug=function(e,t){if(void 0===e)return"undefined";if(null===e)return"null";if("number"==typeof e)return""+e;if("string"==typeof e){var r=re.stringOutput(t);return(r=ne.debugString(r,e)).bind()}if("function"==typeof e.debug){r=re.stringOutput(t);return(r=e.debug(r)).bind()}return""+e},ne.displayAny=function(e,t){return e=void 0===t?e.write("undefined"):null===t?e.write("null"):"number"==typeof t?ne.displayNumber(e,t):"string"==typeof t?e.write(t):"function"==typeof t.display?t.display(e):e.write(""+t)},ne.debugAny=function(e,t){return e=void 0===t?e.write("undefined"):null===t?e.write("null"):"number"==typeof t?ne.debugNumber(e,t):"string"==typeof t?ne.debugString(e,t):"function"==typeof t.debug?t.debug(e):e.write(""+t)},ne.displayNumber=function(e,t){if(isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<2147483648)if(t<0&&(e=e.write(45)),t>-10&&t<10)e=e.write(48+Math.abs(t));else{for(var r=new Array(19),n=t,i=18;0!==n;)r[i]=Math.abs(n%10|0),n=n/10|0,i-=1;for(i+=1;i<19;)e=e.write(48+r[i]),i+=1}else e=e.write(ne.decimal(t,e.settings.precision));return e},ne.debugNumber=function(e,t){return ne.displayNumber(e,t)},ne.debugChar=function(e,t){switch(e=e.write(39),t){case 8:e.write(92).write(98);break;case 9:e.write(92).write(116);break;case 10:e.write(92).write(110);break;case 12:e.write(92).write(102);break;case 13:e.write(92).write(114);break;case 34:e.write(92).write(34);break;case 39:e.write(92).write(39);break;case 92:e.write(92).write(92);break;default:e=t>=0&&t<=31||t>=127&&t<=159?e.write(92).write(117).write(ne.encodeHex(t>>>12&15)).write(ne.encodeHex(t>>>8&15)).write(ne.encodeHex(t>>>4&15)).write(ne.encodeHex(15&t)):e.write(t)}return e=e.write(39)},ne.debugString=function(e,t){e=e.write(34);for(var r=re.stringInput(t);r.isCont();){var n=r.head();switch(n){case 8:e.write(92).write(98);break;case 9:e.write(92).write(116);break;case 10:e.write(92).write(110);break;case 12:e.write(92).write(102);break;case 13:e.write(92).write(114);break;case 34:e.write(92).write(34);break;case 92:e.write(92).write(92);break;default:e=n>=0&&n<=31||n>=127&&n<=159?e.write(92).write(117).write(ne.encodeHex(n>>>12&15)).write(ne.encodeHex(n>>>8&15)).write(ne.encodeHex(n>>>4&15)).write(ne.encodeHex(15&n)):e.write(n)}r=r.step()}return e=e.write(34)},ne.encodeHex=function(e){return e<10?48+e:e-10+65},ne.prefix=(V=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E"," Z","Y"],function(e,t){if(void 0===t&&(t=1),isFinite(e)){var r=Math.abs(e).toExponential(),n=r.indexOf("e"),i=n>=0?+r.slice(n+1):NaN,o=3*Math.min(Math.max(-8,Math.floor(i/3)),8),u=Math.pow(10,-o)*e,s=ne.trimTrailingZeros(Math.abs(u).toFixed(t));return u<0&&0!=+s&&(s="-"+s),s+=V[8+o/3]}return""+e}),ne.decimal=function(e,t){if(void 0===t&&(t=-1),t>=0){var r=ne.trimTrailingZeros(Math.abs(e).toFixed(t));return e<0&&0!=+r&&(r="-"+r),r}return""+e},ne.trimTrailingZeros=function(e){for(var t,r=-1,n=1,i=e.length;n<i;n+=1){var o=e.charCodeAt(n);if(46===o)r=n,t=n;else if(48===o)0===r&&(r=n),t=n;else if(o>=49&&o<=57)r>0&&(r=0);else if(r>0)break}return r>0&&(e=e.slice(0,r)+e.slice(t+1)),e},ne.duration=function(e,t){if(void 0===t&&(t=" "),isFinite(e)){var r=1e3,n=6e4,i=36e5,o=24*i,u=7*o,s=void 0;e>u&&(s=Math.floor(e/u),e%=u);var a=void 0;e>o&&(a=Math.floor(e/o),e%=o);var p=void 0;e>i&&(p=Math.floor(e/i),e%=i);var f=void 0;e>n&&(f=Math.floor(e/n),e%=n);var c=void 0;e>r&&(c=Math.floor(e/r),e%=r);var l="";return void 0!==s&&(l+=s+"w"),void 0!==a&&(l+=(0!==l.length?t:"")+a+"d"),void 0!==p&&(l+=(0!==l.length?t:"")+p+"h"),void 0!==f&&(l+=(0!==l.length?t:"")+f+"m"),void 0===c&&0!==e||(l+=(0!==l.length?t:"")+(void 0!==c?c:0)+"s"),0!==e&&0===l.length&&(l+=e+"ms"),l}return""+e};var ie={isDigit:function(e){return e>=48&&e<=57},decodeDigit:function(e){if(e>=48&&e<=57)return e-48;var t=re.stringOutput();throw t=t.write("Invalid base-10 digit: "),t=ne.debugChar(t,e),new Error(t.bind())},encodeDigit:function(e){if(e>=0&&e<=9)return 48+e;throw new Error(""+e)},countDigits:function(e){var t=0;do{t+=1,e=e/10|0}while(0!==e);return t},integerParser:function(){return new Ne(void 0,void 0,0)},parseInteger:function(e){return Ne.parse(e,void 0,void 0,0)},decimalParser:function(){return new Ne(void 0,void 0,1)},parseDecimal:function(e){return Ne.parse(e,void 0,void 0,1)},numberParser:function(){return new Ne},parseNumber:function(e){return Ne.parse(e)},integerWriter:function(e){return new Fe(void 0,void 0===e?0:e)},writeInteger:function(e,t){return Fe.write(e,void 0,t)}},oe=function(){function e(e,t,r,n,i,o){Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),Object.defineProperty(this,"tag",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(this,"severity",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(this,"note",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:o,enumerable:!0,configurable:!0})}return e.prototype.lineDigits=function(){var e=ie.countDigits(this.tag.end.line);return null!==this.cause&&(e=Math.max(e,this.cause.lineDigits())),e},e.prototype.display=function(t){var r=this.input.clone(),n=this.tag.start,i=this.tag.end,o=this.severity,u=this.message,s=this.note,a=this.cause,p=this.lineDigits();return t=e.display(t,r,n,i,o,u,s,a,2,p)},e.display=function(t,r,n,i,o,u,s,a,p,f){for(;;){void 0!==u&&(t=(t=e.displayMessage(t,o,u)).writeln()),t=(t=e.displayAnchor(t,r,n,f)).writeln();var c=e.displayContext(t,r,n,i,o,s,a,p,f),l=c[0];if(t=c[1],null===l)break;t=t.writeln(),r=l.input.clone(),n=l.tag.start,i=l.tag.end,o=l.severity,u=l.message,s=l.note,a=l.cause}return t},e.displayMessage=function(t,r,n){return t=(t=e.formatSeverity(t,r)).write(r.label),t=B.reset(t),t=(t=B.bold(t)).write(58),void 0!==n&&(t=t.write(32).write(n)),t=B.reset(t)},e.displayAnchor=function(t,r,n,i){t=(t=e.displayLineLeadArrow(t,i)).write(32);var o=r.id;return void 0!==o&&(t=ne.displayAny(t,o)),t=t.write(58),t=(t=ne.displayNumber(t,n.line)).write(58),t=(t=ne.displayNumber(t,n.column)).writeln(),t=e.displayLineLead(t,i)},e.displayContext=function(t,r,n,i,o,u,s,a,p){var f,c=s,l=null!==s&&void 0===s.message&&P.equal(r.id,s.input.id)?n.offset<=s.tag.start.offset?-1:1:0;1===l&&(c=(f=e.displayContext(t,s.input.clone(),s.tag.start,s.tag.end,s.severity,s.note,s.cause,a,p))[0],t=(t=f[1]).writeln(),t=(t=e.displayLineLeadEllipsis(t,p)).writeln());(t=e.displayLines(t,r,n,i,o,a,p),void 0!==u&&(t=e.displayNote(t,u,p)),-1===l)&&(t=t.writeln(),t=(t=e.displayLineLeadEllipsis(t,p)).writeln(),c=(f=e.displayContext(t,s.input.clone(),s.tag.start,s.tag.end,s.severity,s.note,s.cause,a,p))[0],t=f[1]);return[c,t]},e.displayLines=function(t,r,n,i,o,u,s){for(var a=n.line,p=i.line,f=r.line;f<a;)e.consumeLineText(r,f),f+=1;if(p-a>2*u+2){for(;f<=a+u;)t=e.displayLine(t,r,n,i,o,f,s),f+=1;for(t=(t=e.displayLineLeadEllipsis(t,s)).write(32),t=(t=e.formatSeverity(t,o)).write(124),t=(t=B.reset(t)).writeln();f<p-u;)e.consumeLineText(r,f),f+=1}for(;f<=p;)t=e.displayLine(t,r,n,i,o,f,s),f+=1;return t},e.displayNote=function(t,r,n){return t=t.writeln(),t=(t=e.displayLineLead(t,n)).writeln(),t=e.displayLineComment(t,"note",r,n)},e.displayLine=function(t,r,n,i,o,u,s){return t=n.line===u&&i.line===u?e.displaySingleLine(t,r,n,i,o,u,s):n.line===u?e.displayStartLine(t,r,n,o,u,s):i.line===u?e.displayEndLine(t,r,i,o,u,s):e.displayMidLine(t,r,o,u,s)},e.displaySingleLine=function(t,r,n,i,o,u,s){t=(t=e.displayLineLeadNumber(t,u,s)).write(32);for(var a=1;a<r.column;a+=1)t=t.write(32);t=e.displayLineText(t,r,u),t=(t=e.displayLineLead(t,s)).write(32);for(var p=1;p<n.column;)t=t.write(32),p+=1;for(t=e.formatSeverity(t,o);p<=i.column;)t=t.write(94),p+=1;return void 0!==i.note&&(t=t.write(32).write(i.note)),t=B.reset(t)},e.displayStartLine=function(t,r,n,i,o,u){t=(t=e.displayLineLeadNumber(t,o,u)).write(32).write(32).write(32);for(var s=1;s<r.column;s+=1)t=t.write(32);t=e.displayLineText(t,r,o),t=(t=e.displayLineLead(t,u)).write(32).write(32),t=(t=e.formatSeverity(t,i)).write(95);for(var a=1;a<n.column;)t=t.write(95),a+=1;return t=t.write(94),void 0!==n.note&&(t=t.write(32).write(n.note)),t=(t=B.reset(t)).writeln()},e.displayEndLine=function(t,r,n,i,o,u){t=(t=e.displayLineLeadNumber(t,o,u)).write(32),t=(t=e.formatSeverity(t,i)).write(124),t=(t=B.reset(t)).write(32),t=e.displayLineText(t,r,o),t=(t=e.displayLineLead(t,u)).write(32),t=(t=e.formatSeverity(t,i)).write(124).write(95);for(var s=1;s<n.column;)t=t.write(95),s+=1;return t=t.write(94),void 0!==n.note&&(t=t.write(32).write(n.note)),t=B.reset(t)},e.displayMidLine=function(t,r,n,i,o){return t=(t=e.displayLineLeadNumber(t,i,o)).write(32),t=(t=e.formatSeverity(t,n)).write(124),t=(t=B.reset(t)).write(32),t=e.displayLineText(t,r,i)},e.displayLineComment=function(t,r,n,i){return t=(t=e.displayLineLeadComment(t,i)).write(32),t=(t=B.bold(t)).write(r).write(58),t=B.reset(t),void 0!==n&&(t=t.write(32).write(n)),t},e.displayLineLead=function(e,t){e=B.blueBold(e);for(var r=1+t,n=0;n<r;n+=1)e=e.write(32);return e=e.write(124),e=B.reset(e)},e.displayLineLeadComment=function(e,t){e=B.blueBold(e);for(var r=1+t,n=0;n<r;n+=1)e=e.write(32);return e=e.write(61),e=B.reset(e)},e.displayLineLeadArrow=function(e,t){for(var r=0;r<t;r+=1)e=e.write(32);return e=(e=B.blueBold(e)).write(45).write(45).write(62),e=B.reset(e)},e.displayLineLeadEllipsis=function(e,t){e=B.blueBold(e);for(var r=0;r<t;r+=1)e=e.write(46);return e=(e=B.reset(e)).write(32).write(32)},e.displayLineLeadNumber=function(e,t,r){for(var n=r-ie.countDigits(t),i=0;i<n;i+=1)e=e.write(32);return e=B.blueBold(e),e=(e=ne.displayNumber(e,t)).write(32).write(124),e=B.reset(e)},e.displayLineText=function(e,t,r){for(;t.isCont()&&t.line===r;)e=e.write(t.head()),t=t.step();return t.line===r&&(e=e.writeln()),e},e.consumeLineText=function(e,t){for(;e.isCont()&&e.line===t;)e=e.step()},e.formatSeverity=function(e,t){switch(t.level){case q.FATAL_LEVEL:case q.ALERT_LEVEL:case q.ERROR_LEVEL:e=B.redBold(e);break;case q.WARNING_LEVEL:e=B.yellowBold(e);break;case q.NOTE_LEVEL:e=B.greenBold(e);break;case q.INFO_LEVEL:e=B.cyanBold(e);break;case q.DEBUG_LEVEL:case q.TRACE_LEVEL:default:e=B.magentaBold(e)}return e},e.prototype.toString=function(e){return ne.display(this,e)},e.create=function(t,r,n,i,o,u){return 3===arguments.length?(u=null,o=void 0,i=void 0):4===arguments.length?null===i||i instanceof e?(u=i,i=void 0):u=null:5===arguments.length?null===o||o instanceof e?(u=o,o=void 0):u=null:void 0===u&&(u=null),new e(t.clone(),r,n,i,o,u)},e.message=function(t,r,n,i,o){2===arguments.length?(o=null,i=void 0,n=q.error()):3===arguments.length?null===n||n instanceof e?(o=n,n=q.error()):"string"==typeof n?(o=null,i=n,n=q.error()):o=null:4===arguments.length?"string"==typeof n?(o=i,i=n,n=q.error()):null===i||i instanceof e?(o=i,i=void 0):o=null:void 0===o&&(o=null);var u=r.mark,s=r.clone();return s.seek(),new e(s,u,n,t,i,o)},e.unexpected=function(t,r,n,i){var o;if(1===arguments.length?(i=null,r=q.error()):2===arguments.length?null===r||r instanceof e?(i=r,r=q.error()):"string"==typeof r?(i=null,n=r,r=q.error()):i=null:3===arguments.length?"string"==typeof r?(i=n,n=r,r=q.error()):null===n||n instanceof e?(i=n,n=void 0):i=null:void 0===i&&(i=null),t.isCont()){var u=re.stringOutput().write("unexpected").write(32);o=(u=ne.debugChar(u,t.head())).bind()}else o="unexpected end of input";var s=t.mark,a=t.clone();return a.seek(),new e(a,s,r,o,n,i)},e.expected=function(t,r,n,i,o){2===arguments.length?(o=null,n=q.error()):3===arguments.length?null===n||n instanceof e?(o=n,n=q.error()):"string"==typeof n?(o=null,i=n,n=q.error()):o=null:4===arguments.length?"string"==typeof n?(o=i,i=n,n=q.error()):null===i||i instanceof e?(o=i,i=void 0):o=null:void 0===o&&(o=null);var u=re.stringOutput().write("expected").write(32);u=(u="number"==typeof t?ne.debugChar(u,t):u.write(t)).write(44).write(32).write("but found").write(32);var s=(u=r.isCont()?ne.debugChar(u,r.head()):u.write("end of input")).bind(),a=r.mark,p=r.clone();return p.seek(),new e(p,a,n,s,i,o)},e}(),ue=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"id",{value:t,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isEmpty=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!0},t.prototype.asPart=function(e){return e?this:new se(this.id,this.mark,this.settings)},t.prototype.head=function(){throw new H},t.prototype.step=function(){var e=new H("empty step");return new G(e,this.id,this.mark,this.settings)},t.prototype.seek=function(e){var t=new H("empty seek");return new G(t,this.id,this.mark,this.settings)},t.prototype.withId=function(e){return new t(e,this.mark,this.settings)},t.prototype.withMark=function(e){return new t(this.id,e,this.settings)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return e=X.fromAny(e),new t(this.id,this.mark,e)},t.prototype.clone=function(){return this},t}(Y),se=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"id",{value:t,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isEmpty=function(){return!1},t.prototype.isDone=function(){return!0},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return e?new ue(this.id,this.mark,this.settings):this},t.prototype.head=function(){throw new H},t.prototype.step=function(){var e=new H("done step");return new G(e,this.id,this.mark,this.settings)},t.prototype.seek=function(e){var t=new H("empty seek");return new G(t,this.id,this.mark,this.settings)},t.prototype.withId=function(e){return new t(e,this.mark,this.settings)},t.prototype.withMark=function(e){return new t(this.id,e,this.settings)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return e=X.fromAny(e),new t(this.id,this.mark,e)},t.prototype.clone=function(){return this},t}(Y),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.empty=function(){return new pe(void 0,L.zero,X.standard())},t.done=function(){return new fe(void 0,L.zero,X.standard())},t.error=function(e){return new ce(e,void 0,L.zero,X.standard())},E([s],t,"empty",null),E([s],t,"done",null),t}(Y),pe=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"id",{value:t,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isEmpty=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!0},t.prototype.asPart=function(e){return e?this:new fe(this.id,this.mark,this.settings)},Object.defineProperty(t.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withIndex=function(e){if(0===e)return this;var t=new H("invalid index");return new ce(t,this.id,this.mark,this.settings)},Object.defineProperty(t.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withLimit=function(e){if(0===e)return this;var t=new H("invalid limit");return new ce(t,this.id,this.mark,this.settings)},Object.defineProperty(t.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){throw new H},t.prototype.set=function(e,t){throw new H},t.prototype.head=function(){throw new H},t.prototype.step=function(e){var t=new H("empty step");return new ce(t,this.id,this.mark,this.settings)},t.prototype.seek=function(e){var t=new H("empty seek");return new ce(t,this.id,this.mark,this.settings)},t.prototype.withId=function(e){return new t(e,this.mark,this.settings)},t.prototype.withMark=function(e){return new t(this.id,e,this.settings)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return e=X.fromAny(e),new t(this.id,this.mark,e)},t.prototype.clone=function(){return this},t}(ae),fe=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"id",{value:t,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isEmpty=function(){return!1},t.prototype.isDone=function(){return!0},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return e?new pe(this.id,this.mark,this.settings):this},Object.defineProperty(t.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withIndex=function(e){if(0===e)return this;var t=new H("invalid index");return new ce(t,this.id,this.mark,this.settings)},Object.defineProperty(t.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withLimit=function(e){if(0===e)return this;var t=new H("invalid limit");return new ce(t,this.id,this.mark,this.settings)},Object.defineProperty(t.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){throw new H},t.prototype.set=function(e,t){throw new H},t.prototype.head=function(){throw new H},t.prototype.step=function(e){var t=new H("done step");return new ce(t,this.id,this.mark,this.settings)},t.prototype.seek=function(e){var t=new H("done seek");return new ce(t,this.id,this.mark,this.settings)},t.prototype.withId=function(e){return new t(e,this.mark,this.settings)},t.prototype.withMark=function(e){return new t(this.id,e,this.settings)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return e=X.fromAny(e),new t(this.id,this.mark,e)},t.prototype.clone=function(){return this},t}(ae),ce=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"error",{value:t,enumerable:!0}),Object.defineProperty(o,"id",{value:r,enumerable:!0}),Object.defineProperty(o,"mark",{value:n,enumerable:!0}),Object.defineProperty(o,"settings",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isEmpty=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!0},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},Object.defineProperty(t.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withIndex=function(e){return 0===e?this:new t(new H("invalid index"),this.id,this.mark,this.settings)},Object.defineProperty(t.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withLimit=function(e){return 0===e?this:new t(new H("invalid limit"),this.id,this.mark,this.settings)},Object.defineProperty(t.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){throw new H},t.prototype.set=function(e,t){throw new H},t.prototype.head=function(){throw new H},t.prototype.step=function(e){return new t(new H("error step"),this.id,this.mark,this.settings)},t.prototype.trap=function(){return this.error},t.prototype.seek=function(e){return new t(new H("error seek"),this.id,this.mark,this.settings)},t.prototype.withId=function(e){return new t(this.error,e,this.mark,this.settings)},t.prototype.withMark=function(e){return new t(this.error,this.id,e,this.settings)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return e=X.fromAny(e),new t(this.error,this.id,this.mark,e)},t.prototype.clone=function(){return this},t}(ae),le=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"settings",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isFull=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!0},t.prototype.asPart=function(e){return e?this:new he(this.settings)},t.prototype.write=function(e){return new de(new Q("full"),this.settings)},t.prototype.writeln=function(e){return new de(new Q("full"),this.settings)},t.prototype.bind=function(){throw new Q},t.prototype.withSettings=function(e){return new t(e=W.fromAny(e))},t.prototype.clone=function(){return this},t}(Z),he=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"settings",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!0},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return e?new le(this.settings):this},t.prototype.write=function(e){return new de(new Q("done"),this.settings)},t.prototype.writeln=function(e){return new de(new Q("done"),this.settings)},t.prototype.bind=function(){throw new Q},t.prototype.withSettings=function(e){return new t(e=W.fromAny(e))},t.prototype.clone=function(){return this},t}(Z),de=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"error",{value:t,enumerable:!0}),Object.defineProperty(n,"settings",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!0},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},t.prototype.write=function(e){return this},t.prototype.writeln=function(e){return this},t.prototype.bind=function(){throw new Q},t.prototype.trap=function(){return this.error},t.prototype.withSettings=function(e){return e=W.fromAny(e),new t(this.error,e)},t.prototype.clone=function(){return this},t}(Z),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeln=function(e){return"string"==typeof e&&this.write(e),this.write(this.settings.lineSeparator)},t.prototype.flush=function(){return this},t.prototype.clone=function(){throw new Error},t.full=function(){return new ve(W.standard())},t.done=function(){return new be(W.standard())},t.error=function(e){return new me(e,W.standard())},E([s],t,"full",null),E([s],t,"done",null),t}(Z),ve=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"settings",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isFull=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!0},t.prototype.asPart=function(e){return e?this:new be(this.settings)},Object.defineProperty(t.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withIndex=function(e){return 0===e?this:new me(new Q("invalid index"),this.settings)},Object.defineProperty(t.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withLimit=function(e){return 0===e?this:new me(new Q("invalid limit"),this.settings)},Object.defineProperty(t.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){throw new Q},t.prototype.set=function(e,t){throw new Q},t.prototype.write=function(e){return new me(new Q("full"),this.settings)},t.prototype.writeln=function(e){return new me(new Q("full"),this.settings)},t.prototype.step=function(e){return void 0===e&&(e=1),0===e?this:new me(new Q("invalid step"),this.settings)},t.prototype.bind=function(){throw new Q},t.prototype.withSettings=function(e){return new t(e=W.fromAny(e))},t.prototype.clone=function(){return this},t}(ye),be=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"settings",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!0},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return e?new ve(this.settings):this},Object.defineProperty(t.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withIndex=function(e){return 0===e?this:new me(new Q("invalid index"),this.settings)},Object.defineProperty(t.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withLimit=function(e){return 0===e?this:new me(new Q("invalid limit"),this.settings)},Object.defineProperty(t.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){throw new Q},t.prototype.set=function(e,t){throw new Q},t.prototype.write=function(e){return new me(new Q("done"),this.settings)},t.prototype.writeln=function(e){return new me(new Q("done"),this.settings)},t.prototype.step=function(e){return void 0===e&&(e=1),0===e?this:new me(new Q("invalid step"),this.settings)},t.prototype.bind=function(){throw new Q},t.prototype.withSettings=function(e){return new t(e=W.fromAny(e))},t.prototype.clone=function(){return this},t}(ye),me=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"error",{value:t,enumerable:!0}),Object.defineProperty(n,"settings",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!0},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},Object.defineProperty(t.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withIndex=function(e){return 0===e?this:new t(new Q("invalid index"),this.settings)},Object.defineProperty(t.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.withLimit=function(e){return 0===e?this:new t(new Q("invalid limit"),this.settings)},Object.defineProperty(t.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){throw new Q},t.prototype.set=function(e,t){throw new Q},t.prototype.write=function(e){return this},t.prototype.writeln=function(e){return this},t.prototype.step=function(e){return void 0===e&&(e=1),0===e?this:new t(new Q("invalid step"),this.settings)},t.prototype.bind=function(){throw new Q},t.prototype.trap=function(){return this.error},t.prototype.withSettings=function(e){return e=W.fromAny(e),new t(this.error,e)},t.prototype.clone=function(){return this},t}(ye),ge=function(e){function t(r){var n=e.call(this,r instanceof oe?r.message:r)||this;return Object.setPrototypeOf(n,t.prototype),Object.defineProperty(n,"diagnostic",{value:r instanceof oe?r:null,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.toString=function(){return null!==this.diagnostic?this.diagnostic.toString():e.prototype.toString.call(this)},t}(Error),we=function(){function e(){}return e.prototype.isCont=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.fork=function(e){return this},e.prototype.bind=function(){throw new ge},e.prototype.trap=function(){throw new ge},e.prototype.asError=function(){throw new ge},e.done=function(e){return new Oe(e)},e.error=function(e){return e instanceof Error?new Pe(e):new Pe(new ge(e))},e}(),Oe=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isDone=function(){return!0},t.prototype.feed=function(e){return this},t.prototype.bind=function(){return this.value},t}(we),Pe=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"error",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isError=function(){return!0},t.prototype.feed=function(e){return this},t.prototype.bind=function(){throw this.error},t.prototype.trap=function(){return this.error},t.prototype.asError=function(){return this},t}(we),xe=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isDone=function(){return!0},t.prototype.pull=function(e){return this},t.prototype.bind=function(){throw new $},t.prototype.asDone=function(){return this},t.prototype.andThen=function(e){return e},t}(ee),je=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isDone=function(){return!0},t.prototype.pull=function(e){return this},t.prototype.bind=function(){return this.value},t.prototype.asDone=function(){return this},t.prototype.andThen=function(e){return e},t}(ee),Ce=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"error",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isCont=function(){return!1},t.prototype.isError=function(){return!0},t.prototype.pull=function(e){return this},t.prototype.bind=function(){throw this.error},t.prototype.trap=function(){return this.error},t.prototype.asError=function(){return this},t.prototype.andThen=function(e){return this},t}(ee),Ee=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"head",{value:t,enumerable:!0}),Object.defineProperty(n,"tail",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.pull=function(e){var r=this.head;return r.isCont()&&(r=r.pull(e)),r.isError()?r.asError():r.isDone()?this.tail.pull(e):new t(r,this.tail)},t}(ee),Se=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"array",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(i,"size",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0,configurable:!0}),i}return C(t,e),t.prototype.isCont=function(){return!0},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},t.prototype.write=function(e){if("number"==typeof e){var r=this.size,n=this.array,i=void 0;return null===n||r+1>n.length?(i=new Uint8Array(t.expand(r+1)),null!==n&&i.set(n,0),Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0})):i=n,i[r]=e,Object.defineProperty(this,"size",{value:r+1,enumerable:!0,configurable:!0}),this}throw new TypeError(""+e)},t.prototype.writeln=function(e){throw new TypeError(""+e)},t.prototype.toUint8Array=function(){var e=this.size,t=this.array;if(null!==t&&e===t.length)return t;var r=new Uint8Array(e);return null!==t&&r.set(t.slice(0,e),0),Object.defineProperty(this,"array",{value:r,enumerable:!0,configurable:!0}),r},t.prototype.cloneArray=function(){var e=this.array;return null!==e?e.slice(0,this.size):null},t.prototype.withSettings=function(e){return e=W.fromAny(e),Object.defineProperty(this,"settings",{value:e,enumerable:!0,configurable:!0}),this},t.expand=function(e){return e=Math.max(32,e)-1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1},t}(Z),ke=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return C(t,e),t.prototype.bind=function(){return this.toUint8Array()},t.prototype.clone=function(){return new t(this.cloneArray(),this.size,this.settings)},t}(Se),Me=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return Object.defineProperty(u,"array",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(u,"index",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(u,"limit",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(u,"part",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(u,"settings",{value:o,enumerable:!0,configurable:!0}),u}return C(t,e),t.prototype.isCont=function(){return this.index<this.limit},t.prototype.isFull=function(){return this.part&&this.index>=this.limit},t.prototype.isDone=function(){return!this.part&&this.index>=this.limit},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return this.part},t.prototype.asPart=function(e){return Object.defineProperty(this,"part",{value:e,enumerable:!0,configurable:!0}),this},t.prototype.withIndex=function(e){return 0<=e&&e<=this.limit?(Object.defineProperty(this,"index",{value:e,enumerable:!0,configurable:!0}),this):new me(new Q("invalid index"),this.settings)},t.prototype.withLimit=function(e){return 0<=e&&e<=this.array.length?(Object.defineProperty(this,"limit",{value:e,enumerable:!0,configurable:!0}),this):new me(new Q("invalid limit"),this.settings)},Object.defineProperty(t.prototype,"capacity",{get:function(){return this.array.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remaining",{get:function(){return this.limit-this.index},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return 0<=e&&e<this.limit},t.prototype.get=function(e){if(0<=e&&e<this.limit)return this.array[e];throw new Q},t.prototype.set=function(e,t){if(!(0<=e&&e<this.limit))throw new Q;this.array[e]=t},t.prototype.write=function(e){if("number"==typeof e){var t=this.index;return t<this.limit?(this.array[t]=e,Object.defineProperty(this,"index",{value:t+1,enumerable:!0,configurable:!0}),this):new me(new Q("full"),this.settings)}return new me(new Q("binary output"),this.settings)},t.prototype.writeln=function(e){return new me(new Q("binary output"),this.settings)},t.prototype.step=function(e){var t=this.index+e;return 0<=t&&t<=this.limit?(Object.defineProperty(this,"index",{value:t,enumerable:!0,configurable:!0}),this):new me(new Q("invalid step"),this.settings)},t.prototype.bind=function(){return new Uint8Array(this.array.buffer,0,this.index)},t.prototype.withSettings=function(e){return e=W.fromAny(e),Object.defineProperty(this,"settings",{value:e,enumerable:!0,configurable:!0}),this},t.prototype.clone=function(){return new t(this.array,this.index,this.limit,this.part,this.settings)},t.create=function(e,r,n){return void 0===r&&(r=0),void 0===n&&(n=e.length),new t(e,r,r+n,!1,W.standard())},t}(ye),Ae={output:function(e,t){var r;return void 0===t&&"number"!=typeof e?(t=e,e=void 0):"number"!=typeof e&&(e=void 0),r="number"==typeof e?new Uint8Array(e):null,t=W.fromAny(t),new ke(r,0,t)},outputBuffer:function(e,t,r){return Me.create(e,t,r)}},De=function(){function e(){}return e.prototype.isFatal=function(){return!1},e.prototype.isReplacement=function(){return!1},e.prototype.toString=function(){return ne.debug(this)},e.fatal=function(){return new Ie(!1)},e.fatalNonZero=function(){return new Ie(!0)},e.replacement=function(){return new Te(65533,!1)},e.replacementNonZero=function(){return new Te(65533,!0)},E([s],e,"fatal",null),E([s],e,"fatalNonZero",null),E([s],e,"replacement",null),E([s],e,"replacementNonZero",null),e}(),Ie=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"nonZero",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isFatal=function(){return!0},Object.defineProperty(t.prototype,"replacementChar",{get:function(){return 65533},enumerable:!1,configurable:!0}),t.prototype.isNonZero=function(){return this.nonZero},t.prototype.asNonZero=function(e){return e?De.fatalNonZero():De.fatal()},t.prototype.equals=function(e){return this===e||e instanceof t&&this.nonZero===e.nonZero},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),v.hash(this.nonZero)))},t.prototype.debug=function(e){return e=e.write("UtfErrorMode").write(46).write(this.nonZero?"fatalNonZero":"fatal").write(40).write(41)},t}(De),Te=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"replacementChar",{value:t,enumerable:!0}),Object.defineProperty(n,"nonZero",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.isReplacement=function(){return!0},t.prototype.isNonZero=function(){return this.nonZero},t.prototype.asNonZero=function(e){return 65533===this.replacementChar?e?De.replacementNonZero():De.replacement():new t(this.replacementChar,e)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.replacementChar===e.replacementChar&&this.nonZero===e.nonZero)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),b.hash(this.replacementChar)),v.hash(this.nonZero)))},t.prototype.debug=function(e){return e=e.write("UtfErrorMode").write(46).write(this.nonZero?"replacementNonZero":"replacement").write(40).write(41)},t}(De),Ve=function(){function e(e){Object.defineProperty(this,"alphabet",{value:e,enumerable:!0})}return e.prototype.encodeDigit=function(e){return this.alphabet.charCodeAt(e)},e.prototype.uint8ArrayWriter=function(e){return void 0===e?new Ke(this,void 0,null):new Ke(this,e,e)},e.prototype.writeUint8Array=function(e,t){return Ke.write(e,this,void 0,t)},e.prototype.writeInteger=function(e,t,r){return void 0===r&&(r=0),Be.write(e,this,void 0,t,r)},e.prototype.writeIntegerLiteral=function(e,t,r){return void 0===r&&(r=0),Be.writeLiteral(e,this,void 0,t,r)},Object.defineProperty(e,"lowercase",{get:function(){return new e("0123456789abcdef")},enumerable:!1,configurable:!0}),Object.defineProperty(e,"uppercase",{get:function(){return new e("0123456789ABCDEF")},enumerable:!1,configurable:!0}),e.isDigit=function(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102},e.decodeDigit=function(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-65+10;if(e>=97&&e<=102)return e-97+10;var t=re.stringOutput();throw t=t.write("Invalid base-16 digit: "),t=ne.debugChar(t,e),new Error(t.bind())},e.writeQuantum=function(t,r,n){var i=e.decodeDigit(r),o=e.decodeDigit(n);return t=t.write(i<<4|o)},e.parser=function(e){return new Le(e)},e.parse=function(e,t){return Le.parse(e,t)},e.parseUint8Array=function(e){return Le.parse(e,Ae.output())},E([s],e,"lowercase",null),E([s],e,"uppercase",null),e}(),qe=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return Object.defineProperty(s,"output",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(s,"errorMode",{value:r,enumerable:!0,configurable:!0}),s.c1=n,s.c2=i,s.c3=o,s.have=u,s}return C(t,e),t.prototype.isCont=function(){return this.output.isCont()},t.prototype.isFull=function(){return this.output.isFull()},t.prototype.isDone=function(){return this.output.isDone()},t.prototype.isError=function(){return this.output.isError()},t.prototype.isPart=function(){return this.output.isPart()},t.prototype.asPart=function(e){return Object.defineProperty(this,"output",{value:this.output.asPart(e),enumerable:!0,configurable:!0}),this},t.prototype.write=function(e){if("number"==typeof e){var r=this.c1,n=this.c2,i=this.c3,o=-1,u=this.have;if(e>=0)switch(u){case 0:r=255&e,u=1;break;case 1:n=255&e,u=2;break;case 2:i=255&e,u=3;break;case 3:o=255&e,u=4;break;default:throw new Error("unreachable")}if(0===r&&this.errorMode.isNonZero())return Z.error(new Q("unexpected NUL byte"));if(r>=0&&r<=127)Object.defineProperty(this,"output",{value:this.output.write(r),enumerable:!0,configurable:!0}),this.have=0;else if(r>=194&&r<=244)if(r>=194&&r<=223&&n>=128&&n<=191)Object.defineProperty(this,"output",{value:this.output.write((31&r)<<6|63&n),enumerable:!0,configurable:!0}),this.c1=-1,this.have=0;else if(224===r&&n>=160&&n<=191||r>=225&&r<=236&&n>=128&&n<=191||237===r&&n>=128&&n<=159||r>=238&&r<=239&&n>=128&&n<=191)if(i>=128&&i<=191)Object.defineProperty(this,"output",{value:this.output.write((15&r)<<12|(63&n)<<6|63&i),enumerable:!0,configurable:!0}),this.c1=-1,this.c2=-1,this.have=0;else if(i>=0){if(this.errorMode.isFatal())return Z.error(new Q(t.invalid(r,n,i)));Object.defineProperty(this,"output",{value:this.output.write(this.errorMode.replacementChar),enumerable:!0,configurable:!0}),this.c1=i,this.c2=-1,this.have=1}else{if(e<0||this.output.isDone())return Z.error(new Q(t.invalid(r,n)));this.c2=n,this.have=2}else if(240===r&&n>=144&&n<=191||r>=241&&r<=243&&n>=128&&n<=191||244===r&&n>=128&&n<=143)if(i>=128&&i<=191)if(o>=128&&o<=191)this.have=4,Object.defineProperty(this,"output",{value:this.output.write((7&r)<<18|(63&n)<<12|(63&i)<<6|63&o),enumerable:!0,configurable:!0}),this.c1=-1,this.c2=-1,this.c3=-1,this.have=0;else if(o>=0){if(this.errorMode.isFatal())return Z.error(new Q(t.invalid(r,n,i,o)));Object.defineProperty(this,"output",{value:this.output.write(this.errorMode.replacementChar),enumerable:!0,configurable:!0}),this.c1=o,this.c2=-1,this.c3=-1,this.have=1}else{if(e<0||this.output.isDone())return Z.error(new Q(t.invalid(r,n,i)));this.c3=i,this.have=3}else if(i>=0){if(this.errorMode.isFatal())return Z.error(new Q(t.invalid(r,n,i)));Object.defineProperty(this,"output",{value:this.output.write(this.errorMode.replacementChar),enumerable:!0,configurable:!0}),this.c1=i,this.c2=-1,this.have=1}else{if(e<0||this.output.isDone())return Z.error(new Q(t.invalid(r,n)));this.c2=n,this.have=2}else if(n>=0){if(this.errorMode.isFatal())return Z.error(new Q(t.invalid(r,n)));Object.defineProperty(this,"output",{value:this.output.write(this.errorMode.replacementChar),enumerable:!0,configurable:!0}),this.c1=n,this.have=1}else{if(e<0||this.output.isDone())return Z.error(new Q(t.invalid(r)));this.c1=r,this.have=1}else if(r>=0){if(this.errorMode.isFatal())return Z.error(new Q(t.invalid(r)));Object.defineProperty(this,"output",{value:this.output.write(this.errorMode.replacementChar),enumerable:!0,configurable:!0}),this.have=0}return this.output.isError()?this.output:this}if("string"==typeof e)return Object.defineProperty(this,"output",{value:this.output.write(e),enumerable:!0,configurable:!0}),this;throw new TypeError(""+e)},t.invalid=function(e,t,r,n){var i=re.stringOutput();i=i.write("invalid UTF-8 code unit sequence: ");var o=Ve.uppercase;return o.writeIntegerLiteral(i,e,2),void 0!==t&&(i=i.write(" "),o.writeIntegerLiteral(i,t,2),void 0!==r&&(i=i.write(" "),o.writeIntegerLiteral(i,r,2),void 0!==n&&(i=i.write(" "),o.writeIntegerLiteral(i,n,2)))),i.bind()},Object.defineProperty(t.prototype,"settings",{get:function(){return this.output.settings},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return Object.defineProperty(this,"output",{value:this.output.withSettings(e),enumerable:!0,configurable:!0}),this},t.prototype.bind=function(){return 0===this.have?this.output.bind():this.write(-1).bind()},t.prototype.trap=function(){return this.output.trap()},t.prototype.clone=function(){return new t(this.output.clone(),this.errorMode,this.c1,this.c2,this.c3,this.have)},t.create=function(e,r){return void 0===r&&(r=De.fatal()),new t(e,r,-1,-1,-1,0)},t}(Z),Re=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return Object.defineProperty(s,"output",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(s,"errorMode",{value:r,enumerable:!0,configurable:!0}),s.c2=n,s.c3=i,s.c4=o,s.index=u,s}return C(t,e),t.prototype.isCont=function(){return this.output.isCont()},t.prototype.isFull=function(){return this.output.isFull()},t.prototype.isDone=function(){return this.output.isDone()},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return this.output.isPart()},t.prototype.asPart=function(e){return Object.defineProperty(this,"output",{value:this.output.asPart(e),enumerable:!0,configurable:!0}),this},t.prototype.write=function(e){if("number"==typeof e){for(var t=0,r=this.c2,n=this.c3,i=this.c4,o=this.output,u=this.index;u<4;){if(!o.isCont())return Z.error(new Q("unable to flush buffered code units"));switch(u){case 1:o=o.write(r),this.c2=0;break;case 2:o=o.write(n),this.c3=0;break;case 3:o=o.write(i),this.c4=0;break;default:throw new Error("unreachable")}u+=1}if(e>=0&&e<=127)i=e,u=3;else if(e>=128&&e<=2047)n=192|e>>>6,i=128|63&e,u=2;else if(e>=2048&&e<=65535||e>=57344&&e<=65535)r=224|e>>>12,n=128|e>>>6&63,i=128|63&e,u=1;else{if(!(e>=65536&&e<=1114111))return this.errorMode.isFatal()?Z.error(new Q("invalid code point: "+e)):this.write(this.errorMode.replacementChar);t=240|e>>>18,r=128|e>>>12&63,n=128|e>>>6&63,i=128|63&e,u=0}do{switch(u){case 0:o=o.write(t);break;case 1:o=o.write(r),this.c2=0;break;case 2:o=o.write(n),this.c3=0;break;case 3:o=o.write(i),this.c4=0;break;default:throw new Error("unreachable")}Object.defineProperty(this,"output",{value:o,enumerable:!0,configurable:!0}),u+=1}while(u<4&&o.isCont());return u<4&&(u<3&&(u<2&&(this.c2=r),this.c3=n),this.c4=i),Object.defineProperty(this,"output",{value:o,enumerable:!0,configurable:!0}),this.index=u,this}if("string"==typeof e)return Object.defineProperty(this,"output",{value:this.output.write(e),enumerable:!0,configurable:!0}),this;throw new TypeError(""+e)},t.prototype.flush=function(){for(var e=this.output,t=this.index;t<4;){if(!e.isCont())return Z.error(new Q("unable to flush buffered code units"));switch(t){case 1:e=e.write(this.c2),this.c2=0;break;case 2:e=e.write(this.c3),this.c3=0;break;case 3:e=e.write(this.c4),this.c4=0;break;default:throw new Error("unreachable")}t+=1}return Object.defineProperty(this,"output",{value:e,enumerable:!0,configurable:!0}),this.index=t,this},Object.defineProperty(t.prototype,"settings",{get:function(){return this.output.settings},enumerable:!1,configurable:!0}),t.prototype.withSettings=function(e){return Object.defineProperty(this,"output",{value:this.output.withSettings(e),enumerable:!0,configurable:!0}),this},t.prototype.bind=function(){return this.output.bind()},t.prototype.clone=function(){return new t(this.output.clone(),this.errorMode,this.c2,this.c3,this.c4,this.index)},t.create=function(e,r){return void 0===r&&(r=De.fatal()),new t(e,r,0,0,0,4)},t}(Z),Ue={sizeOf:function(e,t){if("number"==typeof e||void 0===e){if("number"==typeof e){if(0===e&&void 0!==t&&t.isNonZero())return 2;if(e>=0&&e<=127)return 1;if(e>=128&&e<=2047)return 2;if(e>=2048&&e<=65535||e>=57344&&e<=65535)return 3;if(e>=65536&&e<=1114111)return 4}return void 0===t?3:t.isReplacement()?Ue.sizeOf(t.replacementChar):0}if("string"==typeof e){for(var r=0,n=0,i=e.length;n<i;n=e.offsetByCodePoints(n,1))r+=Ue.sizeOf(e.charCodeAt(n),t);return r}throw new TypeError(""+e)},decodedOutput:function(e,t){return qe.create(e,t)},encodedOutput:function(e,t){return Re.create(e,t)},decodedString:function(){return Ue.decodedOutput(re.stringOutput())}},Ne=function(e){function t(t,r,n,i){void 0===t&&(t=1),void 0===r&&(r=0),void 0===n&&(n=2),void 0===i&&(i=1);var o=e.call(this)||this;return Object.defineProperty(o,"sign",{value:t,enumerable:!0}),Object.defineProperty(o,"value",{value:r,enumerable:!0}),Object.defineProperty(o,"mode",{value:n,enumerable:!0}),Object.defineProperty(o,"step",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.sign,this.value,this.mode,this.step)},t.parse=function(e,r,n,i,o){void 0===r&&(r=1),void 0===n&&(n=0),void 0===i&&(i=2),void 0===o&&(o=1);var u=0;if(1===o)if(e.isCont())45===(u=e.head())?(e=e.step(),r=-1):43===u&&(e=e.step(),r=1),o=2;else if(e.isDone())return we.error(oe.expected("number",e));if(2===o)if(e.isCont())if(48===(u=e.head()))e=e.step(),o=4;else{if(!(u>=49&&u<=57)){if(i>0&&46===u){var s=re.stringOutput();return r<0&&(s=s.write(45)),ze.parse(e,s,i)}return we.error(oe.expected("number",e))}e=e.step(),n=r*(u-48),o=3}else if(e.isDone())return we.error(oe.expected("number",e));if(3===o){for(;e.isCont()&&(u=e.head())>=48&&u<=57;){var a=10*n+r*(u-48);if(!(-9007199254740991<=a&&a<=9007199254740992))return we.error(oe.message("integer overflow",e));n=a,e=e.step()}if(e.isCont())o=4;else if(e.isDone())return we.done(n)}if(4===o){if(e.isCont()){if(u=e.head(),i>0&&46===u||i>1&&(69===u||101===u)){s=re.stringOutput();return s=r<0&&0===n?s.write(45).write(48):s.write(""+n),ze.parse(e,s,i)}return we.done(n)}if(e.isDone())return we.done(n)}return new t(r,n,i,o)},t}(we),ze=function(e){function t(t,r,n){void 0===r&&(r=2),void 0===n&&(n=1);var i=e.call(this)||this;return Object.defineProperty(i,"output",{value:t,enumerable:!0}),Object.defineProperty(i,"mode",{value:r,enumerable:!0}),Object.defineProperty(i,"step",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.output,this.mode,this.step)},t.parse=function(e,r,n,i){void 0===n&&(n=2),void 0===i&&(i=1);var o=0;if(1===i)if(e.isCont())if(46===(o=e.head()))e=e.step(),r=r.write(o),i=2;else{if(!(n>1)||69!==o&&101!==o)return we.error(oe.expected("decimal or exponent",e));e=e.step(),r=r.write(o),i=5}else if(e.isDone())return we.error(oe.expected("decimal or exponent",e));if(2===i)if(e.isCont()){if(!((o=e.head())>=48&&o<=57))return we.error(oe.expected("digit",e));e=e.step(),r=r.write(o),i=3}else if(e.isDone())return we.error(oe.expected("digit",e));if(3===i){for(;e.isCont()&&(o=e.head())>=48&&o<=57;)e=e.step(),r=r.write(o);if(e.isCont()){if(!(n>1))return we.done(+r.bind());i=4}else if(e.isDone())return we.done(+r.bind())}if(4===i){if(69!==(o=e.head())&&101!==o)return we.done(+r.bind());e=e.step(),r=r.write(o),i=5}if(5===i)if(e.isCont())43!==(o=e.head())&&45!==o||(e=e.step(),r=r.write(o)),i=6;else if(e.isDone())return we.error(oe.unexpected(e));if(6===i)if(e.isCont()){if(!((o=e.head())>=48&&o<=57))return we.error(oe.expected("digit",e));e=e.step(),r=r.write(o),i=7}else if(e.isDone())return we.error(oe.expected("digit",e));if(7===i){for(;e.isCont()&&(o=e.head())>=48&&o<=57;)e=e.step(),r=r.write(o);if(!e.isEmpty())return we.done(+r.bind())}return new t(r,n,i)},t}(we),Fe=function(e){function t(t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=1);var o=e.call(this)||this;return Object.defineProperty(o,"value",{value:t,enumerable:!0}),Object.defineProperty(o,"input",{value:r,enumerable:!0}),Object.defineProperty(o,"index",{value:n,enumerable:!0}),Object.defineProperty(o,"step",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.value,this.input,this.index,this.step)},t.write=function(e,r,n,i,o){if(void 0===i&&(i=0),void 0===o&&(o=1),0===o)return ee.end();if(1===o&&(n<0?e.isCont()&&(e=e.write(45),o=2):o=2),2===o)if(n>-10&&n<10){if(e.isCont())return e=e.write(ie.encodeDigit(Math.abs(0|n))),ee.done(r)}else{for(var u=new Array(19),s=n,a=18;0!==s;)u[a]=Math.abs(s%10|0),s=s/10|0,a-=1;for(a+=1+i;a<19&&e.isCont();)e=e.write(ie.encodeDigit(u[a])),i+=1,a+=1;if(19===a)return ee.done(r)}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o)},t}(ee),Le=function(e){function t(t,r,n){void 0===r&&(r=0),void 0===n&&(n=1);var i=e.call(this)||this;return Object.defineProperty(i,"output",{value:t,enumerable:!0}),Object.defineProperty(i,"p",{value:r,enumerable:!0}),Object.defineProperty(i,"step",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.output.clone(),this.p,this.step)},t.parse=function(e,r,n,i){void 0===n&&(n=0),void 0===i&&(i=1);for(var o=0;!e.isEmpty();){if(1===i)if(e.isCont()&&(o=e.head(),Ve.isDigit(o)))e=e.step(),n=o,i=2;else if(!e.isEmpty())return we.done(r.bind());if(2===i)if(e.isCont()&&(o=e.head(),Ve.isDigit(o)))e=e.step(),r=Ve.writeQuantum(r,n,o),n=0,i=1;else if(!e.isEmpty())return we.error(oe.expected("base16 digit",e))}return new t(r,n,i)},t}(we),Ke=function(e){function t(t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var u=e.call(this)||this;return Object.defineProperty(u,"base16",{value:t,enumerable:!0}),Object.defineProperty(u,"value",{value:r,enumerable:!0}),Object.defineProperty(u,"input",{value:n,enumerable:!0}),Object.defineProperty(u,"index",{value:i,enumerable:!0}),Object.defineProperty(u,"step",{value:o,enumerable:!0}),u}return C(t,e),t.prototype.feed=function(e){if(e instanceof Uint8Array)return new t(this.base16,void 0,e);throw new TypeError(""+e)},t.prototype.pull=function(e){if(null===this.input)throw new $;return t.write(e,this.base16,this.value,this.input,this.index,this.step)},t.write=function(e,r,n,i,o,u){for(void 0===o&&(o=0),void 0===u&&(u=1);o<i.length;){var s=i[o];1===u&&e.isCont()&&(e=e.write(r.encodeDigit(s>>>4)),u=2),2===u&&e.isCont()&&(e=e.write(r.encodeDigit(15&s)),o+=1,u=1)}return o===i.length?ee.done(n):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t}(ee),Be=function(e){function t(t,r,n,i,o,u){void 0===o&&(o=0),void 0===u&&(u=3);var s=e.call(this)||this;return Object.defineProperty(s,"base16",{value:t,enumerable:!0}),Object.defineProperty(s,"value",{value:r,enumerable:!0}),Object.defineProperty(s,"input",{value:n,enumerable:!0}),Object.defineProperty(s,"width",{value:i,enumerable:!0}),Object.defineProperty(s,"index",{value:o,enumerable:!0}),Object.defineProperty(s,"step",{value:u,enumerable:!0}),s}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.base16,this.value,this.input,this.width,this.index,this.step)},t.write=function(e,r,n,i,o,u,s){if(void 0===u&&(u=0),void 0===s&&(s=3),s<=0)return ee.end();if(1===s&&e.isCont()&&(e=e.write(48),s=2),2===s&&e.isCont()&&(e=e.write(120),s=3),3===s)if(i>=0&&i<16&&o<=1){if(e.isCont())return e=e.write(r.encodeDigit(i)),ee.done(n)}else{for(var a=15,p=new Array(16),f=i;0!==f||a>=16-o;)p[a]=15&f,f>>>=4,a-=1;for(a+=1+u;a<16&&e.isCont();)e=e.write(r.encodeDigit(p[a])),u+=1,a+=1;if(16===a)return ee.done(n)}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u,s)},t.writeLiteral=function(e,r,n,i,o){return t.write(e,r,n,i,o,0,1)},t}(ee),We=function(){function e(){}return e.prototype.decodeDigit=function(e){if(e>=65&&e<=90)return e-65;if(e>=97&&e<=122)return e+-71;if(e>=48&&e<=57)return e+4;if(43===e||45===e)return 62;if(47===e||95===e)return 63;var t=re.stringOutput();throw t=t.write("Invalid base-64 digit: "),t=ne.debugChar(t,e),new Error(t.bind())},e.prototype.encodeDigit=function(e){return this.alphabet.charCodeAt(e)},e.prototype.writeQuantum=function(e,t,r,n,i){var o=this.decodeDigit(t),u=this.decodeDigit(r);if(61!==n){var s=this.decodeDigit(n);if(61!==i){var a=this.decodeDigit(i);e=(e=(e=e.write(o<<2|u>>>4)).write(u<<4|s>>>2)).write(s<<6|a)}else e=(e=e.write(o<<2|u>>>4)).write(u<<4|s>>>2)}else{if(61!==i)return Z.error(new Error("Improperly padded base-64"));e=e.write(o<<2|u>>>4)}return e},e.prototype.parser=function(e){return new Ye(this,e)},e.prototype.parse=function(e,t){return Ye.parse(e,this,t)},e.prototype.parseUint8Array=function(e){return Ye.parse(e,this,Ae.output())},e.prototype.uint8ArrayWriter=function(e){return void 0===e?new Ge(this,void 0,null):new Ge(this,e,e)},e.prototype.writeUint8Array=function(e,t){return Ge.write(e,this,void 0,t)},Object.defineProperty(e,"standardPadded",{get:function(){return new He(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"standardUnpadded",{get:function(){return new He(!1)},enumerable:!1,configurable:!0}),e.standard=function(t){return void 0===t&&(t=!0),t?e.standardPadded:e.standardUnpadded},Object.defineProperty(e,"urlPadded",{get:function(){return new Xe(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"urlUnpadded",{get:function(){return new Xe(!1)},enumerable:!1,configurable:!0}),e.url=function(t){return void 0===t&&(t=!0),t?e.urlPadded:e.urlUnpadded},E([s],e,"standardPadded",null),E([s],e,"standardUnpadded",null),E([s],e,"urlPadded",null),E([s],e,"urlUnpadded",null),e}(),He=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"padded",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"alphabet",{get:function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"},enumerable:!1,configurable:!0}),t.prototype.isPadded=function(){return this.padded},t.prototype.asPadded=function(e){return e===this.padded?this:We.standard(e)},t.prototype.isDigit=function(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||43===e||47===e},t}(We),Xe=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"padded",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"alphabet",{get:function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},enumerable:!1,configurable:!0}),t.prototype.isPadded=function(){return this.padded},t.prototype.asPadded=function(e){return e===this.padded?this:We.url(e)},t.prototype.isDigit=function(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||45===e||95===e},t}(We),Ye=function(e){function t(t,r,n,i,o,u){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===u&&(u=1);var s=e.call(this)||this;return Object.defineProperty(s,"base64",{value:t,enumerable:!0}),Object.defineProperty(s,"output",{value:r,enumerable:!0}),Object.defineProperty(s,"p",{value:n,enumerable:!0}),Object.defineProperty(s,"q",{value:i,enumerable:!0}),Object.defineProperty(s,"r",{value:o,enumerable:!0}),Object.defineProperty(s,"step",{value:u,enumerable:!0}),s}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.base64,this.output.clone(),this.p,this.q,this.r,this.step)},t.parse=function(e,r,n,i,o,u,s){void 0===i&&(i=0),void 0===o&&(o=0),void 0===u&&(u=0),void 0===s&&(s=1);for(var a=0;!e.isEmpty();){if(1===s)if(e.isCont()&&(a=e.head(),r.isDigit(a)))e=e.step(),i=a,s=2;else if(!e.isEmpty())return we.done(n.bind());if(2===s)if(e.isCont()&&(a=e.head(),r.isDigit(a)))e=e.step(),o=a,s=3;else if(!e.isEmpty())return we.error(oe.expected("base64 digit",e));if(3===s)if(e.isCont()&&(a=e.head(),r.isDigit(a)||61===a))e=e.step(),u=a,s=61!==a?4:5;else if(!e.isEmpty())return r.isPadded()?we.error(oe.unexpected(e)):(n=r.writeQuantum(n,i,o,61,61),we.done(n.bind()));if(4===s){if(e.isCont()&&(a=e.head(),r.isDigit(a)||61===a)){if(e=e.step(),n=r.writeQuantum(n,i,o,u,a),u=0,o=0,i=0,61===a)return we.done(n.bind());s=1}else if(!e.isEmpty())return r.isPadded()?we.error(oe.unexpected(e)):(n=r.writeQuantum(n,i,o,u,61),we.done(n.bind()))}else if(5===s){if(e.isCont()&&61===(a=e.head()))return e=e.step(),n=r.writeQuantum(n,i,o,u,a),u=0,o=0,i=0,we.done(n.bind());if(!e.isEmpty())return we.error(oe.expected(61,e))}}return new t(r,n,i,o,u,s)},t}(we),Ge=function(e){function t(t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var u=e.call(this)||this;return Object.defineProperty(u,"base64",{value:t,enumerable:!0}),Object.defineProperty(u,"value",{value:r,enumerable:!0}),Object.defineProperty(u,"input",{value:n,enumerable:!0}),Object.defineProperty(u,"index",{value:i,enumerable:!0}),Object.defineProperty(u,"step",{value:o,enumerable:!0}),u}return C(t,e),t.prototype.feed=function(e){if(e instanceof Uint8Array)return new t(this.base64,null,e);throw new TypeError(""+e)},t.prototype.pull=function(e){if(null===this.input)throw new $;return t.write(e,this.base64,this.value,this.input,this.index,this.step)},t.write=function(e,r,n,i,o,u){for(void 0===o&&(o=0),void 0===u&&(u=1);o+2<i.length&&e.isCont();){var s=i[o],a=i[o+1],p=i[o+2];1===u&&e.isCont()&&(e=e.write(r.encodeDigit(s>>>2)),u=2),2===u&&e.isCont()&&(e=e.write(r.encodeDigit(63&(s<<4|a>>>4))),u=3),3===u&&e.isCont()&&(e=e.write(r.encodeDigit(63&(a<<2|p>>>6))),u=4),4===u&&e.isCont()&&(e=e.write(r.encodeDigit(63&p)),o+=3,u=1)}if(o+1<i.length&&e.isCont()){s=i[o],a=i[o+1];1===u&&e.isCont()&&(e=e.write(r.encodeDigit(s>>>2)),u=2),2===u&&e.isCont()&&(e=e.write(r.encodeDigit(63&(s<<4|a>>>4))),u=3),3===u&&e.isCont()&&(e=e.write(r.encodeDigit(a<<2&63)),u=4),4===u&&(r.isPadded()?e.isCont()&&(e=e.write(61),o+=2):o+=2)}else if(o<i.length&&e.isCont()){s=i[o];1===u&&e.isCont()&&(e=e.write(r.encodeDigit(s>>>2)),u=2),2===u&&e.isCont()&&(e=e.write(r.encodeDigit(s<<4&63)),u=3),3===u&&(r.isPadded()?e.isCont()&&(e=e.write(61),u=4):o+=1),4===u&&e.isCont()&&(e=e.write(61),o+=1)}return o===i.length?ee.done(n):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t}(ee),_e=function(e,t){var r=function(e){return r.range(r.domain(e))};return Object.setPrototypeOf(r,_e.prototype),Object.defineProperty(r,"domain",{value:e,enumerable:!0}),Object.defineProperty(r,"range",{value:t,enumerable:!0}),r};_e.prototype=Object.create(Object.prototype),_e.prototype.equivalentTo=function(e,t){return this===e||e instanceof _e&&(this.domain.equivalentTo(e.domain,t)&&this.range.equivalentTo(e.range,t))},_e.prototype.canEqual=function(e){return e instanceof _e},_e.prototype.equals=function(e){return this===e||e instanceof _e&&(e.canEqual(this)&&this.domain.equals(e.domain)&&this.range.equals(e.range))},_e.prototype.toString=function(){return"Mapping("+this.domain+", "+this.range+")"};var Qe=function(e,t){var r=function(e){return P.equal(e,r[1])?1:0};return Object.setPrototypeOf(r,Qe.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Qe.prototype=Object.create(_e.prototype),Object.defineProperty(Qe.prototype,"domain",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"range",{get:function(){return Ze.unit},enumerable:!0,configurable:!0}),Qe.prototype.contains=function(e){return P.compare(this[0],e)<=0&&P.compare(e,this[1])<=0},Qe.prototype.equivalentTo=function(e,t){return this===e||e instanceof Qe&&(P.equivalent(this[0],e[0],t)&&P.equivalent(this[1],e[1],t))},Qe.prototype.canEqual=function(e){return e instanceof Qe},Qe.prototype.equals=function(e){return this===e||e instanceof Qe&&(e.canEqual(this)&&P.equal(this[0],e[0])&&P.equal(this[1],e[1]))},Qe.prototype.toString=function(){return"Domain("+this[0]+", "+this[1]+")"},Object.defineProperty(Qe,"unit",{get:function(){var e=pt(0,1);return Object.defineProperty(Qe,"unit",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0});var Ze=function(e,t){var r=function(e){return e<1?r[0]:r[1]};return Object.setPrototypeOf(r,Ze.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Ze.prototype=Object.create(_e.prototype),Object.defineProperty(Ze.prototype,"domain",{get:function(){return Qe.unit},enumerable:!0,configurable:!0}),Object.defineProperty(Ze.prototype,"range",{get:function(){return this},enumerable:!0,configurable:!0}),Ze.prototype.equivalentTo=function(e,t){return this===e||e instanceof Ze&&(P.equivalent(this[0],e[0],t)&&P.equivalent(this[1],e[1],t))},Ze.prototype.canEqual=function(e){return e instanceof Ze},Ze.prototype.equals=function(e){return this===e||e instanceof Ze&&(e.canEqual(this)&&P.equal(this[0],e[0])&&P.equal(this[1],e[1]))},Ze.prototype.toString=function(){return"Range("+this[0]+", "+this[1]+")"},Object.defineProperty(Ze,"unit",{get:function(){var e=ct(0,1);return Object.defineProperty(Ze,"unit",{value:e,enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0});var Je=function(e,t){return null!=e&&"function"==typeof e.interpolateTo?e.interpolateTo(t):null};Je.is=function(e){return null!=e&&"function"==typeof e.interpolateTo};var $e=function(e,t){var r;return e===t?r=tt(e):"number"==typeof e&&"number"==typeof t?r=nt(e,t):Array.isArray(e)&&Array.isArray(t)?r=it(e,t):null===(r=Je(e,t))&&(r=rt(e,t)),r};($e.prototype=Object.create(Ze.prototype)).map=function(e){return et(this,e)},$e.prototype.interpolateTo=function(e){return e instanceof $e?ot(this,e):null},$e.prototype.canEqual=function(e){return e instanceof this.constructor},$e.prototype.equals=function(e){return this===e||e instanceof $e&&(e.canEqual(this)&&P.equal(this[0],e[0])&&P.equal(this[1],e[1]))},$e.prototype.toString=function(){return"Interpolator("+this[0]+", "+this[1]+")"};var et=function(e,t){var r=function(e){return r.transform(r.interpolator(e))};return Object.setPrototypeOf(r,et.prototype),Object.defineProperty(r,"interpolator",{value:e,enumerable:!0}),Object.defineProperty(r,"transform",{value:t,enumerable:!0}),r};et.prototype=Object.create($e.prototype),Object.defineProperty(et.prototype,0,{get:function(){return this.transform(this.interpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(et.prototype,1,{get:function(){return this.transform(this.interpolator[1])},enumerable:!0,configurable:!0}),et.prototype.equals=function(e){return this===e||e instanceof et&&(this.interpolator.equals(e.interpolator)&&this.transform===e.transform)};var tt=function(e){var t=function(e){return t.value};return Object.setPrototypeOf(t,tt.prototype),Object.defineProperty(t,"value",{value:e,enumerable:!0}),t};tt.prototype=Object.create($e.prototype),Object.defineProperty(tt.prototype,0,{get:function(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(tt.prototype,1,{get:function(){return this.value},enumerable:!0,configurable:!0}),tt.prototype.equals=function(e){return this===e||e instanceof tt&&this.value===e.value};var rt=function(e,t){var r=function(e){return e<1?r[0]:r[1]};return Object.setPrototypeOf(r,rt.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};rt.prototype=Object.create($e.prototype);var nt=function(e,t){var r=function(e){var t=r[0];return t+e*(r[1]-t)};return Object.setPrototypeOf(r,nt.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};nt.prototype=Object.create($e.prototype);var it=function(e,t){var r=function(e){for(var t=r.interpolators,n=t.length,i=new Array(n),o=0;o<n;o+=1)i[o]=t[o](e);return i};Object.setPrototypeOf(r,it.prototype);for(var n=Math.min(e.length,t.length),i=new Array(n),o=0;o<n;o+=1)i[o]=$e(e[o],t[o]);return Object.defineProperty(r,"interpolators",{value:i,enumerable:!0}),r};it.prototype=Object.create($e.prototype),Object.defineProperty(it.prototype,0,{get:function(){for(var e=this.interpolators,t=e.length,r=new Array(t),n=0;n<t;n+=1)r[n]=e[n][0];return r},enumerable:!0,configurable:!0}),Object.defineProperty(it.prototype,1,{get:function(){for(var e=this.interpolators,t=e.length,r=new Array(t),n=0;n<t;n+=1)r[n]=e[n][1];return r},enumerable:!0,configurable:!0}),it.prototype.equals=function(e){if(this===e)return!0;if(e instanceof it){var t=this.interpolators.length;if(t===e.interpolators.length){for(var r=0;r<t;r+=1)if(!this.interpolators[r].equals(e.interpolators[r]))return!1;return!0}}return!1};var ot=function(e,t){var r=function(e){return 0===e?r[0]:1===e?r[1]:$e(r[0](e),r[1](e))};return Object.setPrototypeOf(r,ot.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};ot.prototype=Object.create($e.prototype);var ut=function(e,t,r){var n=function(e){var t=n[0],r=n[1];return n.easing(Math.min(Math.max(0,(e-t)/(r-t)),1))};return Object.setPrototypeOf(n,ut.prototype),Object.defineProperty(n,"easing",{value:e,enumerable:!0}),Object.defineProperty(n,0,{value:t,enumerable:!0}),Object.defineProperty(n,1,{value:r,enumerable:!0}),n};ut.prototype=Object.create(Qe.prototype),Object.defineProperty(ut.prototype,"duration",{get:function(){return this[1]-this[0]},enumerable:!0,configurable:!0}),ut.prototype.contains=function(e){return this[0]<=e&&e<=this[1]},ut.prototype.withDomain=function(e,t){return ut(this.easing,e,t)},ut.prototype.withDuration=function(e){var t=this[0];return ut(this.easing,t,t+e)},ut.prototype.overRange=function(e,t){var r;return r=1===arguments.length?e:$e(e,t),at(this,r)},ut.prototype.equivalentTo=function(e,t){return this===e||e instanceof ut&&(this.easing.equivalentTo(e.easing,t)&&P.equivalent(this[0],e[0],t)&&P.equivalent(this[1],e[1],t))},ut.prototype.canEqual=function(e){return e instanceof ut},ut.prototype.equals=function(e){return this===e||e instanceof ut&&(e.canEqual(this)&&this.easing.equals(e.easing)&&P.equal(this[0],e[0])&&P.equal(this[1],e[1]))},ut.prototype.toString=function(){return"Timing("+this.easing+", "+this[0]+", "+this[1]+")"},ut.fromInit=function(e){var t=e.easing;void 0===t?t=st.linear:"string"==typeof t&&(t=st(t));var r=e.t0;void 0===r&&(r=0);var n=e.t1;if(void 0===n){var i=e.dt;n=void 0!==i?r+i:r}return ut(t,r,n)},ut.fromAny=function(e){if(null==e)return!1;if(e instanceof ut||"boolean"==typeof e)return e;if("object"==typeof e)return ut.fromInit(e);throw new TypeError(""+e)};var st=function(e){switch(e){case"linear":return st.linear;case"quad-in":return st.quadIn;case"quad-out":return st.quadOut;case"quad-in-out":return st.quadInOut;case"cubic-in":return st.cubicIn;case"cubic-out":return st.cubicOut;case"cubic-in-out":return st.cubicInOut;case"quart-in":return st.quartIn;case"quart-out":return st.quartOut;case"quart-in-out":return st.quartInOut;case"expo-in":return st.expoIn;case"expo-out":return st.expoOut;case"expo-in-out":return st.expoInOut;case"circ-in":return st.circIn;case"circ-out":return st.circOut;case"circ-in-out":return st.circInOut;case"back-in":return st.backIn;case"back-out":return st.backOut;case"back-in-out":return st.backInOut;case"elastic-in":return st.elasticIn;case"elastic-out":return st.elasticOut;case"elastic-in-out":return st.elasticInOut;case"bounce-in":return st.bounceIn;case"bounce-out":return st.bounceOut;case"bounce-in-out":return st.bounceInOut;default:throw new Error("unknown easing: "+e)}};st.prototype=Object.create(ut.prototype),Object.defineProperty(st.prototype,0,{value:0,enumerable:!0}),Object.defineProperty(st.prototype,1,{value:1,enumerable:!0}),Object.defineProperty(st.prototype,"easing",{get:function(){return this},enumerable:!0}),st.prototype.equivalentTo=function(e,t){return this===e},st.prototype.canEqual=function(e){return e instanceof st},st.prototype.equals=function(e){return this===e},st.prototype.toString=function(){return'Easing("'+this.type+'")'},st.fromAny=function(e){if(e instanceof st)return e;if("string"==typeof e)return st(e);throw new TypeError(""+e)},st.linear=function(e){return e},Object.setPrototypeOf(st.linear,st.prototype),Object.defineProperty(st.linear,"type",{value:"linear",enumerable:!0}),st.quadIn=function(e){return e*e},Object.setPrototypeOf(st.quadIn,st.prototype),Object.defineProperty(st.quadIn,"type",{value:"quad-in",enumerable:!0}),st.quadOut=function(e){return e*(2-e)},Object.setPrototypeOf(st.quadOut,st.prototype),Object.defineProperty(st.quadOut,"type",{value:"quad-out",enumerable:!0}),st.quadInOut=function(e){return(e*=2)<=1?e*=e:(e-=1,e*=2-e,e+=1),e/=2},Object.setPrototypeOf(st.quadInOut,st.prototype),Object.defineProperty(st.quadInOut,"type",{value:"quad-in-out",enumerable:!0}),st.cubicIn=function(e){return e*e*e},Object.setPrototypeOf(st.cubicIn,st.prototype),Object.defineProperty(st.cubicIn,"type",{value:"cubic-in",enumerable:!0}),st.cubicOut=function(e){return e-=1,e*=e*e,e+=1},Object.setPrototypeOf(st.cubicOut,st.prototype),Object.defineProperty(st.cubicOut,"type",{value:"cubic-out",enumerable:!0}),st.cubicInOut=function(e){return(e*=2)<=1?e*=e*e:(e-=2,e*=e*e,e+=2),e/=2},Object.setPrototypeOf(st.cubicInOut,st.prototype),Object.defineProperty(st.cubicInOut,"type",{value:"cubic-in-out",enumerable:!0}),st.quartIn=function(e){return e*e*e*e},Object.setPrototypeOf(st.quartIn,st.prototype),Object.defineProperty(st.quartIn,"type",{value:"quart-in",enumerable:!0}),st.quartOut=function(e){return 1-(e-=1)*e*e*e},Object.setPrototypeOf(st.quartOut,st.prototype),Object.defineProperty(st.quartOut,"type",{value:"quart-out",enumerable:!0}),st.quartInOut=function(e){var t=e-1;return e<.5?8*e*e*e*e:1-8*t*t*t*t},Object.setPrototypeOf(st.quartInOut,st.prototype),Object.defineProperty(st.quartInOut,"type",{value:"quart-in-out",enumerable:!0}),st.expoIn=function(e){return 0===e?0:Math.pow(2,10*(e-1))},Object.setPrototypeOf(st.expoIn,st.prototype),Object.defineProperty(st.expoIn,"type",{value:"expo-in",enumerable:!0}),st.expoOut=function(e){return 1===e?1:1-Math.pow(2,-10*e)},Object.setPrototypeOf(st.expoOut,st.prototype),Object.defineProperty(st.expoOut,"type",{value:"expo-out",enumerable:!0}),st.expoInOut=function(e){return 1===e||0===e?e:(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))},Object.setPrototypeOf(st.expoInOut,st.prototype),Object.defineProperty(st.expoInOut,"type",{value:"expo-in-out",enumerable:!0}),st.circIn=function(e){return-1*(Math.sqrt(1-e/1*e)-1)},Object.setPrototypeOf(st.circIn,st.prototype),Object.defineProperty(st.circIn,"type",{value:"circ-in",enumerable:!0}),st.circOut=function(e){return e-=1,Math.sqrt(1-e*e)},Object.setPrototypeOf(st.circOut,st.prototype),Object.defineProperty(st.circOut,"type",{value:"circ-out",enumerable:!0}),st.circInOut=function(e){if((e*=2)<1)return-.5*(Math.sqrt(1-e*e)-1);var t=e-2;return.5*(Math.sqrt(1-t*t)+1)},Object.setPrototypeOf(st.circInOut,st.prototype),Object.defineProperty(st.circInOut,"type",{value:"circ-in-ou",enumerable:!0}),st.backIn=function(e){var t=1.70158;return e*e*((t+1)*e-t)},Object.setPrototypeOf(st.backIn,st.prototype),Object.defineProperty(st.backIn,"type",{value:"back-in",enumerable:!0}),st.backOut=function(e){var t=1.70158,r=e/1-1;return r*r*((t+1)*t+t)+1},Object.setPrototypeOf(st.backOut,st.prototype),Object.defineProperty(st.backOut,"type",{value:"back-out",enumerable:!0}),st.backInOut=function(e){var t=2.5949095;if((e*=2)<1)return.5*e*e*((t+1)*e-t);var r=e-2;return.5*(r*r*((t+1)*r+t)+2)},Object.setPrototypeOf(st.backInOut,st.prototype),Object.defineProperty(st.backInOut,"type",{value:"back-in-out",enumerable:!0}),st.elasticIn=function(e){if(0===e||1===e)return e;var t=e/1-1,r=(1-.7)/2*Math.PI*Math.asin(1);return-Math.pow(2,10*t)*Math.sin(2*(t-r)*Math.PI/(1-.7))},Object.setPrototypeOf(st.elasticIn,st.prototype),Object.defineProperty(st.elasticIn,"type",{value:"elastic-in",enumerable:!0}),st.elasticOut=function(e){if(0===e||1===e)return e;var t=(1-.7)/(2*Math.PI)*Math.asin(1);return e*=2,Math.pow(2,-10*e)*Math.sin(2*(e-t)*Math.PI/(1-.7))+1},Object.setPrototypeOf(st.elasticOut,st.prototype),Object.defineProperty(st.elasticOut,"type",{value:"elastic-out",enumerable:!0}),st.elasticInOut=function(e){if(0===e||1===e)return e;var t=.65,r=(1-t)/(2*Math.PI)*Math.asin(1),n=2*e,i=n-1;return n<1?Math.pow(2,10*i)*Math.sin(2*(i-r)*Math.PI/(1-t))*-.5:Math.pow(2,-10*i)*Math.sin(2*(i-r)*Math.PI/(1-t))*.5+1},Object.setPrototypeOf(st.elasticInOut,st.prototype),Object.defineProperty(st.elasticInOut,"type",{value:"elastic-in-out",enumerable:!0}),st.bounceIn=function(e){var t=7.5625;return(e=1-e)<1/2.75?1-t*e*e:e<2/2.75?1-(t*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(t*(e-=2.25/2.75)*e+.9375):1-(t*(e-=2.625/2.75)*e+.984375)},Object.setPrototypeOf(st.bounceIn,st.prototype),Object.defineProperty(st.bounceIn,"type",{value:"bounce-in",enumerable:!0}),st.bounceOut=function(e){var t=7.5625;return e<1/2.75?t*e*e:e<2/2.75?t*(e-=1.5/2.75)*e+.75:e<2.5/2.75?t*(e-=2.25/2.75)*e+.9375:t*(e-=2.625/2.75)*e+.984375},Object.setPrototypeOf(st.bounceOut,st.prototype),Object.defineProperty(st.bounceOut,"type",{value:"bounce-out",enumerable:!0}),st.bounceInOut=function(e){var t=e<.5,r=7.5625;return(e=t?1-2*e:2*e-1)<1/2.75?e*=r*e:e=e<2/2.75?r*(e-=1.5/2.75)*e+.75:e<2.5/2.75?r*(e-=2.25/2.75)*e+.9375:r*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5},Object.setPrototypeOf(st.bounceInOut,st.prototype),Object.defineProperty(st.bounceInOut,"type",{value:"bounce-in-out",enumerable:!0});var at=function(e,t){var r=function(e){return r.range(r.domain(e))};return Object.setPrototypeOf(r,at.prototype),Object.defineProperty(r,"domain",{value:e,enumerable:!0}),Object.defineProperty(r,"range",{value:t,enumerable:!0}),r};at.prototype=Object.create(_e.prototype),at.prototype.withDomain=function(e,t){return this.domain.withDomain(e,t).overRange(this.range)},at.prototype.canEqual=function(e){return e instanceof at},at.prototype.equals=function(e){return this===e||e instanceof at&&(this.domain.equals(e.domain)&&this.range.equals(e.range))},at.prototype.toString=function(){return"Tweening("+this.domain+", "+this.range+")"};var pt=function(e,t){var r=function(e){var t=r[0],n=r[1]-t;return 0!==n?(e-t)/n:0};return Object.setPrototypeOf(r,pt.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};pt.prototype=Object.create(Qe.prototype),Object.defineProperty(pt.prototype,"inverse",{get:function(){return ct(this[0],this[1])},enumerable:!0,configurable:!0}),pt.prototype.contains=function(e){return this[0]<=e&&e<=this[1]},pt.prototype.interpolateTo=function(e){return e instanceof pt?ft(this,e):null},pt.prototype.canEqual=function(e){return e instanceof pt},pt.prototype.equals=function(e){return this===e||e instanceof pt&&(e.canEqual(this)&&this[0]===e[0]&&this[1]===e[1])},pt.prototype.toString=function(){return"LinearDomain("+this[0]+", "+this[1]+")"};var ft=function(e,t){var r=function(e){var t=r[0],n=t[0],i=t[1],o=r[1],u=o[0],s=o[1];return pt(n+e*(u-n),i+e*(s-i))};return Object.setPrototypeOf(r,ft.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};ft.prototype=Object.create($e.prototype);var ct=function(e,t){var r=function(e){var t=r[0];return t+e*(r[1]-t)};return Object.setPrototypeOf(r,ct.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};ct.prototype=Object.create(Ze.prototype),Object.defineProperty(ct.prototype,"inverse",{get:function(){return pt(this[0],this[1])},enumerable:!0,configurable:!0}),ct.prototype.interpolateTo=function(e){return e instanceof ct?lt(this,e):null},ct.prototype.canEqual=function(e){return e instanceof ct},ct.prototype.equals=function(e){return this===e||e instanceof ct&&(e.canEqual(this)&&this[0]===e[0]&&this[1]===e[1])},ct.prototype.toString=function(){return"LinearRange("+this[0]+", "+this[1]+")"};var lt=function(e,t){var r=function(e){var t=r[0],n=t[0],i=t[1],o=r[1],u=o[0],s=o[1];return ct(n+e*(u-n),i+e*(s-i))};return Object.setPrototypeOf(r,lt.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};lt.prototype=Object.create($e.prototype);var ht=function(){throw new Error};(ht.prototype=Object.create(_e.prototype)).canEqual=function(e){return e instanceof ht},ht.prototype.equals=function(e){return this===e||e instanceof ht&&(this.domain.equals(e.domain)&&this.range.equals(e.range))},ht.prototype.toString=function(){return"Scale("+this.domain+", "+this.range+")"};var dt=function(){throw new Error};(dt.prototype=Object.create(ht.prototype)).canEqual=function(e){return e instanceof dt},dt.prototype.equals=function(e){return this===e||e instanceof dt&&(this.domain.equals(e.domain)&&this.range.equals(e.range))},dt.prototype.toString=function(){return"ContinuousScale("+this.domain+", "+this.range+")"};var yt=function(e,t){var r=function(e){return r.range(r.domain(e))};return Object.setPrototypeOf(r,yt.prototype),Object.defineProperty(r,"domain",{value:e,enumerable:!0}),Object.defineProperty(r,"range",{value:t,enumerable:!0}),r};yt.prototype=Object.create(dt.prototype),Object.defineProperty(yt.prototype,"inverse",{get:function(){return yt(this.range.inverse,this.domain.inverse)},enumerable:!0,configurable:!0}),yt.prototype.withDomain=function(e,t){var r;return r=1===arguments.length?e:pt(e,t),yt(r,this.range)},yt.prototype.overRange=function(e,t){var r;return r=1===arguments.length?e:ct(e,t),yt(this.domain,r)},yt.prototype.clampDomain=function(e,t,r,i,o){void 0===o&&(o=n.Epsilon);var u=this.domain[0],s=this.domain[1];void 0!==e&&void 0!==t&&Math.abs(s-u)>t-e?u<s?(u=e,s=t):(s=e,u=t):(void 0!==e&&(u<s&&u<e?(s+=e-u,u=e):s<u&&s<e&&(u+=e-s,s=e)),void 0!==t&&(u<s&&s>t?(u-=s-t,s=t):s<u&&u>t&&(s-=u-t,u=t)));var a=this(u),p=this(s),f=a<p?p-a:a-p,c=Math.abs(f/(s-u));if(void 0!==r&&c<1/r)u=((h=u+s)-(l=f*r))/2,s=(h+l)/2;else if(void 0!==i&&c>1/i){var l,h;u=((h=u+s)-(l=f*i))/2,s=(h+l)/2}return Math.abs(u-this.domain[0])<o&&Math.abs(s-this.domain[1])<o?this:yt(pt(u,s),this.range)},yt.prototype.solveDomain=function(e,t,r,i,o,u){void 0===u&&(u=n.Epsilon);var s,a=this.domain[1]-this.domain[0],p=this.range[0],f=this.range[1];void 0===r||void 0===i||Math.abs(r-e)<u||Math.abs(i-t)<u?s=(f-p)/(0!==a?a:u):(s=(i-t)/(r-e),void 0!==o&&o||s<0==(f-p)/a<0||(s=-s));var c=t-s*e,l=(p-c)/s,h=(f-c)/s;return Math.abs(l-this.domain[0])<u&&Math.abs(h-this.domain[1])<u?this:yt(pt(l,h),this.range)},yt.prototype.interpolateTo=function(e){return e instanceof yt?vt(this,e):null},yt.prototype.canEqual=function(e){return e instanceof yt},yt.prototype.equals=function(e){return this===e||e instanceof yt&&(this.domain.equals(e.domain)&&this.range.equals(e.range))},yt.prototype.toString=function(){return"LinearScale("+this.domain+", "+this.range+")"};var vt=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.domain,o=i[0],u=i[1],s=n.domain,a=s[0],p=s[1],f=pt(o+e*(a-o),u+e*(p-u)),c=t.range,l=c[0],h=c[1],d=n.range,y=d[0],v=d[1],b=ct(l+e*(y-l),h+e*(v-h));return yt(f,b)};return Object.setPrototypeOf(r,vt.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};vt.prototype=Object.create($e.prototype);var bt=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"cursor",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isEmpty=function(){return this.cursor.isEmpty()},t.prototype.head=function(){return this.cursor.head()[0]},t.prototype.step=function(){this.cursor.step()},t.prototype.skip=function(e){this.cursor.skip(e)},t.prototype.hasNext=function(){return this.cursor.hasNext()},t.prototype.nextIndex=function(){return this.cursor.nextIndex()},t.prototype.next=function(){var e=this.cursor.next(),t=e.value,r=e.done;return{value:t&&t[0],done:r}},t.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},t.prototype.previousIndex=function(){return this.cursor.previousIndex()},t.prototype.previous=function(){var e=this.cursor.previous(),t=e.value,r=e.done;return{value:t&&t[0],done:r}},t.prototype.delete=function(){this.cursor.delete()},t}(k),mt=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"cursor",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isEmpty=function(){return this.cursor.isEmpty()},t.prototype.head=function(){return this.cursor.head()[1]},t.prototype.step=function(){this.cursor.step()},t.prototype.skip=function(e){this.cursor.skip(e)},t.prototype.hasNext=function(){return this.cursor.hasNext()},t.prototype.nextIndex=function(){return this.cursor.nextIndex()},t.prototype.next=function(){var e=this.cursor.next(),t=e.value,r=e.done;return{value:t&&t[1],done:r}},t.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},t.prototype.previousIndex=function(){return this.cursor.previousIndex()},t.prototype.previous=function(){var e=this.cursor.previous(),t=e.value,r=e.done;return{value:t&&t[1],done:r}},t.prototype.delete=function(){this.cursor.delete()},t}(k),gt=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"pages",{value:t,enumerable:!0}),o.index=r,o.childIndex=n,o.childCursor=i,o}return C(t,e),t.prototype.isEmpty=function(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return!1;this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,!0;this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},t.prototype.head=function(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return this.childCursor.head();this.childCursor=null}else{if(!(this.childIndex<this.pages.length))throw this.childIndex=this.pages.length,new Error("empty");this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},t.prototype.step=function(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return void(this.index+=1);this.childCursor=null}else{if(!(this.childIndex<this.pages.length))throw this.childIndex=this.pages.length,new Error("empty");this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},t.prototype.skip=function(e){for(;e>0;)if(null!==this.childCursor)this.childCursor.hasNext()?(this.index+=1,e-=1,this.childCursor.next()):this.childCursor=null;else{if(!(this.childIndex<this.pages.length))break;var t=this.pages[this.childIndex],r=this.pageSize(t);if(this.childIndex+=1,r<e){this.childCursor=this.pageCursor(t),e>0&&(this.index+=e,this.childCursor.skip(e),e=0);break}this.index+=r,e-=r}},t.prototype.hasNext=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasNext())return!0;this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,!1;this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},t.prototype.nextIndex=function(){return this.index},t.prototype.next=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasNext())return this.index+=1,this.childCursor.next();this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,{done:!0};this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},t.prototype.hasPrevious=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasPrevious())return!0;this.childCursor=null}else{if(!(this.childIndex>0))return this.childIndex=0,!1;this.childCursor=this.reversePageCursor(this.pages[this.childIndex-1]),this.childIndex-=1}},t.prototype.previousIndex=function(){return this.index-1},t.prototype.previous=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasPrevious())return this.index-=1,this.childCursor.previous();this.childCursor=null}else{if(!(this.childIndex>0))return this.childIndex=0,{done:!0};this.childCursor=this.reversePageCursor(this.pages[this.childIndex-1]),this.childIndex-=1}},t.prototype.set=function(e){this.childCursor.set(e)},t.prototype.delete=function(){this.childCursor.delete()},t}(k),wt=function(){function e(){}return Object.defineProperty(e.prototype,"pageSplitSize",{get:function(){return 32},set:function(e){Object.defineProperty(this,"pageSplitSize",{value:e,configurable:!0,enumerable:!0,writable:!0})},enumerable:!1,configurable:!0}),e.prototype.compare=function(e,t){return P.compare(e,t)},e.prototype.pageShouldSplit=function(e){return e.arity>this.pageSplitSize},e.prototype.pageShouldMerge=function(e){return e.arity<this.pageSplitSize>>>1},e}(),Ot=function(e){function t(t){var r=e.call(this)||this;return void 0===t&&(t=Pt.empty()),r.root=t,r}return C(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return this.root.isEmpty()},t.prototype.has=function(e){return this.root.has(e,this)},t.prototype.get=function(e){return this.root.get(e,this)},t.prototype.getEntry=function(e){return this.root.getEntry(e)},t.prototype.firstKey=function(){var e=this.root.firstEntry();return void 0!==e?e[0]:void 0},t.prototype.firstValue=function(){var e=this.root.firstEntry();return void 0!==e?e[1]:void 0},t.prototype.firstEntry=function(){return this.root.firstEntry()},t.prototype.lastKey=function(){var e=this.root.lastEntry();return void 0!==e?e[0]:void 0},t.prototype.lastValue=function(){var e=this.root.lastEntry();return void 0!==e?e[1]:void 0},t.prototype.lastEntry=function(){return this.root.lastEntry()},t.prototype.nextKey=function(e){var t=this.root.nextEntry(e,this);return void 0!==t?t[0]:void 0},t.prototype.nextValue=function(e){var t=this.root.nextEntry(e,this);return void 0!==t?t[1]:void 0},t.prototype.nextEntry=function(e){return this.root.nextEntry(e,this)},t.prototype.previousKey=function(e){var t=this.root.previousEntry(e,this);return void 0!==t?t[0]:void 0},t.prototype.previousValue=function(e){var t=this.root.previousEntry(e,this);return void 0!==t?t[1]:void 0},t.prototype.previousEntry=function(e){return this.root.previousEntry(e,this)},t.prototype.set=function(e,t){var r=this.root,n=this.root.updated(e,t,this);return r!==n&&(n.size>r.size&&(n=n.balanced(this)),this.root=n),this},t.prototype.delete=function(e){var t=this.root,r=this.root.removed(e,this);return t!==r&&(this.root=r,!0)},t.prototype.drop=function(e){return e>0&&this.root.size>0&&(e<this.root.size?this.root=this.root.drop(e,this):this.root=Pt.empty()),this},t.prototype.take=function(e){return e<this.root.size&&this.root.size>0&&(this.root=e>0?this.root.take(e,this):Pt.empty()),this},t.prototype.clear=function(){this.root=Pt.empty()},t.prototype.updated=function(e,t){var r=this.root,n=r.updated(e,t,this);return r!==n?(n.size>r.size&&(n=n.balanced(this)),this.copy(n)):this},t.prototype.removed=function(e){var t=this.root,r=t.removed(e,this);return t!==r?this.copy(r):this},t.prototype.cleared=function(){return this.root.isEmpty()?this:this.copy(Pt.empty())},t.prototype.reduced=function(e,t,r){var n=this.root,i=n.reduced(e,t,r);return n!==i&&(this.root=i),i.fold},t.prototype.forEach=function(e,t){return this.root.forEach(e,t)},t.prototype.forEachKey=function(e,t){return this.root.forEachKey(e,t)},t.prototype.forEachValue=function(e,t){return this.root.forEachValue(e,t)},t.prototype.keys=function(){return this.root.keys()},t.prototype.values=function(){return this.root.values()},t.prototype.entries=function(){return this.root.entries()},t.prototype.reverseKeys=function(){return this.root.reverseKeys()},t.prototype.reverseValues=function(){return this.root.reverseValues()},t.prototype.reverseEntries=function(){return this.root.reverseEntries()},t.prototype.clone=function(){return this.copy(this.root)},t.prototype.copy=function(e){var r=new t(e);return r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},t}(wt),Pt=function(){function e(){}return e.prototype.keys=function(){return new bt(this.entries())},e.prototype.values=function(){return new mt(this.entries())},e.prototype.reverseKeys=function(){return new bt(this.reverseEntries())},e.prototype.reverseValues=function(){return new mt(this.reverseEntries())},e.empty=function(){return new xt([],void 0)},E([s],e,"empty",null),e}(),xt=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"slots",{value:t,enumerable:!0}),Object.defineProperty(n,"fold",{value:r,enumerable:!0}),n}return C(t,e),Object.defineProperty(t.prototype,"arity",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.slots.length},t.prototype.minKey=function(){return this.slots[0][0]},t.prototype.maxKey=function(){return this.slots[this.slots.length-1][0]},t.prototype.has=function(e,t){return this.lookup(e,t)>=0},t.prototype.get=function(e,t){var r=this.lookup(e,t);return r>=0?this.slots[r][1]:void 0},t.prototype.getEntry=function(e){return this.slots[e]},t.prototype.firstEntry=function(){var e=this.slots;return 0!==e.length?e[0]:void 0},t.prototype.lastEntry=function(){var e=this.slots;return 0!==e.length?e[e.length-1]:void 0},t.prototype.nextEntry=function(e,t){var r=this.lookup(e,t);return r>=0?r+=1:r=-(r+1),this.slots[r]},t.prototype.previousEntry=function(e,t){var r=this.lookup(e,t);return r>=0?r-=1:r=-(r+2),this.slots[r]},t.prototype.updated=function(e,t,r){var n=this.lookup(e,r);return n>=0?this.updatedSlot(n,e,t):(n=-(n+1),this.insertedSlot(n,e,t))},t.prototype.updatedSlot=function(e,r,n){var i=this.slots;if(n!==i[e][1]){var o=i.slice(0);return o[e]=[r,n],new t(o,void 0)}return this},t.prototype.insertedSlot=function(e,r,n){for(var i=this.slots,o=i.length+1,u=new Array(o),s=0;s<e;s+=1)u[s]=i[s];u[e]=[r,n];for(s=e;s<o-1;s+=1)u[s+1]=i[s];return new t(u,void 0)},t.prototype.removed=function(e,t){var r=this.lookup(e,t);return r>=0?this.slots.length>1?this.removedSlot(r):Pt.empty():this},t.prototype.removedSlot=function(e){for(var r=this.slots,n=new Array(r.length-1),i=0;i<e;i+=1)n[i]=r[i];for(i=e;i<n.length;i+=1)n[i]=r[i+1];return new t(n,void 0)},t.prototype.drop=function(e,r){if(e>0){var n=this.slots;if(e<n.length){for(var i=n.length-e,o=new Array(i),u=0;u<i;u+=1)o[u]=n[u+e];return new t(o,void 0)}return Pt.empty()}return this},t.prototype.take=function(e,r){var n=this.slots;if(e<n.length){if(e>0){for(var i=new Array(e),o=0;o<e;o+=1)i[o]=n[o];return new t(i,void 0)}return Pt.empty()}return this},t.prototype.balanced=function(e){var t=this.slots.length;if(t>1&&e.pageShouldSplit(this)){var r=t>>>1;return this.split(r)}return this},t.prototype.split=function(e){var t=new Array(2),r=this.splitLeft(e),n=this.splitRight(e);t[0]=r,t[1]=n;var i=new Array(1);return i[0]=n.minKey(),new jt(t,i,void 0,this.slots.length)},t.prototype.splitLeft=function(e){for(var r=this.slots,n=new Array(e),i=0;i<e;i+=1)n[i]=r[i];return new t(n,void 0)},t.prototype.splitRight=function(e){for(var r=this.slots,n=r.length-e,i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+e];return new t(i,void 0)},t.prototype.reduced=function(e,r,n){if(void 0===this.fold){for(var i=this.slots,o=e,u=0,s=i.length;u<s;u+=1)o=r(o,i[u][1]);return new t(i,o)}return this},t.prototype.forEach=function(e,t){for(var r=this.slots,n=0,i=r.length;n<i;n+=1){var o=r[n],u=e.call(t,o[0],o[1]);if(void 0!==u)return u}},t.prototype.forEachKey=function(e,t){for(var r=this.slots,n=0,i=r.length;n<i;n+=1){var o=r[n],u=e.call(t,o[0]);if(void 0!==u)return u}},t.prototype.forEachValue=function(e,t){for(var r=this.slots,n=0,i=r.length;n<i;n+=1){var o=r[n],u=e.call(t,o[1]);if(void 0!==u)return u}},t.prototype.entries=function(){return k.array(this.slots)},t.prototype.reverseEntries=function(){return k.array(this.slots,this.slots.length)},t.prototype.lookup=function(e,t){for(var r=0,n=this.slots.length-1;r<=n;){var i=r+n>>>1,o=t.compare(e,this.slots[i][0]);if(o>0)r=i+1;else{if(!(o<0))return i;n=i-1}}return-(r+1)},t}(Pt),jt=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"pages",{value:t,enumerable:!0}),Object.defineProperty(o,"knots",{value:r,enumerable:!0}),Object.defineProperty(o,"fold",{value:n,enumerable:!0}),Object.defineProperty(o,"size",{value:i,enumerable:!0}),o}return C(t,e),Object.defineProperty(t.prototype,"arity",{get:function(){return this.pages.length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.size},t.prototype.minKey=function(){return this.pages[0].minKey()},t.prototype.maxKey=function(){return this.pages[this.pages.length-1].maxKey()},t.prototype.has=function(e,t){var r=this.lookup(e,t);if(r>0)r+=1;else{if(!(r<0))return!0;r=-(r+1)}return this.pages[r].has(e,t)},t.prototype.get=function(e,t){var r=this.lookup(e,t);return r>=0?r+=1:r=-(r+1),this.pages[r].get(e,t)},t.prototype.getEntry=function(e){for(var t=this.pages,r=0,n=t.length;r<n;r+=1){var i=t[r];if(e<i.size)return i.getEntry(e);e-=i.size}},t.prototype.firstEntry=function(){var e=this.pages;return 0!==e.length?e[0].firstEntry():void 0},t.prototype.lastEntry=function(){var e=this.pages;return 0!==e.length?e[e.length-1].lastEntry():void 0},t.prototype.nextEntry=function(e,t){var r=this.lookup(e,t);r>=0?r+=1:r=-(r+1);var n=this.pages,i=n[r].nextEntry(e,t);return void 0===i&&r+1<n.length&&(i=n[r+1].nextEntry(e,t)),i},t.prototype.previousEntry=function(e,t){var r=this.lookup(e,t);r>=0?r+=1:r=-(r+1);var n=this.pages,i=n[r].previousEntry(e,t);return void 0===i&&r>0&&(i=n[r-1].previousEntry(e,t)),i},t.prototype.updated=function(e,t,r){var n=this.lookup(e,r);n>=0?n+=1:n=-(n+1);var i=this.pages[n],o=i.updated(e,t,r);return i!==o?i.size!==o.size&&r.pageShouldSplit(o)?this.updatedPageSplit(n,o,i):this.updatedPage(n,o,i):this},t.prototype.updatedPage=function(e,r,n){var i=this.pages.slice(0);i[e]=r;var o,u=this.knots;return u.length>0?(o=u.slice(0),e>0&&(o[e-1]=r.minKey())):o=[],new t(i,o,void 0,this.size-n.size+r.size)},t.prototype.updatedPageSplit=function(e,r,n){for(var i=this.pages,o=new Array(i.length+1),u=0;u<e;u+=1)o[u]=i[u];var s=r.splitLeft(r.arity>>>1),a=r.splitRight(r.arity>>>1);o[e]=s,o[e+1]=a;for(u=e+1;u<i.length;u+=1)o[u+1]=i[u];var p=this.knots,f=new Array(i.length);if(e>0){for(u=0;u<e-1;u+=1)f[u]=p[u];f[e-1]=s.minKey(),f[e]=a.minKey();for(u=e;u<p.length;u+=1)f[u+1]=p[u]}else{f[0]=a.minKey();for(u=0;u<p.length;u+=1)f[u+1]=p[u]}return new t(o,f,void 0,this.size-n.size+r.size)},t.prototype.updatedPageMerge=function(e,r,n){for(var i=this.pages,o=r.pages,u=new Array(i.length+o.length-1),s=0;s<e;s+=1)u[s]=i[s];for(s=0;s<o.length;s+=1)u[s+e]=o[s];for(s=e+1;s<i.length;s+=1)u[s+o.length-1]=i[s];var a=this.knots,p=r.knots,f=new Array(u.length-1);if(e>0){for(s=0;s<e-1;s+=1)f[s]=a[s];f[e-1]=o[0].minKey();for(s=0;s<p.length;s+=1)f[s+e]=p[s];for(s=e;s<a.length;s+=1)f[s+p.length]=a[s]}else{for(s=0;s<p.length;s+=1)f[s]=p[s];f[p.length]=i[1].minKey();for(s=1;s<a.length;s+=1)f[s+p.length]=a[s]}return new t(u,f,void 0,this.size-n.size+r.size)},t.prototype.removed=function(e,t){var r=this.lookup(e,t);r>=0?r+=1:r=-(r+1);var n=this.pages[r],i=n.removed(e,t);return n!==i?this.replacedPage(r,i,n,t):this},t.prototype.replacedPage=function(e,r,n,i){return r.isEmpty()?this.pages.length>2?this.removedPage(e,r,n):this.pages.length>1?0===e?this.pages[1]:this.pages[0]:Pt.empty():r instanceof t&&i.pageShouldMerge(r)?this.updatedPageMerge(e,r,n):this.updatedPage(e,r,n)},t.prototype.removedPage=function(e,r,n){for(var i=this.pages,o=new Array(i.length-1),u=0;u<e;u+=1)o[u]=i[u];for(u=e+1;u<i.length;u+=1)o[u-1]=i[u];var s=this.knots,a=new Array(s.length-1);if(e>0){for(u=0;u<e-1;u+=1)a[u]=s[u];for(u=e;u<s.length;u+=1)a[u-1]=s[u]}else for(u=1;u<s.length;u+=1)a[u-1]=s[u];return new t(o,a,void 0,this.size-n.size)},t.prototype.drop=function(e,r){if(e>0){var n=this.size;if(e<n){for(var i=this.pages,o=0;o<i.length;){var u=i[o].size;if(!(u<=e))break;n-=u,e-=u,o+=1}var s=i.length-o;if(s>1){var a=void 0;if(o>0){for(var p=new Array(s),f=0;f<s;f+=1)p[f]=i[f+o];var c=new Array(s-1);for(f=0;f<c.length;f+=1)c[f]=this.knots[f+o];a=new t(p,c,void 0,n)}else a=this;if(e>0){var l=i[o],h=l.drop(e,r);return a.replacedPage(0,h,l,r)}return a}return i[o].drop(e,r)}return Pt.empty()}return this},t.prototype.take=function(e,r){if(e<this.size){if(e>0){for(var n=this.pages,i=0,o=0;i<n.length&&e>0;){var u=n[i].size;if(o+=u,i+=1,!(u<=e))break;e-=u}var s=0===e?i:i+1;if(s>1){var a=void 0;if(i<n.length){for(var p=new Array(s),f=0;f<s;f+=1)p[f]=n[f];var c=new Array(s-1);for(f=0;f<c.length;f+=1)c[f]=this.knots[f];a=new t(p,c,void 0,o)}else a=this;if(e>0){var l=n[i-1],h=l.take(e,r);return a.replacedPage(i-1,h,l,r)}return a}return e>0?n[0].take(e,r):n[0]}return Pt.empty()}return this},t.prototype.balanced=function(e){if(this.pages.length>1&&e.pageShouldSplit(this)){var t=this.knots.length>>>1;return this.split(t)}return this},t.prototype.split=function(e){var r=new Array(2),n=this.splitLeft(e),i=this.splitRight(e);r[0]=n,r[1]=i;var o=new Array(1);return o[0]=i.minKey(),new t(r,o,void 0,this.size)},t.prototype.splitLeft=function(e){for(var r=this.pages,n=new Array(e+1),i=0;i<e+1;i+=1)n[i]=r[i];var o=this.knots,u=new Array(e);for(i=0;i<e;i+=1)u[i]=o[i];var s=0;for(i=0;i<=e;i+=1)s+=n[i].size;return new t(n,u,void 0,s)},t.prototype.splitRight=function(e){for(var r=this.pages,n=r.length-(e+1),i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+(e+1)];var u=this.knots,s=new Array(n-1);for(o=0;o<s.length;o+=1)s[o]=u[o+(e+1)];var a=0;for(o=0;o<n;o+=1)a+=i[o].size;return new t(i,s,void 0,a)},t.prototype.reduced=function(e,r,n){if(void 0===this.fold){for(var i=this.pages,o=i.length,u=new Array(o),s=0;s<o;s+=1)u[s]=i[s].reduced(e,r,n);var a=u[0].fold;for(s=1;s<o;s+=1)a=n(a,u[s].fold);return new t(u,this.knots,a,this.size)}return this},t.prototype.forEach=function(e,t){for(var r=this.pages,n=0,i=r.length;n<i;n+=1){var o=r[n].forEach(e,t);if(void 0!==o)return o}},t.prototype.forEachKey=function(e,t){for(var r=this.pages,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachKey(e,t);if(void 0!==o)return o}},t.prototype.forEachValue=function(e,t){for(var r=this.pages,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachValue(e,t);if(void 0!==o)return o}},t.prototype.entries=function(){return new Ct(this.pages)},t.prototype.reverseEntries=function(){return new Ct(this.pages,this.size,this.pages.length)},t.prototype.lookup=function(e,t){for(var r=0,n=this.knots.length-1;r<=n;){var i=r+n>>>1,o=t.compare(e,this.knots[i]);if(o>0)r=i+1;else{if(!(o<0))return i;n=i-1}}return-(r+1)},t}(Pt),Ct=function(e){function t(t,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=null),e.call(this,t,r,n,i)||this}return C(t,e),t.prototype.pageSize=function(e){return e.size},t.prototype.pageCursor=function(e){return e.entries()},t.prototype.reversePageCursor=function(e){return e.reverseEntries()},t}(gt),Et=function(){function e(){}return Object.defineProperty(e.prototype,"pageSplitSize",{get:function(){return 32},set:function(e){Object.defineProperty(this,"pageSplitSize",{value:e,configurable:!0,enumerable:!0,writable:!0})},enumerable:!1,configurable:!0}),e.prototype.identify=function(e){var t=new Uint8Array(6);return a.fillBytes(t),t},e.prototype.compare=function(e,t){return P.compare(e,t)},e.prototype.pageShouldSplit=function(e){return e.arity>this.pageSplitSize},e.prototype.pageShouldMerge=function(e){return e.arity<this.pageSplitSize>>>1},e}(),St=function(e){function t(t){var r=e.call(this)||this;return void 0===t&&(t=kt.empty()),r.root=t,r}return C(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return this.root.isEmpty()},t.prototype.get=function(e,t){if(!(void 0!==t&&(e=this.lookup(t,e))<0))return this.root.get(e)},t.prototype.getEntry=function(e,t){if(!(void 0!==t&&(e=this.lookup(t,e))<0))return this.root.getEntry(e)},t.prototype.set=function(e,t,r){if(void 0!==r&&(e=this.lookup(r,e))<0)throw new RangeError(""+r);var n=this.root;if(e<0||e>=n.size)throw new RangeError(""+e);return this.root=n.updated(e,t,this),this},t.prototype.insert=function(e,t,r){var n=this.root;if(e<0||e>n.size)throw new RangeError(""+e);return this.root=n.inserted(e,t,r,this).balanced(this),this},t.prototype.remove=function(e,t){if(void 0!==t&&(e=this.lookup(t,e))<0)throw new RangeError(""+t);var r=this.root;if(e<0||e>r.size)throw new RangeError(""+e);return this.root=r.removed(e,this),this},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this.root,n=0;n<e.length;n+=1)r=r.inserted(r.size,e[n],void 0,this).balanced(this);return this.root=r,r.size},t.prototype.pop=function(){var e=this.root,t=e.size-1;if(t>=0){var r=e.get(t);return this.root=e.removed(t,this),r}},t.prototype.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this.root,n=e.length-1;n>=0;n-=1)r=r.inserted(0,e[n],void 0,this).balanced(this);return this.root=r,r.size},t.prototype.shift=function(){var e=this.root;if(e.size>0){var t=e.get(0);return this.root=e.removed(0,this),t}},t.prototype.move=function(e,t,r){if(void 0!==r&&(e=this.lookup(r,e))<0)throw new RangeError(""+r);var n=this.root;if(e<0||e>=n.size)throw new RangeError(""+e);if(t<0||t>=n.size)throw new RangeError(""+t);if(e!==t){var i=n.getEntry(e);this.root=n.removed(e,this).inserted(t,i[1],i[0],this).balanced(this)}return this},t.prototype.splice=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=this.root;e<0&&(e=i.size+e),e=Math.min(Math.max(0,e),i.size),void 0===t&&(t=i.size-e);for(var o=[],u=e,s=e+t;u<s;u+=1)o.push(i.get(e)),i=i.removed(e,this);for(u=0;u<r.length;u+=1)i=i.inserted(e+u,r[u],void 0,this).balanced(this);return this.root=i,o},t.prototype.drop=function(e){var t=this.root;return e>0&&t.size>0&&(e<t.size?this.root=t.drop(e,this):this.root=kt.empty()),this},t.prototype.take=function(e){var t=this.root;return e<t.size&&t.size>0&&(this.root=e>0?t.take(e,this):kt.empty()),this},t.prototype.clear=function(){this.root=kt.empty()},t.prototype.forEach=function(e,t){return this.root.forEach(e,t,0)},t.prototype.keys=function(){return this.root.keys()},t.prototype.values=function(){return this.root.values()},t.prototype.entries=function(){return this.root.entries()},t.prototype.reverseKeys=function(){return this.root.reverseKeys()},t.prototype.reverseValues=function(){return this.root.reverseValues()},t.prototype.reverseEntries=function(){return this.root.reverseEntries()},t.prototype.clone=function(){return this.copy(this.root)},t.prototype.copy=function(e){var r=new t(e);return r.identify!==this.identify&&(r.identify=this.identify),r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},t.prototype.lookup=function(e,t){void 0===t&&(t=0);var r=this.root,n=t=Math.min(Math.max(0,t),r.size-1);do{var i=r.getEntry(n);if(void 0!==i&&0===this.compare(i[0],e))return n;n=(n+1)%r.size}while(isFinite(n)&&n!==t);return-1},t}(Et),kt=function(){function e(){}return e.prototype.keys=function(){return new bt(this.entries())},e.prototype.values=function(){return new mt(this.entries())},e.prototype.reverseKeys=function(){return new bt(this.reverseEntries())},e.prototype.reverseValues=function(){return new mt(this.reverseEntries())},e.empty=function(){return new Mt([])},E([s],e,"empty",null),e}(),Mt=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"slots",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"arity",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.slots.length},t.prototype.get=function(e){var t=this.slots[e];return void 0!==t?t[1]:void 0},t.prototype.getEntry=function(e){return this.slots[e]},t.prototype.updated=function(e,t,r){if(e<0||e>=this.slots.length)throw new RangeError(""+e);return this.updatedItem(e,t)},t.prototype.updatedItem=function(e,r){var n=this.slots,i=n[e];if(void 0!==i&&r!==i[1]){var o=n.slice(0);return o[e]=[i[0],r],new t(o)}return this},t.prototype.inserted=function(e,t,r,n){if(e<0||e>this.slots.length)throw new RangeError(""+e);return this.insertedItem(e,t,r,n)},t.prototype.insertedItem=function(e,r,n,i){void 0===n&&(n=i.identify(r));for(var o=this.slots,u=new Array(o.length+1),s=0;s<e;s+=1)u[s]=o[s];u[e]=[n,r];for(s=e;s<o.length;s+=1)u[s+1]=o[s];return new t(u)},t.prototype.removed=function(e,t){if(e<0||e>=this.slots.length)throw new RangeError(""+e);return this.slots.length>1?this.removedSlot(e):kt.empty()},t.prototype.removedSlot=function(e){for(var r=this.slots,n=new Array(r.length-1),i=0;i<e;i+=1)n[i]=r[i];for(i=e;i<n.length;i+=1)n[i]=r[i+1];return new t(n)},t.prototype.drop=function(e,r){var n=this.slots;if(e>0&&n.length>0){if(e<n.length){for(var i=n.length-e,o=new Array(i),u=0;u<i;u+=1)o[u]=n[u+e];return new t(o)}return kt.empty()}return this},t.prototype.take=function(e,r){var n=this.slots;if(e<n.length&&n.length>0){if(e>0){for(var i=new Array(e),o=0;o<e;o+=1)i[o]=n[o];return new t(i)}return kt.empty()}return this},t.prototype.balanced=function(e){var t=this.slots.length;return t>1&&e.pageShouldSplit(this)?this.split(t>>>1):this},t.prototype.split=function(e){var t=new Array(2),r=this.splitLeft(e),n=this.splitRight(e);t[0]=r,t[1]=n;var i=new Array(1);return i[0]=e,new At(t,i,this.slots.length)},t.prototype.splitLeft=function(e){for(var r=this.slots,n=new Array(e),i=0;i<e;i+=1)n[i]=r[i];return new t(n)},t.prototype.splitRight=function(e){for(var r=this.slots,n=r.length-e,i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+e];return new t(i)},t.prototype.forEach=function(e,t,r){for(var n=0;n<this.slots.length;n+=1){var i=this.slots[n],o=e.call(t,i[1],r+n,i[0]);if(void 0!==o)return o}},t.prototype.entries=function(){return k.array(this.slots)},t.prototype.reverseEntries=function(){return k.array(this.slots,this.slots.length)},t}(kt),At=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"pages",{value:t,enumerable:!0}),Object.defineProperty(i,"knots",{value:r,enumerable:!0}),Object.defineProperty(i,"size",{value:n,enumerable:!0}),i}return C(t,e),Object.defineProperty(t.prototype,"arity",{get:function(){return this.pages.length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.size},t.prototype.get=function(e){var t=this.lookup(e);t>=0?t+=1:t=-(t+1);var r=0===t?e:e-this.knots[t-1];return this.pages[t].get(r)},t.prototype.getEntry=function(e){var t=this.lookup(e);t>=0?t+=1:t=-(t+1);var r=0===t?e:e-this.knots[t-1];return this.pages[t].getEntry(r)},t.prototype.updated=function(e,t,r){var n=this.lookup(e);n>=0?n+=1:n=-(n+1);var i=0===n?e:e-this.knots[n-1],o=this.pages[n],u=o.updated(i,t,r);return o!==u?o.size!==u.size&&r.pageShouldSplit(u)?this.updatedPageSplit(n,u,o):this.updatedPage(n,u,o):this},t.prototype.updatedPage=function(e,r,n){var i=this.pages,o=i.slice(0);o[e]=r;var u,s,a=this.knots;if(i.length-1>0){u=a.slice(0),s=e>0?a[e-1]:0;for(var p=e;p<u.length;p+=1)s+=o[p].size,u[p]=s;s+=o[u.length].size}else u=[],s=0;return new t(o,u,s)},t.prototype.updatedPageSplit=function(e,r,n){for(var i=this.pages,o=new Array(i.length+1),u=0;u<e;u+=1)o[u]=i[u];var s=r.splitLeft(r.arity>>>1),a=r.splitRight(r.arity>>>1);o[e]=s,o[e+1]=a;for(u=e+1;u<i.length;u+=1)o[u+1]=i[u];return t.create(o)},t.prototype.updatedPageMerge=function(e,r,n){for(var i=this.pages,o=r.pages,u=new Array(i.length+o.length-1),s=0;s<e;s+=1)u[s]=i[s];for(s=0;s<o.length;s+=1)u[s+e]=o[s];for(s=e+1;s<i.length;s+=1)u[s+o.length-1]=i[s];return t.create(u)},t.prototype.inserted=function(e,t,r,n){var i=this.lookup(e);i>=0?i+=1:i=-(i+1);var o=0===i?e:e-this.knots[i-1],u=this.pages[i],s=u.inserted(o,t,r,n);return u!==s?n.pageShouldSplit(s)?this.updatedPageSplit(i,s,u):this.updatedPage(i,s,u):this},t.prototype.removed=function(e,t){var r=this.lookup(e);r>=0?r+=1:r=-(r+1);var n=0===r?e:e-this.knots[r-1],i=this.pages[r],o=i.removed(n,t);return i!==o?this.replacedPage(r,o,i,t):this},t.prototype.replacedPage=function(e,r,n,i){return r.isEmpty()?this.pages.length>2?this.removedPage(e,r,n):this.pages.length>1?0===e?this.pages[1]:this.pages[0]:kt.empty():r instanceof t&&i.pageShouldMerge(r)?this.updatedPageMerge(e,r,n):this.updatedPage(e,r,n)},t.prototype.removedPage=function(e,r,n){for(var i=this.pages,o=new Array(i.length-1),u=0;u<e;u+=1)o[u]=i[u];for(u=e+1;u<i.length;u+=1)o[u-1]=i[u];var s,a=this.knots,p=new Array(a.length-1);if(e>0){for(u=0;u<e;u+=1)p[u]=a[u];s=a[e-1]}else s=0;for(u=e;u<p.length;u+=1)s+=o[u].size,p[u]=s;return new t(o,p,s+=o[p.length].size)},t.prototype.drop=function(e,r){if(e>0){if(e<this.size){var n=this.lookup(e);n>=0?n+=1:n=-(n+1),e=0===n?e:e-this.knots[n-1];var i=this.pages,o=i.length-n;if(o>1){var u=void 0;if(n>0){for(var s=new Array(o),a=0;a<o;a+=1)s[a]=i[a+n];u=t.create(s)}else u=this;if(e>0){var p=i[n],f=p.drop(e,r);return u.replacedPage(0,f,p,r)}return u}return i[n].drop(e,r)}return kt.empty()}return this},t.prototype.take=function(e,r){if(e<this.size){if(e>0){var n=this.lookup(e);n>=0?n+=1:n=-(n+1),e=0===n?e:e-this.knots[n-1];var i=this.pages,o=0===e?n:n+1;if(o>1){var u=void 0;if(n<i.length){for(var s=new Array(o),a=0;a<o;a+=1)s[a]=i[a];var p=new Array(o-1);for(a=0;a<p.length;a+=1)p[a]=this.knots[a];u=new t(s,p,p[o-2]+s[o-1].size)}else u=this;if(e>0){var f=i[n],c=f.take(e,r);return u.replacedPage(n,c,f,r)}return u}return e>0?i[0].take(e,r):i[0]}return kt.empty()}return this},t.prototype.balanced=function(e){if(this.pages.length>1&&e.pageShouldSplit(this)){var t=this.knots.length>>>1;return this.split(t)}return this},t.prototype.split=function(e){var r=new Array(2),n=this.splitLeft(e),i=this.splitRight(e);r[0]=n,r[1]=i;var o=new Array(1);return o[0]=n.size,new t(r,o,this.size)},t.prototype.splitLeft=function(e){for(var r=this.pages,n=new Array(e+1),i=0;i<e+1;i+=1)n[i]=r[i];var o=this.knots,u=new Array(e);for(i=0;i<e;i+=1)u[i]=o[i];var s=0;for(i=0;i<=e;i+=1)s+=n[i].size;return new t(n,u,s)},t.prototype.splitRight=function(e){for(var r=this.pages,n=r.length-(e+1),i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+(e+1)];var u,s=new Array(n-1);if(n>0){u=i[0].size;for(o=1;o<n;o+=1)s[o-1]=u,u+=i[o].size}else u=0;return new t(i,s,u)},t.prototype.forEach=function(e,t,r){for(var n=0;n<this.pages.length;n+=1){var i=this.pages[n],o=i.forEach(e,t,r);if(void 0!==o)return o;r+=i.size}},t.prototype.entries=function(){return new Dt(this.pages)},t.prototype.reverseEntries=function(){return new Dt(this.pages,this.size,this.pages.length)},t.prototype.lookup=function(e){for(var t=0,r=this.knots.length-1;t<=r;){var n=t+r>>>1;if(e>this.knots[n])t=n+1;else{if(!(e<this.knots[n]))return n;r=n-1}}return-(t+1)},t.create=function(e){for(var r=new Array(e.length-1),n=0,i=0,o=r.length;i<o;i+=1)n+=e[i].size,r[i]=n;return new t(e,r,n+=e[r.length].size)},t}(kt),Dt=function(e){function t(t,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=null),e.call(this,t,r,n,i)||this}return C(t,e),t.prototype.pageSize=function(e){return e.size},t.prototype.pageCursor=function(e){return e.entries()},t.prototype.reversePageCursor=function(e){return e.reverseEntries()},t}(gt),It={};Object.defineProperty(It,"idCount",{value:0,enumerable:!0,configurable:!0}),It.nextId=function(){var e=It.idCount+1;return Object.defineProperty(It,"idCount",{value:e,enumerable:!0,configurable:!0}),e};var Tt=function(){function e(e,t){Object.defineProperty(this,"index",{value:void 0!==e?e:{},enumerable:!0,configurable:!0}),Object.defineProperty(this,"array",{value:void 0!==t?t:[],enumerable:!0})}return Object.defineProperty(e.prototype,"size",{get:function(){return this.array.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.array.length},e.prototype.has=function(e){return void 0!==this.index[e.id]},e.prototype.get=function(e){var t=this.index[e.id];return void 0!==t?this.array[t][1]:void 0},e.prototype.getField=function(e){var t=this.index[e.id];return void 0!==t?this.array[t]:void 0},e.prototype.getEntry=function(e){return this.array[e]},e.prototype.set=function(e,t){var r=this.index[e.id];if(void 0!==r){var n=this.array[r],i=n[1];return n[1]=t,i}return this.index[e.id]=this.array.length,void this.array.push([e,t])},e.prototype.delete=function(e){var t=this.index[e.id];if(void 0!==t){delete this.index[e.id];var r=this.array[t],n=this.array.pop();return r!==n&&(this.array[t]=n,this.index[n[0].id]=t),!0}return!1},e.prototype.remove=function(e){var t=this.index[e.id];if(void 0!==t){delete this.index[e.id];var r=this.array[t],n=this.array.pop();return r!==n&&(this.array[t]=n,this.index[n[0].id]=t),r[1]}},e.prototype.clear=function(){Object.defineProperty(this,"index",{value:{},enumerable:!0,configurable:!0}),this.array.length=0},e.prototype.forEach=function(e,t){for(var r=this.array,n=0,i=r.length;n<i;n+=1){var o=r[n],u=e.call(t,o[0],o[1]);if(void 0!==u)return u}},e.prototype.clone=function(){for(var t=this.array,r=t.length,n={},i=new Array(r),o=0;o<r;o+=1){var u=t[o],s=u[0],a=u[1];i[o]=[s,a],n[s.id]=o}return new e(n,i)},e}(),Vt={},qt=function(){function e(){Object.defineProperty(this,"id",{value:It.nextId(),enumerable:!0})}return e.prototype.isExternal=function(){return!1},e.prototype.isDummy=function(){return!1},e.prototype.isInvalid=function(){return!1},e.prototype.addConstraintCondition=function(e,t){},e.prototype.removeConstraintCondition=function(e,t){},e.prototype.updateConstraintSolution=function(e){},e}(),Rt=function(){function e(){Object.defineProperty(this,"id",{value:It.nextId(),enumerable:!0})}return e.prototype.isExternal=function(){return!1},e.prototype.isDummy=function(){return!0},e.prototype.isInvalid=function(){return!1},e.prototype.addConstraintCondition=function(e,t){},e.prototype.removeConstraintCondition=function(e,t){},e.prototype.updateConstraintSolution=function(e){},e}(),Ut=function(){function e(){Object.defineProperty(this,"id",{value:It.nextId(),enumerable:!0})}return e.prototype.isExternal=function(){return!1},e.prototype.isDummy=function(){return!1},e.prototype.isInvalid=function(){return!1},e.prototype.addConstraintCondition=function(e,t){},e.prototype.removeConstraintCondition=function(e,t){},e.prototype.updateConstraintSolution=function(e){},e}(),Nt=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return-1},enumerable:!1,configurable:!0}),e.prototype.isExternal=function(){return!1},e.prototype.isDummy=function(){return!1},e.prototype.isInvalid=function(){return!0},e.prototype.addConstraintCondition=function(e,t){},e.prototype.removeConstraintCondition=function(e,t){},e.prototype.updateConstraintSolution=function(e){},e}();Object.defineProperty(Vt,"invalid",{value:new Nt,enumerable:!0,configurable:!0});var zt={fromAny:function(e){return"number"==typeof e?zt.constant(e):e},sum:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=new Tt,n=0,i=0,o=e.length;i<o;i+=1){var u=e[i];if("number"==typeof u)n+=u;else if(Lt.is(u)){if(null!==(l=u.variable))void 0!==(f=r.getField(l))?f[1]+=u.coefficient:r.set(l,u.coefficient);else n+=u.constant}else{for(var s=u.terms,a=0,p=s.size;a<p;a+=1){var f,c=s.getEntry(a),l=c[0],h=c[1];void 0!==(f=r.getField(l))?f[1]+=h:r.set(l,h)}n+=u.constant}}return new Ft(r,n)},product:function(e,t){return new Kt(e,t)},constant:function(e){return 0===e?zt.zero:new Bt(e)}},Ft=function(){function e(e,t){Object.defineProperty(this,"terms",{value:e,enumerable:!0}),Object.defineProperty(this,"constant",{value:t,enumerable:!0})}return e.prototype.isConstant=function(){return this.terms.isEmpty()},e.prototype.plus=function(e){return zt.sum(this,e)},e.prototype.negative=function(){for(var t=this.terms,r=new Tt,n=0,i=t.size;n<i;n+=1){var o=t.getEntry(n),u=o[0],s=o[1];r.set(u,-s)}return new e(r,-this.constant)},e.prototype.minus=function(e){return e="number"==typeof e?zt.constant(e):e.negative(),zt.sum(this,e)},e.prototype.times=function(t){for(var r=this.terms,n=new Tt,i=0,o=r.size;i<o;i+=1){var u=r.getEntry(i),s=u[0],a=u[1];n.set(s,a*t)}return new e(n,this.constant*t)},e.prototype.divide=function(t){for(var r=this.terms,n=new Tt,i=0,o=r.size;i<o;i+=1){var u=r.getEntry(i),s=u[0],a=u[1];n.set(s,a/t)}return new e(n,this.constant/t)},e.prototype.debug=function(e){e=e.write("ConstraintExpression").write(46).write("sum").write(40);for(var t=this.terms.size,r=0;r<t;r+=1){var n=this.terms.getEntry(r),i=n[0],o=n[1];r>0&&(e=e.write(", ")),e=1===o?e.debug(i):e.debug(zt.product(o,i))}return 0!==this.constant&&(t>0&&(e=e.write(", ")),e=e.debug(this.constant)),e=e.write(41)},e.prototype.toString=function(){return ne.debug(this)},e}(),Lt={is:function(e){if(void 0!==typeof e&&null!==e){return"coefficient"in e&&"variable"in e}return!1}},Kt=function(){function e(e,t){Object.defineProperty(this,"coefficient",{value:e,enumerable:!0}),Object.defineProperty(this,"variable",{value:t,enumerable:!0})}return e.prototype.isConstant=function(){return!1},Object.defineProperty(e.prototype,"terms",{get:function(){var e=new Tt;return e.set(this.variable,this.coefficient),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"constant",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.plus=function(t){return(t=zt.fromAny(t))instanceof e&&this.variable===t.variable?zt.product(this.coefficient+t.coefficient,this.variable):this.variable===t?zt.product(this.coefficient+1,this.variable):zt.sum(this,t)},e.prototype.negative=function(){return zt.product(-this.coefficient,this.variable)},e.prototype.minus=function(t){return(t=zt.fromAny(t))instanceof e&&this.variable===t.variable?zt.product(this.coefficient-t.coefficient,this.variable):this.variable===t?zt.product(this.coefficient-1,this.variable):zt.sum(this,t.negative())},e.prototype.times=function(e){return zt.product(this.coefficient*e,this.variable)},e.prototype.divide=function(e){return zt.product(this.coefficient/e,this.variable)},e.prototype.debug=function(e){return e=e.write("ConstraintExpression").write(46).write("product").write(40).debug(this.coefficient).write(", ").debug(this.variable).write(41)},e.prototype.toString=function(){return ne.debug(this)},e}(),Bt=function(){function e(e){Object.defineProperty(this,"constant",{value:e,enumerable:!0})}return e.prototype.isConstant=function(){return!0},Object.defineProperty(e.prototype,"coefficient",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variable",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){return new Tt},enumerable:!1,configurable:!0}),e.prototype.plus=function(t){return(t=zt.fromAny(t))instanceof e?zt.constant(this.constant+t.constant):zt.sum(this,t)},e.prototype.negative=function(){return zt.constant(-this.constant)},e.prototype.minus=function(t){return(t=zt.fromAny(t))instanceof e?zt.constant(this.constant-t.constant):zt.sum(this,t.negative())},e.prototype.times=function(e){return zt.constant(this.constant*e)},e.prototype.divide=function(e){return zt.constant(this.constant/e)},e.prototype.debug=function(e){return e=e.write("ConstraintExpression").write(46),e=0===this.constant?e.write("zero"):e.write("constant").write(40).debug(this.constant).write(41)},e.prototype.toString=function(){return ne.debug(this)},e}();Object.defineProperty(zt,"zero",{value:new Bt(0),enumerable:!0,configurable:!0});var Wt=function(){function e(e,t,r,n){Object.defineProperty(this,"id",{value:It.nextId(),enumerable:!0}),Object.defineProperty(this,"owner",{value:e,enumerable:!0}),Object.defineProperty(this,"name",{value:t,enumerable:!0}),Object.defineProperty(this,"state",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(this,"strength",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(this,"constraintFlags",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"conditionCount",{value:0,enumerable:!0,configurable:!0})}return e.prototype.isExternal=function(){return!0},e.prototype.isDummy=function(){return!1},e.prototype.isInvalid=function(){return!1},e.prototype.isConstant=function(){return!1},e.prototype.setState=function(e){var t=this.state;t!==e&&(this.willSetState(e,t),Object.defineProperty(this,"state",{value:e,enumerable:!0,configurable:!0}),this.onSetState(e,t),this.didSetState(e,t))},e.prototype.willSetState=function(e,t){},e.prototype.onSetState=function(e,t){this.isConstraining()&&this.owner.setConstraintVariable(this,e)},e.prototype.didSetState=function(e,t){},e.prototype.evaluateConstraintVariable=function(){},e.prototype.updateConstraintSolution=function(e){this.isConstrained()&&this.setState(e)},Object.defineProperty(e.prototype,"coefficient",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variable",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"terms",{get:function(){var e=new Tt;return e.set(this,1),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"constant",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.plus=function(e){return this===(e=zt.fromAny(e))?zt.product(2,this):zt.sum(this,e)},e.prototype.negative=function(){return zt.product(-1,this)},e.prototype.minus=function(e){return this===(e=zt.fromAny(e))?zt.zero:zt.sum(this,e.negative())},e.prototype.times=function(e){return zt.product(e,this)},e.prototype.divide=function(e){return zt.product(1/e,this)},e.prototype.setConstraintFlags=function(e){Object.defineProperty(this,"constraintFlags",{value:e,enumerable:!0,configurable:!0})},e.prototype.isConstrained=function(){return 0!=(this.constraintFlags&e.ConstrainedFlag)},e.prototype.constrain=function(t){void 0===t&&(t=!0);var r=this.constraintFlags;return t&&0==(r&e.ConstrainedFlag)?(this.setConstraintFlags(r|e.ConstrainedFlag),0!==this.conditionCount&&this.stopConstraining()):t||0==(r&e.ConstrainedFlag)||(this.setConstraintFlags(r&~e.ConstrainedFlag),0!==this.conditionCount&&(this.startConstraining(),this.updateConstraintVariable())),this},e.prototype.addConstraintCondition=function(e,t){var r=this.conditionCount,n=r+1;Object.defineProperty(this,"conditionCount",{value:n,enumerable:!0,configurable:!0}),this.isConstrained()||0!==r||(this.startConstraining(),this.updateConstraintVariable())},e.prototype.removeConstraintCondition=function(e,t){var r=this.conditionCount-1;Object.defineProperty(this,"conditionCount",{value:r,enumerable:!0,configurable:!0}),this.isConstrained()||0!==r||this.stopConstraining()},e.prototype.isConstraining=function(){return 0!=(this.constraintFlags&e.ConstrainingFlag)},e.prototype.startConstraining=function(){0==(this.constraintFlags&e.ConstrainingFlag)&&(this.willStartConstraining(),this.setConstraintFlags(this.constraintFlags|e.ConstrainingFlag),this.onStartConstraining(),this.didStartConstraining())},e.prototype.willStartConstraining=function(){},e.prototype.onStartConstraining=function(){this.owner.addConstraintVariable(this)},e.prototype.didStartConstraining=function(){},e.prototype.stopConstraining=function(){0!=(this.constraintFlags&e.ConstrainingFlag)&&(this.willStopConstraining(),this.setConstraintFlags(this.constraintFlags&~e.ConstrainingFlag),this.onStopConstraining(),this.didStopConstraining())},e.prototype.willStopConstraining=function(){},e.prototype.onStopConstraining=function(){this.owner.removeConstraintVariable(this)},e.prototype.didStopConstraining=function(){},e.prototype.updateConstraintVariable=function(){void 0!==this.state&&this.owner.setConstraintVariable(this,this.state)},e.prototype.debug=function(e){return e=e.debug(this.owner).write(46).write("constraintVariable").write(40).debug(this.name).write(", ").debug(this.state).write(41)},e.prototype.toString=function(){return ne.debug(this)},e.ConstrainedFlag=1,e.ConstrainingFlag=2,e}(),Ht={};Object.defineProperty(Ht,"Required",{value:1001001e3,enumerable:!0,configurable:!0}),Object.defineProperty(Ht,"Strong",{value:1e6,enumerable:!0,configurable:!0}),Object.defineProperty(Ht,"Medium",{value:1e3,enumerable:!0,configurable:!0}),Object.defineProperty(Ht,"Weak",{value:1,enumerable:!0,configurable:!0}),Object.defineProperty(Ht,"Unbound",{value:-1,enumerable:!0,configurable:!0}),Ht.clip=function(e){return Math.min(Math.max(0,e),Ht.Required)},Ht.fromAny=function(e){if("number"==typeof e)return Ht.clip(e);if("required"===e)return Ht.Required;if("strong"===e)return Ht.Strong;if("medium"===e)return Ht.Medium;if("weak"===e)return Ht.Weak;throw new TypeError(""+e)};var Xt=function(){function e(e,t,r,n){Object.defineProperty(this,"id",{value:It.nextId(),enumerable:!0}),Object.defineProperty(this,"scope",{value:e,enumerable:!0}),Object.defineProperty(this,"expression",{value:t,enumerable:!0}),Object.defineProperty(this,"relation",{value:r,enumerable:!0}),Object.defineProperty(this,"strength",{value:n,enumerable:!0})}return e.prototype.isConstrained=function(){return this.scope.hasConstraint(this)},e.prototype.constrain=function(e){return void 0===e&&(e=!0),e?this.scope.addConstraint(this):this.scope.removeConstraint(this),this},e.prototype.debug=function(e){return e=e.debug(this.scope).write(46).write("constraint").write(40).debug(this.expression).write(", ").debug(this.relation).write(", ").debug(void 0).write(", "),e=(e=this.strength===Ht.Required?e.debug("required"):this.strength===Ht.Strong?e.debug("strong"):this.strength===Ht.Medium?e.debug("medium"):this.strength===Ht.Weak?e.debug("weak"):e.debug(this.strength)).write(41)},e.prototype.toString=function(){return ne.debug(this)},e}(),Yt=function(){function e(e){Object.defineProperty(this,"scope",{value:e,enumerable:!0}),Object.defineProperty(this,"constraints",{value:[],enumerable:!0}),Object.defineProperty(this,"constrained",{value:!1,enumerable:!0,configurable:!0})}return e.prototype.constraint=function(e,t,r,n){e=zt.fromAny(e),void 0!==r&&(r=zt.fromAny(r));var i=void 0!==r?e.minus(r):e;n=void 0===n?Ht.Required:Ht.fromAny(n);var o=new Xt(this.scope,i,t,n);return this.addConstraint(o),o},e.prototype.hasConstraint=function(e){return this.constraints.indexOf(e)>=0},e.prototype.addConstraint=function(e){var t=this.constraints;t.indexOf(e)<0&&(t.push(e),e.constrain(this.constrained))},e.prototype.removeConstraint=function(e){var t=this.constraints;if(void 0!==t){var r=t.indexOf(e);r>=0&&(t.splice(r,1),e.constrain(!1))}},e.prototype.enableConstraints=function(){for(var e=this.constraints,t=0,r=e.length;t<r;t+=1)e[t].constrain(!0)},e.prototype.disableConstraints=function(){for(var e=this.constraints,t=0,r=e.length;t<r;t+=1)e[t].constrain(!1)},e.prototype.isConstrained=function(){return this.constrained},e.prototype.constrain=function(e){return void 0===e&&(e=!0),e&&!this.constrained?(Object.defineProperty(this,"constrained",{value:!0,enumerable:!0,configurable:!0}),this.enableConstraints()):!e&&this.constrained&&(Object.defineProperty(this,"constrained",{value:!1,enumerable:!0,configurable:!0}),this.disableConstraints()),this},e}(),Gt=function(){function e(e,t,r,n){Object.defineProperty(this,"solver",{value:e,enumerable:!0}),Object.defineProperty(this,"symbol",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(this,"cells",{value:r,enumerable:!0}),Object.defineProperty(this,"constant",{value:n,enumerable:!0,configurable:!0})}return e.prototype.setSymbol=function(e){Object.defineProperty(this,"symbol",{value:e,enumerable:!0,configurable:!0}),this.invalidate()},e.prototype.setConstant=function(e){this.constant!==e&&(Object.defineProperty(this,"constant",{value:e,enumerable:!0,configurable:!0}),this.invalidate())},e.prototype.isConstant=function(){return this.cells.isEmpty()},e.prototype.isDummy=function(){for(var e=0,t=this.cells.size;e<t;e+=1){if(!(this.cells.getEntry(e)[0]instanceof Rt))return!1}return!0},e.prototype.clone=function(){return new e(this.solver,this.symbol,this.cells.clone(),this.constant)},e.prototype.add=function(e){var t=this.constant+e;return this.setConstant(t),t},e.prototype.insertSymbol=function(e,t){var r;void 0===t&&(t=1),t+=null!==(r=this.cells.get(e))&&void 0!==r?r:0,Math.abs(t)<n.Epsilon?this.cells.remove(e):this.cells.set(e,t)},e.prototype.insertRow=function(e,t){this.setConstant(this.constant+e.constant*t);for(var r=0,n=e.cells.size;r<n;r+=1){var i=e.cells.getEntry(r),o=i[0],u=i[1];this.insertSymbol(o,u*t)}},e.prototype.removeSymbol=function(e){this.cells.remove(e)},e.prototype.negate=function(){this.setConstant(-this.constant);for(var e=0,t=this.cells.size;e<t;e+=1){var r=this.cells.getEntry(e);r[1]=-r[1]}},e.prototype.solveFor=function(e){var t=this.cells.remove(e);if(void 0!==t){var r=-1/t;this.setConstant(this.constant*r);for(var n=0,i=this.cells.size;n<i;n+=1){this.cells.getEntry(n)[1]*=r}}},e.prototype.solveForEx=function(e,t){this.insertSymbol(e,-1),this.solveFor(t)},e.prototype.coefficientFor=function(e){var t=this.cells.get(e);return void 0!==t?t:0},e.prototype.substitute=function(e,t){var r=this.cells.remove(e);void 0!==r&&this.insertRow(t,r)},e.prototype.invalidate=function(){var e=this.symbol;null!==e&&this.solver.invalidate(e,this)},e}(),_t=function(){function e(){Object.defineProperty(this,"constraints",{value:new Tt,enumerable:!0}),Object.defineProperty(this,"constraintVariables",{value:new Tt,enumerable:!0}),Object.defineProperty(this,"rows",{value:new Tt,enumerable:!0}),Object.defineProperty(this,"infeasible",{value:[],enumerable:!0}),Object.defineProperty(this,"objective",{value:new Gt(this,null,new Tt,0),enumerable:!0}),Object.defineProperty(this,"artificial",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"invalidated",{value:new Tt,enumerable:!0,configurable:!0})}return e.prototype.constraint=function(e,t,r,n){e=zt.fromAny(e),void 0!==r&&(r=zt.fromAny(r));var i=void 0!==r?e.minus(r):e;n=void 0===n?Ht.Required:Ht.fromAny(n);var o=new Xt(this,i,t,n);return this.addConstraint(o),o},e.prototype.hasConstraint=function(e){return this.constraints.has(e)},e.prototype.addConstraint=function(e){if(!this.constraints.has(e)){for(var t=e.expression.terms,r=0,n=t.size;r<n;r+=1){t.getEntry(r)[0].addConstraintCondition(e,this)}var i=this.createRow(e),o=i.row,u=i.tag;this.addConstraintRow(e,o,u)}},e.prototype.addConstraintRow=function(e,t,r){this.willAddConstraint(e);var i=this.chooseSubject(t,r);if(i.isInvalid()&&t.isDummy()){if(!(Math.abs(t.constant)<n.Epsilon))throw new Error("unsatisfiable constraint");i=r.marker}if(i.isInvalid()){if(!this.addWithArtificialVariable(t))throw new Error("unsatisfiable constraint")}else t.setSymbol(i),t.solveFor(i),this.substitute(i,t),this.rows.set(i,t);this.constraints.set(e,r),this.optimize(this.objective),this.didAddConstraint(e),this.updateSolution()},e.prototype.willAddConstraint=function(e){},e.prototype.didAddConstraint=function(e){},e.prototype.removeConstraint=function(e){if(void 0!==this.constraints.get(e)){this.removeConstraintRow(e);for(var t=e.expression.terms,r=0,n=t.size;r<n;r+=1){t.getEntry(r)[0].removeConstraintCondition(e,this)}}},e.prototype.removeConstraintRow=function(e){var t=this.constraints.get(e);if(void 0!==t){this.willRemoveConstraint(e),this.constraints.remove(e),this.removeConstraintEffects(e,t);var r=t.marker;if(void 0===this.rows.remove(r)){var n=this.getMarkerLeavingSymbol(r);if(n.isInvalid())throw new Error("failed to find leaving row");var i=this.rows.remove(n);i.solveForEx(n,r),this.substitute(r,i)}this.optimize(this.objective),this.didRemoveConstraint(e),this.updateSolution()}},e.prototype.willRemoveConstraint=function(e){},e.prototype.didRemoveConstraint=function(e){},e.prototype.constraintVariable=function(e,t,r){return void 0===t&&(t=0),r=void 0===r?Ht.Strong:Ht.fromAny(r),new Wt(this,e,t,r)},e.prototype.hasConstraintVariable=function(e){return this.constraintVariables.has(e)},e.prototype.addConstraintVariable=function(e){if(!this.constraintVariables.has(e)){var t=Ht.clip(e.strength);if(t===Ht.Required)throw new Error("invalid variable strength");this.willAddConstraintVariable(e);var r=new Xt(this,e,"eq",t),n=this.createRow(r),i=n.row,o=n.tag;this.constraintVariables.set(e,{constraint:r,tag:o,state:0}),this.addConstraintRow(r,i,o),this.didAddConstraintVariable(e)}},e.prototype.willAddConstraintVariable=function(e){},e.prototype.didAddConstraintVariable=function(e){},e.prototype.removeConstraintVariable=function(e){var t=this.constraintVariables.get(e);void 0!==t&&(this.willRemoveConstraintVariable(e),this.constraintVariables.remove(e),this.removeConstraintRow(t.constraint),this.didRemoveConstraintVariable(e))},e.prototype.willRemoveConstraintVariable=function(e){},e.prototype.didRemoveConstraintVariable=function(e){},e.prototype.setConstraintVariable=function(e,t){var r=this.constraintVariables.get(e);if(void 0===r)throw new Error("unbound variable");var n=r.state;if(n!==t){r.state=t;var i=t-n;this.willSetConstraintVariable(e,t,n);var o=r.tag.marker,u=this.rows.get(o);if(void 0!==u)return u.add(-i)<0&&this.infeasible.push(o),void this.dualOptimize();var s=r.tag.other;if(void 0!==(u=this.rows.get(s)))return u.add(i)<0&&this.infeasible.push(s),void this.dualOptimize();for(var a=0,p=this.rows.size;a<p;a+=1){var f=this.rows.getEntry(a),c=f[0],l=f[1],h=l.coefficientFor(o);0!==h&&l.add(i*h)<0&&!c.isExternal()&&this.infeasible.push(c)}this.dualOptimize(),this.didSetConstraintVariable(e,t,n),this.updateSolution()}},e.prototype.willSetConstraintVariable=function(e,t,r){},e.prototype.didSetConstraintVariable=function(e,t,r){},e.prototype.invalidate=function(e,t){void 0===t&&(t=null),e.isExternal()&&this.invalidated.set(e,t)},e.prototype.updateSolution=function(){var e=this.invalidated;if(!e.isEmpty()){Object.defineProperty(this,"invalidated",{value:new Tt,enumerable:!0,configurable:!0});for(var t=0,r=e.size;t<r;t+=1){var n=e.getEntry(t)[0],i=this.rows.get(n);void 0!==i&&n.updateConstraintSolution(i.constant)}}},e.prototype.createRow=function(e){for(var t=e.expression,r=new Gt(this,null,new Tt,t.constant),i=t.terms,o=0,u=i.size;o<u;o+=1){var s=i.getEntry(o),a=s[0],p=s[1];if(Math.abs(p)>=n.Epsilon){var f=this.rows.get(a);void 0!==f?r.insertRow(f,p):r.insertSymbol(a,p)}}var c=this.objective,l=e.relation,h=e.strength,d={marker:Vt.invalid,other:Vt.invalid};if("le"===l||"ge"===l){p="le"===l?1:-1;var y=new qt;if(d.marker=y,r.insertSymbol(y,p),h<Ht.Required){var v=new Ut;d.other=v,r.insertSymbol(v,-p),c.insertSymbol(v,h)}}else if(h<Ht.Required){var b=new Ut,m=new Ut;d.marker=b,d.other=m,r.insertSymbol(b,-1),r.insertSymbol(m,1),c.insertSymbol(b,h),c.insertSymbol(m,h)}else{var g=new Rt;d.marker=g,r.insertSymbol(g)}return r.constant<0&&r.negate(),{row:r,tag:d}},e.prototype.chooseSubject=function(e,t){for(var r=0,n=e.cells.size;r<n;r+=1){var i=e.cells.getEntry(r)[0];if(i.isExternal())return i}return(t.marker instanceof qt||t.marker instanceof Ut)&&e.coefficientFor(t.marker)<0?t.marker:(t.other instanceof qt||t.other instanceof Ut)&&e.coefficientFor(t.other)<0?t.other:Vt.invalid},e.prototype.addWithArtificialVariable=function(e){var t=new qt;this.rows.set(t,e.clone()),Object.defineProperty(this,"artificial",{value:e.clone(),enumerable:!0,configurable:!0}),this.optimize(this.artificial);var r=Math.abs(this.artificial.constant)<n.Epsilon;Object.defineProperty(this,"artificial",{value:null,enumerable:!0,configurable:!0});var i=this.rows.remove(t);if(void 0!==i){if(i.isConstant())return r;var o=this.anyPivotableSymbol(i);if(o.isInvalid())return!1;i.setSymbol(o),i.solveForEx(t,o),this.substitute(o,i),this.rows.set(o,i)}for(var u=0,s=this.rows.size;u<s;u+=1)this.rows.getEntry(u)[1].removeSymbol(t);return this.objective.removeSymbol(t),r},e.prototype.substitute=function(e,t){for(var r=0,n=this.rows.size;r<n;r+=1){var i=this.rows.getEntry(r),o=i[0],u=i[1];u.substitute(e,t),u.constant<0&&!o.isExternal()&&this.infeasible.push(o)}this.objective.substitute(e,t),null!==this.artificial&&this.artificial.substitute(e,t)},e.prototype.optimize=function(e){for(;;){var t=this.getEnteringSymbol(e);if(t.isInvalid())return;var r=this.getLeavingSymbol(t);if(r.isInvalid())throw new Error("objective is unbounded");var n=this.rows.remove(r);n.setSymbol(t),n.solveForEx(r,t),this.substitute(t,n),this.rows.set(t,n)}},e.prototype.dualOptimize=function(){for(var e;void 0!==(e=this.infeasible.pop());){var t=this.rows.get(e);if(void 0!==t&&t.constant<0){var r=this.getDualEnteringSymbol(t);if(r.isInvalid())throw new Error("dual optimize failed");this.rows.remove(e),t.setSymbol(r),t.solveForEx(e,r),this.substitute(r,t),this.rows.set(r,t)}}},e.prototype.getEnteringSymbol=function(e){for(var t=0,r=e.cells.size;t<r;t+=1){var n=e.cells.getEntry(t),i=n[0];if(n[1]<0&&!i.isDummy())return i}return Vt.invalid},e.prototype.getDualEnteringSymbol=function(e){for(var t=Number.MAX_VALUE,r=Vt.invalid,n=0,i=e.cells.size;n<i;n+=1){var o=e.cells.getEntry(n),u=o[0],s=o[1];if(s>0&&!u.isDummy()){var a=this.objective.coefficientFor(u)/s;a<t&&(t=a,r=u)}}return r},e.prototype.getLeavingSymbol=function(e){for(var t=Number.MAX_VALUE,r=Vt.invalid,n=0,i=this.rows.size;n<i;n+=1){var o=this.rows.getEntry(n),u=o[0],s=o[1];if(!u.isExternal()){var a=s.coefficientFor(e);if(a<0){var p=-s.constant/a;p<t&&(t=p,r=u)}}}return r},e.prototype.getMarkerLeavingSymbol=function(e){for(var t=Number.MAX_VALUE,r=Number.MAX_VALUE,n=Vt.invalid,i=Vt.invalid,o=Vt.invalid,u=0,s=this.rows.size;u<s;u+=1){var a=this.rows.getEntry(u),p=a[0],f=a[1],c=f.coefficientFor(e);if(0!==c)if(p.isExternal())o=p;else if(c<0){(l=-f.constant/c)<t&&(t=l,n=p)}else{var l;(l=f.constant/c)<r&&(r=l,i=p)}}return n.isInvalid()?i.isInvalid()?o:i:n},e.prototype.removeConstraintEffects=function(e,t){t.marker instanceof Ut&&this.removeMarkerEffects(t.marker,e.strength),t.other instanceof Ut&&this.removeMarkerEffects(t.other,e.strength)},e.prototype.removeMarkerEffects=function(e,t){var r=this.rows.get(e);void 0!==r?this.objective.insertRow(r,-t):this.objective.insertSymbol(e,-t)},e.prototype.anyPivotableSymbol=function(e){for(var t=0,r=e.cells.size;t<r;t+=1){var n=e.cells.getEntry(t)[0];if(n instanceof qt||n instanceof Ut)return n}return Vt.invalid},e}(),Qt=function(){function e(){}return e.prototype.updated=function(e,t){var r=or.create(2);return r.push(this),r.set(e,t),r},e.prototype.updatedAttr=function(e,t){var r=or.create(2);return r.push(this),r.setAttr(e,t),r},e.prototype.updatedSlot=function(e,t){var r=or.create(2);return r.push(this),r.setSlot(e,t),r},e.prototype.appended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=or.create(1+arguments.length);return r.push(this),r.push.apply(r,e),r},e.prototype.prepended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=or.create(arguments.length+1);return r.push.apply(r,e),r.push(this),r},e.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=or.create();n.push(this);for(var i=0,o=t.length;i<o;i+=1)e.fromAny(t[i]).forEach((function(e){n.push(e)}));return n},e.prototype.lt=function(t){return t=e.fromAny(t),this.compareTo(t)<0?br.from(!0):e.absent()},e.prototype.le=function(t){return t=e.fromAny(t),this.compareTo(t)<=0?br.from(!0):e.absent()},e.prototype.eq=function(t){return t=e.fromAny(t),this.equals(t)?br.from(!0):e.absent()},e.prototype.ne=function(t){return t=e.fromAny(t),this.equals(t)?e.absent():br.from(!0)},e.prototype.ge=function(t){return t=e.fromAny(t),this.compareTo(t)>=0?br.from(!0):e.absent()},e.prototype.gt=function(t){return t=e.fromAny(t),this.compareTo(t)>0?br.from(!0):e.absent()},e.prototype.invoke=function(t){return e.absent()},e.prototype.filter=function(e){var t=$r.literal(this);return 0===arguments.length?t.filter():t.filter(e)},e.prototype.max=function(e){return this.compareTo(e)>=0?this:e},e.prototype.min=function(e){return this.compareTo(e)<=0?this:e},e.prototype.evaluate=function(e){return this},e.prototype.substitute=function(e){return this},e.prototype.cast=function(e,t){var r=e.cast(this);return void 0===r&&(r=t),r},e.prototype.coerce=function(e,t){var r=e.cast(this);return void 0===r&&(r=e.unit),void 0===r&&(r=t),r},Object.defineProperty(e.prototype,"precedence",{get:function(){return 11},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e,t){return e.call(t,this,0)},e.prototype.iterator=function(){return k.unary(this)},e.prototype.interpolateTo=function(t){return t instanceof e?Zt(this,t):null},e.prototype.display=function(e){return this.debug(e)},e.prototype.toString=function(){return ne.debug(this)},e.empty=function(){return or.empty()},e.extant=function(){return mr.extant()},e.absent=function(){return gr.absent()},e.fromAny=function(t){return t instanceof e?t:ir.fromAny(t)},e.globalScope=function(){return or.create(1).slot("math",dn.scope).commit()},E([s],e,"globalScope",null),e}(),Zt=function(e,t){var r=function(e){return e<1?r[0]:r[1]};return Object.setPrototypeOf(r,Zt.prototype),Object.defineProperty(r,0,{value:e.commit(),enumerable:!0}),Object.defineProperty(r,1,{value:t.commit(),enumerable:!0}),r};Zt.prototype=Object.create($e.prototype);var Jt=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isDefined=function(){return!0},t.prototype.isDistinct=function(){return!0},t.prototype.isDefinite=function(){return!0},t.prototype.toValue=function(){return this.value},Object.defineProperty(t.prototype,"tag",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.value},enumerable:!1,configurable:!0}),t.prototype.flattened=function(){return ir.absent()},t.prototype.unflattened=function(){return or.of(this)},t.prototype.header=function(e){return ir.absent()},t.prototype.headers=function(e){},t.prototype.head=function(){return Qt.absent()},t.prototype.tail=function(){return or.empty()},t.prototype.body=function(){return ir.absent()},Object.defineProperty(t.prototype,"length",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){return ir.absent()},t.prototype.getAttr=function(e){return ir.absent()},t.prototype.getSlot=function(e){return ir.absent()},t.prototype.getField=function(e){},t.prototype.getItem=function(e){return Qt.absent()},t.prototype.deleted=function(e){return this},t.prototype.conditional=function(e,t){return e=Qt.fromAny(e)},t.prototype.or=function(e){return this},t.prototype.and=function(e){return e=Qt.fromAny(e)},t.prototype.lambda=function(e){return ir.absent()},t.prototype.stringValue=function(e){return this.value.stringValue(e)},t.prototype.numberValue=function(e){return this.value.numberValue(e)},t.prototype.booleanValue=function(e){return this.value.booleanValue(e)},t.prototype.interpolateTo=function(r){return r instanceof t?er(this,r):e.prototype.interpolateTo.call(this,r)},t.of=function(e,t){var r;return"string"==typeof e?r=e:e instanceof hr&&(r=e.value),void 0!==r&&64===r.charCodeAt(0)?(r=r.slice(1),1===arguments.length?tr.of(r):tr.of(r,t)):1===arguments.length?$t.of(e):$t.of(e,t)},t.fromAny=function(e){if(e instanceof t)return e;if("object"==typeof e&&null!==e){if(void 0!==e.$key)return t.of(e.$key,e.$value);for(var r in e)return t.of(r,e[r])}throw new TypeError(""+e)},t.ImmutableFlag=1,t}(Qt),$t=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"key",{value:t.commit(),enumerable:!0}),Object.defineProperty(i,"value",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(i,"flags",{value:void 0!==n?n:0,enumerable:!0,configurable:!0}),i}return C(t,e),t.prototype.isConstant=function(){return this.key.isConstant()&&this.value.isConstant()},t.prototype.setValue=function(e){if(0!=(this.flags&Jt.ImmutableFlag))throw new Error("immutable");var t=this.value;return Object.defineProperty(this,"value",{value:e,enumerable:!0,configurable:!0}),t},t.prototype.updatedValue=function(e){return new t(this.key,e)},t.prototype.bitwiseOr=function(e){return(e=Qt.fromAny(e))instanceof wr?new Tr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.bitwiseOr(e.value):e instanceof ir?this.value.bitwiseOr(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.bitwiseXor=function(e){return(e=Qt.fromAny(e))instanceof wr?new Vr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.bitwiseXor(e.value):e instanceof ir?this.value.bitwiseXor(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.bitwiseAnd=function(e){return(e=Qt.fromAny(e))instanceof wr?new qr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.bitwiseAnd(e.value):e instanceof ir?this.value.bitwiseAnd(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.plus=function(e){return(e=Qt.fromAny(e))instanceof wr?new Kr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.plus(e.value):e instanceof ir?this.value.plus(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.minus=function(e){return(e=Qt.fromAny(e))instanceof wr?new Br(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.minus(e.value):e instanceof ir?this.value.minus(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.times=function(e){return(e=Qt.fromAny(e))instanceof wr?new Wr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.times(e.value):e instanceof ir?this.value.times(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.divide=function(e){return(e=Qt.fromAny(e))instanceof wr?new Hr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.divide(e.value):e instanceof ir?this.value.divide(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.modulo=function(e){return(e=Qt.fromAny(e))instanceof wr?new Xr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.modulo(e.value):e instanceof ir?this.value.modulo(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.not=function(){var e=this.value.not();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.bitwiseNot=function(){var e=this.value.bitwiseNot();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.negative=function(){var e=this.value.negative();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.positive=function(){var e=this.value.positive();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.inverse=function(){var e=this.value.inverse();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.evaluate=function(e){e=Ar.fromAny(e);var r=this.key.evaluate(e).toValue(),n=this.value.evaluate(e).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?new t(r,n):Qt.absent()},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.key.substitute(e).toValue(),n=this.value.substitute(e).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?new t(r,n):Qt.absent()},t.prototype.toAny=function(){var e={};return this.key instanceof hr?e[this.key.value]=this.value.toAny():(e.$key=this.key.toAny(),e.$value=this.value.toAny()),e},t.prototype.isAliased=function(){return!1},t.prototype.isMutable=function(){return 0==(this.flags&Jt.ImmutableFlag)},t.prototype.alias=function(){0==(this.flags&Jt.ImmutableFlag)&&(Object.defineProperty(this,"flags",{value:this.flags|Jt.ImmutableFlag,enumerable:!0,configurable:!0}),Object.defineProperty(this,"value",{value:this.value,enumerable:!0}))},t.prototype.branch=function(){return 0!=(this.flags&Jt.ImmutableFlag)?new t(this.key,this.value,this.flags&~Jt.ImmutableFlag):this},t.prototype.clone=function(){return new t(this.key.clone(),this.value.clone())},t.prototype.commit=function(){return 0==(this.flags&Jt.ImmutableFlag)&&(Object.defineProperty(this,"flags",{value:this.flags|Jt.ImmutableFlag,enumerable:!0,configurable:!0}),Object.defineProperty(this,"value",{value:this.value,enumerable:!0})),this.value.commit(),this},t.prototype.interpolateTo=function(r){return r instanceof t?nr(this,r):e.prototype.interpolateTo.call(this,r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 2},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.key.compareTo(e.key);return 0===r&&(r=this.value.compareTo(e.value)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.key.equals(e.key)&&this.value.equivalentTo(e.value,r))},t.prototype.keyEquals=function(e){return"string"==typeof e&&this.key instanceof hr?this.key.value===e:e instanceof Jt?this.key.equals(e.key):this.key.equals(e)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.key.equals(e.key)&&this.value.equals(e.value))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.key.hashCode()),this.value.hashCode()))},t.prototype.debug=function(e){return e=e.write("Slot").write(46).write("of").write(40).display(this.key),this.value instanceof mr||(e=e.write(44).write(32).display(this.value)),e=e.write(41)},t.of=function(e,r){return new t(e=ir.fromAny(e),r=1===arguments.length?ir.extant():ir.fromAny(r))},t}(Jt),er=function(e,t){var r=function(e){var t=r.keyInterpolator(e),n=r.valueInterpolator(e);return $t.of(t,n)};return Object.setPrototypeOf(r,er.prototype),Object.defineProperty(r,"keyInterpolator",{value:e.key.interpolateTo(t.key),enumerable:!0}),Object.defineProperty(r,"valueInterpolator",{value:e.value.interpolateTo(t.value),enumerable:!0}),r};er.prototype=Object.create($e.prototype),Object.defineProperty(er.prototype,0,{get:function(){return $t.of(this.keyInterpolator[0],this.valueInterpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(er.prototype,1,{get:function(){return $t.of(this.keyInterpolator[1],this.valueInterpolator[1])},enumerable:!0,configurable:!0}),er.prototype.equals=function(e){return this===e||e instanceof er&&(this.keyInterpolator.equals(e.keyInterpolator)&&this.valueInterpolator.equals(e.valueInterpolator))};var tr=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"key",{value:t,enumerable:!0}),Object.defineProperty(i,"value",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(i,"flags",{value:void 0!==n?n:0,enumerable:!0,configurable:!0}),i}return C(t,e),t.prototype.isConstant=function(){return this.key.isConstant()&&this.value.isConstant()},Object.defineProperty(t.prototype,"name",{get:function(){return this.key.value},enumerable:!1,configurable:!0}),t.prototype.setValue=function(e){if(0!=(this.flags&Jt.ImmutableFlag))throw new Error("immutable");var t=this.value;return Object.defineProperty(this,"value",{value:e,enumerable:!0,configurable:!0}),t},t.prototype.updatedValue=function(e){return new t(this.key,e)},t.prototype.bitwiseOr=function(e){return(e=Qt.fromAny(e))instanceof wr?new Tr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.bitwiseOr(e.value):e instanceof ir?this.value.bitwiseOr(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.bitwiseXor=function(e){return(e=Qt.fromAny(e))instanceof wr?new Vr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.bitwiseXor(e.value):e instanceof ir?this.value.bitwiseXor(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.bitwiseAnd=function(e){return(e=Qt.fromAny(e))instanceof wr?new qr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.bitwiseAnd(e.value):e instanceof ir?this.value.bitwiseAnd(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.plus=function(e){return(e=Qt.fromAny(e))instanceof wr?new Kr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.plus(e.value):e instanceof ir?this.value.plus(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.minus=function(e){return(e=Qt.fromAny(e))instanceof wr?new Br(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.minus(e.value):e instanceof ir?this.value.minus(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.times=function(e){return(e=Qt.fromAny(e))instanceof wr?new Wr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.times(e.value):e instanceof ir?this.value.times(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.divide=function(e){return(e=Qt.fromAny(e))instanceof wr?new Hr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.divide(e.value):e instanceof ir?this.value.divide(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.modulo=function(e){return(e=Qt.fromAny(e))instanceof wr?new Xr(this,e):(r=e instanceof t&&this.key.equals(e.key)?this.value.modulo(e.value):e instanceof ir?this.value.modulo(e):ir.absent()).isDefined()?new t(this.key,r):Qt.absent();var r},t.prototype.not=function(){var e=this.value.not();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.bitwiseNot=function(){var e=this.value.bitwiseNot();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.negative=function(){var e=this.value.negative();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.positive=function(){var e=this.value.positive();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.inverse=function(){var e=this.value.inverse();return e.isDefined()?new t(this.key,e):Qt.absent()},t.prototype.evaluate=function(e){e=Ar.fromAny(e);var r=this.key.evaluate(e).toValue(),n=this.value.evaluate(e).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?r instanceof hr?new t(r,n):new $t(r,n):Qt.absent()},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.key.substitute(e).toValue(),n=this.value.substitute(e).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?r instanceof hr?new t(r,n):new $t(r,n):Qt.absent()},t.prototype.toAny=function(){var e={};return e["@"+this.key.value]=this.value.toAny(),e},t.prototype.isAliased=function(){return!1},t.prototype.isMutable=function(){return 0==(this.flags&Jt.ImmutableFlag)},t.prototype.alias=function(){0==(this.flags&Jt.ImmutableFlag)&&(Object.defineProperty(this,"flags",{value:this.flags|Jt.ImmutableFlag,enumerable:!0,configurable:!0}),Object.defineProperty(this,"value",{value:this.value,enumerable:!0}))},t.prototype.branch=function(){return 0!=(this.flags&Jt.ImmutableFlag)?new t(this.key,this.value,this.flags&~Jt.ImmutableFlag):this},t.prototype.clone=function(){return new t(this.key.clone(),this.value.clone())},t.prototype.commit=function(){return 0==(this.flags&Jt.ImmutableFlag)&&(Object.defineProperty(this,"flags",{value:this.flags|Jt.ImmutableFlag,enumerable:!0,configurable:!0}),Object.defineProperty(this,"value",{value:this.value,enumerable:!0})),this.value.commit(),this},t.prototype.interpolateTo=function(r){return r instanceof t?rr(this,r):e.prototype.interpolateTo.call(this,r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 1},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.key.compareTo(e.key);return 0===r&&(r=this.value.compareTo(e.value)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.key.equals(e.key)&&this.value.equivalentTo(e.value,r))},t.prototype.keyEquals=function(e){return"string"==typeof e?this.key.value===e:e instanceof Jt?this.key.equals(e.key):this.key.equals(e)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.key.equals(e.key)&&this.value.equals(e.value))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.key.hashCode()),this.value.hashCode()))},t.prototype.debug=function(e){return e=e.write("Attr").write(46).write("of").write(40).display(this.key),this.value instanceof mr||(e=e.write(44).write(32).display(this.value)),e=e.write(41)},t.of=function(e,r){return new t(e=hr.fromAny(e),r=1===arguments.length?ir.extant():ir.fromAny(r))},t}(Jt),rr=function(e,t){var r=function(e){var t=r.keyInterpolator(e),n=r.valueInterpolator(e);return tr.of(t,n)};return Object.setPrototypeOf(r,rr.prototype),Object.defineProperty(r,"keyInterpolator",{value:e.key.interpolateTo(t.key),enumerable:!0}),Object.defineProperty(r,"valueInterpolator",{value:e.value.interpolateTo(t.value),enumerable:!0}),r};rr.prototype=Object.create($e.prototype),Object.defineProperty(rr.prototype,0,{get:function(){return tr.of(this.keyInterpolator[0],this.valueInterpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(rr.prototype,1,{get:function(){return tr.of(this.keyInterpolator[1],this.valueInterpolator[1])},enumerable:!0,configurable:!0}),rr.prototype.equals=function(e){return this===e||e instanceof rr&&(this.keyInterpolator.equals(e.keyInterpolator)&&this.valueInterpolator.equals(e.valueInterpolator))};var nr=function(e,t){var r=function(e){var t=r.keyInterpolator(e),n=r.valueInterpolator(e);return $t.of(t,n)};return Object.setPrototypeOf(r,nr.prototype),Object.defineProperty(r,"keyInterpolator",{value:e.key.interpolateTo(t.key),enumerable:!0}),Object.defineProperty(r,"valueInterpolator",{value:e.value.interpolateTo(t.value),enumerable:!0}),r};nr.prototype=Object.create($e.prototype),Object.defineProperty(nr.prototype,0,{get:function(){return $t.of(this.keyInterpolator[0],this.valueInterpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,1,{get:function(){return $t.of(this.keyInterpolator[1],this.valueInterpolator[1])},enumerable:!0,configurable:!0}),nr.prototype.equals=function(e){return this===e||e instanceof nr&&(this.keyInterpolator.equals(e.keyInterpolator)&&this.valueInterpolator.equals(e.valueInterpolator))};var ir=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isDefined=function(){return!0},t.prototype.isDistinct=function(){return!0},t.prototype.isDefinite=function(){return!0},Object.defineProperty(t.prototype,"key",{get:function(){return t.absent()},enumerable:!1,configurable:!0}),t.prototype.toValue=function(){return this},Object.defineProperty(t.prototype,"tag",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this},enumerable:!1,configurable:!0}),t.prototype.flattened=function(){return this},t.prototype.unflattened=function(){return or.of(this)},t.prototype.header=function(e){return t.absent()},t.prototype.headers=function(e){},t.prototype.head=function(){return Qt.absent()},t.prototype.tail=function(){return or.empty()},t.prototype.body=function(){return t.extant()},Object.defineProperty(t.prototype,"length",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){return t.absent()},t.prototype.getAttr=function(e){return t.absent()},t.prototype.getSlot=function(e){return t.absent()},t.prototype.getField=function(e){},t.prototype.getItem=function(e){return Qt.absent()},t.prototype.deleted=function(e){return this},t.prototype.conditional=function(e,t){return e=Qt.fromAny(e)},t.prototype.or=function(e){return this},t.prototype.and=function(e){return e=Qt.fromAny(e)},t.prototype.bitwiseOr=function(e){if((e=Qt.fromAny(e))instanceof wr)return new Tr(this,e);if(e instanceof tr){if((t=this.bitwiseOr(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.bitwiseOr(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.bitwiseXor=function(e){if((e=Qt.fromAny(e))instanceof wr)return new Vr(this,e);if(e instanceof tr){if((t=this.bitwiseXor(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.bitwiseXor(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.bitwiseAnd=function(e){if((e=Qt.fromAny(e))instanceof wr)return new qr(this,e);if(e instanceof tr){if((t=this.bitwiseAnd(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.bitwiseAnd(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.lt=function(t){return(t=Qt.fromAny(t))instanceof wr?new Rr(this,t):e.prototype.lt.call(this,t)},t.prototype.le=function(t){return(t=Qt.fromAny(t))instanceof wr?new Ur(this,t):e.prototype.le.call(this,t)},t.prototype.eq=function(t){return(t=Qt.fromAny(t))instanceof wr?new Nr(this,t):e.prototype.eq.call(this,t)},t.prototype.ne=function(t){return(t=Qt.fromAny(t))instanceof wr?new zr(this,t):e.prototype.ne.call(this,t)},t.prototype.ge=function(t){return(t=Qt.fromAny(t))instanceof wr?new Fr(this,t):e.prototype.ge.call(this,t)},t.prototype.gt=function(t){return(t=Qt.fromAny(t))instanceof wr?new Lr(this,t):e.prototype.gt.call(this,t)},t.prototype.plus=function(e){if((e=Qt.fromAny(e))instanceof wr)return new Kr(this,e);if(e instanceof tr){if((t=this.plus(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.plus(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.minus=function(e){if((e=Qt.fromAny(e))instanceof wr)return new Br(this,e);if(e instanceof tr){if((t=this.minus(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.minus(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.times=function(e){if((e=Qt.fromAny(e))instanceof wr)return new Wr(this,e);if(e instanceof tr){if((t=this.times(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.times(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.divide=function(e){if((e=Qt.fromAny(e))instanceof wr)return new Hr(this,e);if(e instanceof tr){if((t=this.divide(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.divide(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.modulo=function(e){if((e=Qt.fromAny(e))instanceof wr)return new Xr(this,e);if(e instanceof tr){if((t=this.modulo(e.value)).isDefined())return new tr(e.key,t)}else if(e instanceof $t){var t;if((t=this.modulo(e.value)).isDefined())return new $t(e.key,t)}return Qt.absent()},t.prototype.not=function(){return t.absent()},t.prototype.bitwiseNot=function(){return t.absent()},t.prototype.negative=function(){return t.absent()},t.prototype.positive=function(){return t.absent()},t.prototype.inverse=function(){return t.absent()},t.prototype.lambda=function(e){return new ln(this,e)},t.prototype.stringValue=function(e){return e},t.prototype.numberValue=function(e){return e},t.prototype.booleanValue=function(e){return e},t.prototype.isAliased=function(){return!1},t.prototype.isMutable=function(){return!1},t.prototype.alias=function(){},t.prototype.branch=function(){return this},t.prototype.clone=function(){return this},t.prototype.commit=function(){return this},t.prototype.interpolateTo=function(t){return e.prototype.interpolateTo.call(this,t)},t.prototype.keyEquals=function(e){return!1},t.builder=function(){return new ur},t.empty=function(){return or.empty()},t.extant=function(){return mr.extant()},t.absent=function(){return gr.absent()},t.fromAny=function(e){if(e instanceof t)return e;if(void 0===e)return gr.absent();if(null===e)return mr.extant();if("boolean"==typeof e)return br.from(e);if("number"==typeof e)return yr.from(e);if("string"==typeof e)return hr.from(e);if(e instanceof Uint8Array)return cr.wrap(e);if(Array.isArray(e))return or.fromArray(e);if("object"==typeof e)return or.fromObject(e);throw new TypeError(""+e)},t}(Qt),or=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isDefinite=function(){return!this.isEmpty()},t.prototype.isArray=function(){return 0===this.fieldCount},t.prototype.isObject=function(){return 0===this.valueCount},Object.defineProperty(t.prototype,"valueCount",{get:function(){var e=0;return this.forEach((function(t){t instanceof ir&&(e+=1)}),this),e},enumerable:!1,configurable:!0}),t.prototype.isConstant=function(){return void 0===this.forEach((function(e){return!!e.isConstant()&&void 0}),this)},Object.defineProperty(t.prototype,"tag",{get:function(){var e=this.head();if(e instanceof tr)return e.key.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e,r,n=!1;return this.forEach((function(i){i instanceof tr?n=!0:void 0===e&&i instanceof ir?e=i:(void 0===r&&(r=t.create(),void 0!==e&&r.push(e)),r.push(i))}),this),void 0===e?ir.extant():void 0===r?e:n?r:this},enumerable:!1,configurable:!0}),t.prototype.flattened=function(){if(this.isEmpty())return ir.extant();var e=this.iterator(),t=e.head();return e.step(),e.isEmpty()&&t instanceof ir?t:this.branch()},t.prototype.unflattened=function(){return this},t.prototype.header=function(e){var t=this.head();return t instanceof tr&&t.key.value===e?t.value:ir.absent()},t.prototype.headers=function(e){var r=this.head();if(r instanceof tr&&r.key.value===e){var n=r.value;return n instanceof t?n:t.of(n)}},t.prototype.head=function(){return this.forEach((function(e){return e}),this)||Qt.absent()},t.prototype.tail=function(){var e=t.create();return this.forEach((function(t,r){r>0&&e.push(t)}),this),e},t.prototype.body=function(){var e=this.tail();return e.isEmpty()?ir.absent():e.flattened()},t.prototype.has=function(e){return e=ir.fromAny(e),this.forEach((function(t){return!!(t instanceof Jt&&t.key.equals(e))||void 0}),this)||!1},t.prototype.indexOf=function(e,t){void 0===t&&(t=0),e=Qt.fromAny(e),t<0&&(t=Math.max(0,this.length+t));var r=this.forEach((function(r,n){return n>=t&&e.equals(r)?n:void 0}),this);return void 0!==r?r:-1},t.prototype.lastIndexOf=function(e,t){e=Qt.fromAny(e);var r=this.length;for(void 0===t?t=r-1:t<0&&(t=r+t),t=Math.min(t,r-1);t>=0;){if(e.equals(this.getItem(t)))return t;t-=1}return-1},t.prototype.get=function(e){return e=ir.fromAny(e),this.forEach((function(t){return t instanceof Jt&&t.key.equals(e)?t.value:void 0}),this)||ir.absent()},t.prototype.getAttr=function(e){return e=hr.fromAny(e),this.forEach((function(t){return t instanceof tr&&t.key.equals(e)?t.value:void 0}),this)||ir.absent()},t.prototype.getSlot=function(e){return e=ir.fromAny(e),this.forEach((function(t){return t instanceof $t&&t.key.equals(e)?t.value:void 0}),this)||ir.absent()},t.prototype.getField=function(e){return e=ir.fromAny(e),this.forEach((function(t){return t instanceof Jt&&t.key.equals(e)?t:void 0}),this)},t.prototype.set=function(e,t){e=ir.fromAny(e),t=ir.fromAny(t);for(var r=this.iterator();!r.isEmpty();){var n=r.head();if(n instanceof Jt&&n.key.equals(e))return n.isMutable()?n.setValue(t):r.set(n.updatedValue(t)),this;r.step()}return this.push(new $t(e,t)),this},t.prototype.setAttr=function(e,t){e=hr.fromAny(e),t=ir.fromAny(t);for(var r=this.iterator();!r.isEmpty();){var n=r.head();if(n instanceof Jt&&n.key.equals(e))return n instanceof tr&&n.isMutable()?n.setValue(t):r.set(new tr(e,t)),this;r.step()}return this.push(new tr(e,t)),this},t.prototype.setSlot=function(e,t){e=ir.fromAny(e),t=ir.fromAny(t);for(var r=this.iterator();!r.isEmpty();){var n=r.head();if(n instanceof Jt&&n.key.equals(e))return n instanceof $t&&n.isMutable()?n.setValue(t):r.set(new $t(e,t)),this;r.step()}return this.push(new $t(e,t)),this},t.prototype.updated=function(e,t){e=ir.fromAny(e),t=ir.fromAny(t);for(var r=this.isMutable()?this:this.branch(),n=r.iterator();!n.isEmpty();){var i=n.head();if(i.key.equals(e))return i instanceof Jt&&i.isMutable()?i.setValue(t):n.set(new $t(e,t)),r;n.step()}return r.push(new $t(e,t)),r},t.prototype.updatedAttr=function(e,t){e=hr.fromAny(e),t=ir.fromAny(t);for(var r=this.isMutable()?this:this.branch(),n=r.iterator();!n.isEmpty();){var i=n.head();if(i.key.equals(e))return i instanceof tr&&i.isMutable()?i.setValue(t):n.set(new tr(e,t)),r;n.step()}return r.push(new tr(e,t)),r},t.prototype.updatedSlot=function(e,t){e=ir.fromAny(e),t=ir.fromAny(t);for(var r=this.isMutable()?this:this.branch(),n=r.iterator();!n.isEmpty();){var i=n.head();if(i.key.equals(e))return i instanceof $t&&i.isMutable()?i.setValue(t):n.set(new $t(e,t)),r;n.step()}return r.push(new $t(e,t)),r},t.prototype.appended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.isMutable()?this:this.branch();return r.push.apply(r,e),r},t.prototype.prepended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.isMutable()?this:this.branch();return r.splice.apply(r,S([0,0],e,!1)),r},t.prototype.deleted=function(e){var t=this.isMutable()?this:this.branch();return t.delete(e),t},t.prototype.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this.isMutable()?this:this.branch(),n=0,i=e.length;n<i;n+=1)Qt.fromAny(e[n]).forEach((function(e){r.push(e)}));return r},t.prototype.slice=function(e,t){return this.subRecord(e,t).branch()},t.prototype.attr=function(e,t){var r;return r=1===arguments.length?tr.of(e):tr.of(e,t),this.push(r),this},t.prototype.slot=function(e,t){var r;return r=1===arguments.length?$t.of(e):$t.of(e,t),this.push(r),this},t.prototype.item=function(e){return this.push(e),this},t.prototype.items=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.push.apply(this,S([this],e,!1)),this},t.prototype.evaluate=function(e){e=Ar.fromAny(e);var r=t.create();e.pushScope(r);var n=!1;return this.forEach((function(t){var i=t.evaluate(e);i.isDefined()&&r.push(i),t!==i&&(n=!0)}),this),e.popScope(),n?r:this},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=t.create();e.pushScope(r);var n=!1;return this.forEach((function(t){var i=t.substitute(e);i.isDefined()&&r.push(i),t!==i&&(n=!0)}),this),e.popScope(),n?r:this},t.prototype.stringValue=function(e){var t="";return void 0===this.forEach((function(e){if(e instanceof ir){var r=e.stringValue();if(void 0!==r)return void(t+=r)}return null}),this)?t:void 0},t.prototype.toAny=function(){return!this.isEmpty()&&this.isArray()?this.toArray():this.toObject()},t.prototype.toArray=function(){var e=new Array(this.length);return this.forEach((function(t,r){t instanceof ir?e[r]=t.toAny():t instanceof Jt&&(e[r]={$key:t.key.toAny(),$value:t.value.toAny()})}),this),e},t.prototype.toObject=function(){var e={};return this.forEach((function(t,r){t instanceof tr?e["@"+t.key.value]=t.value.toAny():t instanceof $t?t.key instanceof hr?e[t.key.value]=t.value.toAny():e["$"+r]={$key:t.key.toAny(),$value:t.value.toAny()}:t instanceof ir&&(e["$"+r]=t.toAny())}),this),e},t.prototype.isAliased=function(){return!1},t.prototype.isMutable=function(){return!0},t.prototype.alias=function(){},t.prototype.branch=function(){var e=t.create();return this.forEach((function(t){e.push(t)}),this),e},t.prototype.clone=function(){var e=t.create();return this.forEach((function(t){e.push(t.clone())}),this),e},t.prototype.commit=function(){return this},t.prototype.bind=function(){return this},t.prototype.subRecord=function(e,r){var n=this.length;void 0===e?e=0:e<0&&(e=n+e),e=Math.min(Math.max(0,e),n),void 0===r?r=n:r<0&&(r=n+r);var i=t.create();return this.forEach((function(t,n){return n<e?void 0:n<r?void i.push(t):null}),this),i},t.prototype.iterator=function(){return new ar(this)},t.prototype.interpolateTo=function(r){return r instanceof t?sr(this,r):e.prototype.interpolateTo.call(this,r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 3},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.iterator(),n=e.iterator(),i=0;do{if(r.isEmpty()||n.isEmpty())break;i=r.head().compareTo(n.head()),r.step(),n.step()}while(0===i);return 0!==i?i:r.isEmpty()&&!n.isEmpty()?-1:!r.isEmpty()&&n.isEmpty()?1:0}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){if(this===e)return!0;if(e instanceof t){for(var n=this.iterator(),i=e.iterator();!n.isEmpty()&&!i.isEmpty();){if(!n.head().equivalentTo(i.head(),r))return!1;n.step(),i.step()}return n.isEmpty()&&i.isEmpty()}return!1},t.prototype.equals=function(e){if(this===e)return!0;if(e instanceof t){for(var r=this.iterator(),n=e.iterator();!r.isEmpty()&&!n.isEmpty();){if(!r.head().equals(n.head()))return!1;r.step(),n.step()}return r.isEmpty()&&n.isEmpty()}return!1},t.prototype.hashCode=function(){var e=w.hash(t);return this.forEach((function(t){e=c.mix(e,t.hashCode())}),this),e},t.prototype.debug=function(e){return e=e.write("Record").write(46),this.isEmpty()?e=e.write("empty").write(40).write(41):(e=e.write("of").write(40),this.forEach((function(t,r){0!==r&&(e=e.write(44).write(32)),e=e.display(t)}),this),e=e.write(41)),e},t.empty=function(){return pr.empty()},t.create=function(e){return pr.create(e)},t.of=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pr.of.apply(pr,e)},t.fromAny=function(e){if(e instanceof t)return e;if(Array.isArray(e))return t.fromArray(e);if("object"==typeof e&&null!==e)return t.fromObject(e);throw new TypeError(""+e)},t.fromArray=function(e){for(var r=e.length||0,n=t.create(r),i=0;i<r;i+=1)n.push(Qt.fromAny(e[i]));return n},t.fromObject=function(e){var r=t.create();for(var n in e){var i=e[n];36===n.charCodeAt(0)?i&&"object"==typeof i&&Object.prototype.hasOwnProperty.call(i,"$key")?r.push(Jt.of(i.$key,i.$value)):r.push(ir.fromAny(i)):r.push(Jt.of(n,i))}return r},t.expand=function(e){return e=Math.max(8,e)-1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1},t.AliasedFlag=1,t.ImmutableFlag=2,t}(ir);Object.defineProperty(or.prototype,"fieldCount",{get:function(){var e=0;return this.forEach((function(t){t instanceof Jt&&(e+=1)}),this),e},enumerable:!0,configurable:!0});var ur=function(){function e(){this.record=null,this.value=null}return e.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e.length;r<n;r+=1){var i=e[r];if(i instanceof Jt)return this.pushField(i);if(i instanceof ir)return this.pushValue(i);throw new TypeError(""+i)}},e.prototype.pushField=function(e){null===this.record&&(this.record=or.create(),null!==this.value&&(this.record.push(this.value),this.value=null)),this.record.push(e)},e.prototype.pushValue=function(e){null!==this.record?this.record.push(e):null===this.value?this.value=e:(this.record=or.create(),this.record.push(this.value),this.value=null,this.record.push(e))},e.prototype.bind=function(){return null!==this.record?this.record:null!==this.value?this.value:ir.absent()},e}(),sr=function(e,t){var r=function(e){for(var t=r.interpolators,n=t.length,i=or.create(n),o=0;o<n;o+=1)i.push(t[o](e));return i};Object.setPrototypeOf(r,sr.prototype);for(var n=Math.min(e.length,t.length),i=new Array(n),o=0;o<n;o+=1)i[o]=e.getItem(o).interpolateTo(t.getItem(o));return Object.defineProperty(r,"interpolators",{value:i,enumerable:!0}),r};sr.prototype=Object.create($e.prototype),Object.defineProperty(sr.prototype,0,{get:function(){for(var e=this.interpolators,t=e.length,r=or.create(t),n=0;n<t;n+=1)r.push(e[n][0]);return r},enumerable:!0,configurable:!0}),Object.defineProperty(sr.prototype,1,{get:function(){for(var e=this.interpolators,t=e.length,r=or.create(t),n=0;n<t;n+=1)r.push(e[n][1]);return r},enumerable:!0,configurable:!0}),sr.prototype.equals=function(e){if(this===e)return!0;if(e instanceof sr){var t=this.interpolators.length;if(t===e.interpolators.length){for(var r=0;r<t;r+=1)if(!this.interpolators[r].equals(e.interpolators[r]))return!1;return!0}}return!1};var ar=function(e){function t(t,r,n,i){var o=e.call(this)||this;return void 0===r&&(r=0),void 0===n&&(n=t.length),void 0===i&&(i=r),Object.defineProperty(o,"record",{value:t,enumerable:!0}),Object.defineProperty(o,"lower",{value:r,enumerable:!0}),Object.defineProperty(o,"upper",{value:n,enumerable:!0}),Object.defineProperty(o,"index",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(o,"direction",{value:0,enumerable:!0,configurable:!0}),o}return C(t,e),t.prototype.isEmpty=function(){return this.index>=this.upper},t.prototype.head=function(){if(Object.defineProperty(this,"direction",{value:0,enumerable:!0,configurable:!0}),this.index<this.upper)return this.record.getItem(this.index);throw new Error("empty")},t.prototype.step=function(){if(Object.defineProperty(this,"direction",{value:0,enumerable:!0,configurable:!0}),!(this.index<this.upper))throw new Error("empty");Object.defineProperty(this,"index",{value:this.index+1,enumerable:!0,configurable:!0})},t.prototype.skip=function(e){Object.defineProperty(this,"index",{value:Math.min(Math.max(this.lower,this.index+e,this.upper)),enumerable:!0,configurable:!0})},t.prototype.hasNext=function(){return this.index<this.upper},t.prototype.nextIndex=function(){return this.index-this.lower},t.prototype.next=function(){Object.defineProperty(this,"direction",{value:1,enumerable:!0,configurable:!0});var e=this.index;return e<this.upper?(Object.defineProperty(this,"index",{value:e+1,enumerable:!0,configurable:!0}),{value:this.record.getItem(e),done:this.index===this.upper}):(Object.defineProperty(this,"index",{value:this.upper,enumerable:!0,configurable:!0}),{done:!0})},t.prototype.hasPrevious=function(){return this.index>this.lower},t.prototype.previousIndex=function(){return this.index-this.lower-1},t.prototype.previous=function(){Object.defineProperty(this,"direction",{value:-1,enumerable:!0,configurable:!0});var e=this.index-1;return e>=this.lower?(Object.defineProperty(this,"index",{value:e,enumerable:!0,configurable:!0}),{value:this.record.getItem(e),done:e===this.lower}):(Object.defineProperty(this,"index",{value:0,enumerable:!0,configurable:!0}),{done:!0})},t.prototype.set=function(e){this.direction>0?this.record.setItem(this.index-1,e):this.record.setItem(this.index,e)},t.prototype.delete=function(){this.direction>0&&Object.defineProperty(this,"index",{value:this.index-1,enumerable:!0,configurable:!0}),this.record.splice(this.index,1),Object.defineProperty(this,"direction",{value:0,enumerable:!0,configurable:!0})},t}(k),pr=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return Object.defineProperty(u,"array",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(u,"table",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(u,"length",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(u,"fieldCount",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(u,"flags",{value:o,enumerable:!0,configurable:!0}),u}return C(t,e),t.prototype.isEmpty=function(){return 0===this.length},Object.defineProperty(t.prototype,"valueCount",{get:function(){return this.length-this.fieldCount},enumerable:!1,configurable:!0}),t.prototype.isConstant=function(){for(var e=this.array,t=0,r=this.length;t<r;t+=1)if(!e[t].isConstant())return!1;return!0},Object.defineProperty(t.prototype,"tag",{get:function(){if(this.fieldCount>0){var e=this.array[0];if(e instanceof tr)return e.key.value}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){for(var e,t,r=!1,n=this.array,i=0,o=this.length;i<o;i+=1){var u=n[i];u instanceof tr?r=!0:void 0===e&&u instanceof ir?e=u:(void 0===t&&(t=or.create(),void 0!==e&&t.push(e)),t.push(u))}return void 0===e?ir.extant():void 0===t?e:r?t:this},enumerable:!1,configurable:!0}),t.prototype.head=function(){return this.length>0?this.array[0]:Qt.absent()},t.prototype.tail=function(){var e=this.length;return e>0?new fr(this,1,e):or.empty()},t.prototype.body=function(){var e=this.length;if(e>2)return new fr(this,1,e).branch();if(2===e){var t=this.array[1];return t instanceof ir?t:or.of(t)}return ir.absent()},t.prototype.has=function(e){if(0!==this.fieldCount){e=ir.fromAny(e);var t=this.hashTable(),r=t.length,n=Math.abs(e.hashCode()%r),i=n;do{var o=t[i];if(void 0===o)break;if(o.key.equals(e))return!0;i=(i+1)%r}while(i!==n)}return!1},t.prototype.indexOf=function(e,t){void 0===t&&(t=0),e=Qt.fromAny(e);var r=this.array,n=this.length;for(t<0&&(t=Math.max(0,n+t));t<n;){if(e.equals(r[t]))return t;t+=1}return-1},t.prototype.lastIndexOf=function(e,t){e=Qt.fromAny(e);var r=this.array,n=this.length;for(void 0===t?t=n-1:t<0&&(t=n+t),t=Math.min(t,n-1);t>=0;){if(e.equals(r[t]))return t;t-=1}return-1},t.prototype.get=function(e){if(this.fieldCount>0){e=ir.fromAny(e);var t=this.hashTable(),r=t.length,n=Math.abs(e.hashCode()%r),i=n;do{var o=t[i];if(void 0===o)break;if(o.key.equals(e))return o.value;i=(i+1)%r}while(i!==n)}return ir.absent()},t.prototype.getAttr=function(e){if(this.fieldCount>0){e=hr.fromAny(e);var t=this.hashTable(),r=t.length,n=Math.abs(e.hashCode()%r),i=n;do{var o=t[i];if(void 0===o)break;if(o instanceof tr&&o.key.equals(e))return o.value;i=(i+1)%r}while(i!==n)}return ir.absent()},t.prototype.getSlot=function(e){if(this.fieldCount>0){e=ir.fromAny(e);var t=this.hashTable(),r=t.length,n=Math.abs(e.hashCode()%r),i=n;do{var o=t[i];if(void 0===o)break;if(o instanceof $t&&o.key.equals(e))return o.value;i=(i+1)%r}while(i!==n)}return ir.absent()},t.prototype.getField=function(e){if(this.fieldCount>0){e=ir.fromAny(e);var t=this.hashTable(),r=t.length,n=Math.abs(e.hashCode()%r),i=n;do{var o=t[i];if(void 0===o)break;if(o.key.equals(e))return o;i=(i+1)%r}while(i!==n)}},t.prototype.getItem=function(e){e instanceof yr&&(e=e.value);var t=this.length;return e<0&&(e=t+e),e>=0&&e<t?this.array[e]:Qt.absent()},t.prototype.set=function(e,t){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return e=ir.fromAny(e),t=ir.fromAny(t),0!=(this.flags&or.AliasedFlag)?this.fieldCount>0?this.setAliased(e,t):this.pushAliased(new $t(e,t)):this.fieldCount>0?null!==this.table?this.setMutable(e,t):this.updateMutable(e,t):this.pushMutable(new $t(e,t)),this},t.prototype.setAliased=function(e,t){for(var r=this.length,n=this.array,i=new Array(or.expand(r+1)),o=0;o<r;o+=1){var u=n[o];if(u instanceof Jt&&u.key.equals(e)){for(i[o]=u.updatedValue(t),o+=1;o<r;)i[o]=n[o],o+=1;return Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),void Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})}i[o]=u}i[r]=new $t(e,t),Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:r+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:this.fieldCount+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.setMutable=function(e,r){var n=this.table,i=n.length,o=Math.abs(e.hashCode()%i),u=o;do{var s=n[u];if(void 0===s)break;if(s.key.equals(e))return s.isMutable()?void s.setValue(r):void this.updateMutable(e,r);u=(u+1)%i}while(u!==o);var a=new $t(e,r);this.pushMutable(a),t.put(n,a)},t.prototype.updateMutable=function(e,r){for(var n=this.array,i=0,o=this.length;i<o;i+=1){var u=n[i];if(u instanceof Jt&&u.key.equals(e))return n[i]=u.updatedValue(r),void Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0})}var s=new $t(e,r);this.pushMutable(s),t.put(this.table,s)},t.prototype.setAttr=function(e,t){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return e=hr.fromAny(e),t=ir.fromAny(t),0!=(this.flags&or.AliasedFlag)?this.fieldCount>0?this.setAttrAliased(e,t):this.pushAliased(new tr(e,t)):this.fieldCount>0?null!==this.table?this.setAttrMutable(e,t):this.updateAttrMutable(e,t):this.pushMutable(new tr(e,t)),this},t.prototype.setAttrAliased=function(e,t){for(var r=this.length,n=this.array,i=new Array(or.expand(r+1)),o=0;o<r;o+=1){var u=n[o];if(u instanceof Jt&&u.key.equals(e)){for(i[o]=new tr(e,t),o+=1;o<r;)i[o]=n[o],o+=1;return Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),void Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})}i[o]=u}i[r]=new tr(e,t),Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:r+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:this.fieldCount+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.setAttrMutable=function(e,r){var n=this.table,i=n.length,o=Math.abs(e.hashCode()%i),u=o;do{var s=n[u];if(void 0===s)break;if(s.key.equals(e))return void(s instanceof tr&&s.isMutable()?s.setValue(r):this.updateAttrMutable(e,r));u=(u+1)%i}while(u!==o);var a=new tr(e,r);this.push(a),t.put(n,a)},t.prototype.updateAttrMutable=function(e,r){for(var n=this.array,i=0,o=this.length;i<o;i+=1){var u=n[i];if(u instanceof Jt&&u.key.equals(e))return n[i]=new tr(e,r),void Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0})}var s=new tr(e,r);this.push(s),t.put(this.table,s)},t.prototype.setSlot=function(e,t){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return e=ir.fromAny(e),t=ir.fromAny(t),0!=(this.flags&or.AliasedFlag)?this.fieldCount>0?this.setSlotAliased(e,t):this.pushAliased(new $t(e,t)):this.fieldCount>0?null!==this.table?this.setSlotMutable(e,t):this.updateSlotMutable(e,t):this.pushMutable(new $t(e,t)),this},t.prototype.setSlotAliased=function(e,t){for(var r=this.length,n=this.array,i=new Array(or.expand(r+1)),o=0;o<r;o+=1){var u=n[o];if(u instanceof Jt&&u.key.equals(e)){for(i[o]=new $t(e,t),o+=1;o<r;)i[o]=n[o],o+=1;return Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),void Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})}i[o]=u}i[r]=new $t(e,t),Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:r+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:this.fieldCount+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.setSlotMutable=function(e,r){var n=this.table,i=n.length,o=Math.abs(e.hashCode()%i),u=o;do{var s=n[u];if(void 0===s)break;if(s.key.equals(e))return void(s instanceof $t&&s.isMutable()?s.setValue(r):this.updateSlotMutable(e,r));u=(u+1)%i}while(u!==o);var a=new $t(e,r);this.push(a),t.put(n,a)},t.prototype.updateSlotMutable=function(e,r){for(var n=this.array,i=0,o=this.length;i<o;i+=1){var u=n[i];if(u instanceof Jt&&u.key.equals(e))return n[i]=new $t(e,r),void Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0})}var s=new $t(e,r);this.push(s),t.put(this.table,s)},t.prototype.setItem=function(e,t){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");t=Qt.fromAny(t);var r=this.length;if(e<0&&(e=r+e),e<0||e>r)throw new RangeError(""+e);return 0!=(this.flags&or.AliasedFlag)?this.setItemAliased(e,t):this.setItemMutable(e,t),this},t.prototype.setItemAliased=function(e,t){for(var r=this.length,n=this.array,i=new Array(or.expand(r)),o=0;o<r;o+=1)i[o]=n[o];var u=n[e];i[e]=t,Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),t instanceof Jt?u instanceof Jt||Object.defineProperty(this,"fieldCount",{value:this.fieldCount+1,enumerable:!0,configurable:!0}):u instanceof Jt&&Object.defineProperty(this,"fieldCount",{value:this.fieldCount-1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.setItemMutable=function(e,t){var r=this.array,n=r[e];r[e]=t,t instanceof Jt?(Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),n instanceof Jt||Object.defineProperty(this,"fieldCount",{value:this.fieldCount+1,enumerable:!0,configurable:!0})):n instanceof Jt&&(Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:this.fieldCount-1,enumerable:!0,configurable:!0}))},t.prototype.updated=function(e,t){e=ir.fromAny(e),t=ir.fromAny(t);var r=0==(this.flags&or.ImmutableFlag)?this:this.branch();return 0!=(r.flags&or.AliasedFlag)?r.fieldCount>0?r.setAliased(e,t):r.pushAliased(new $t(e,t)):r.fieldCount>0?null!==r.table?r.setMutable(e,t):r.updateMutable(e,t):r.pushMutable(new $t(e,t)),r},t.prototype.updatedAttr=function(e,t){e=hr.fromAny(e),t=ir.fromAny(t);var r=0==(this.flags&or.ImmutableFlag)?this:this.branch();return 0!=(r.flags&or.AliasedFlag)?r.fieldCount>0?r.setAttrAliased(e,t):r.pushAliased(new tr(e,t)):r.fieldCount>0?null!==r.table?r.setAttrMutable(e,t):r.updateAttrMutable(e,t):r.pushMutable(new tr(e,t)),r},t.prototype.updatedSlot=function(e,t){e=ir.fromAny(e),t=ir.fromAny(t);var r=0==(this.flags&or.ImmutableFlag)?this:this.branch();return 0!=(r.flags&or.AliasedFlag)?r.fieldCount>0?r.setSlotAliased(e,t):r.pushAliased(new $t(e,t)):r.fieldCount>0?null!==r.table?r.setSlotMutable(e,t):r.updateSlotMutable(e,t):r.pushMutable(new $t(e,t)),r},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return 0!=(this.flags&or.AliasedFlag)?this.pushAliased.apply(this,e):this.pushMutable.apply(this,e),this.length},t.prototype.pushAliased=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.length,n=this.length,i=this.fieldCount,o=this.array,u=new Array(or.expand(n+r));if(null!==o)for(var s=0;s<n;s+=1)u[s]=o[s];for(s=0;s<r;s+=1){var a=Qt.fromAny(e[s]);u[n]=a,n+=1,a instanceof Jt&&(i+=1)}Object.defineProperty(this,"array",{value:u,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.pushMutable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r,n=e.length,i=this.length,o=this.fieldCount,u=this.array;if(null===u||i+n>u.length){if(r=new Array(or.expand(i+n)),null!==u)for(var s=0;s<i;s+=1)r[s]=u[s]}else r=u;for(s=0;s<n;s+=1){var a=Qt.fromAny(e[s]);r[i]=a,i+=1,a instanceof Jt&&(o+=1,Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}))}Object.defineProperty(this,"array",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:o,enumerable:!0,configurable:!0})},t.prototype.splice=function(e,t){void 0===t&&(t=0);for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");var i=this.length;return e<0&&(e=i+e),e=Math.min(Math.max(0,e),i),t=Math.min(Math.max(0,t),i-e),0!=(this.flags&or.AliasedFlag)?this.spliceAliased.apply(this,S([e,t],r,!1)):this.spliceMutable.apply(this,S([e,t],r,!1))},t.prototype.spliceAliased=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];for(var i=r.length,o=this.length,u=this.fieldCount,s=this.array,a=new Array(or.expand(o-t+i)),p=0;p<e;p+=1)a[p]=s[p];var f=[];for(p=e;p<e+t;p+=1){var c=s[p];f.push(c),o-=1,c instanceof Jt&&(u-=1)}for(p=e;p<o;p+=1)a[p+i]=s[p+t];for(p=0;p<i;p+=1){var l=Qt.fromAny(r[p]);a[p+e]=l,o+=1,l instanceof Jt&&(u+=1)}return Object.defineProperty(this,"array",{value:a,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:u,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0}),f},t.prototype.spliceMutable=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i,o=r.length,u=this.length,s=this.fieldCount,a=this.array;if(null===a||u-t+o>a.length){if(i=new Array(or.expand(u-t+o)),null!==a)for(var p=0;p<e;p+=1)i[p]=a[p]}else i=a;var f=[];for(p=e;p<e+t;p+=1){var c=a[p];f.push(c),u-=1,c instanceof Jt&&(s-=1)}if(o>t)for(p=u-1;p>=e;p-=1)i[p+o]=a[p+t];else for(p=e;p<u;p+=1)i[p+o]=a[p+t];for(p=0;p<o;p+=1){var l=Qt.fromAny(r[p]);i[p+e]=l,u+=1,l instanceof Jt&&(s+=1)}return Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:u,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:s,enumerable:!0,configurable:!0}),f},t.prototype.delete=function(e){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return e=ir.fromAny(e),0!=(this.flags&or.AliasedFlag)?this.deleteAliased(e):this.deleteMutable(e)},t.prototype.deleteAliased=function(e){for(var t=this.length,r=this.array,n=new Array(or.expand(t)),i=0;i<t;i+=1){var o=r[i];if(o instanceof Jt&&o.key.equals(e)){for(var u=i+1;u<t;u+=1,i+=1)n[i]=r[u];return Object.defineProperty(this,"array",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:t-1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:this.fieldCount-1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~or.AliasedFlag,enumerable:!0,configurable:!0}),o}n[i]=o}return Qt.absent()},t.prototype.deleteMutable=function(e){for(var t=this.length,r=this.array,n=0;n<t;n+=1){var i=r[n];if(i instanceof Jt&&i.key.equals(e)){for(var o=n+1;o<t;o+=1,n+=1)r[n]=r[o];return r[t-1]=void 0,Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:t-1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:this.fieldCount-1,enumerable:!0,configurable:!0}),i}}return Qt.absent()},t.prototype.clear=function(){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");Object.defineProperty(this,"array",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"length",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"fieldCount",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:0,enumerable:!0,configurable:!0})},t.prototype.isAliased=function(){return 0!=(this.flags&or.AliasedFlag)},t.prototype.isMutable=function(){return 0==(this.flags&or.ImmutableFlag)},t.prototype.alias=function(){Object.defineProperty(this,"flags",{value:this.flags|or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.branch=function(){if(0==(this.flags&(or.AliasedFlag|or.ImmutableFlag)))for(var e=this.array,r=0,n=this.length;r<n;r+=1)e[r].alias();return Object.defineProperty(this,"flags",{value:this.flags|or.AliasedFlag,enumerable:!0,configurable:!0}),new t(this.array,this.table,this.length,this.fieldCount,or.AliasedFlag)},t.prototype.clone=function(){for(var e=this.length,r=this.array,n=new Array(e),i=0;i<e;i+=1)n[i]=r[i].clone();return new t(n,null,e,this.fieldCount,0)},t.prototype.commit=function(){if(0==(this.flags&or.ImmutableFlag)){Object.defineProperty(this,"flags",{value:this.flags|or.ImmutableFlag,enumerable:!0,configurable:!0});for(var e=this.array,t=0,r=this.length;t<r;t+=1)e[t].commit()}return this},t.prototype.hashTable=function(){var e=this.fieldCount,r=this.table;if(0!==e&&null===r){r=new Array(or.expand(Math.max(e,10*e/7)));for(var n=this.array,i=0,o=this.length;i<o;i+=1){var u=n[i];u instanceof Jt&&t.put(r,u)}Object.defineProperty(this,"table",{value:r,enumerable:!0,configurable:!0})}return r},t.put=function(e,t){if(null!==e){var r=e.length,n=Math.abs(t.key.hashCode()%r),i=n;do{var o=e[i];if(void 0===o)return void(e[i]=t);if(t.key.equals(o.key))return void(e[i]=t);i=(i+1)%r}while(i!==n);throw new Error}},t.prototype.evaluate=function(e){e=Ar.fromAny(e);var t=this.array,r=this.length,n=or.create(r);e.pushScope(n);for(var i=!1,o=0;o<r;o+=1){var u=t[o],s=u.evaluate(e);s.isDefined()&&n.push(s),u!==s&&(i=!0)}return e.popScope(),i?n:this},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.array,r=this.length,n=or.create(r);e.pushScope(n);for(var i=!1,o=0;o<r;o+=1){var u=t[o],s=u.substitute(e);s.isDefined()&&n.push(s),u!==s&&(i=!0)}return e.popScope(),i?n:this},t.prototype.subRecord=function(e,t){var r=this.length;if(void 0===e?e=0:e<0&&(e=r+e),void 0===t?t=r:t<0&&(t=r+t),e<0||t>r||e>t)throw new RangeError(e+", "+t);return new fr(this,e,t)},t.prototype.forEach=function(e,t){for(var r=this.array,n=0,i=this.length;n<i;n+=1){var o=e.call(t,r[n],n);if(void 0!==o)return o}},t.empty=function(){return new t(null,null,0,0,or.AliasedFlag|or.ImmutableFlag)},t.create=function(e){return void 0===e?new t(null,null,0,0,or.AliasedFlag):new t(new Array(e),null,0,0,0)},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e.length;if(0===n)return new t(null,null,0,0,or.AliasedFlag);for(var i=new Array(n),o=0,u=0,s=0;s<n;s+=1){var a=Qt.fromAny(e[s]);i[s]=a,o+=1,a instanceof Jt&&(u+=1)}return new t(i,null,o,u,0)},E([s],t,"empty",null),t}(or),fr=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"record",{value:t,enumerable:!0}),Object.defineProperty(i,"lower",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(i,"upper",{value:n,enumerable:!0,configurable:!0}),i}return C(t,e),t.prototype.isEmpty=function(){return this.lower===this.upper},t.prototype.isArray=function(){for(var e=this.record.array,t=this.lower,r=this.upper;t<r;t+=1)if(e[t]instanceof Jt)return!1;return!0},t.prototype.isObject=function(){for(var e=this.record.array,t=this.lower,r=this.upper;t<r;t+=1)if(e[t]instanceof ir)return!1;return!0},Object.defineProperty(t.prototype,"length",{get:function(){return this.upper-this.lower},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueCount",{get:function(){for(var e=0,t=this.record.array,r=this.lower,n=this.upper;r<n;r+=1)t[r]instanceof ir&&(e+=1);return e},enumerable:!1,configurable:!0}),t.prototype.isConstant=function(){for(var e=this.record.array,t=this.lower,r=this.upper;t<r;t+=1)if(!e[t].isConstant())return!1;return!0},Object.defineProperty(t.prototype,"tag",{get:function(){if(this.length>0){var e=this.record.array[this.lower];if(e instanceof tr)return e.key.value}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){for(var e,t,r=!1,n=this.record.array,i=this.lower,o=this.upper;i<o;i+=1){var u=n[i];u instanceof tr?r=!0:void 0===e&&u instanceof ir?e=u:(void 0===t&&(t=or.create(),void 0!==e&&t.push(e)),t.push(u))}return void 0===e?ir.extant():void 0===t?e:r?t:this},enumerable:!1,configurable:!0}),t.prototype.head=function(){return this.length>0?this.record.array[this.lower]:Qt.absent()},t.prototype.tail=function(){return this.length>0?new t(this.record,this.lower+1,this.upper):or.empty()},t.prototype.body=function(){var e=this.length;if(e>2)return new t(this.record,this.lower+1,this.upper).branch();if(2===e){var r=this.record.array[this.lower+1];return r instanceof ir?r:or.of(r)}return ir.absent()},t.prototype.indexOf=function(e,t){void 0===t&&(t=0),e=Qt.fromAny(e);var r=this.record.array,n=this.length;for(t<0&&(t=Math.max(0,n+t)),t=this.lower+t;t<this.upper;){if(e.equals(r[t]))return t-this.lower;t+=1}return-1},t.prototype.lastIndexOf=function(e,t){e=Qt.fromAny(e);var r=this.record.array,n=this.length;for(void 0===t?t=n-1:t<0&&(t=n+t),t=this.lower+Math.min(t,n-1);t>=this.lower;){if(e.equals(r[t]))return t-this.lower;t-=1}return-1},t.prototype.getItem=function(e){e instanceof yr&&(e=e.value);var t=this.length;return e<0&&(e=t+e),e>=0&&e<t?this.record.array[this.lower+e]:Qt.absent()},t.prototype.setItem=function(e,t){if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");t=Qt.fromAny(t);var r=this.length;if(e<0&&(e=r+e),e<0||e>r)throw new RangeError(""+e);return 0!=(this.record.flags&or.AliasedFlag)?this.setItemAliased(e,t):this.setItemMutable(e,t),this},t.prototype.setItemAliased=function(e,t){for(var r=this.record,n=r.length,i=r.array,o=new Array(or.expand(n)),u=0;u<n;u+=1)o[u]=i[u];var s=null!==i?i[this.lower+e]:null;o[this.lower+e]=t,Object.defineProperty(r,"array",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(r,"table",{value:null,enumerable:!0,configurable:!0}),t instanceof Jt?s instanceof Jt||Object.defineProperty(r,"fieldCount",{value:r.fieldCount+1,enumerable:!0,configurable:!0}):s instanceof Jt&&Object.defineProperty(r,"fieldCount",{value:r.fieldCount-1,enumerable:!0,configurable:!0}),Object.defineProperty(r,"flags",{value:r.flags&~or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.setItemMutable=function(e,t){var r=this.record,n=r.array,i=n[this.lower+e];n[this.lower+e]=t,t instanceof Jt?(Object.defineProperty(r,"table",{value:null,enumerable:!0,configurable:!0}),i instanceof Jt||Object.defineProperty(r,"fieldCount",{value:r.fieldCount+1,enumerable:!0,configurable:!0})):i instanceof Jt&&(Object.defineProperty(r,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(r,"fieldCount",{value:r.fieldCount-1,enumerable:!0,configurable:!0}))},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");return 0!=(this.record.flags&or.AliasedFlag)?this.pushAliased.apply(this,e):this.pushMutable.apply(this,e),this.length},t.prototype.pushAliased=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.record,n=e.length,i=r.length,o=r.fieldCount,u=r.array,s=new Array(or.expand(i+n));if(null!==u){for(var a=0;a<this.upper;a+=1)s[a]=u[a];for(a=this.upper;a<i;a+=1)s[a+n]=u[a]}for(a=0;a<n;a+=1){var p=Qt.fromAny(e[a]);s[a+this.upper]=p,i+=1,p instanceof Jt&&(o+=1)}Object.defineProperty(r,"array",{value:s,enumerable:!0,configurable:!0}),Object.defineProperty(r,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(r,"length",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(r,"fieldCount",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(r,"flags",{value:r.flags&~or.AliasedFlag,enumerable:!0,configurable:!0}),Object.defineProperty(this,"upper",{value:this.upper+n,enumerable:!0,configurable:!0})},t.prototype.pushMutable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r,n=this.record,i=e.length,o=n.length,u=n.fieldCount,s=n.array;if(null===s||o+i>s.length){if(r=new Array(or.expand(o+i)),null!==s)for(var a=0;a<this.upper;a+=1)r[a]=s[a]}else r=s;for(a=o-1;a>=this.upper;a-=1)r[a+i]=s[a];for(a=0;a<i;a+=1){var p=Qt.fromAny(e[a]);r[a+this.upper]=p,o+=1,p instanceof Jt&&(u+=1,Object.defineProperty(n,"table",{value:null,enumerable:!0,configurable:!0}))}Object.defineProperty(n,"array",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(n,"length",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(n,"fieldCount",{value:u,enumerable:!0,configurable:!0}),Object.defineProperty(this,"upper",{value:this.upper+i,enumerable:!0,configurable:!0})},t.prototype.splice=function(e,t){var r,n;void 0===t&&(t=0);for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");var u,s=this.length;return e<0&&(e=s+e),e=Math.min(Math.max(0,e),s),t=Math.min(Math.max(0,t),s-e),u=0!=(this.record.flags&or.AliasedFlag)?(r=this.record).spliceAliased.apply(r,S([this.lower+e,t],i,!1)):(n=this.record).spliceMutable.apply(n,S([this.lower+e,t],i,!1)),Object.defineProperty(this,"upper",{value:this.upper+i.length-u.length,enumerable:!0,configurable:!0}),u},t.prototype.delete=function(e){if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");return e=ir.fromAny(e),0!=(this.record.flags&or.AliasedFlag)?this.deleteAliased(e):this.deleteMutable(e)},t.prototype.deleteAliased=function(e){for(var t=this.record,r=t.length,n=t.array,i=new Array(or.expand(r)),o=this.lower;o<this.upper;o+=1){var u=n[o];if(u instanceof Jt&&u.key.equals(e)){for(var s=o+1;s<r;s+=1,o+=1)i[o]=n[s];return Object.defineProperty(t,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(t,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(t,"length",{value:r-1,enumerable:!0,configurable:!0}),Object.defineProperty(t,"fieldCount",{value:t.fieldCount-1,enumerable:!0,configurable:!0}),Object.defineProperty(t,"flags",{value:t.flags&~or.AliasedFlag,enumerable:!0,configurable:!0}),Object.defineProperty(this,"upper",{value:this.upper-1,enumerable:!0,configurable:!0}),u}i[o]=u}return Qt.absent()},t.prototype.deleteMutable=function(e){for(var t=this.record,r=t.length,n=t.array,i=this.lower;i<this.upper;i+=1){var o=n[i];if(o instanceof Jt&&o.key.equals(e)){for(var u=i+1;u<r;u+=1,i+=1)n[i]=n[u];return n[r-1]=void 0,Object.defineProperty(t,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(t,"length",{value:r-1,enumerable:!0,configurable:!0}),Object.defineProperty(t,"fieldCount",{value:t.fieldCount-1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"upper",{value:this.upper-1,enumerable:!0,configurable:!0}),o}}return Qt.absent()},t.prototype.clear=function(){if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");0!=(this.record.flags&or.AliasedFlag)?this.clearAliased():this.clearMutable()},t.prototype.clearAliased=function(){for(var e=this.record,t=e.length,r=e.fieldCount,n=t-this.length,i=e.array,o=new Array(or.expand(n)),u=0;u<this.lower;)o[u]=i[u],u+=1;for(;u<this.upper;)i[u]instanceof Jt&&(r-=1),u+=1;u=this.lower;for(var s=this.upper;s<t;)o[u]=i[s],u+=1,s+=1;Object.defineProperty(e,"array",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(e,"table",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(e,"length",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(e,"fieldCount",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(e,"flags",{value:e.flags&~or.AliasedFlag,enumerable:!0,configurable:!0}),Object.defineProperty(this,"upper",{value:this.lower,enumerable:!0,configurable:!0})},t.prototype.clearMutable=function(){for(var e=this.record,t=e.length,r=e.fieldCount,n=e.array,i=this.lower;i<this.upper;)n[i]instanceof Jt&&(r-=1),i+=1;i=this.lower;for(var o=this.upper;o<t;){var u=n[o];u instanceof Jt&&Object.defineProperty(e,"table",{value:null,enumerable:!0,configurable:!0}),n[i]=u,i+=1,o+=1}for(Object.defineProperty(e,"length",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(e,"fieldCount",{value:r,enumerable:!0,configurable:!0});i<t;)n[i]=void 0,i+=1;Object.defineProperty(this,"upper",{value:this.lower,enumerable:!0,configurable:!0})},t.prototype.isAliased=function(){return 0!=(this.record.flags&or.AliasedFlag)},t.prototype.isMutable=function(){return 0==(this.record.flags&or.ImmutableFlag)},t.prototype.alias=function(){Object.defineProperty(this.record,"flags",{value:this.record.flags|or.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.branch=function(){for(var e=this.length,t=0,r=this.record.array,n=new Array(or.expand(e)),i=this.lower,o=0;o<e;){var u=r[i];n[o]=u,u instanceof Jt&&(t+=1),i+=1,o+=1}return new pr(n,null,e,t,0)},t.prototype.clone=function(){for(var e=this.length,t=0,r=this.record.array,n=new Array(or.expand(e)),i=this.lower,o=0;o<e;){var u=r[i];n[o]=u.clone(),u instanceof Jt&&(t+=1),i+=1,o+=1}return new pr(n,null,e,t,0)},t.prototype.commit=function(){return this.record.commit(),this},t.prototype.subRecord=function(e,r){var n=this.length;if(void 0===e?e=0:e<0&&(e=n+e),void 0===r?r=n:r<0&&(r=n+r),e<0||r>n||e>r)throw new RangeError(e+", "+r);return new t(this.record,this.lower+e,this.upper+r)},t.prototype.forEach=function(e,t){for(var r=this.record.array,n=this.lower,i=this.upper;n<i;n+=1){var o=e.call(t,r[n],n);if(void 0!==o)return o}},t}(or);Object.defineProperty(fr.prototype,"fieldCount",{get:function(){for(var e=this.record.array,t=0,r=this.lower,n=this.upper;r<n;r+=1)e[r]instanceof Jt&&(t+=1);return t},enumerable:!0,configurable:!0});var cr=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"array",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(i,"size",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(i,"flags",{value:n,enumerable:!0,configurable:!0}),i}return C(t,e),t.prototype.isConstant=function(){return!0},t.prototype.getByte=function(e){if(e<0||e>=this.size)throw new RangeError(""+e);return this.array[e]},t.prototype.setByte=function(e,r){var n=this.flags;if(0!=(n&t.ImmutableFlag))throw new Error("immutable");if(e<0||e>=this.size)throw new RangeError(""+e);return 0!=(n&t.AliasedFlag)?this.setByteAliased(e,r):this.setByteMutable(e,r)},t.prototype.setByteAliased=function(e,r){var n=this.size,i=this.array,o=new Uint8Array(t.expand(n));return o.set(i,0),o[e]=r,Object.defineProperty(this,"array",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~t.AliasedFlag,enumerable:!0,configurable:!0}),this},t.prototype.setByteMutable=function(e,t){return this.array[e]=t,this},t.prototype.addByte=function(e){var r=this.flags;if(0!=(r&t.ImmutableFlag))throw new Error("immutable");return 0!=(r&t.AliasedFlag)?this.addByteAliased(e):this.addByteMutable(e)},t.prototype.addByteAliased=function(e){var r=this.size,n=this.array,i=new Uint8Array(t.expand(r+1));return null!==n&&i.set(n,0),i[r]=e,Object.defineProperty(this,"array",{value:i,enumerable:!0,configurable:!0}),Object.defineProperty(this,"size",{value:r+1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~t.AliasedFlag,enumerable:!0,configurable:!0}),this},t.prototype.addByteMutable=function(e){var r,n=this.size,i=this.array;return null===i||n+1>i.length?(r=new Uint8Array(t.expand(n+1)),null!==i&&r.set(i,0),Object.defineProperty(this,"array",{value:r,enumerable:!0,configurable:!0})):r=i,r[n]=e,Object.defineProperty(this,"size",{value:n+1,enumerable:!0,configurable:!0}),this},t.prototype.addData=function(e){var t=e.array;if(null!==t){var r=e.size;return t.length>r&&(t=t.slice(0,r)),this.addUint8Array(t)}return this},t.prototype.addUint8Array=function(e){var r=this.flags;if(0!=(r&t.ImmutableFlag))throw new Error("immutable");return 0!=(r&t.AliasedFlag)?this.addUint8ArrayAliased(e):this.addUint8ArrayMutable(e)},t.prototype.addUint8ArrayAliased=function(e){var r=e.length;if(0===r)return this;var n=this.size,i=this.array,o=new Uint8Array(t.expand(n+r));return null!==i&&o.set(i,0),o.set(e,n),Object.defineProperty(this,"array",{value:o,enumerable:!0,configurable:!0}),Object.defineProperty(this,"size",{value:n+r,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~t.AliasedFlag,enumerable:!0,configurable:!0}),this},t.prototype.addUint8ArrayMutable=function(e){var r=e.length;if(0===r)return this;var n,i=this.size,o=this.array;return null===o||i+r>o.length?(n=new Uint8Array(t.expand(i+r)),null!==o&&n.set(o,0),Object.defineProperty(this,"array",{value:n,enumerable:!0,configurable:!0})):n=o,n.set(e,i),Object.defineProperty(this,"size",{value:i+r,enumerable:!0,configurable:!0}),this},t.prototype.clear=function(){if(0!=(this.flags&t.ImmutableFlag))throw new Error("immutable");Object.defineProperty(this,"array",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"size",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:t.AliasedFlag,enumerable:!0,configurable:!0})},t.prototype.toUint8Array=function(){var e=this.array,r=this.flags;if(0!=(r&t.ImmutableFlag))return null!==e?e.slice(0):new Uint8Array(0);if(0!=(r&t.AliasedFlag)||this.size!==e.length){var n=null!==e?e.slice(0):new Uint8Array(0);return Object.defineProperty(this,"array",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(this,"flags",{value:this.flags&~t.AliasedFlag,enumerable:!0,configurable:!0}),n}return e},t.prototype.asUint8Array=function(){var e;return null!==this.array&&this.size>0?(e=this.array).length!==this.size&&(e=new Uint8Array(e.buffer,e.byteOffset,this.size)):e=void 0,e},t.prototype.toAny=function(){return this.toUint8Array()},t.prototype.isAliased=function(){return 0!=(this.flags&t.AliasedFlag)},t.prototype.isMutable=function(){return 0==(this.flags&t.ImmutableFlag)},t.prototype.branch=function(){return Object.defineProperty(this,"flags",{value:this.flags|t.AliasedFlag,enumerable:!0,configurable:!0}),new t(this.array,this.size,t.AliasedFlag)},t.prototype.clone=function(){return this.branch()},t.prototype.commit=function(){return Object.defineProperty(this,"flags",{value:this.flags|t.ImmutableFlag,enumerable:!0,configurable:!0}),this},t.prototype.writeBase16=function(e,t){void 0===t&&(t=Ve.uppercase);var r=this.array,n=this.size;return null!==r&&0!==n?(r.length!==n&&(r=r.slice(0,n)),t.writeUint8Array(e,r)):ee.end()},t.prototype.toBase16=function(e){void 0===e&&(e=Ve.uppercase);var t=re.stringOutput();return this.writeBase16(t,e).bind(),t.bind()},t.prototype.writeBase64=function(e,t){void 0===t&&(t=We.standard());var r=this.array,n=this.size;return null!==r&&0!==n?(r.length!==n&&(r=r.slice(0,n)),t.writeUint8Array(e,r)):ee.end()},t.prototype.toBase64=function(e){void 0===e&&(e=We.standard());var t=re.stringOutput();return this.writeBase64(t,e),t.bind()},t.prototype.interpolateTo=function(t){return e.prototype.interpolateTo.call(this,t)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 4},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.array,n=e.array,i=this.size,o=e.size,u=0,s=0;do{if(!(s<i&&s<o))break;u=r[s]-n[s],s+=1}while(0===u);return u>0?1:u<0?-1:i>o?1:i<o?-1:0}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e){return this.equals(e)},t.prototype.equals=function(e){if(this===e)return!0;if(e instanceof t){var r=this.array,n=e.array,i=this.size;if(i!==e.size)return!1;for(var o=0;o<i;o+=1)if(r[o]!==n[o])return!1;return!0}return!1},t.prototype.hashCode=function(){return c.mash(c.mixUint8Array(w.hash(t),null!==this.array?this.array:new Uint8Array(0)))},t.prototype.debug=function(e){if(e=e.write("Data").write(46),0===this.size)e=e.write("empty").write(40).write(41);else{e=e.write("base16").write(40).write(34);var t=this.writeBase16(e);if(!t.isDone())return Z.error(t.trap());e=e.write(34).write(41)}return e},t.empty=function(){return new t(null,0,t.AliasedFlag|t.ImmutableFlag)},t.create=function(e){return void 0===e?new t(null,0,t.AliasedFlag):new t(new Uint8Array(e),0,0)},t.wrap=function(e){return new t(e,e.length,t.AliasedFlag)},t.fromBase16=function(e){return"string"==typeof e&&(e=re.stringInput(e)),Ve.parse(e,t.output()).bind()},t.fromBase64=function(e,r){return void 0===r&&(r=We.standard()),"string"==typeof e&&(e=re.stringInput(e)),r.parse(e,t.output()).bind()},t.fromAny=function(e){if(e instanceof t)return e;if(e instanceof Uint8Array)return t.wrap(e);throw new TypeError(""+e)},t.random=function(e){var r=new Uint8Array(e);return a.fillBytes(r),t.wrap(r)},t.output=function(e){return e instanceof t||(e=t.create(e)),new lr(e,W.standard())},t.expand=function(e){return e=Math.max(32,e)-1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1},t.AliasedFlag=1,t.ImmutableFlag=2,E([s],t,"empty",null),t}(ir),lr=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"data",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(n,"settings",{value:r,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.isCont=function(){return!0},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},t.prototype.write=function(e){if("number"==typeof e)return this.data.addByte(e),this;throw new TypeError(""+e)},t.prototype.writeln=function(e){throw new TypeError(""+e)},t.prototype.withSettings=function(e){return e=W.fromAny(e),Object.defineProperty(this,"settings",{value:e,enumerable:!0,configurable:!0}),this},t.prototype.bind=function(){return this.data},t.prototype.clone=function(){return new t(this.data.branch(),this.settings)},t}(Z),hr=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),Object.defineProperty(r,"hashValue",{value:void 0,configurable:!0}),r}return C(t,e),t.prototype.isConstant=function(){return!0},Object.defineProperty(t.prototype,"size",{get:function(){return this.value.length},enumerable:!1,configurable:!0}),t.prototype.stringValue=function(e){return this.value},t.prototype.numberValue=function(e){try{return yr.parse(this.value).numberValue()}catch(t){return e}},t.prototype.booleanValue=function(e){return"true"===this.value||"false"!==this.value&&e},t.prototype.toAny=function(){return this.value},t.prototype.valueOf=function(){return this.value},t.prototype.plus=function(r){return(r=Qt.fromAny(r))instanceof t?t.from(this.value+r.value):e.prototype.plus.call(this,r)},t.prototype.branch=function(){return this},t.prototype.clone=function(){return this},t.prototype.commit=function(){return this},t.prototype.interpolateTo=function(t){return e.prototype.interpolateTo.call(this,t)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 5},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.value.localeCompare(e.value):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e){return this.equals(e)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){var e=this.hashValue;return void 0===e&&(e=m.hash(this.value),Object.defineProperty(this,"hashValue",{value:e})),e},t.prototype.debug=function(e){return e=e.write("Text").write(46),e=0===this.value.length?e.write("empty").write(40).write(41):e.write("from").write(40).debug(this.value).write(41)},t.prototype.display=function(e){return ne.debugAny(e,this.value)},t.prototype.toString=function(){return this.value},t.empty=function(){return new t("")},t.from=function(e){var r=e.length;if(0===r)return t.empty();var n=new t(e);return r<=64&&(n=t.cache.put(n)),n},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.from(e);throw new TypeError(""+e)},t.output=function(e){return void 0===e&&(e=W.standard()),new dr("",e)},Object.defineProperty(t,"cache",{get:function(){return new N(128)},enumerable:!1,configurable:!0}),E([s],t,"empty",null),E([s],t,"cache",null),t}(ir),dr=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"string",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(n,"settings",{value:r,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.isCont=function(){return!0},t.prototype.isFull=function(){return!1},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.isPart=function(){return!1},t.prototype.asPart=function(e){return this},t.prototype.write=function(e){if("number"==typeof e)if(e>=0&&e<=55295||e>=57344&&e<=65535)e=String.fromCharCode(e);else if(e>=65536&&e<=1114111){var t=e-65536;e=String.fromCharCode(55296|t>>>10,56320|1023&t)}else e="ï¿½";return Object.defineProperty(this,"string",{value:this.string+e,enumerable:!0,configurable:!0}),this},t.prototype.withSettings=function(e){return e=W.fromAny(e),Object.defineProperty(this,"settings",{value:e,enumerable:!0,configurable:!0}),this},t.prototype.bind=function(){return hr.from(this.string)},t.prototype.clone=function(){return new t(this.string,this.settings)},t.prototype.toString=function(){return this.string},t}(Z),yr=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"value",{value:t,enumerable:!0}),Object.defineProperty(n,"flags",{value:void 0!==r?r:0,enumerable:!0}),n}return C(t,e),t.prototype.isConstant=function(){return!0},t.prototype.isNaN=function(){return isNaN(this.value)},t.prototype.isInfinite=function(){return!isNaN(this.value)&&!isFinite(this.value)},t.prototype.isUint32=function(){return 0!=(this.flags&t.Uint32Flag)},t.prototype.isUint64=function(){return 0!=(this.flags&t.Uint64Flag)},t.prototype.stringValue=function(e){return""+this.value},t.prototype.numberValue=function(e){return this.value},t.prototype.booleanValue=function(e){return!!this.value},t.prototype.toAny=function(){return this.value},t.prototype.valueOf=function(){return this.value},t.prototype.bitwiseOr=function(r){return(r=Qt.fromAny(r))instanceof t?t.from((this.value|r.value)>>>0):e.prototype.bitwiseOr.call(this,r)},t.prototype.bitwiseXor=function(r){return(r=Qt.fromAny(r))instanceof t?t.from((this.value^r.value)>>>0):e.prototype.bitwiseXor.call(this,r)},t.prototype.bitwiseAnd=function(r){return(r=Qt.fromAny(r))instanceof t?t.from((this.value&r.value)>>>0):e.prototype.bitwiseAnd.call(this,r)},t.prototype.plus=function(r){return(r=Qt.fromAny(r))instanceof t?t.from(this.value+r.value):e.prototype.plus.call(this,r)},t.prototype.minus=function(r){return(r=Qt.fromAny(r))instanceof t?t.from(this.value-r.value):e.prototype.minus.call(this,r)},t.prototype.times=function(r){return(r=Qt.fromAny(r))instanceof t?t.from(this.value*r.value):e.prototype.times.call(this,r)},t.prototype.divide=function(r){return(r=Qt.fromAny(r))instanceof t?t.from(this.value/r.value):e.prototype.divide.call(this,r)},t.prototype.modulo=function(r){return(r=Qt.fromAny(r))instanceof t?t.from(this.value%r.value):e.prototype.modulo.call(this,r)},t.prototype.bitwiseNot=function(){return t.from(~this.value>>>0)},t.prototype.negative=function(){return t.from(-this.value)},t.prototype.positive=function(){return this},t.prototype.inverse=function(){return t.from(1/this.value)},t.prototype.abs=function(){return t.from(Math.abs(this.value))},t.prototype.ceil=function(){return t.from(Math.ceil(this.value))},t.prototype.floor=function(){return t.from(Math.floor(this.value))},t.prototype.round=function(){return t.from(Math.round(this.value))},t.prototype.sqrt=function(){return t.from(Math.sqrt(this.value))},t.prototype.pow=function(e){return e=t.fromAny(e),t.from(Math.pow(this.value,e.value))},t.prototype.max=function(e){return this.compareTo(e)>=0?this:e},t.prototype.min=function(e){return this.compareTo(e)<=0?this:e},t.prototype.interpolateTo=function(r){return r instanceof t?vr(this,r):e.prototype.interpolateTo.call(this,r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 6},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.value,n=e.value;return r<n?-1:r>n?1:isNaN(n)?isNaN(r)?0:-1:isNaN(r)?1:0}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){if(this===e)return!0;if(e instanceof t){var i=this.value,o=e.value;return i===o||isNaN(i)&&isNaN(o)||Math.abs(o-i)<(void 0!==r?r:n.Epsilon)}return!1},t.prototype.equals=function(e){if(this===e)return!0;if(e instanceof t){var r=this.value,n=e.value;return r===n||isNaN(r)&&isNaN(n)}return!1},t.prototype.hashCode=function(){return b.hash(this.value)},t.prototype.debug=function(e){return e=e.write("Num").write(46).write("from").write(40).display(this).write(41)},t.prototype.display=function(e){return ne.displayNumber(e,this.value)},Object.defineProperty(t,"zero",{get:function(){return new t(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"negativeZero",{get:function(){return new t(-0)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"one",{get:function(){return new t(1)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"negativeOne",{get:function(){return new t(-1)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"nan",{get:function(){return new t(NaN)},enumerable:!1,configurable:!0}),t.uint32=function(e){return new t(e,t.Uint32Flag)},t.uint64=function(e){return new t(e,t.Uint64Flag)},t.from=function(e){return 0===e?1/e==-1/0?t.negativeZero:t.zero:1===e?t.one:-1===e?t.negativeOne:isNaN(e)?t.nan:t.cache.put(new t(e))},t.fromAny=function(e){if(e instanceof t)return e;if("number"==typeof e)return t.from(e);throw new TypeError(""+e)},t.parse=function(e){if("NaN"===e)return t.nan;var r=+e;if(isFinite(r))return t.from(r);throw new Error(e)},Object.defineProperty(t,"cache",{get:function(){return new N(128)},enumerable:!1,configurable:!0}),t.Uint32Flag=1,t.Uint64Flag=2,t.TypeMask=3,E([s],t,"zero",null),E([s],t,"negativeZero",null),E([s],t,"one",null),E([s],t,"negativeOne",null),E([s],t,"nan",null),E([s],t,"cache",null),t}(ir),vr=function(e,t){var r=function(e){var t=r[0].value,n=r[1].value;return yr.from(t+e*(n-t))};return Object.setPrototypeOf(r,vr.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};vr.prototype=Object.create($e.prototype);var br=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),Object.defineProperty(r,"hashValue",{value:m.hash(t?"true":"false")}),r}return C(t,e),t.prototype.isDefinite=function(){return this.value},t.prototype.isConstant=function(){return!0},t.prototype.stringValue=function(e){return this.value?"true":"false"},t.prototype.booleanValue=function(e){return this.value},t.prototype.toAny=function(){return this.value},t.prototype.valueOf=function(){return this.value},t.prototype.conditional=function(e,t){return this.value?Qt.fromAny(e):Qt.fromAny(t)},t.prototype.or=function(e){return this.value?this:Qt.fromAny(e)},t.prototype.and=function(e){return this.value?Qt.fromAny(e):this},t.prototype.not=function(){return t.from(!this.value)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 7},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.value&&!e.value?-1:!this.value&&e.value?1:0:e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e){return this.equals(e)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return this.hashValue},t.prototype.debug=function(e){return e=e.write("Bool").write(46).write("from").write(40).write(this.value?"true":"false").write(41)},t.prototype.display=function(e){return e=e.write(this.value?"true":"false")},Object.defineProperty(t,"true",{get:function(){return new t(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"false",{get:function(){return new t(!1)},enumerable:!1,configurable:!0}),t.from=function(e){return e?t.true:t.false},t.fromAny=function(e){if(e instanceof t)return e;if("boolean"==typeof e)return t.from(e);throw new TypeError(""+e)},E([s],t,"true",null),E([s],t,"false",null),t}(ir),mr=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isDefined=function(){return!0},t.prototype.isDistinct=function(){return!1},t.prototype.isDefinite=function(){return!1},t.prototype.isConstant=function(){return!0},t.prototype.unflattened=function(){return or.empty()},t.prototype.not=function(){return ir.absent()},t.prototype.stringValue=function(e){return""},t.prototype.booleanValue=function(e){return!0},t.prototype.toAny=function(){return null},t.prototype.interpolateTo=function(t){return e.prototype.interpolateTo.call(this,t)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 98},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e){return this===e},t.prototype.equals=function(e){return this===e},t.prototype.hashCode=function(){return w.hash(t)},t.prototype.debug=function(e){return e=e.write("Value").write(46).write("extant").write(40).write(41)},t.prototype.display=function(e){return e=e.write("null")},t.extant=function(){return new t},t.fromAny=function(e){if(e instanceof t)return e;if(null===e)return t.extant();throw new TypeError(""+e)},E([s],t,"extant",null),t}(ir),gr=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isDefined=function(){return!1},t.prototype.isDistinct=function(){return!1},t.prototype.isDefinite=function(){return!1},t.prototype.isConstant=function(){return!0},t.prototype.unflattened=function(){return or.empty()},t.prototype.updated=function(e,t){return or.of($t.of(e,t))},t.prototype.updatedAttr=function(e,t){return or.of(tr.of(e,t))},t.prototype.updatedSlot=function(e,t){return or.of($t.of(e,t))},t.prototype.appended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return or.of(e)},t.prototype.prepended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return or.of(e)},t.prototype.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=or.create(),n=0,i=e.length;n<i;n+=1)Qt.fromAny(e[n]).forEach((function(e){r.push(e)}));return r},t.prototype.conditional=function(e,t){return Qt.fromAny(t)},t.prototype.or=function(e){return Qt.fromAny(e)},t.prototype.and=function(e){return this},t.prototype.not=function(){return ir.extant()},t.prototype.booleanValue=function(e){return!1},t.prototype.toAny=function(){},t.prototype.forEach=function(e,t){},t.prototype.iterator=function(){return k.empty()},t.prototype.interpolateTo=function(t){return e.prototype.interpolateTo.call(this,t)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 99},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e){return this===e},t.prototype.equals=function(e){return this===e},t.prototype.hashCode=function(){return w.hash(t)},t.prototype.debug=function(e){return e=e.write("Value").write(46).write("absent").write(40).write(41)},t.prototype.display=function(e){return e=e.write("undefined")},t.absent=function(){return new t},t.fromAny=function(e){if(e instanceof t)return e;if(void 0===e)return t.absent();throw new TypeError(""+e)},E([s],t,"absent",null),t}(ir),wr=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.conditional=function(e,t){return e=Qt.fromAny(e),t=Qt.fromAny(t),new Er(this,e,t)},t.prototype.or=function(e){return e=Qt.fromAny(e),new Dr(this,e)},t.prototype.and=function(e){return e=Qt.fromAny(e),new Ir(this,e)},t.prototype.bitwiseOr=function(e){return e=Qt.fromAny(e),new Tr(this,e)},t.prototype.bitwiseXor=function(e){return e=Qt.fromAny(e),new Vr(this,e)},t.prototype.bitwiseAnd=function(e){return e=Qt.fromAny(e),new qr(this,e)},t.prototype.lt=function(e){return e=Qt.fromAny(e),new Rr(this,e)},t.prototype.le=function(e){return e=Qt.fromAny(e),new Ur(this,e)},t.prototype.eq=function(e){return e=Qt.fromAny(e),new Nr(this,e)},t.prototype.ne=function(e){return e=Qt.fromAny(e),new zr(this,e)},t.prototype.ge=function(e){return e=Qt.fromAny(e),new Fr(this,e)},t.prototype.gt=function(e){return e=Qt.fromAny(e),new Lr(this,e)},t.prototype.plus=function(e){return e=Qt.fromAny(e),new Kr(this,e)},t.prototype.minus=function(e){return e=Qt.fromAny(e),new Br(this,e)},t.prototype.times=function(e){return e=Qt.fromAny(e),new Wr(this,e)},t.prototype.divide=function(e){return e=Qt.fromAny(e),new Hr(this,e)},t.prototype.modulo=function(e){return e=Qt.fromAny(e),new Xr(this,e)},t.prototype.not=function(){return new Yr(this)},t.prototype.bitwiseNot=function(){return new Gr(this)},t.prototype.negative=function(){return new _r(this)},t.prototype.positive=function(){return new Qr(this)},t.prototype.inverse=function(){return new Hr(yr.one,this)},t.prototype.toAny=function(){return this},t}(ir),Or=function(e){function t(){return e.call(this)||this}return C(t,e),t.binary=function(e,t,r){switch(t){case"||":return new Dr(e,r);case"&&":return new Ir(e,r);case"|":return new Tr(e,r);case"^":return new Vr(e,r);case"&":return new qr(e,r);case"<":return new Rr(e,r);case"<=":return new Ur(e,r);case"==":return new Nr(e,r);case"!=":return new zr(e,r);case">=":return new Fr(e,r);case">":return new Lr(e,r);case"+":return new Kr(e,r);case"-":return new Br(e,r);case"*":return new Wr(e,r);case"/":return new Hr(e,r);case"%":return new Xr(e,r);default:throw new Error(t)}},t.unary=function(e,t){switch(e){case"!":return new Yr(t);case"~":return new Gr(t);case"-":return new _r(t);case"+":return new Qr(t);default:throw new Error(e)}},t}(wr),Pr=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"operand1",{value:t,enumerable:!0}),Object.defineProperty(n,"operand2",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.isConstant=function(){return this.operand1.isConstant()&&this.operand2.isConstant()},t.prototype.interpolateTo=function(r){return r instanceof t&&this.operator===r.operator?xr(this,r):e.prototype.interpolateTo.call(this,r)},t}(Or),xr=function(e,t){var r=e.operator;if(r!==t.operator)throw new Error;var n=function(e){var t=n.operand1Interpolator(e),r=n.operand2Interpolator(e);return Or.binary(t,n.operator,r)};return Object.setPrototypeOf(n,xr.prototype),Object.defineProperty(n,"operand1Interpolator",{value:e.operand1.interpolateTo(t.operand1),enumerable:!0}),Object.defineProperty(n,"operator",{value:r,enumerable:!0}),Object.defineProperty(n,"operand2Interpolator",{value:e.operand2.interpolateTo(t.operand2),enumerable:!0}),n};xr.prototype=Object.create($e.prototype),Object.defineProperty(xr.prototype,0,{get:function(){var e=this.operand1Interpolator[0],t=this.operand2Interpolator[0];return Or.binary(e,this.operator,t)},enumerable:!0,configurable:!0}),Object.defineProperty(xr.prototype,1,{get:function(){var e=this.operand1Interpolator[1],t=this.operand2Interpolator[1];return Or.binary(e,this.operator,t)},enumerable:!0,configurable:!0}),xr.prototype.equals=function(e){return this===e||e instanceof xr&&(this.operator===e.operator&&this.operand1Interpolator.equals(e.operand1Interpolator)&&this.operand2Interpolator.equals(e.operand2Interpolator))};var jr=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"operand",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isConstant=function(){return this.operand.isConstant()},t.prototype.interpolateTo=function(r){return r instanceof t&&this.operator===r.operator?Cr(this,r):e.prototype.interpolateTo.call(this,r)},t}(Or),Cr=function(e,t){var r=e.operator;if(r!==t.operator)throw new Error;var n=function(e){var t=n.operandInterpolator(e);return Or.unary(n.operator,t)};return Object.setPrototypeOf(n,Cr.prototype),Object.defineProperty(n,"operator",{value:r,enumerable:!0}),Object.defineProperty(n,"operandInterpolator",{value:e.operand.interpolateTo(t.operand),enumerable:!0}),n};Cr.prototype=Object.create($e.prototype),Object.defineProperty(Cr.prototype,0,{get:function(){var e=this.operandInterpolator[0];return Or.unary(this.operator,e)},enumerable:!0,configurable:!0}),Object.defineProperty(Cr.prototype,1,{get:function(){var e=this.operandInterpolator[1];return Or.unary(this.operator,e)},enumerable:!0,configurable:!0}),Cr.prototype.equals=function(e){return this===e||e instanceof Cr&&(this.operator===e.operator&&this.operandInterpolator.equals(e.operandInterpolator))};var Er=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"ifTerm",{value:t.commit(),enumerable:!0}),Object.defineProperty(i,"thenTerm",{value:r.commit(),enumerable:!0}),Object.defineProperty(i,"elseTerm",{value:n.commit(),enumerable:!0}),i}return C(t,e),t.prototype.isConstant=function(){return this.ifTerm.isConstant()&&this.thenTerm.isConstant()&&this.elseTerm.isConstant()},Object.defineProperty(t.prototype,"precedence",{get:function(){return 2},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){var t;((e=Ar.fromAny(e)).willOperate(this),this.ifTerm.evaluate(e).isDefinite())?t=this.thenTerm.evaluate(e):t=this.elseTerm.evaluate(e);return e.didOperate(this,t),t},t.prototype.substitute=function(e){return e=Ar.fromAny(e),new t(this.ifTerm.substitute(e),this.thenTerm.substitute(e),this.elseTerm.substitute(e))},t.prototype.interpolateTo=function(r){return r instanceof t?Sr(this,r):e.prototype.interpolateTo.call(this,r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 20},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.ifTerm.compareTo(e.ifTerm);return 0===r&&0===(r=this.thenTerm.compareTo(e.thenTerm))&&(r=this.elseTerm.compareTo(e.elseTerm)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.ifTerm.equivalentTo(e.ifTerm,r)&&this.thenTerm.equivalentTo(e.thenTerm,r)&&this.elseTerm.equivalentTo(e.elseTerm,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.ifTerm.equals(e.ifTerm)&&this.thenTerm.equals(e.thenTerm)&&this.elseTerm.equals(e.elseTerm))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(w.hash(t),this.ifTerm.hashCode()),this.thenTerm.hashCode()),this.elseTerm.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.ifTerm).write(46).write("conditional").write(40).debug(this.thenTerm).write(44).write(32).debug(this.elseTerm).write(41)},t.prototype.clone=function(){return new t(this.ifTerm.clone(),this.thenTerm.clone(),this.elseTerm.clone())},t}(Or),Sr=function(e,t){var r=function(e){var t=r.ifTermInterpolator(e),n=r.thenTermInterpolator(e),i=r.elseTermInterpolator(e);return new Er(t,n,i)};return Object.setPrototypeOf(r,Sr.prototype),Object.defineProperty(r,"ifTermInterpolator",{value:e.ifTerm.interpolateTo(t.ifTerm),enumerable:!0}),Object.defineProperty(r,"thenTermInterpolator",{value:e.thenTerm.interpolateTo(t.thenTerm),enumerable:!0}),Object.defineProperty(r,"elseTermInterpolator",{value:e.elseTerm.interpolateTo(t.elseTerm),enumerable:!0}),r};Sr.prototype=Object.create($e.prototype),Object.defineProperty(Sr.prototype,0,{get:function(){var e=this.ifTermInterpolator[0],t=this.thenTermInterpolator[0],r=this.elseTermInterpolator[0];return new Er(e,t,r)},enumerable:!0,configurable:!0}),Object.defineProperty(Sr.prototype,1,{get:function(){var e=this.ifTermInterpolator[1],t=this.thenTermInterpolator[1],r=this.elseTermInterpolator[1];return new Er(e,t,r)},enumerable:!0,configurable:!0}),Sr.prototype.equals=function(e){return this===e||e instanceof Sr&&(this.ifTermInterpolator.equals(e.ifTermInterpolator)&&this.thenTermInterpolator.equals(e.thenTermInterpolator)&&this.elseTermInterpolator.equals(e.elseTermInterpolator))};var kr=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),Mr=function(){function e(e){Object.defineProperty(this,"maxScopeDepth",{value:e,enumerable:!0})}return e.prototype.withMaxScopeDepth=function(e){return this.copy(e)},e.prototype.copy=function(t){return new e(t)},e.prototype.canEqual=function(t){return t instanceof e},e.prototype.equals=function(t){return this===t||t instanceof e&&(t.canEqual(this)&&this.maxScopeDepth===t.maxScopeDepth)},e.prototype.hashCode=function(){return c.mash(c.mix(w.hash(e),b.hash(this.maxScopeDepth)))},e.prototype.debug=function(e){return e=e.write("new").write(32).write("InterpreterSettings").write(40).debug(this.maxScopeDepth).write(41)},e.prototype.toString=function(){return ne.debug(this)},e.standard=function(){return new e(1024)},E([s],e,"standard",null),e}(),Ar=function(){function e(e,t,r){Object.defineProperty(this,"settings",{value:void 0!==e?e:Mr.standard(),enumerable:!0,configurable:!0}),Object.defineProperty(this,"scopeStack",{value:void 0!==t?t:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"scopeDepth",{value:void 0!==r?r:0,enumerable:!0,configurable:!0})}return e.prototype.withSettings=function(e){return Object.defineProperty(this,"settings",{value:e,enumerable:!0,configurable:!0}),this},e.prototype.peekScope=function(){var e=this.scopeDepth;if(e<=0)throw new kr("scope stack empty");return this.scopeStack[e-1]},e.prototype.getScope=function(e){if(e<0||e>=this.scopeDepth)throw new RangeError(""+e);return this.scopeStack[e]},e.prototype.pushScope=function(t){var r=this.scopeDepth;if(r>=this.settings.maxScopeDepth)throw new kr("scope stack overflow");var n,i=this.scopeStack;if(null===i||r+1>i.length){if(n=new Array(e.expand(r+1)),null!==i)for(var o=0;o<r;o+=1)n[o]=i[o];Object.defineProperty(this,"scopeStack",{value:n,enumerable:!0,configurable:!0})}else n=i;n[r]=t,Object.defineProperty(this,"scopeDepth",{value:r+1,enumerable:!0,configurable:!0})},e.prototype.popScope=function(){var e=this.scopeDepth;if(e<=0)throw new kr("scope stack empty");var t=this.scopeStack,r=t[e-1];return t[e-1]=void 0,Object.defineProperty(this,"scopeDepth",{value:e-1,enumerable:!0,configurable:!0}),r},e.prototype.swapScope=function(e){var t=this.scopeDepth;if(t<=0)throw new kr("scope stack empty");var r=this.scopeStack,n=r[t-1];return r[t-1]=e,n},e.prototype.willOperate=function(e){},e.prototype.didOperate=function(e,t){},e.prototype.willSelect=function(e){},e.prototype.didSelect=function(e,t){},e.prototype.willTransform=function(e){},e.prototype.didTransform=function(e,t){},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=t.length,i=new Array(e.expand(n)),o=0;o<n;o+=1){var u=Qt.fromAny(t[o]);i[o]=u}return new e(Mr.standard(),i,n)},e.fromAny=function(t,r){if(void 0===r&&(r=Qt.globalScope()),!(t instanceof e)){var n=t;t=new e,void 0!==r&&t.pushScope(r),void 0!==n&&t.pushScope(Qt.fromAny(n))}return t},e.expand=function(e){return e=Math.max(32,e)-1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1},e}(),Dr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"||"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 3},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){var t;(e=Ar.fromAny(e)).willOperate(this);var r=this.operand1.evaluate(e);r.isDefinite()?t=r:t=this.operand2.evaluate(e);return e.didOperate(this,t),t},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.or(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 21},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("or").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Ir=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"&&"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 4},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){var t;(e=Ar.fromAny(e)).willOperate(this);var r=this.operand1.evaluate(e);r.isDefinite()?t=this.operand2.evaluate(e):t=r;return e.didOperate(this,t),t},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.and(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 22},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("and").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Tr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 5},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.bitwiseOr(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.bitwiseOr(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 23},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("bitwiseOr").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Vr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"^"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 6},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.bitwiseXor(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.bitwiseXor(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 24},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("bitwiseXor").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),qr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"&"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 7},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.bitwiseAnd(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.bitwiseAnd(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 25},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("bitwiseAnd").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Rr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"<"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.lt(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.lt(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 26},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e.debug(this.operand1).write(46).write("lt").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Ur=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"<="},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.le(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.le(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 27},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e.debug(this.operand1).write(46).write("le").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Nr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"=="},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.eq(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.eq(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 28},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("eq").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),zr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"!="},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.ne(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.ne(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 29},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("ne").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Fr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return">="},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.ge(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.ge(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 30},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("ge").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Lr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return">"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.gt(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.gt(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 31},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("gt").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Kr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"+"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 8},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.plus(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.plus(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 32},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("plus").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Br=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"-"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 8},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.minus(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.minus(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 33},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("minus").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Wr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"*"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 9},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.times(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.times(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 34},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("times").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Hr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"/"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 9},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.divide(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.divide(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 35},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("divide").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Xr=function(e){function t(t,r){return e.call(this,t,r)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"%"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 9},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){(e=Ar.fromAny(e)).willOperate(this);var t=this.operand1.evaluate(e),r=this.operand2.evaluate(e),n=t.modulo(r);return e.didOperate(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var t=this.operand1.substitute(e),r=this.operand2.substitute(e);return t.modulo(r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 36},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.operand1.compareTo(e.operand1);return 0===r&&(r=this.operand2.compareTo(e.operand2)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.operand1.equivalentTo(e.operand1,r)&&this.operand2.equivalentTo(e.operand2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.operand1.equals(e.operand1)&&this.operand2.equals(e.operand2))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.operand1.hashCode()),this.operand2.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand1).write(46).write("modulo").write(40).debug(this.operand2).write(41)},t.prototype.clone=function(){return new t(this.operand1.clone(),this.operand2.clone())},t}(Pr),Yr=function(e){function t(t){return e.call(this,t)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"!"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){return e=Ar.fromAny(e),this.operand.evaluate(e).not()},t.prototype.substitute=function(e){return e=Ar.fromAny(e),this.operand.substitute(e).not()},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 37},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return b.compare(this.typeOrder,e.typeOrder)},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.operand.equivalentTo(e.operand,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.operand.equals(e.operand)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.operand.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand).write(46).write("not").write(40).write(41)},t.prototype.clone=function(){return new t(this.operand.clone())},t}(jr),Gr=function(e){function t(t){return e.call(this,t)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"~"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){return e=Ar.fromAny(e),this.operand.evaluate(e).bitwiseNot()},t.prototype.substitute=function(e){return e=Ar.fromAny(e),this.operand.substitute(e).bitwiseNot()},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 38},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.operand.compareTo(e.operand):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.operand.equivalentTo(e.operand,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.operand.equals(e.operand)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.operand.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand).write(46).write("bitwiseNot").write(40).write(41)},t.prototype.clone=function(){return new t(this.operand.clone())},t}(jr),_r=function(e){function t(t){return e.call(this,t)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"-"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){return e=Ar.fromAny(e),this.operand.evaluate(e).negative()},t.prototype.substitute=function(e){return e=Ar.fromAny(e),this.operand.substitute(e).negative()},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 39},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.operand.compareTo(e.operand):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.operand.equivalentTo(e.operand,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.operand.equals(e.operand)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.operand.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand).write(46).write("negative").write(40).write(41)},t.prototype.clone=function(){return new t(this.operand.clone())},t}(jr),Qr=function(e){function t(t){return e.call(this,t)||this}return C(t,e),Object.defineProperty(t.prototype,"operator",{get:function(){return"+"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){return e=Ar.fromAny(e),this.operand.evaluate(e).positive()},t.prototype.substitute=function(e){return e=Ar.fromAny(e),this.operand.substitute(e).positive()},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 40},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.operand.compareTo(e.operand):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.operand.equivalentTo(e.operand,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.operand.equals(e.operand)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.operand.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.operand).write(46).write("positive").write(40).write(41)},t.prototype.clone=function(){return new t(this.operand.clone())},t}(jr),Zr=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"func",{value:t,enumerable:!0}),Object.defineProperty(n,"args",{value:r.commit(),enumerable:!0}),Object.defineProperty(n,"state",{value:void 0,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.setState=function(e){Object.defineProperty(this,"state",{value:e,enumerable:!0,configurable:!0})},t.prototype.isConstant=function(){return this.func.isConstant()&&this.args.isConstant()},Object.defineProperty(t.prototype,"precedence",{get:function(){return 11},enumerable:!1,configurable:!0}),t.prototype.evaluate=function(e){e=Ar.fromAny(e);var t=this.func.evaluate(e);return t instanceof cn?t.invoke(this.args,e,this):Qt.absent()},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.func.evaluate(e);if(r instanceof cn){var n=r.expand(this.args,e,this);if(void 0!==n)return n}var i=this.args.substitute(e).toValue();return new t(this.func,i)},t.prototype.interpolateTo=function(r){return r instanceof t?Jr(this,r):e.prototype.interpolateTo.call(this,r)},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 41},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.func.compareTo(e.func);return 0===r&&(r=this.args.compareTo(e.args)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.func.equals(e.func)&&this.args.equivalentTo(e.args,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.func.equals(e.func)&&this.args.equals(e.args))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.func.hashCode()),this.args.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.func).write(46).write("invoke").write(40).debug(this.args).write(41)},t.prototype.clone=function(){return new t(this.func.clone(),this.args.clone())},t}(Or),Jr=function(e,t){var r=function(e){var t=r.funcInterpolator(e),n=r.argsInterpolator(e);return new Zr(t,n)};return Object.setPrototypeOf(r,Jr.prototype),Object.defineProperty(r,"funcInterpolator",{value:e.func.interpolateTo(t.func),enumerable:!0}),Object.defineProperty(r,"argsInterpolator",{value:e.args.interpolateTo(t.args),enumerable:!0}),r};Jr.prototype=Object.create($e.prototype),Object.defineProperty(Jr.prototype,0,{get:function(){var e=this.funcInterpolator[0],t=this.argsInterpolator[0];return new Zr(e,t)},enumerable:!0,configurable:!0}),Object.defineProperty(Jr.prototype,1,{get:function(){var e=this.funcInterpolator[1],t=this.argsInterpolator[1];return new Zr(e,t)},enumerable:!0,configurable:!0}),Jr.prototype.equals=function(e){return this===e||e instanceof Jr&&(this.funcInterpolator.equals(e.funcInterpolator)&&this.argsInterpolator.equals(e.argsInterpolator))};var $r=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isConstant=function(){return!1},t.prototype.evaluate=function(e){e=Ar.fromAny(e);var t=or.create();return this.forSelected(e,(function(e){var r=e.peekScope();void 0!==r&&t.push(r)}),this),t.isEmpty()?Qt.absent():t.flattened()},t.prototype.get=function(e){return e=ir.fromAny(e),this.andThen(new tn(e,t.identity()))},t.prototype.getAttr=function(e){return e=hr.fromAny(e),this.andThen(new rn(e,t.identity()))},t.prototype.getItem=function(e){return e=yr.fromAny(e),this.andThen(new nn(e,t.identity()))},t.prototype.keys=function(){return this.andThen(t.keys())},t.prototype.values=function(){return this.andThen(t.values())},t.prototype.children=function(){return this.andThen(t.children())},t.prototype.descendants=function(){return this.andThen(t.descendants())},t.prototype.filter=function(e){return 0===arguments.length?new pn(this,t.identity()):(e=Qt.fromAny(e),this.andThen(e.filter()))},t.prototype.invoke=function(e){return new Zr(this,e)},Object.defineProperty(t.prototype,"precedence",{get:function(){return 11},enumerable:!1,configurable:!0}),t.prototype.debug=function(e){return e=e.write("Selector").write(46).write("identity").write(40).write(41),e=this.debugThen(e)},t.identity=function(){return new en},t.get=function(e){return e=ir.fromAny(e),new tn(e,t.identity())},t.getAttr=function(e){return e=hr.fromAny(e),new rn(e,t.identity())},t.getItem=function(e){return e=yr.fromAny(e),new nn(e,t.identity())},t.keys=function(){return new on(t.identity())},t.values=function(){return new un(t.identity())},t.children=function(){return new sn(t.identity())},t.descendants=function(){return new an(t.identity())},t.literal=function(e){return(e=Qt.fromAny(e))instanceof t||(e=new fn(e,t.identity())),e},E([s],t,"identity",null),E([s],t,"keys",null),E([s],t,"values",null),E([s],t,"children",null),E([s],t,"descendants",null),t}(wr),en=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),Object.defineProperty(t.prototype,"then",{get:function(){return this},enumerable:!1,configurable:!0}),t.prototype.forSelected=function(e,t,r){var n;if(e.willSelect(this),0!==e.scopeDepth){var i=e.popScope(),o=i.evaluate(e);e.pushScope(o),n=t.call(r,e),e.swapScope(i)}return e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){return t.call(r,e)},t.prototype.substitute=function(e){return(e=Ar.fromAny(e)).peekScope().substitute(e)},t.prototype.get=function(e){return e=ir.fromAny(e),new tn(e,this)},t.prototype.getAttr=function(e){return e=hr.fromAny(e),new rn(e,this)},t.prototype.getItem=function(e){return e=yr.fromAny(e),new nn(e,this)},t.prototype.andThen=function(e){return e},t.prototype.keys=function(){return $r.keys()},t.prototype.values=function(){return $r.values()},t.prototype.children=function(){return $r.children()},t.prototype.descendants=function(){return $r.descendants()},t.prototype.filter=function(e){return 0===arguments.length?new pn(this,this):(e=Qt.fromAny(e)).filter()},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 10},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e){return this===e},t.prototype.equals=function(e){return this===e},t.prototype.hashCode=function(){return w.hash(t)},t.prototype.debugThen=function(e){return e},t.prototype.clone=function(){return this},t}($r),tn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"item",{value:t.commit(),enumerable:!0}),Object.defineProperty(n,"then",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.forSelected=function(e,r,n){e.willSelect(this);var i=this.item.evaluate(e).toValue(),o=t.forSelected(i,this.then,e,r,n);return e.didSelect(this,o),o},t.forSelected=function(e,r,n,i,o){var u;if(0!==n.scopeDepth){var s=n.popScope().toValue(),a=void 0;s instanceof or&&void 0!==(a=s.getField(e))&&(n.pushScope(a.toValue()),u=r.forSelected(n,i,o),n.popScope()),void 0===a&&void 0===u&&t.forSelected(e,r,n,i,o),n.pushScope(s)}return u},t.prototype.mapSelected=function(e,t,r){var n;e.willTransform(this);var i=this.item.evaluate(e).toValue();if(0!==e.scopeDepth){var o=e.popScope().toValue();if(o instanceof or){var u=o.getField(i);if(void 0!==u){e.pushScope(u.toValue());var s=this.then.mapSelected(e,t,r);e.popScope(),s instanceof Jt?i.equals(s.key)?o.set(i,s.toValue()):(o.delete(i),o.push(s)):s.isDefined()?o.set(i,s.toValue()):o.delete(i)}}e.pushScope(o),n=o}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.item.evaluate(e).toValue(),n=t.substitute(r,this.then,e);if(void 0!==n)return n;var i=this.then.substitute(e);return i instanceof $r||(i=this.then),new t(this.item,i)},t.substitute=function(e,r,n){var i;if(0!==n.scopeDepth){var o=n.popScope().toValue(),u=void 0;o instanceof or&&void 0!==(u=o.getField(e))&&(i=u.toValue().substitute(n)),void 0===u&&void 0===i&&t.substitute(e,r,n),n.pushScope(o)}return i},t.prototype.andThen=function(e){return new t(this.item,this.then.andThen(e))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 12},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.item.compareTo(e.item);return 0===r&&(r=this.then.compareTo(e.then)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.item.equals(e.item)&&this.then.equivalentTo(e.then,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.item.equals(e.item)&&this.then.equals(e.then))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.item.hashCode()),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("get").write(40).debug(this.item).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.item.clone(),this.then.clone())},t}($r),rn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"item",{value:t,enumerable:!0}),Object.defineProperty(n,"then",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.forSelected=function(e,r,n){e.willSelect(this);var i=this.item,o=t.forSelected(i,this.then,e,r);return e.didSelect(this,o),o},t.forSelected=function(e,r,n,i,o){var u;if(0!==n.scopeDepth){var s=n.popScope().toValue(),a=void 0;s instanceof or&&(a=s.getField(e))instanceof tr&&(n.pushScope(a.toValue()),u=r.forSelected(n,i,o),n.popScope()),void 0===a&&void 0===u&&t.forSelected(e,r,n,i,o),n.pushScope(s)}return u},t.prototype.mapSelected=function(e,t,r){var n;e.willTransform(this);var i=this.item;if(0!==e.scopeDepth){var o=e.popScope().toValue();if(o instanceof or){var u=o.getField(i);if(u instanceof tr){e.pushScope(u.toValue());var s=this.then.mapSelected(e,t,r);e.popScope(),s instanceof Jt?i.equals(s.key)?o.setAttr(i,s.toValue()):(o.delete(i),o.push(s)):s.isDefined()?o.setAttr(i,s.toValue()):o.delete(i)}}e.pushScope(o),n=o}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.item,n=t.substitute(r,this.then,e);if(void 0!==n)return n;var i=this.then.substitute(e);return i instanceof $r||(i=this.then),new t(this.item,i)},t.substitute=function(e,r,n){var i;if(0!==n.scopeDepth){var o=n.popScope().toValue(),u=void 0;o instanceof or&&(u=o.getField(e))instanceof tr&&(i=u.toValue().substitute(n)),void 0===u&&void 0===i&&t.substitute(e,r,n),n.pushScope(o)}return i},t.prototype.andThen=function(e){return new t(this.item,this.then.andThen(e))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 13},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.item.compareTo(e.item);return 0===r&&(r=this.then.compareTo(e.then)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.item.equals(e.item)&&this.then.equivalentTo(e.then,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.item.equals(e.item)&&this.then.equals(e.then))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.item.hashCode()),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("getAttr").write(40).debug(this.item).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.item.clone(),this.then.clone())},t}($r),nn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"item",{value:t,enumerable:!0}),Object.defineProperty(n,"then",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.forSelected=function(e,t,r){var n;e.willSelect(this);var i=this.item.numberValue();if(0!==e.scopeDepth){var o=e.popScope().toValue();if(o instanceof or&&i<o.length){var u=o.getItem(i);e.pushScope(u),n=this.then.forSelected(e,t,r),e.popScope()}e.pushScope(o)}return e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){var n;if(e.willTransform(this),0!==e.scopeDepth){var i=e.popScope().toValue(),o=this.item.numberValue();if(i instanceof or&&o<i.length){var u=i.getItem(o);e.pushScope(u);var s=this.then.mapSelected(e,t,r);e.popScope(),s.isDefined()?i.setItem(o,s):i.splice(o,1)}e.pushScope(i),n=i}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.item.numberValue();if(0!==e.scopeDepth){var n=e.popScope().toValue(),i=void 0;if(n instanceof or&&r<n.length)i=n.getItem(r).substitute(e);if(e.pushScope(n),void 0!==i)return i}var o=this.then.substitute(e);return o instanceof $r||(o=this.then),new t(this.item,o)},t.prototype.andThen=function(e){return new t(this.item,this.then.andThen(e))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 14},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.item.compareTo(e.item);return 0===r&&(r=this.then.compareTo(e.then)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.item.equals(e.item)&&this.then.equivalentTo(e.then,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.item.equals(e.item)&&this.then.equals(e.then))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.item.hashCode()),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("getItem").write(40).debug(this.item).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.item,this.then.clone())},t}($r),on=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"then",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.forSelected=function(e,t,r){var n;if(e.willSelect(this),0!==e.scopeDepth){var i=e.popScope();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var u=o.next().value;u instanceof Jt&&(e.pushScope(u.key),n=this.then.forSelected(e,t,r),e.popScope())}else i instanceof Jt&&(e.pushScope(i.key),n=this.then.forSelected(e,t,r),e.popScope());e.pushScope(i)}return e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){var n;if(e.willTransform(this),0!==e.scopeDepth){var i=e.popScope();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var u=o.next().value;if(u instanceof Jt){var s=u.key;e.pushScope(s);var a=this.then.mapSelected(e,t,r).toValue();e.popScope(),a.isDefined()?s!==a&&(i instanceof tr&&a instanceof hr?o.set(tr.of(a,i.toValue())):o.set($t.of(a,i.toValue()))):o.delete()}}else if(i instanceof Jt){s=i.key;e.pushScope(s);a=this.then.mapSelected(e,t,r).toValue();e.popScope(),a.isDefined()?s!==a&&(i=i instanceof tr&&a instanceof hr?tr.of(a,i.toValue()):$t.of(a,i.toValue())):i=Qt.absent()}e.pushScope(i),n=i}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.then.substitute(e);return r instanceof $r||(r=this.then),new t(r)},t.prototype.andThen=function(e){return new t(this.then.andThen(e))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 15},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.then.compareTo(e.then):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.then.equivalentTo(e.then,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.then.equals(e.then)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("keys").write(40).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.then.clone())},t}($r),un=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"then",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.forSelected=function(e,t,r){var n;if(e.willSelect(this),0!==e.scopeDepth){var i=e.popScope();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var u=o.next().value;e.pushScope(u.toValue()),n=this.then.forSelected(e,t,r),e.popScope()}else e.pushScope(i.toValue()),n=this.then.forSelected(e,t,r),e.popScope();e.pushScope(i)}return e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){var n;if(e.willTransform(this),0!==e.scopeDepth){var i=e.popScope();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var u=o.next().value;if(u instanceof Jt){var s=u.toValue();e.pushScope(s);var a=this.then.mapSelected(e,t,r);e.popScope(),a.isDefined()?a instanceof Jt?o.set(a):a!==s&&o.set(u.updatedValue(a.toValue())):o.delete()}else{e.pushScope(u.toValue());a=this.then.mapSelected(e,t,r);e.popScope(),a.isDefined()?u!==a&&o.set(a):o.delete()}}else if(i instanceof Jt){s=i.toValue();e.pushScope(s);a=this.then.mapSelected(e,t,r);e.popScope(),a.isDefined()?a instanceof Jt?i=a:a!==s&&(i=i.updatedValue(a.toValue())):i=Qt.absent()}else e.pushScope(i),i=this.then.mapSelected(e,t,r),e.popScope();e.pushScope(i),n=i}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.then.substitute(e);return r instanceof $r||(r=this.then),new t(r)},t.prototype.andThen=function(e){return new t(this.then.andThen(e))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 16},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.then.compareTo(e.then):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.then.equivalentTo(e.then,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.then.equals(e.then)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("values").write(40).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.then.clone())},t}($r),sn=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"then",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.forSelected=function(e,t,r){var n;if(e.willSelect(this),0!==e.scopeDepth){var i=e.popScope().toValue();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var u=o.next().value;e.pushScope(u),n=this.then.forSelected(e,t,r),e.popScope()}e.pushScope(i)}return e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){var n;if(e.willTransform(this),0!==e.scopeDepth){var i=e.popScope().toValue();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var u=o.next().value;e.pushScope(u);var s=this.then.mapSelected(e,t);e.popScope(),s.isDefined()?s!==u&&o.set(s):o.delete()}e.pushScope(i),n=i}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.then.substitute(e);return r instanceof $r||(r=this.then),new t(r)},t.prototype.andThen=function(e){return new t(this.then.andThen(e))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 17},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.then.compareTo(e.then):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.then.equivalentTo(e.then,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.then.equals(e.then)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("children").write(40).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.then.clone())},t}($r),an=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"then",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.forSelected=function(e,t,r){var n;if(e.willSelect(this),0!==e.scopeDepth){var i=e.popScope().toValue();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var u=o.next().value;e.pushScope(u),void 0===(n=this.then.forSelected(e,t,r))&&this.forSelected(e,t,r),e.popScope()}e.pushScope(i)}return e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){var n;if(e.willTransform(this),0!==e.scopeDepth){var i=e.popScope().toValue();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var u=o.next().value;e.pushScope(u);var s=this.then.mapSelected(e,t,r);s.isDefined()&&(s=this.mapSelected(e,t,r)),e.popScope(),s.isDefined()?s!==u&&o.set(s):o.delete()}e.pushScope(i),n=i}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.then.substitute(e);return r instanceof $r||(r=this.then),new t(r)},t.prototype.andThen=function(e){return new t(this.then.andThen(e))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 18},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?this.then.compareTo(e.then):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&this.then.equivalentTo(e.then,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&this.then.equals(e.then)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("descendants").write(40).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.then.clone())},t}($r),pn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"predicate",{value:t,enumerable:!0}),Object.defineProperty(n,"then",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.forSelected=function(e,t,r){var n;return e.willSelect(this),0!==e.scopeDepth&&this.filterSelected(e)&&(n=this.then.forSelected(e,t,r)),e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){var n;return e.willTransform(this),n=0!==e.scopeDepth?this.filterSelected(e)?this.then.mapSelected(e,t,r):e.peekScope().toValue():Qt.absent(),e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.predicate.substitute(e);r instanceof $r||(r=this.predicate);var n=this.then.substitute(e);return n instanceof $r||(n=this.then),new t(r,n)},t.prototype.filterSelected=function(e){return void 0!==this.predicate.forSelected(e,this.selected,this)},t.prototype.selected=function(e){return null},t.prototype.andThen=function(e){return new t(this.predicate,this.then.andThen(e))},t.prototype.filter=function(e){return 0===arguments.length?this:(e=Qt.fromAny(e),this.andThen(e.filter()))},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 19},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.predicate.compareTo(e.predicate);return 0===r&&(r=this.then.compareTo(e.then)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.predicate.equivalentTo(e.predicate,r)&&this.then.equivalentTo(e.then,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.predicate.equals(e.predicate)&&this.then.equals(e.then))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.predicate.hashCode()),this.then.hashCode()))},t.prototype.debugThen=function(e){return e=e.write(46).write("filter").write(40).debug(this.predicate).write(41),e=this.then.debugThen(e)},t.prototype.clone=function(){return new t(this.predicate.clone(),this.then.clone())},t}($r),fn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"item",{value:t.commit(),enumerable:!0}),Object.defineProperty(n,"then",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.forSelected=function(e,t,r){var n;if(e.willSelect(this),0!==e.scopeDepth){var i=this.item.evaluate(e);i.isDefined()&&(e.pushScope(i),n=this.then.forSelected(e,t,r),e.popScope())}return e.didSelect(this,n),n},t.prototype.mapSelected=function(e,t,r){var n;if(e.willTransform(this),0!==e.scopeDepth){var i=this.item.evaluate(e);i.isDefined()&&(e.pushScope(i),i=this.then.mapSelected(e,t,r),e.popScope()),n=i}else n=Qt.absent();return e.didTransform(this,n),n},t.prototype.substitute=function(e){e=Ar.fromAny(e);var r=this.item.substitute(e),n=this.then.substitute(e);return n instanceof $r||(n=this.then),new t(r,n)},t.prototype.andThen=function(e){return new t(this.item,this.then.andThen(e))},Object.defineProperty(t.prototype,"precedence",{get:function(){return this.item.precedence},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 11},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.item.compareTo(e.item);return 0===r&&(r=this.then.compareTo(e.then)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.item.equivalentTo(e.item,r)&&this.then.equivalentTo(e.then,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.item.equals(e.item)&&this.then.equals(e.then))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.item.hashCode()),this.then.hashCode()))},t.prototype.debug=function(e){return e=e.write("Selector").write(46).write("literal").write(40).debug(this.item).write(41),e=this.then.debugThen(e)},t.prototype.debugThen=function(e){return e},t.prototype.clone=function(){return new t(this.item.clone(),this.then.clone())},t}($r),cn=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isConstant=function(){return!1},t.prototype.expand=function(e,t,r){},t}(wr),ln=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"bindings",{value:t,enumerable:!0}),Object.defineProperty(n,"template",{value:r,enumerable:!0}),n}return C(t,e),Object.defineProperty(t.prototype,"precedence",{get:function(){return 1},enumerable:!1,configurable:!0}),t.prototype.invoke=function(e,t,r){t=Ar.fromAny(t);for(var n=this.bindings,i=Math.max(1,n.length),o=or.create(i),u=0,s=0;u<i;){var a=n instanceof or?n.getItem(u):0===u?n:Qt.absent(),p=e instanceof or?e.getItem(s).toValue():0===s?e:ir.absent();a instanceof hr&&p.isDistinct()?(o.push($t.of(a,p)),s+=1):a instanceof $t&&(p.isDistinct()?o.push(a.updatedValue(p)):o.push(a),s+=1),u+=1}t.pushScope(o);var f=this.template.evaluate(t);return t.popScope(),f},Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 50},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){if(e instanceof t){var r=this.bindings.compareTo(e.bindings);return 0===r&&(r=this.template.compareTo(e.template)),r}return e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(this.bindings.equivalentTo(e.bindings,r)&&this.template.equivalentTo(e.template,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.bindings.equals(e.bindings)&&this.template.equals(e.template))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.bindings.hashCode()),this.template.hashCode()))},t.prototype.debug=function(e){return e=e.debug(this.bindings).write(46).write("lambda").write(40).debug(this.template).write(41)},t}(cn),hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),Object.defineProperty(t.prototype,"typeOrder",{get:function(){return 51},enumerable:!1,configurable:!0}),t.prototype.compareTo=function(e){return e instanceof t?w.compare(this.constructor,e.constructor):e instanceof Qt?b.compare(this.typeOrder,e.typeOrder):NaN},t.prototype.equivalentTo=function(e){return this===e},t.prototype.equals=function(e){return this===e},t.prototype.hashCode=function(){return w.hash(this.constructor)},t.prototype.debug=function(e){return e=e.write(this.constructor.name)},t}(cn),dn={};Object.defineProperty(dn,"max",{get:function(){var e=new yn;return Object.defineProperty(dn,"max",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"min",{get:function(){var e=new vn;return Object.defineProperty(dn,"min",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"abs",{get:function(){var e=new bn;return Object.defineProperty(dn,"abs",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"ceil",{get:function(){var e=new mn;return Object.defineProperty(dn,"ceil",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"floor",{get:function(){var e=new gn;return Object.defineProperty(dn,"floor",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"round",{get:function(){var e=new wn;return Object.defineProperty(dn,"round",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"sqrt",{get:function(){var e=new On;return Object.defineProperty(dn,"sqrt",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"pow",{get:function(){var e=new Pn;return Object.defineProperty(dn,"pow",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"rate",{get:function(){var e=new xn;return Object.defineProperty(dn,"rate",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"random",{get:function(){var e=new jn;return Object.defineProperty(dn,"random",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"scope",{get:function(){var e=or.create(10).slot("max",dn.max).slot("min",dn.min).slot("abs",dn.abs).slot("ceil",dn.ceil).slot("floor",dn.floor).slot("round",dn.round).slot("pow",dn.pow).slot("sqrt",dn.sqrt).slot("rate",dn.rate).slot("random",dn.random).commit();return Object.defineProperty(dn,"scope",{value:e,configurable:!0,enumerable:!0}),e},configurable:!0,enumerable:!0});var yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){var n,i;if(t=Ar.fromAny(t),e.length>=2?(n=e.getItem(0).evaluate(t),i=e.getItem(1).evaluate(t)):n=e.evaluate(t),void 0!==i)return n.max(i);if(void 0!==r){var o=void 0!==(i=r.state)?n.max(i):n;return r.setState(o),o}return Qt.absent()},t.prototype.expand=function(e,t,r){if(1===e.length)return e=e.evaluate(t).toValue(),this.invoke(e,t,r)},t}(hn),vn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){var n,i;if(t=Ar.fromAny(t),e.length>=2?(n=e.getItem(0).evaluate(t),i=e.getItem(1).evaluate(t)):n=e.evaluate(t),void 0!==i)return n.min(i);if(void 0!==r){var o=void 0!==(i=r.state)?n.min(i):n;return r.setState(o),o}return Qt.absent()},t.prototype.expand=function(e,t,r){if(1===e.length)return e=e.evaluate(t).toValue(),this.invoke(e,t,r)},t}(hn),bn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){return(e=e.evaluate(t).toValue())instanceof yr?e.abs():Qt.absent()},t}(hn),mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){return(e=e.evaluate(t).toValue())instanceof yr?e.ceil():Qt.absent()},t}(hn),gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){return(e=e.evaluate(t).toValue())instanceof yr?e.floor():Qt.absent()},t}(hn),wn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){return(e=e.evaluate(t).toValue())instanceof yr?e.round():Qt.absent()},t}(hn),On=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){return(e=e.evaluate(t).toValue())instanceof yr?e.sqrt():Qt.absent()},t}(hn),Pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){t=Ar.fromAny(t);var n=e.getItem(0).evaluate(t),i=e.getItem(1).evaluate(t);return n instanceof yr&&i instanceof yr?n.pow(i):Qt.absent()},t}(hn),xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){var n,i;if(t=Ar.fromAny(t),e.length>=2?(n=e.getItem(0).evaluate(t).numberValue(NaN),i=e.getItem(1).evaluate(t).numberValue(1e3)):(n=e.evaluate(t).numberValue(NaN),i=1e3),isFinite(n)&&void 0!==r){var o=r.state;if(void 0===o)o={v0:n,t0:Date.now(),dv:0,dt:0},r.setState(o);else{var u=Date.now(),s=u-o.t0;if(s>i&&u>o.t0||s>2*i){var a=n-o.v0;o.v0=n,o.t0=u,o.dv=a,o.dt=s}if(r.setState(o),0!==o.dt){var p=i*o.dv/o.dt;return yr.from(p)}}}return Qt.absent()},t.prototype.expand=function(e,t,r){return e=e.evaluate(t).toValue(),this.invoke(e,t,r)},t}(hn),jn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.invoke=function(e,t,r){var n=(e=e.evaluate(t).toValue()).length>=1?e.getItem(0).numberValue(0):0,i=e.length>=2?e.getItem(1).numberValue(n+1):n+1,o=n+Math.random()*(i-n);return yr.from(o)},t}(hn),Cn=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),En=function(){function e(){}return e.prototype.withTag=function(e){return void 0!==e&&e!==this.tag?new Sn(this,e):this},e.prototype.withUnit=function(e){return e!==this.unit?new kn(this,e):this},e.forString=function(){return new An("")},e.forNumber=function(){return new Dn(0)},e.forBoolean=function(){return new In(!1)},e.forAny=function(){return new Tn(void 0)},e.forItem=function(){return new Vn(Qt.absent())},e.forValue=function(){return new qn(ir.absent())},E([s],e,"forString",null),E([s],e,"forNumber",null),E([s],e,"forBoolean",null),E([s],e,"forAny",null),E([s],e,"forItem",null),E([s],e,"forValue",null),e}();Object.defineProperty(En.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(En.prototype,"unit",{get:function(){},enumerable:!0,configurable:!0});var Sn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"form",{value:t,enumerable:!0}),Object.defineProperty(n,"tag",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.withTag=function(e){return void 0!==e&&e!==this.tag?new t(this.form,e):void 0===e?this.form:this},t.prototype.withUnit=function(e){return e!==this.unit?new t(this.form.withUnit(e),this.tag):this},t.prototype.mold=function(e,t){return(t=this.form.mold(e,t)).header(this.tag).isDefined()||(t=t.prepended(tr.of(this.tag))),t},t.prototype.cast=function(e,t){return e.header(this.tag).isDefined()?this.form.cast(e,t):e.keyEquals(this.tag)?this.form.cast(e.toValue(),t):void 0},t}(En);Object.defineProperty(Sn.prototype,"unit",{get:function(){return this.form.unit},enumerable:!0,configurable:!0});var kn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"form",{value:t,enumerable:!0}),Object.defineProperty(n,"unit",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.withTag=function(e){return e!==this.tag?new t(this.form.withTag(e),this.unit):this},t.prototype.withUnit=function(e){return e!==this.unit?new t(this.form,e):e===this.form.unit?this.form:this},t.prototype.mold=function(e,t){return 1===arguments.length?this.form.mold(e):this.form.mold(e,t)},t.prototype.cast=function(e,t){return 1===arguments.length?this.form.cast(e):this.form.cast(e,t)},t}(En);Object.defineProperty(kn.prototype,"tag",{get:function(){return this.form.tag},enumerable:!0,configurable:!0});var Mn,An=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return void 0===t?hr.from(e):t.concat(hr.from(e))},t.prototype.cast=function(e,t){var r=e.target;try{return r.stringValue()}catch(e){return}},t}(En),Dn=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return void 0===t?yr.from(e):t.concat(yr.from(e))},t.prototype.cast=function(e,t){var r=e.target;try{return r.numberValue()}catch(e){return}},t}(En),In=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return void 0===t?br.from(e):t.concat(br.from(e))},t.prototype.cast=function(e,t){var r=e.target;try{return r.booleanValue()}catch(e){return}},t}(En),Tn=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return e=Qt.fromAny(e),void 0!==t&&(e=t.concat(e)),e},t.prototype.cast=function(e,t){return e.toAny()},t}(En),Vn=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:void 0!==t?t.commit():void 0,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return e=Qt.fromAny(e),void 0!==t&&(e=t.concat(e)),e},t.prototype.cast=function(e,t){return e},t}(En),qn=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:void 0!==t?t.commit():void 0,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return e=ir.fromAny(e),void 0!==t&&(e=t.concat(e)),e},t.prototype.cast=function(e,t){return e.toValue()},t}(En),Rn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"cursor",{value:t,enumerable:!0}),Object.defineProperty(n,"form",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.isEmpty=function(){return this.cursor.isEmpty()},t.prototype.head=function(){return this.cursor.head().coerce(this.form)},t.prototype.step=function(){this.cursor.step()},t.prototype.skip=function(e){this.cursor.skip(e)},t.prototype.hasNext=function(){return this.cursor.hasNext()},t.prototype.nextIndex=function(){return this.cursor.nextIndex()},t.prototype.next=function(){var e=this.cursor.next(),t=e.value,r=e.done;return void 0!==t?{value:t.coerce(this.form),done:r}:{done:r}},t.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},t.prototype.previousIndex=function(){return this.cursor.previousIndex()},t.prototype.previous=function(){var e=this.cursor.previous(),t=e.value,r=e.done;return void 0!==t?{value:t.coerce(this.form),done:r}:{done:r}},t.prototype.delete=function(){this.cursor.delete()},t}(k),Un=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"cursor",{value:t,enumerable:!0}),Object.defineProperty(i,"keyForm",{value:r,enumerable:!0}),Object.defineProperty(i,"valueForm",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.isEmpty=function(){return this.cursor.isEmpty()},t.prototype.head=function(){var e=this.cursor.head();return[e[0].coerce(this.keyForm),e[1].coerce(this.valueForm)]},t.prototype.step=function(){this.cursor.step()},t.prototype.skip=function(e){this.cursor.skip(e)},t.prototype.hasNext=function(){return this.cursor.hasNext()},t.prototype.nextIndex=function(){return this.cursor.nextIndex()},t.prototype.next=function(){var e=this.cursor.next(),t=e.value,r=e.done;return void 0!==t?{value:[t[0].coerce(this.keyForm),t[1].coerce(this.valueForm)],done:r}:{done:r}},t.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},t.prototype.previousIndex=function(){return this.cursor.previousIndex()},t.prototype.previous=function(){var e=this.cursor.previous(),t=e.value,r=e.done;return void 0!==t?{value:[t[0].coerce(this.keyForm),t[1].coerce(this.valueForm)],done:r}:{done:r}},t.prototype.delete=function(){this.cursor.delete()},t}(k),Nn={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"input"in t&&"function"==typeof t.bindInput&&"function"==typeof t.unbindInput}return!1}},zn={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"function"==typeof t.outputIterator&&"function"==typeof t.bindOutput&&"function"==typeof t.unbindOutput}return!1}},Fn={};Fn.define=function(e){Object.prototype.hasOwnProperty.call(e,"memoize")||(e.memoize=Fn.memoize),Object.prototype.hasOwnProperty.call(e,"map")||(e.map=Fn.map),Object.prototype.hasOwnProperty.call(e,"watch")||(e.watch=Fn.watch)},Fn.memoize=function(){var e=new ai;return e.bindInput(this),e},Fn.map=function(e){var t=new hi(e);return t.bindInput(this),t},Fn.watch=function(e){return new gi(e).bindInput(this),this},e.KeyEffect=void 0,(Mn=e.KeyEffect||(e.KeyEffect={}))[Mn.Update=0]="Update",Mn[Mn.Remove=1]="Remove";var Ln={is:function(e){if("object"==typeof e&&null!==e){var t=e;return Nn.is(t)&&"function"==typeof t.decohereOutputKey&&"function"==typeof t.recohereOutputKey}return!1}},Kn={is:function(e){if("object"==typeof e&&null!==e){var t=e;return zn.is(t)&&"function"==typeof t.keyIterator&&"function"==typeof t.outlet}return!1}},Bn={define:function(e){Object.prototype.hasOwnProperty.call(e,"memoize")||(e.memoize=Bn.memoize),Object.prototype.hasOwnProperty.call(e,"filterr")||(e.filter=Bn.filter),Object.prototype.hasOwnProperty.call(e,"map")||(e.map=Bn.map),Object.prototype.hasOwnProperty.call(e,"reduce")||(e.reduce=Bn.reduce),Object.prototype.hasOwnProperty.call(e,"watch")||(e.watch=Bn.watch)},memoize:function(){var e=new pi;return e.bindInput(this),e},filter:function(e){var t=new ci(e);return t.bindInput(this),t},map:function(e){var t;return 1===e.length?((t=new hi(e)).bindInput(this),t):((t=new yi(e)).bindInput(this),t)},reduce:function(e,t,r){var n=new bi(e,t,r);return n.bindInput(this),n},watch:function(e){return 1===e.length?(new gi(e).bindInput(this),this):(new Oi(e).bindInput(this),this)}},Wn=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),Hn={is:function(e){if("object"==typeof e&&null!==e){return"streamletScope"in e&&"streamletContext"in e&&"function"==typeof e.outlet}return!1}},Xn={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"streamletScope"in t&&"function"==typeof t.setStreamletScope&&"streamletContext"in t&&"function"==typeof t.setStreamletContext}return!1}},Yn=function(){function e(){Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.bindInput=function(e){var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},e.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},e.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},e.prototype.disconnectOutputs=function(){},e.prototype.decohereOutput=function(){this.version>=0&&(this.willDecohereOutput(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereOutput(),this.didDecohereOutput())},e.prototype.recohereOutput=function(e){this.version<0&&(this.willRecohereOutput(e),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInput(e),this.onRecohereOutput(e),this.didRecohereOutput(e))},e.prototype.willDecohereOutput=function(){},e.prototype.onDecohereOutput=function(){},e.prototype.didDecohereOutput=function(){},e.prototype.willRecohereOutput=function(e){},e.prototype.onRecohereOutput=function(e){},e.prototype.didRecohereOutput=function(e){},e}(),Gn=function(){function e(){Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.outputIterator=function(){return k.array(this.outputs)},e.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){e[t].unbindInput()}},e.prototype.disconnectOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){var n=e[t];n.unbindInput(),n.disconnectOutputs()}},e.prototype.disconnectInputs=function(){},e.prototype.decohereInput=function(){if(this.version>=0){this.willDecohereInput(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereInput();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1)e[t].decohereOutput();this.didDecohereInput()}},e.prototype.recohereInput=function(e){if(this.version<0){this.willRecohereInput(e),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohereInput(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1)t[r].recohereOutput(e);this.didRecohereInput(e)}},e.prototype.willDecohereInput=function(){},e.prototype.onDecohereInput=function(){},e.prototype.didDecohereInput=function(){},e.prototype.willRecohereInput=function(e){},e.prototype.onRecohereInput=function(e){},e.prototype.didRecohereInput=function(e){},e}();Fn.define(Gn.prototype);var _n=function(){function e(){Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.bindInput=function(e){var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},e.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},e.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},e.prototype.outputIterator=function(){return k.array(this.outputs)},e.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){e[t].unbindInput()}},e.prototype.disconnectOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){var n=e[t];n.unbindInput(),n.disconnectOutputs()}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1)e[t].decohereOutput();this.didDecohere()}},e.prototype.recohereOutput=function(e){this.recohere(e)},e.prototype.recohereInput=function(e){this.recohere(e)},e.prototype.recohere=function(e){if(this.version<0){this.willRecohere(e),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInput(e),this.onRecohere(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1)t[r].recohereOutput(e);this.didRecohere(e)}},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohere=function(e){},e.prototype.onRecohere=function(e){},e.prototype.didRecohere=function(e){},e}();Fn.define(_n.prototype);var Qn=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"input",{value:t,enumerable:!0}),Object.defineProperty(n,"key",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.get=function(){return this.input.get(this.key)},t}(Gn),Zn=function(){function e(){Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"effects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.bindInput=function(e){if(!Kn.is(e))throw new TypeError(""+e);var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},e.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},e.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},e.prototype.disconnectOutputs=function(){},e.prototype.decohereOutputKey=function(e,t){var r=this.effects;r.get(e)!==t&&(this.willDecohereOutputKey(e,t),Object.defineProperty(this,"effects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereOutputKey(e,t),this.didDecohereOutputKey(e,t))},e.prototype.decohereOutput=function(){this.version>=0&&(this.willDecohereOutput(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereOutput(),this.didDecohereOutput())},e.prototype.recohereOutputKey=function(e,t){if(this.version<0){var r=this.effects,n=r.get(e);void 0!==n&&(this.willRecohereOutputKey(e,n,t),Object.defineProperty(this,"effects",{value:r.removed(e),enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInputKey(e,t),this.onRecohereOutputKey(e,n,t),this.didRecohereOutputKey(e,n,t))}},e.prototype.recohereOutput=function(e){this.version<0&&(this.willRecohereOutput(e),this.effects.forEach((function(t){this.recohereOutputKey(t,e)}),this),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohereOutput(e),this.didRecohereOutput(e))},e.prototype.willDecohereOutputKey=function(e,t){},e.prototype.onDecohereOutputKey=function(e,t){},e.prototype.didDecohereOutputKey=function(e,t){},e.prototype.willDecohereOutput=function(){},e.prototype.onDecohereOutput=function(){},e.prototype.didDecohereOutput=function(){},e.prototype.willRecohereOutputKey=function(e,t,r){},e.prototype.onRecohereOutputKey=function(e,t,r){},e.prototype.didRecohereOutputKey=function(e,t,r){},e.prototype.willRecohereOutput=function(e){},e.prototype.onRecohereOutput=function(e){},e.prototype.didRecohereOutput=function(e){},e}(),Jn=function(){function e(){Object.defineProperty(this,"effects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.outlet=function(e){var t=this.outlets,r=t.get(e);return void 0===r&&(r=new Qn(this,e),Object.defineProperty(this,"outlets",{value:t.updated(e,r),enumerable:!0,configurable:!0})),r},e.prototype.outputIterator=function(){return k.array(this.outputs)},e.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.unbindOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){t[r].unbindInput()}},e.prototype.disconnectOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.disconnectOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){var i=t[r];i.unbindInput(),i.disconnectOutputs()}},e.prototype.disconnectInputs=function(){},e.prototype.decohereInputKey=function(e,t){var r=this.effects;if(r.get(e)!==t){this.willDecohereInputKey(e,t),Object.defineProperty(this,"effects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereInputKey(e,t);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var u=n[i];Ln.is(u)?u.decohereOutputKey(e,t):u.decohereOutput()}var s=this.outlets.get(e);void 0!==s&&s.decohereInput(),this.didDecohereInputKey(e,t)}},e.prototype.decohereInput=function(){if(this.version>=0){this.willDecohereInput(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereInput();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1){e[t].decohereOutput()}this.outlets.forEach((function(e,t){t.decohereInput()}),this),this.didDecohereInput()}},e.prototype.recohereInputKey=function(e,t){if(this.version<0){var r=this.effects,n=r.get(e);if(void 0!==n){this.willRecohereInputKey(e,n,t),Object.defineProperty(this,"effects",{value:r.removed(e),enumerable:!0,configurable:!0}),this.onRecohereInputKey(e,n,t);for(var i=this.outputs,o=0,u=i.length;o<u;o+=1){var s=i[o];Ln.is(s)&&s.recohereOutputKey(e,t)}var a=this.outlets.get(e);void 0!==a&&a.recohereInput(t),this.didRecohereInputKey(e,n,t)}}},e.prototype.recohereInput=function(e){if(this.version<0){this.willRecohereInput(e),this.effects.forEach((function(t){this.recohereInputKey(t,e)}),this),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohereInput(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1){t[r].recohereOutput(e)}this.didRecohereInput(e)}},e.prototype.willDecohereInputKey=function(e,t){},e.prototype.onDecohereInputKey=function(e,t){},e.prototype.didDecohereInputKey=function(e,t){},e.prototype.willDecohereInput=function(){},e.prototype.onDecohereInput=function(){},e.prototype.didDecohereInput=function(){},e.prototype.willRecohereInputKey=function(e,t,r){},e.prototype.onRecohereInputKey=function(e,t,r){},e.prototype.didRecohereInputKey=function(e,t,r){},e.prototype.willRecohereInput=function(e){},e.prototype.onRecohereInput=function(e){},e.prototype.didRecohereInput=function(e){},e}();Bn.define(Jn.prototype);var $n=function(){function e(){Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"effects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.bindInput=function(e){if(!Kn.is(e))throw new TypeError(""+e);var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},e.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},e.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},e.prototype.outlet=function(e){var t=this.outlets,r=t.get(e);return void 0===r&&(r=new Qn(this,e),Object.defineProperty(this,"outlets",{value:t.updated(e,r),enumerable:!0,configurable:!0})),r},e.prototype.outputIterator=function(){return k.array(this.outputs)},e.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.unbindOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){t[r].unbindInput()}},e.prototype.disconnectOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.disconnectOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){var i=t[r];i.unbindInput(),i.disconnectOutputs()}},e.prototype.decohereOutputKey=function(e,t){this.decohereKey(e,t)},e.prototype.decohereInputKey=function(e,t){this.decohereKey(e,t)},e.prototype.decohereKey=function(e,t){var r=this.effects;if(r.get(e)!==t){this.willDecohereKey(e,t),Object.defineProperty(this,"effects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereKey(e,t);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var u=n[i];Ln.is(u)?u.decohereOutputKey(e,t):u.decohereOutput()}var s=this.outlets.get(e);void 0!==s&&s.decohereInput(),this.didDecohereKey(e,t)}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1){e[t].decohereOutput()}this.outlets.forEach((function(e,t){t.decohereInput()}),this),this.didDecohere()}},e.prototype.recohereOutputKey=function(e,t){this.recohereKey(e,t)},e.prototype.recohereInputKey=function(e,t){this.recohereKey(e,t)},e.prototype.recohereKey=function(e,t){if(this.version<0){var r=this.effects,n=r.get(e);if(void 0!==n){this.willRecohereKey(e,n,t),Object.defineProperty(this,"effects",{value:r.removed(e),enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInputKey(e,t),this.onRecohereKey(e,n,t);for(var i=this.outputs,o=0,u=i.length;o<u;o+=1){var s=i[o];Ln.is(s)&&s.recohereOutputKey(e,t)}var a=this.outlets.get(e);void 0!==a&&a.recohereInput(t),this.didRecohereKey(e,n,t)}}},e.prototype.recohereOutput=function(e){this.recohere(e)},e.prototype.recohereInput=function(e){this.recohere(e)},e.prototype.recohere=function(e){if(this.version<0){this.willRecohere(e),this.effects.forEach((function(t){this.recohereKey(t,e)}),this),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohere(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1){t[r].recohereOutput(e)}this.didRecohere(e)}},e.prototype.willDecohereKey=function(e,t){},e.prototype.onDecohereKey=function(e,t){},e.prototype.didDecohereKey=function(e,t){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohereKey=function(e,t,r){},e.prototype.onRecohereKey=function(e,t,r){},e.prototype.didRecohereKey=function(e,t,r){},e.prototype.willRecohere=function(e){},e.prototype.onRecohere=function(e){},e.prototype.didRecohere=function(e){},e}();Bn.define($n.prototype);var ei=function(){function e(){Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"effects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.bindInput=function(e){if(!Kn.is(e))throw new TypeError(""+e);var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},e.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},e.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},e.prototype.outputIterator=function(){return k.array(this.outputs)},e.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){e[t].unbindInput()}},e.prototype.disconnectOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){var n=e[t];n.unbindInput(),n.disconnectOutputs()}},e.prototype.decohereOutputKey=function(e,t){var r=this.effects;if(r.get(e)!==t){this.willDecohereOutputKey(e,t),Object.defineProperty(this,"effects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereOutputKey(e,t);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){n[i].decohereOutput()}this.didDecohereOutputKey(e,t)}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1){e[t].decohereOutput()}this.didDecohere()}},e.prototype.recohereOutputKey=function(e,t){if(this.version<0){var r=this.effects,n=r.get(e);void 0!==n&&(this.willRecohereOutputKey(e,n,t),Object.defineProperty(this,"effects",{value:r.removed(e),enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInputKey(e,t),this.onRecohereOutputKey(e,n,t),this.didRecohereOutputKey(e,n,t))}},e.prototype.recohereOutput=function(e){this.recohere(e)},e.prototype.recohereInput=function(e){this.recohere(e)},e.prototype.recohere=function(e){if(this.version<0){this.willRecohere(e),this.effects.forEach((function(t){this.recohereOutputKey(t,e)}),this),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohere(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1){t[r].recohereOutput(e)}this.didRecohere(e)}},e.prototype.willDecohereOutputKey=function(e,t){},e.prototype.onDecohereOutputKey=function(e,t){},e.prototype.didDecohereOutputKey=function(e,t){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohereOutputKey=function(e,t,r){},e.prototype.onRecohereOutputKey=function(e,t,r){},e.prototype.didRecohereOutputKey=function(e,t,r){},e.prototype.willRecohere=function(e){},e.prototype.onRecohere=function(e){},e.prototype.didRecohere=function(e){},e}();Fn.define(ei.prototype);var ti=function(){function e(){Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outputEffects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"inputEffects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.bindInput=function(e){if(!Kn.is(e))throw new TypeError(""+e);var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},e.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},e.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},e.prototype.outlet=function(e){var t=this.outlets,r=t.get(e);return void 0===r&&(r=new Qn(this,e),Object.defineProperty(this,"outlets",{value:t.updated(e,r),enumerable:!0,configurable:!0})),r},e.prototype.outputIterator=function(){return k.array(this.outputs)},e.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},e.prototype.unbindOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.unbindOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){t[r].unbindInput()}},e.prototype.disconnectOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.disconnectOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){var i=t[r];i.unbindInput(),i.disconnectOutputs()}},e.prototype.decohereOutputKey=function(e,t){var r=this.outputEffects;r.get(e)!==t&&(this.willDecohereOutputKey(e,t),Object.defineProperty(this,"outputEffects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereOutputKey(e,t),this.didDecohereOutputKey(e,t))},e.prototype.decohereInputKey=function(e,t){var r=this.inputEffects;if(r.get(e)!==t){this.willDecohereInputKey(e,t),Object.defineProperty(this,"inputEffects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereInputKey(e,t);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var u=n[i];Ln.is(u)?u.decohereOutputKey(e,t):u.decohereOutput()}var s=this.outlets.get(e);void 0!==s&&s.decohereInput(),this.didDecohereInputKey(e,t)}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1){e[t].decohereOutput()}this.outlets.forEach((function(e,t){t.decohereInput()}),this),this.didDecohere()}},e.prototype.recohereOutputKey=function(e,t){if(this.version<0){var r=this.outputEffects,n=r.get(e);void 0!==n&&(this.willRecohereOutputKey(e,n,t),Object.defineProperty(this,"outputEffects",{value:r.removed(e),enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInputKey(e,t),this.onRecohereOutputKey(e,n,t),this.didRecohereOutputKey(e,n,t))}},e.prototype.recohereInputKey=function(e,t){if(this.version<0){var r=this.inputEffects,n=r.get(e);if(void 0!==n){var i=this.willRecohereInputKey(e,n,t);n!==i&&this.decohereInputKey(e,i),Object.defineProperty(this,"inputEffects",{value:r.removed(e),enumerable:!0,configurable:!0}),this.onRecohereInputKey(e,i,t);for(var o=this.outputs,u=0,s=o.length;u<s;u+=1){var a=o[u];Ln.is(a)&&a.recohereOutputKey(e,t)}var p=this.outlets.get(e);void 0!==p&&p.recohereInput(t),this.didRecohereInputKey(e,i,t)}}},e.prototype.recohereOutput=function(e){this.recohere(e)},e.prototype.recohereInput=function(e){this.recohere(e)},e.prototype.recohere=function(e){if(this.version<0){this.willRecohere(e),this.outputEffects.forEach((function(t){this.recohereOutputKey(t,e)}),this),this.inputEffects.forEach((function(t){this.recohereInputKey(t,e)}),this),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohere(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1){t[r].recohereOutput(e)}this.didRecohere(e)}},e.prototype.willDecohereOutputKey=function(e,t){},e.prototype.onDecohereOutputKey=function(e,t){},e.prototype.didDecohereOutputKey=function(e,t){},e.prototype.willDecohereInputKey=function(e,t){},e.prototype.onDecohereInputKey=function(e,t){},e.prototype.didDecohereInputKey=function(e,t){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohereOutputKey=function(e,t,r){},e.prototype.onRecohereOutputKey=function(e,t,r){},e.prototype.didRecohereOutputKey=function(e,t,r){},e.prototype.willRecohereInputKey=function(e,t,r){return t},e.prototype.onRecohereInputKey=function(e,t,r){},e.prototype.didRecohereInputKey=function(e,t,r){},e.prototype.willRecohere=function(e){},e.prototype.onRecohere=function(e){},e.prototype.didRecohere=function(e){},e}();Bn.define(ti.prototype);var ri=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"outlet",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.onDecohereOutput=function(){this.outlet.decohereInput()},t.prototype.onRecohereOutput=function(e){this.outlet.recohereInput(e)},t}(Yn),ni=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"outlet",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.onDecohereOutputKey=function(e,t){this.outlet.decohereInput()},t.prototype.onDecohereOutput=function(){this.outlet.decohereInput()},t.prototype.onRecohereOutputKey=function(e,t,r){this.outlet.recohereInput(r)},t.prototype.onRecohereOutput=function(e){this.outlet.recohereInput(e)},t}(Zn),ii=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"state",{value:t,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.get=function(){return this.state},t.prototype.set=function(e){var t=this.state;return t!==e&&(Object.defineProperty(this,"state",{value:e,enumerable:!0,configurable:!0}),this.decohereInput()),t},t}(Gn),oi=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"state",{value:t,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.get=function(){return this.state},t.prototype.onRecohereOutput=function(e){var t=this.input;null!==t&&Object.defineProperty(this,"state",{value:t.get(),enumerable:!0,configurable:!0})},t}(Yn),ui=function(e){function t(t){var r=e.call(this)||this;void 0===t&&(t=new Ot),Object.defineProperty(r,"state",{value:t,enumerable:!0,configurable:!0});var n=r.effects;return t.forEach((function(e){n=n.updated(e,0)}),r),Object.defineProperty(r,"effects",{value:n,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.has=function(e){return this.state.has(e)},t.prototype.get=function(e){return void 0===e?this.state:this.state.get(e)},t.prototype.set=function(e,t){var r=this.state,n=r.get(e);return n!==t&&(Object.defineProperty(this,"state",{value:r.updated(e,t),enumerable:!0,configurable:!0}),this.decohereInputKey(e,0)),n},t.prototype.delete=function(e){var t=this.state,r=t.removed(e);return t!==r&&(Object.defineProperty(this,"state",{value:r,enumerable:!0,configurable:!0}),this.decohereInputKey(e,1)),this},t.prototype.keyIterator=function(){return this.state.keys()},t}(Jn),si=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"state",{value:new Ot,enumerable:!0,configurable:!0}),t}return C(t,e),t.prototype.get=function(){return this.state},t.prototype.onRecohereOutputKey=function(e,t,r){if(0===t){var n=this.input;if(null!==n){var i=n.get(e);void 0!==i?Object.defineProperty(this,"state",{value:this.state.updated(e,i),enumerable:!0,configurable:!0}):Object.defineProperty(this,"state",{value:this.state.removed(e),enumerable:!0,configurable:!0})}}else 1===t&&Object.defineProperty(this,"state",{value:this.state.removed(e),enumerable:!0,configurable:!0})},t}(Zn),ai=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"state",{value:void 0,enumerable:!0,configurable:!0}),t}return C(t,e),t.prototype.get=function(){return this.state},t.prototype.onRecohere=function(e){var t=this.input;null!==t&&Object.defineProperty(this,"state",{value:t.get(),enumerable:!0,configurable:!0})},t.prototype.memoize=function(){return this},t}(_n),pi=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"state",{value:void 0,enumerable:!0,configurable:!0}),Object.defineProperty(t,"cache",{value:new Ot,enumerable:!0,configurable:!0}),t}return C(t,e),t.prototype.has=function(e){return this.cache.has(e)},t.prototype.get=function(e){if(void 0===e){var t=this.state,r=this.input;return void 0===t&&null!==r&&(t=r.get(),Object.defineProperty(this,"state",{value:t,enumerable:!0,configurable:!0})),t}return this.cache.get(e)},t.prototype.keyIterator=function(){return this.cache.keys()},t.prototype.onRecohereKey=function(e,t,r){if(0===t){var n=this.input;if(null!==n){var i=n.get(e);void 0!==i?Object.defineProperty(this,"cache",{value:this.cache.updated(e,i),enumerable:!0,configurable:!0}):Object.defineProperty(this,"cache",{value:this.cache.removed(e),enumerable:!0,configurable:!0})}}else 1===t&&Object.defineProperty(this,"cache",{value:this.cache.removed(e),enumerable:!0,configurable:!0})},t.prototype.onRecohere=function(e){Object.defineProperty(this,"state",{value:void 0,enumerable:!0,configurable:!0})},t.prototype.memoize=function(){return this},t}($n),fi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.has=function(e){var t=this.input;if(null!==t){var r=t.get(e);return void 0!==r&&this.evaluate(e,r)}return!1},t.prototype.get=function(e){if(void 0===e){for(var t=new Ot,r=this.keyIterator();;){var n=r.next();if(n.done)break;var i=n.value;void 0!==(o=this.input.get(i))&&this.evaluate(i,o)&&t.set(i,o)}return t}var o,u=this.input;if(null!==u&&void 0!==(o=u.get(e))&&this.evaluate(e,o))return o},t.prototype.keyIterator=function(){var e=this.input;return null!==e?e.keyIterator():k.empty()},t.prototype.onDecohereOutputKey=function(e,t){this.decohereInputKey(e,t)},t.prototype.onRecohereOutputKey=function(e,t,r){this.recohereInputKey(e,r)},t.prototype.willRecohereInputKey=function(e,t,r){if(0===t){var n=this.input;if(null!==n){var i=n.get(e);if(void 0===i||!this.evaluate(e,i))return 1}}return t},t}(ti),ci=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"func",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.evaluate=function(e,t){return(0,this.func)(e,t)},t}(fi),li=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.get=function(){var e=this.input;return null!==e?this.evaluate(e.get()):void 0},t}(_n),hi=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"func",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.evaluate=function(e){return void 0!==e?(0,this.func)(e):void 0},t}(li),di=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.has=function(e){var t=this.input;return null!==t&&t.has(e)},t.prototype.get=function(e){if(void 0===e){for(var t=new Ot,r=this.keyIterator();;){var n=r.next();if(n.done)break;var i=n.value,o=this.evaluate(i,this.input.get(i));void 0!==o&&t.set(i,o)}return t}var u=this.input;return null!==u?this.evaluate(e,u.get(e)):void 0},t.prototype.keyIterator=function(){var e=this.input;return null!==e?e.keyIterator():k.empty()},t}($n),yi=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"func",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.evaluate=function(e,t){return void 0!==t?(0,this.func)(e,t):void 0},t}(di),vi=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"state",{value:new Ot,enumerable:!0,configurable:!0}),t}return C(t,e),t.prototype.get=function(){return this.state.reduced(this.identity,this.accumulate.bind(this),this.combine.bind(this))},t.prototype.onRecohereOutputKey=function(e,t,r){if(0===t){var n=this.input;if(null!==n){var i=n.get(e);void 0!==i?this.state.set(e,i):this.state.delete(e)}}else 1===t&&this.state.delete(e)},t}(ei),bi=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"identity",{value:t,enumerable:!0}),Object.defineProperty(i,"accumulator",{value:r,enumerable:!0}),Object.defineProperty(i,"combiner",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.get=function(){return this.state.reduced(this.identity,this.accumulator,this.combiner)},t.prototype.accumulate=function(e,t){return(0,this.accumulator)(e,t)},t.prototype.combine=function(e,t){return(0,this.combiner)(e,t)},t}(vi),mi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.onRecohereOutput=function(e){var t=this.input;null!==t&&this.evaluate(t.get())},t}(Yn),gi=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"func",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.evaluate=function(e){if(void 0!==e)return(0,this.func)(e)},t}(mi),wi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.onRecohereOutputKey=function(e,t,r){if(0===t){var n=this.input;null!==n?this.evaluate(e,n.get(e)):this.evaluate(e,void 0)}else 1===t&&this.evaluate(e,void 0)},t}(Zn),Oi=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"func",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.evaluate=function(e,t){if(void 0!==t)return(0,this.func)(e,t)},t}(wi),Pi=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"streamlet",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.willDecohereOutput=function(){var e=this.streamlet;void 0!==e.willDecohereInlet&&e.willDecohereInlet(this)},t.prototype.didDecohereOutput=function(){var e=this.streamlet;void 0!==e.didDecohereInlet?e.didDecohereInlet(this):e.decohere()},t.prototype.willRecohereOutput=function(e){var t=this.streamlet;void 0!==t.willRecohereInlet&&t.willRecohereInlet(this,e)},t.prototype.didRecohereOutput=function(e){var t=this.streamlet;void 0!==t.didRecohereInlet?t.didRecohereInlet(this,e):t.recohere(e)},t}(Yn),xi=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"streamlet",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.get=function(){var e=this.streamlet;return void 0!==e.getOutput?e.getOutput(this):void 0},t.prototype.willDecohereInput=function(){var e=this.streamlet;void 0!==e.willDecohereOutlet&&e.willDecohereOutlet(this)},t.prototype.didDecohereInput=function(){var e=this.streamlet;void 0!==e.didDecohereOutlet?e.didDecohereOutlet(this):e.decohere()},t.prototype.willRecohereInput=function(e){var t=this.streamlet;void 0!==t.willRecohereOutlet&&t.willRecohereOutlet(this,e)},t.prototype.didRecohereInput=function(e){var t=this.streamlet;void 0!==t.didRecohereOutlet&&t.didRecohereOutlet(this,e)},t}(Gn),ji=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"streamlet",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.get=function(){var e=this.streamlet;if(void 0!==e.getOutput){var t=e.getOutput(this);if(void 0!==t)return t}var r=this.input;return null!==r?r.get():void 0},t.prototype.willDecohere=function(){var e=this.streamlet;void 0!==e.willDecohereOutlet&&e.willDecohereOutlet(this)},t.prototype.didDecohere=function(){var e=this.streamlet;void 0!==e.didDecohereOutlet?e.didDecohereOutlet(this):e.decohere()},t.prototype.willRecohere=function(e){var t=this.streamlet;void 0!==t.willRecohereOutlet&&t.willRecohereOutlet(this,e)},t.prototype.didRecohere=function(e){var t=this.streamlet;void 0!==t.didRecohereOutlet&&t.didRecohereOutlet(this,e)},t}(_n),Ci=function(e,t,r){this.key=e,this.name=t,this.type=r},Ei=function(e,t,r){this.key=e,this.name=t,this.type=r},Si=function(e,t,r){this.key=e,this.name=t,this.type=r},ki=function(){function e(e){void 0===e&&(e=null),Object.defineProperty(this,"streamletScope",{value:e,enumerable:!0,configurable:!0}),Object.defineProperty(this,"streamletContext",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0})}return e.prototype.setStreamletScope=function(e){Object.defineProperty(this,"streamletScope",{value:e,enumerable:!0,configurable:!0})},e.prototype.setStreamletContext=function(e){Object.defineProperty(this,"streamletContext",{value:e,enumerable:!0,configurable:!0})},e.prototype.inlet=function(t){return void 0===t?new Pi(this):e.reflectInletKey(t,this,Object.getPrototypeOf(this))},e.prototype.bindInput=function(e,t){var r=this.inlet(e);if(null===r)throw new Error(""+e);r.bindInput(t)},e.prototype.unbindInput=function(e){var t=this.inlet(e);if(null===t)throw new Error(""+e);t.unbindInput()},e.prototype.outlet=function(t){return void 0===t?new xi(this):"string"==typeof t?e.reflectOutletKey(t,this,Object.getPrototypeOf(this)):t},e.prototype.inoutlet=function(){return new ji(this)},e.prototype.decohere=function(){this.version>=0&&(this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere(),this.onDecohereOutlets(),this.didDecohere())},e.prototype.recohere=function(e){this.version<0&&(this.willRecohere(e),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohereInlets(e),this.onRecohere(e),this.onRecohereOutlets(e),this.didRecohere(e))},e.prototype.getInput=function(e,t){var r;if("string"==typeof e&&(e=this.inlet(e)),null!==e){var n=e.input;null!==n&&(r=n.get())}return void 0===r&&(r=t),r},e.prototype.getOutput=function(e){},e.prototype.disconnectInputs=function(){e.disconnectInputs(this,Object.getPrototypeOf(this))},e.disconnectInputs=function(t,r){for(;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"inlets"))for(var n in r.inlets){var i=r.inlets[n];if(i instanceof Ci)e.reflectInletField(t,i).disconnectInputs();else if(i instanceof Si){e.reflectInoutletField(t,i).disconnectInputs()}}r=Object.getPrototypeOf(r)}},e.prototype.disconnectOutputs=function(){e.disconnectOutputs(this,Object.getPrototypeOf(this))},e.disconnectOutputs=function(t,r){for(;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"outlets"))for(var n in r.outlets){var i=r.outlets[n];if(i instanceof Ei)e.reflectOutletField(t,i).disconnectOutputs();else if(i instanceof Si){e.reflectInoutletField(t,i).disconnectOutputs()}}r=Object.getPrototypeOf(r)}},e.prototype.willDecohereInlet=function(e){},e.prototype.didDecohereInlet=function(e){this.decohere()},e.prototype.willRecohereInlet=function(e,t){},e.prototype.didRecohereInlet=function(e,t){this.recohere(t)},e.prototype.willDecohereOutlet=function(e){},e.prototype.didDecohereOutlet=function(e){},e.prototype.willRecohereOutlet=function(e,t){},e.prototype.didRecohereOutlet=function(e,t){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.onDecohereOutlets=function(){e.decohereOutlets(this,Object.getPrototypeOf(this))},e.decohereOutlets=function(t,r){for(;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"outlets"))for(var n in r.outlets){var i=r.outlets[n];if(i instanceof Ei)e.reflectOutletField(t,i).decohereInput();else if(i instanceof Si){e.reflectInoutletField(t,i).decohereInput()}}r=Object.getPrototypeOf(r)}},e.prototype.didDecohere=function(){},e.prototype.willRecohere=function(e){},e.prototype.onRecohereInlets=function(t){e.recohereInlets(t,this,Object.getPrototypeOf(this))},e.recohereInlets=function(t,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"inlets"))for(var i in n.inlets){var o=n.inlets[i];if(o instanceof Ci)e.reflectInletField(r,o).recohereOutput(t);else if(o instanceof Si){e.reflectInoutletField(r,o).recohereOutput(t)}}n=Object.getPrototypeOf(n)}},e.prototype.onRecohere=function(e){},e.prototype.onRecohereOutlets=function(t){e.recohereOutlets(t,this,Object.getPrototypeOf(this))},e.recohereOutlets=function(t,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"outlets"))for(var i in n.outlets){var o=n.outlets[i];if(o instanceof Ei)e.reflectOutletField(r,o).recohereInput(t);else if(o instanceof Si){e.reflectInoutletField(r,o).recohereInput(t)}}n=Object.getPrototypeOf(n)}},e.prototype.didRecohere=function(e){},e.reflectEachInlet=function(t,r,n,i){for(var o=0;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"inlets"))for(var u in r.inlets){var s=r.inlets[u],a=void 0;if(null!==(a=s instanceof Ci?e.reflectInletField(t,s):s instanceof Si?e.reflectInoutletField(t,s):null)){var p=n.call(i,a,s.name,o);if(void 0!==p)return p;o+=1}}r=Object.getPrototypeOf(r)}},e.reflectEachOutlet=function(t,r,n,i){for(var o=0;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"outlets"))for(var u in r.outlets){var s=r.outlets[u],a=void 0;if(null!==(a=s instanceof Ei?e.reflectOutletField(t,s):s instanceof Si?e.reflectInoutletField(t,s):null)){var p=n.call(i,a,s.name,o);if(void 0!==p)return p;o+=1}}r=Object.getPrototypeOf(r)}},e.reflectInletCount=function(e){for(var t=0;null!==e;){if(Object.prototype.hasOwnProperty.call(e,"inlets"))for(var r in e.inlets)t+=1;e=Object.getPrototypeOf(e)}return t},e.reflectOutletCount=function(e){for(var t=0;null!==e;){if(Object.prototype.hasOwnProperty.call(e,"outlets"))for(var r in e.outlets)t+=1;e=Object.getPrototypeOf(e)}return t},e.reflectInletIndex=function(t,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"inlets"))for(var i in n.inlets){if(0===t){var o=n.inlets[i];return o instanceof Ci?[o.name,e.reflectInletField(r,o)]:o instanceof Si?[o.name,e.reflectInoutletField(r,o)]:null}t-=1}n=Object.getPrototypeOf(n)}return null},e.reflectOutletIndex=function(t,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"outlets"))for(var i in n.outlets){if(0===t){var o=n.outlets[i];return o instanceof Ei?[o.name,e.reflectOutletField(r,o)]:o instanceof Si?[o.name,e.reflectInoutletField(r,o)]:null}t-=1}n=Object.getPrototypeOf(n)}return null},e.reflectInletKey=function(t,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"inlets")){var i=n.inlets[t];if(void 0!==i)return i instanceof Ci?e.reflectInletField(r,i):i instanceof Si?e.reflectInoutletField(r,i):null}n=Object.getPrototypeOf(n)}return null},e.reflectOutletKey=function(t,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"outlets")){var i=n.outlets[t];if(void 0!==i)return i instanceof Ei?e.reflectOutletField(r,i):i instanceof Si?e.reflectInoutletField(r,i):null}n=Object.getPrototypeOf(n)}return null},e.reflectInletField=function(t,r){if("value"===r.type)return e.reflectValueInletField(t,r.key);if("map"===r.type)return e.reflectMapInletField(t,r.key);throw new TypeError(r.type)},e.reflectValueInletField=function(t,r){var n=t[r];return void 0===n&&(n=t instanceof e?t.inlet():new Pi(t),t[r]=n),n},e.reflectMapInletField=function(e,t){return null},e.reflectOutletField=function(t,r){if("value"===r.type)return e.reflectValueOutletField(t,r.key);if("map"===r.type)return e.reflectMapOutletField(t,r.key);throw new TypeError(r.type)},e.reflectValueOutletField=function(t,r){var n=t[r];return void 0===n&&(n=t instanceof e?t.outlet():new xi(t),t[r]=n),n},e.reflectMapOutletField=function(e,t){return null},e.reflectInoutletField=function(t,r){if("value"===r.type)return e.reflectValueInoutletField(t,r.key);if("map"===r.type)return e.reflectMapInoutletField(t,r.key);throw new TypeError(r.type)},e.reflectValueInoutletField=function(t,r){var n=t[r];return void 0===n&&(n=t instanceof e?t.inoutlet():new ji(t),t[r]=n),n},e.reflectMapInoutletField=function(e,t){return null},e.init=function(e){Object.prototype.hasOwnProperty.call(e,"inlets")||(e.inlets={}),Object.prototype.hasOwnProperty.call(e,"outlets")||(e.outlets={}),Object.prototype.hasOwnProperty.call(e,"inoutlets")||(e.inoutlets={})},e.decorateInlet=function(t,r,n){e.init(r);var i=void 0!==t.name?t.name:n.toString(),o=void 0!==t.type?t.type:"value",u=new Ci(n.toString(),i,o);r.inlets[i]=u},e.decorateOutlet=function(t,r,n){e.init(r);var i=void 0!==t.name?t.name:n.toString(),o=void 0!==t.type?t.type:"value",u=new Ei(n.toString(),i,o);r.outlets[i]=u},e.decorateInoutlet=function(t,r,n){e.init(r);var i=void 0!==t.name?t.name:n.toString(),o=void 0!==t.type?t.type:"value",u=new Si(n.toString(),i,o);r.inlets[i]=u,r.outlets[i]=u,r.inoutlets[i]=u},e}();function Mi(e,t){if(1===arguments.length)return"string"==typeof e&&(e={name:e}),ki.decorateOutlet.bind(void 0,e);ki.decorateOutlet({},e,t)}function Ai(e,t){if(1===arguments.length)return"string"==typeof e&&(e={name:e}),ki.decorateInoutlet.bind(void 0,e);ki.decorateInoutlet({},e,t)}var Di={is:function(e){if("object"==typeof e&&null!==e){var t=e;return Kn.is(t)&&Hn.is(t)}return!1}},Ii=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"effects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(t,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(t,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(t,"version",{value:-1,enumerable:!0,configurable:!0}),t}return C(t,e),Object.defineProperty(t.prototype,"streamletContext",{get:function(){var e=this.streamletScope;return null!==e?e.streamletContext:null},enumerable:!1,configurable:!0}),t.prototype.hasOwn=function(e){return this.has(e)},t.prototype.get=function(t){return void 0===t?this:e.prototype.get.call(this,t)},t.prototype.outlet=function(e){if("string"==typeof e&&(e=hr.from(e)),!this.hasOwn(e)){var t=this.streamletScope;if(Di.is(t)&&t.has(e))return t.outlet(e)}var r=this.outlets,n=r.get(e);return void 0===n&&(n=new Qn(this,e),Object.defineProperty(this,"outlets",{value:r.updated(e,n),enumerable:!0,configurable:!0}),this.decohereInputKey(e,0)),n},t.prototype.outputIterator=function(){return k.array(this.outputs)},t.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},t.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},t.prototype.unbindOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.unbindOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){t[r].unbindInput()}},t.prototype.disconnectOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.disconnectOutputs()}),this));var r=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var n=0,i=r.length;n<i;n+=1){var o=r[n];o.unbindInput(),o.disconnectOutputs()}this.forEach((function(e){e instanceof Jt&&(e=e.toValue()),(e instanceof t||e instanceof Ti||Di.is(e))&&e.disconnectOutputs()}),this)},t.prototype.disconnectInputs=function(){},t.prototype.decohereInputKey=function(e,t){var r=this.effects;if(r.get(e)!==t){this.willDecohereInputKey(e,t),Object.defineProperty(this,"effects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereInputKey(e,t);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var u=n[i];Ln.is(u)?u.decohereOutputKey(e,t):u.decohereOutput()}var s=this.outlets.get(e);void 0!==s&&s.decohereInput(),this.didDecohereInputKey(e,t)}},t.prototype.decohereInput=function(){if(this.version>=0){this.willDecohereInput(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereInput();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1){e[t].decohereOutput()}this.outlets.forEach((function(e,t){t.decohereInput()}),this),this.didDecohereInput()}},t.prototype.recohereInputKey=function(e,t){if(this.version<0){var r=this.effects,n=r.get(e);if(void 0!==n){this.willRecohereInputKey(e,n,t),Object.defineProperty(this,"effects",{value:r.removed(e),enumerable:!0,configurable:!0}),this.onRecohereInputKey(e,n,t);for(var i=this.outputs,o=0,u=i.length;o<u;o+=1){var s=i[o];Ln.is(s)&&s.recohereOutputKey(e,t)}var a=this.outlets.get(e);void 0!==a&&a.recohereInput(t),this.didRecohereInputKey(e,n,t)}}},t.prototype.recohereInput=function(e){if(this.version<0){this.willRecohereInput(e),this.effects.forEach((function(t){this.recohereInputKey(t,e)}),this),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohereInput(e);for(var r=this.outputs,n=0,i=r.length;n<i;n+=1){r[n].recohereOutput(e)}this.forEach((function(r){r instanceof Jt&&(r=r.toValue()),r instanceof t?r.recohereInput(e):r instanceof Ti?r.recohere(e):Di.is(r)&&r.recohereInput(e)}),this),this.didRecohereInput(e)}},t.prototype.willDecohereInputKey=function(e,t){},t.prototype.onDecohereInputKey=function(e,t){},t.prototype.didDecohereInputKey=function(e,t){},t.prototype.willDecohereInput=function(){},t.prototype.onDecohereInput=function(){},t.prototype.didDecohereInput=function(){},t.prototype.willRecohereInputKey=function(e,t,r){},t.prototype.onRecohereInputKey=function(e,t,r){},t.prototype.didRecohereInputKey=function(e,t,r){},t.prototype.willRecohereInput=function(e){},t.prototype.onRecohereInput=function(e){},t.prototype.didRecohereInput=function(e){},t.prototype.filter=function(t){if("function"!=typeof t)return e.prototype.filter.call(this,t);var r=new ci(t);return r.bindInput(this),r},t}(or);Object.defineProperty(Ii.prototype,"streamletScope",{get:function(){return null},enumerable:!0,configurable:!0}),Bn.define(Ii.prototype);var Ti=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.isConstant=function(){return!1},t.prototype.compile=function(){ki.reflectEachInlet(this,Object.getPrototypeOf(this),(function(e,t){null===e.input&&this.compileInlet(e,t)}),this)},t.prototype.compileInlet=function(e,t){var r=this.streamletScope;if(null!==r){var n=r.outlet(t);null!==n&&e.bindInput(n)}},t}(or),Vi=function(e){function t(t){void 0===t&&(t=null);var r=e.call(this)||this;return Object.defineProperty(r,"streamletScope",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(r,"streamletContext",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(r,"version",{value:-1,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.setStreamletScope=function(e){Object.defineProperty(this,"streamletScope",{value:e,enumerable:!0,configurable:!0})},t.prototype.setStreamletContext=function(e){Object.defineProperty(this,"streamletContext",{value:e,enumerable:!0,configurable:!0})},t.prototype.isEmpty=function(){return 0!==this.length},Object.defineProperty(t.prototype,"length",{get:function(){return ki.reflectOutletCount(Object.getPrototypeOf(this))},enumerable:!1,configurable:!0}),t.prototype.has=function(e){if(e instanceof hr)e=e.value;else if("string"!=typeof e)return!1;return null!==this.outlet(e)},t.prototype.get=function(e){if(e instanceof hr)e=e.value;else if("string"!=typeof e)return ir.absent();var t=this.outlet(e);if(null!==t){var r=t.get();if(void 0!==r)return r}return ir.absent()},t.prototype.getAttr=function(e){return ir.absent()},t.prototype.getSlot=function(e){return this.get(e)},t.prototype.getField=function(e){if("string"==typeof e)e=hr.from(e);else if(!(e instanceof hr))return;var t=this.get(e);if(t.isDefined())return $t.of(e,t)},t.prototype.getItem=function(e){e instanceof yr&&(e=e.value);var t=ki.reflectOutletIndex(e,this,Object.getPrototypeOf(this));if(null!==t){var r=t[0],n=t[1].get();return void 0===n&&(n=ir.extant()),$t.of(r,n)}return Qt.absent()},t.prototype.set=function(e,t){throw new Error("unsupported")},t.prototype.setAttr=function(e,t){throw new Error("unsupported")},t.prototype.setSlot=function(e,t){throw new Error("unsupported")},t.prototype.setItem=function(e,t){throw new Error("unsupported")},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("unsupported")},t.prototype.splice=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];throw new Error("unsupported")},t.prototype.delete=function(e){throw new Error("unsupported")},t.prototype.clear=function(){throw new Error("unsupported")},t.prototype.forEach=function(e,t){return ki.reflectEachOutlet(this,Object.getPrototypeOf(this),(function(r,n,i){var o=r.get();if(void 0!==o){var u=e.call(t,o,i);if(void 0!==u)return u}}),this)},t.prototype.inlet=function(e){return void 0===e?new Pi(this):ki.reflectInletKey(e,this,Object.getPrototypeOf(this))},t.prototype.bindInput=function(e,t){var r=this.inlet(e);if(null===r)throw new Error(e);r.bindInput(t)},t.prototype.unbindInput=function(e){var t=this.inlet(e);if(null===t)throw new Error(e);t.unbindInput()},t.prototype.outlet=function(e){return void 0===e?new xi(this):"string"==typeof e?ki.reflectOutletKey(e,this,Object.getPrototypeOf(this)):e},t.prototype.inoutlet=function(){return new ji(this)},t.prototype.decohere=function(){this.version>=0&&(this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere(),this.onDecohereOutlets(),this.didDecohere())},t.prototype.recohere=function(e){this.version<0&&(this.willRecohere(e),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohereInlets(e),this.onRecohere(e),this.onRecohereOutlets(e),this.didRecohere(e))},t.prototype.getInput=function(e,t){var r;if("string"==typeof e&&(e=this.inlet(e)),null!==e){var n=e.input;null!==n&&(r=n.get())}return void 0===r&&(r=t),r},t.prototype.castInput=function(e,t,r){var n,i=this.getInput(e);return void 0!==i&&(n=t.cast(i)),void 0===n&&(n=r),n},t.prototype.coerceInput=function(e,t,r){var n,i=this.getInput(e);return void 0!==i&&(n=t.cast(i)),void 0===n&&(n=t.unit),void 0===n&&(n=r),n},t.prototype.getOutput=function(e){},t.prototype.disconnectInputs=function(){ki.disconnectInputs(this,Object.getPrototypeOf(this))},t.prototype.disconnectOutputs=function(){ki.disconnectOutputs(this,Object.getPrototypeOf(this))},t.prototype.willDecohereInlet=function(e){},t.prototype.didDecohereInlet=function(e){this.decohere()},t.prototype.willRecohereInlet=function(e,t){},t.prototype.didRecohereInlet=function(e,t){this.recohere(t)},t.prototype.willDecohereOutlet=function(e){},t.prototype.didDecohereOutlet=function(e){},t.prototype.willRecohereOutlet=function(e,t){},t.prototype.didRecohereOutlet=function(e,t){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.onDecohereOutlets=function(){ki.decohereOutlets(this,Object.getPrototypeOf(this))},t.prototype.willRecohere=function(e){},t.prototype.onRecohereInlets=function(e){ki.recohereInlets(e,this,Object.getPrototypeOf(this))},t.prototype.onRecohere=function(e){},t.prototype.onRecohereOutlets=function(e){ki.recohereOutlets(e,this,Object.getPrototypeOf(this))},t.prototype.didRecohere=function(e){},t}(Ti),qi=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"record",{value:t,enumerable:!0}),Object.defineProperty(n,"key",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.onDecohereOutput=function(){var e=this.record;Di.is(e)&&e.decohereInputKey(this.key,0)},t.prototype.onRecohereOutput=function(e){var t=this.input;if(null!==t){var r=t.get();void 0!==r?this.record.set(this.key,r):this.record.delete(this.key)}},t}(Yn),Ri=function(e){function t(t){var r=e.call(this)||this;return void 0===t&&(t=or.create()),Object.defineProperty(r,"state",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(r,"fieldUpdaters",{value:new Ot,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.isEmpty=function(){return this.state.isEmpty()},t.prototype.isArray=function(){return this.state.isArray()},t.prototype.isObject=function(){return this.state.isObject()},Object.defineProperty(t.prototype,"length",{get:function(){return this.state.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueCount",{get:function(){return this.state.valueCount},enumerable:!1,configurable:!0}),t.prototype.has=function(e){if(this.state.has(e))return!0;var t=this.streamletScope;return t instanceof or&&t.has(e)},t.prototype.hasOwn=function(e){return this.state.has(e)},t.prototype.indexOf=function(e,t){return this.state.indexOf(e,t)},t.prototype.lastIndexOf=function(e,t){return void 0===t&&(t=0),this.state.lastIndexOf(e,t)},t.prototype.get=function(e){if(void 0===e)return this;e=ir.fromAny(e);var t=this.state.get(e);if(!t.isDefined()){var r=this.streamletScope;r instanceof or&&(t=r.get(e))}return t},t.prototype.getAttr=function(e){e=hr.fromAny(e);var t=this.state.getAttr(e);if(!t.isDefined()){var r=this.streamletScope;r instanceof or&&(t=r.getAttr(e))}return t},t.prototype.getSlot=function(e){e=ir.fromAny(e);var t=this.state.getSlot(e);if(!t.isDefined()){var r=this.streamletScope;r instanceof or&&(t=r.getSlot(e))}return t},t.prototype.getField=function(e){e=ir.fromAny(e);var t=this.state.getField(e);if(void 0===t){var r=this.streamletScope;r instanceof or&&(t=r.getField(e))}return t},t.prototype.getItem=function(e){return this.state.getItem(e)},t.prototype.bindValue=function(e,t){var r=new qi(this,e),n=fo.compile(t,this);r.bindInput(n),Object.defineProperty(this,"fieldUpdaters",{value:this.fieldUpdaters.updated(e,r),enumerable:!0,configurable:!0})},t.prototype.set=function(e,t){if(e=ir.fromAny(e),this.state.has(e))this.state.set(e,t);else{var r=this.streamletScope;r instanceof or&&r.has(e)?r.set(e,t):this.state.set(e,t)}return this.decohereInputKey(e,0),this},t.prototype.setAttr=function(e,t){if(e=hr.fromAny(e),this.state.has(e))this.state.setAttr(e,t);else{var r=this.streamletScope;r instanceof or&&r.has(e)?r.setAttr(e,t):this.state.setAttr(e,t)}return this.decohereInputKey(e,0),this},t.prototype.setSlot=function(e,t){if(e=ir.fromAny(e),this.state.has(e))this.state.setSlot(e,t);else{var r=this.streamletScope;r instanceof or&&r.has(e)?r.setSlot(e,t):this.state.setSlot(e,t)}return this.decohereInputKey(e,0),this},t.prototype.setItem=function(e,t){var r=this.state.getItem(e);return t=Qt.fromAny(t),this.state.setItem(e,t),r instanceof Jt&&t instanceof Jt?r.key.equals(t.key)?this.decohereInputKey(r.key,0):(this.decohereInputKey(r.key,1),this.decohereInputKey(t.key,0)):r instanceof Jt?this.decohereInputKey(r.key,1):t instanceof Jt?this.decohereInputKey(t.key,0):this.decohereInput(),this},t.prototype.push=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=this.state.length,i=(e=this.state).push.apply(e,t);n<i;){var o=this.state.get(n);o instanceof Jt&&this.decohereInputKey(o.key,0),n+=1}return i},t.prototype.splice=function(e,t){var r;void 0===t&&(t=0);for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=this.state.length;e<0&&(e=o+e),e=Math.max(0,e),t=Math.max(0,t);for(var u=(r=this.state).splice.apply(r,S([e,t],n,!1)),s=0;s<u.length;s+=1){var a=u[s];a instanceof Jt&&this.decohereInputKey(a.key,1)}for(s=e;s<e+n.length;s+=1){var p=this.state.get(s);p instanceof Jt&&this.decohereInputKey(p.key,0)}return u},t.prototype.delete=function(e){var t=this.state.delete(e);return t instanceof Jt&&this.decohereInputKey(t.key,1),t},t.prototype.clear=function(){var e=this.state.branch();this.state.clear(),e.forEach((function(e){e instanceof Jt&&this.decohereInputKey(e.key,1)}),this)},t.prototype.forEach=function(e,t){return this.state.forEach(e,t)},t.prototype.keyIterator=function(){throw new Error},t.prototype.disconnectInputs=function(){var e=this.fieldUpdaters;e.isEmpty()||(Object.defineProperty(this,"fieldUpdaters",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.disconnectInputs()}),this))},t.prototype.memoize=function(){return this},t.prototype.materialize=function(e){e.forEach((function(e){this.materializeItem(e)}),this)},t.prototype.materializeItem=function(e){e instanceof Jt?this.materializeField(e):this.materializeValue(e)},t.prototype.materializeField=function(e){var t=e.value;if(t instanceof Ti)t.setStreamletScope(this),this.state.push(e);else if(t instanceof or){var r=new Ui(this);r.materialize(t),this.state.push(e.updatedValue(r))}else this.state.push(e)},t.prototype.materializeValue=function(e){if(e instanceof Ti)e.setStreamletScope(this),this.state.push(e);else if(e instanceof or){var t=new Ui(this);t.materialize(e),this.state.push(t)}else this.state.push(e)},t.prototype.compile=function(e){e.forEach((function(e,t){this.compileItem(e,t)}),this)},t.prototype.compileItem=function(e,t){e instanceof Jt?this.compileField(e,t):this.compileValue(e,t)},t.prototype.compileField=function(e,t){var r=e.key,n=e.value;r.isConstant()&&(n.isConstant()?this.decohereInputKey(r,0):n instanceof Ti?(n.compile(),this.decohereInputKey(r,0)):n instanceof or?(this.state.getItem(t).toValue().compile(n),this.decohereInputKey(r,0)):(e.setValue(ir.extant()),this.bindValue(r,n)))},t.prototype.compileValue=function(e,t){e instanceof Ti?e.compile():e instanceof or?this.state.getItem(t).compile(e):e.isConstant()},t.prototype.reify=function(e){void 0===e&&(e=Ni.system()),this.forEach((function(t,r){var n=this.reifyItem(t,e);t!==n&&this.setItem(r,n)}),this)},t.prototype.reifyItem=function(e,r){null!==r&&(e=r.reify(e));var n=this.streamletScope;return n instanceof t?n.reifyItem(e,r):e},t.from=function(e){var r=new t;return r.materialize(e),r.compile(e),r},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.from(or.of.apply(or,e))},t.globalScope=function(){var e=new t;return e.materializeField($t.of("math",dn.scope.branch())),e},t}(Ii);Object.defineProperty(Ri.prototype,"fieldCount",{get:function(){return this.state.fieldCount},enumerable:!0,configurable:!0});var Ui=function(e){function t(t,r){var n=e.call(this,r)||this;return Object.defineProperty(n,"streamletScope",{value:t,enumerable:!0,configurable:!0}),n}return C(t,e),t.from=function(e){var r=new t(t.globalScope());return r.materialize(e),r.compile(e),r},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.from(or.of.apply(or,e))},t}(Ri),Ni=function(){function e(){}return e.system=function(){return null},e}(),zi=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"keyInlet",{value:new ri(t),enumerable:!0}),Object.defineProperty(t,"mapInlet",{value:new ni(t),enumerable:!0}),t}return C(t,e),t.prototype.get=function(){var e=this.keyInlet.input;if(null!==e){var t=e.get();if(void 0!==t){var r=this.mapInlet.input;if(null!==r){var n=r.get(t);if(void 0!==n)return n}}}return ir.absent()},t}(Gn),Fi=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"operand1Inlet",{value:new ri(t),enumerable:!0}),Object.defineProperty(t,"operand2Inlet",{value:new ri(t),enumerable:!0}),t}return C(t,e),t.prototype.get=function(){var e=this.operand1Inlet.input,t=this.operand2Inlet.input;if(null!==e&&null!==t){var r=e.get(),n=t.get();if(void 0!==r&&void 0!==n)return this.evaluate(r,n).toValue()}return ir.absent()},t}(Gn),Li=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"operandInlet",{value:new ri(t),enumerable:!0}),t}return C(t,e),t.prototype.get=function(){var e=this.operandInlet.input;if(null!==e){var t=e.get();if(void 0!==t)return this.evaluate(t).toValue()}return ir.absent()},t}(Gn),Ki=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"ifInlet",{value:new ri(t),enumerable:!0}),Object.defineProperty(t,"thenInlet",{value:new ri(t),enumerable:!0}),Object.defineProperty(t,"elseInlet",{value:new ri(t),enumerable:!0}),t}return C(t,e),t.prototype.get=function(){var e=this.ifInlet.input;if(null!==e){var t=e.get();if(void 0!==t)if(t.isDefinite()){var r=this.thenInlet.input;if(null!==r){var n=r.get();if(void 0!==n)return n}}else{var i=this.elseInlet.input;if(null!==i){var o=i.get();if(void 0!==o)return o}}}return ir.absent()},t}(Gn),Bi=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"operand1Inlet",{value:new ri(t),enumerable:!0}),Object.defineProperty(t,"operand2Inlet",{value:new ri(t),enumerable:!0}),t}return C(t,e),t.prototype.get=function(){var e=this.operand1Inlet.input,t=null!==e?e.get():void 0;if(void 0!==t&&t.isDefinite())return t;var r=this.operand2Inlet.input,n=null!==r?r.get():void 0;return void 0!==n?n:ir.absent()},t}(Gn),Wi=function(e){function t(){var t=e.call(this)||this;return Object.defineProperty(t,"operand1Inlet",{value:new ri(t),enumerable:!0}),Object.defineProperty(t,"operand2Inlet",{value:new ri(t),enumerable:!0}),t}return C(t,e),t.prototype.get=function(){var e=this.operand1Inlet.input,t=null!==e?e.get():void 0;if(void 0!==t){if(t.isDefinite()){var r=this.operand2Inlet.input,n=null!==r?r.get():void 0;if(void 0!==n)return n}return t}return ir.absent()},t}(Gn),Hi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.bitwiseOr(t)},t}(Fi),Xi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.bitwiseXor(t)},t}(Fi),Yi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.bitwiseAnd(t)},t}(Fi),Gi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.lt(t)},t}(Fi),_i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.le(t)},t}(Fi),Qi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.eq(t)},t}(Fi),Zi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.ne(t)},t}(Fi),Ji=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.ge(t)},t}(Fi),$i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.gt(t)},t}(Fi),eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.plus(t)},t}(Fi),to=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.minus(t)},t}(Fi),ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.times(t)},t}(Fi),no=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.divide(t)},t}(Fi),io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e,t){return e.modulo(t)},t}(Fi),oo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e){return e.not()},t}(Li),uo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e){return e.bitwiseNot()},t}(Li),so=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e){return e.negative()},t}(Li),ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.evaluate=function(e){return e.positive()},t}(Li),po=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"scope",{value:t,enumerable:!0}),Object.defineProperty(r,"funcInlet",{value:new ri(r),enumerable:!0}),Object.defineProperty(r,"argsInlet",{value:new ri(r),enumerable:!0}),r}return C(t,e),t.prototype.get=function(){var e=this.funcInlet.input,t=this.argsInlet.input;if(null!==e&&null!==t){var r=e.get();if(r instanceof cn){var n=t.get();if(void 0!==n){var i=new Ar;return i.pushScope(this.scope),r.invoke(n,i,void 0).toValue()}}}return ir.absent()},t}(Gn),fo={compile:function(e,t){if(t instanceof Qn){var r=t.get();zn.is(r)&&(t=r)}if(e.isConstant())return new ii(e);if(e instanceof $r)return fo.compileSelector(e,t);if(e instanceof Or)return fo.compileOperator(e,t);throw new TypeError(""+e)},compileSelector:function(e,t){if(e instanceof en)return fo.compileIdentitySelector(t);if(e instanceof tn)return fo.compileGetSelector(e,t);if(e instanceof rn)return fo.compileGetAttrSelector(e,t);if(e instanceof nn)return fo.compileGetItemSelector(e,t);if(e instanceof on)return fo.compileKeysSelector(t);if(e instanceof un)return fo.compileValuesSelector(t);if(e instanceof sn)return fo.compileChildrenSelector(t);if(e instanceof an)return fo.compileDescendantsSelector(t);if(e instanceof pn)return fo.compileFilterSelector(e,t);throw new TypeError(""+e)},compileIdentitySelector:function(e){return e},compileGetSelector:function(e,t){var r=e.item;if(!r.isConstant()){var n=new zi;i=fo.compile(r,t);return n.keyInlet.bindInput(i),n.mapInlet.bindInput(t),n}if(Di.is(t)){if(null!==(i=t.outlet(r)))return fo.compile(e.then,i)}else if(Hn.is(t)){var i,o=r.stringValue(void 0);if(void 0!==o)if(null!==(i=t.outlet(o)))return fo.compile(e.then,i)}return null},compileGetAttrSelector:function(e,t){throw new Error},compileGetItemSelector:function(e,t){throw new Error},compileKeysSelector:function(e){throw new Error},compileValuesSelector:function(e){throw new Error},compileChildrenSelector:function(e){throw new Error},compileDescendantsSelector:function(e){throw new Error},compileFilterSelector:function(e,t){throw new Error},compileOperator:function(e,t){if(e instanceof Er)return fo.compileConditionalOperator(e,t);if(e instanceof Pr)return fo.compileBinaryOperator(e,t);if(e instanceof jr)return fo.compileUnaryOperator(e,t);if(e instanceof Zr)return fo.compileInvokeOperator(e,t);throw new TypeError(""+e)},compileConditionalOperator:function(e,t){var r=new Ki,n=e.ifTerm.toValue(),i=e.thenTerm.toValue(),o=e.elseTerm.toValue(),u=fo.compile(n,t),s=fo.compile(i,t),a=fo.compile(o,t);return r.ifInlet.bindInput(u),r.thenInlet.bindInput(s),r.elseInlet.bindInput(a),r},compileBinaryOperator:function(e,t){if(e instanceof Dr)return fo.compileOrOperator(e,t);if(e instanceof Ir)return fo.compileAndOperator(e,t);if(e instanceof Tr)return fo.compileBitwiseOrOperator(e,t);if(e instanceof Vr)return fo.compileBitwiseXorOperator(e,t);if(e instanceof qr)return fo.compileBitwiseAndOperator(e,t);if(e instanceof Rr)return fo.compileLtOperator(e,t);if(e instanceof Ur)return fo.compileLeOperator(e,t);if(e instanceof Nr)return fo.compileEqOperator(e,t);if(e instanceof zr)return fo.compileNeOperator(e,t);if(e instanceof Fr)return fo.compileGeOperator(e,t);if(e instanceof Lr)return fo.compileGtOperator(e,t);if(e instanceof Kr)return fo.compilePlusOperator(e,t);if(e instanceof Br)return fo.compileMinusOperator(e,t);if(e instanceof Wr)return fo.compileTimesOperator(e,t);if(e instanceof Hr)return fo.compileDivideOperator(e,t);if(e instanceof Xr)return fo.compileModuloOperator(e,t);throw new TypeError(""+e)},compileBinaryOutlet:function(e,t,r){var n=e.operand1.toValue(),i=e.operand2.toValue(),o=fo.compile(n,r),u=fo.compile(i,r);return t.operand1Inlet.bindInput(o),t.operand2Inlet.bindInput(u),t},compileOrOperator:function(e,t){var r=new Bi,n=e.operand1.toValue(),i=e.operand2.toValue(),o=fo.compile(n,t),u=fo.compile(i,t);return r.operand1Inlet.bindInput(o),r.operand2Inlet.bindInput(u),r},compileAndOperator:function(e,t){var r=new Wi,n=e.operand1.toValue(),i=e.operand2.toValue(),o=fo.compile(n,t),u=fo.compile(i,t);return r.operand1Inlet.bindInput(o),r.operand2Inlet.bindInput(u),r},compileBitwiseOrOperator:function(e,t){return fo.compileBinaryOutlet(e,new Hi,t)},compileBitwiseXorOperator:function(e,t){return fo.compileBinaryOutlet(e,new Xi,t)},compileBitwiseAndOperator:function(e,t){return fo.compileBinaryOutlet(e,new Yi,t)},compileLtOperator:function(e,t){return fo.compileBinaryOutlet(e,new Gi,t)},compileLeOperator:function(e,t){return fo.compileBinaryOutlet(e,new _i,t)},compileEqOperator:function(e,t){return fo.compileBinaryOutlet(e,new Qi,t)},compileNeOperator:function(e,t){return fo.compileBinaryOutlet(e,new Zi,t)},compileGeOperator:function(e,t){return fo.compileBinaryOutlet(e,new Ji,t)},compileGtOperator:function(e,t){return fo.compileBinaryOutlet(e,new $i,t)},compilePlusOperator:function(e,t){return fo.compileBinaryOutlet(e,new eo,t)},compileMinusOperator:function(e,t){return fo.compileBinaryOutlet(e,new to,t)},compileTimesOperator:function(e,t){return fo.compileBinaryOutlet(e,new ro,t)},compileDivideOperator:function(e,t){return fo.compileBinaryOutlet(e,new no,t)},compileModuloOperator:function(e,t){return fo.compileBinaryOutlet(e,new io,t)},compileUnaryOperator:function(e,t){if(e instanceof Yr)return fo.compileNotOperator(e,t);if(e instanceof Gr)return fo.compileBitwiseNotOperator(e,t);if(e instanceof _r)return fo.compileNegativeOperator(e,t);if(e instanceof Qr)return fo.compilePositiveOperator(e,t);throw new TypeError(""+e)},compileUnaryOutlet:function(e,t,r){var n=e.operand.toValue(),i=fo.compile(n,r);return t.operandInlet.bindInput(i),t},compileNotOperator:function(e,t){return fo.compileUnaryOutlet(e,new oo,t)},compileBitwiseNotOperator:function(e,t){return fo.compileUnaryOutlet(e,new uo,t)},compileNegativeOperator:function(e,t){return fo.compileUnaryOutlet(e,new so,t)},compilePositiveOperator:function(e,t){return fo.compileUnaryOutlet(e,new ao,t)},compileInvokeOperator:function(e,t){var r=e.func,n=e.args,i=new po(t),o=fo.compile(r,t),u=fo.compile(n,t);return i.funcInlet.bindInput(o),i.argsInlet.bindInput(u),i}},co={};Object.defineProperty(co,"structureParser",{value:function(){var e=new Bo;return Object.defineProperty(co,"structureParser",{value:function(){return e},enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),Object.defineProperty(co,"structureWriter",{value:function(){var e=new hu;return Object.defineProperty(co,"structureWriter",{value:function(){return e},enumerable:!0,configurable:!0}),e},enumerable:!0,configurable:!0}),co.parse=function(e){return co.structureParser().parseBlockString(e)},co.parser=function(){return co.structureParser().blockParser()},co.sizeOf=function(e){return co.structureWriter().sizeOfItem(e)},co.sizeOfBlock=function(e){return co.structureWriter().sizeOfBlockItem(e)},co.write=function(e,t){return co.structureWriter().writeItem(e,t)},co.writeBlock=function(e,t){return co.structureWriter().writeBlockItem(e,t)},co.toString=function(e){var t=re.stringOutput(),r=co.write(t,e);return r.isDone()||(t=Z.error(r.trap())),t.bind()},co.toBlockString=function(e){var t=re.stringOutput(),r=co.writeBlock(t,e);return r.isDone()||(t=Z.error(r.trap())),t.bind()},co.toData=function(e){var t=Ue.encodedOutput(cr.output()),r=co.write(t,e);return r.isDone()||(t=Z.error(r.trap())),t.bind()},co.toBlockData=function(e){var t=Ue.encodedOutput(cr.output()),r=co.writeBlock(t,e);return r.isDone()||(t=Z.error(r.trap())),t.bind()},co.isSpace=function(e){return 32===e||9===e},co.isNewline=function(e){return 10===e||13===e},co.isWhitespace=function(e){return co.isSpace(e)||co.isNewline(e)},co.isIdentStartChar=function(e){return e>=65&&e<=90||95===e||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039},co.isIdentChar=function(e){return 45===e||e>=48&&e<=57||e>=65&&e<=90||95===e||e>=97&&e<=122||183===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039},Qt.prototype.toRecon=function(){return co.toString(this)},Qt.prototype.toReconBlock=function(){return co.toBlockString(this)},ir.parseRecon=function(e){return co.parse(e)};var lo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.keyParser=n,u.valueParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.keyParser,this.valueParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;e:for(;;){if(1===u){for(;e.isCont()&&(s=e.head(),co.isWhitespace(s));)e=e.step();if(e.isCont())if(33===s||34===s||36===s||37===s||39===s||40===s||43===s||45===s||s>=48&&s<=57||64===s||91===s||96===s||123===s||126===s||co.isIdentStartChar(s))n=n||r.valueBuilder(),u=2;else{if(35!==s)return void 0!==n?we.done(n.bind()):we.done(r.absent());e=e.step(),u=7}else if(e.isDone())return void 0!==n?we.done(n.bind()):we.done(r.absent())}if(2===u){for(void 0===i&&(i=r.parseBlockExpression(e));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=3;else if(i.isError())return i}if(3===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont())58===s?(e=e.step(),u=4):(n.push(r.item(i.bind())),i=void 0,u=6);else if(e.isDone())return n.push(r.item(i.bind())),we.done(n.bind())}if(4===u){for(;e.isCont()&&co.isSpace(e.head());)e=e.step();if(e.isCont())u=5;else if(e.isDone())return n.push(r.slot(i.bind())),we.done(n.bind())}if(5===u){for(void 0===o&&(o=r.parseBlockExpression(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())n.push(r.slot(i.bind(),o.bind())),i=void 0,o=void 0,u=6;else if(o.isError())return o}if(6===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(44===s||59===s||co.isNewline(s)){e=e.step(),u=1;continue}if(35!==s)return we.done(n.bind());e=e.step(),u=7}else if(e.isDone())return we.done(n.bind())}if(7===u){for(;e.isCont();){if(s=e.head(),co.isNewline(s)){u=1;continue e}e=e.step()}if(e.isDone()){u=1;continue}}break}return new t(r,n,i,o,u)},t}(we),ho=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.recon=t,o.keyParser=r,o.valueParser=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.keyParser,this.valueParser,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o)if(e.isCont()){if(64!==(u=e.head()))return we.error(oe.expected(64,e));e=e.step(),o=2}else if(e.isDone())return we.error(oe.expected(64,e));if(2===o){if(void 0===n){if(e.isCont())if(34===(u=e.head())||39===u)n=r.parseString(e);else{if(!co.isIdentStartChar(u))return we.error(oe.expected("attribute name",e));n=r.parseIdent(e)}else if(e.isDone())return we.error(oe.expected("attribute name",e))}else n=n.feed(e);if(void 0!==n)if(n.isDone())o=3;else if(n.isError())return n.asError()}if(3===o)if(e.isCont()&&40===e.head())e=e.step(),o=4;else if(!e.isEmpty())return we.done(r.attr(n.bind()));if(4===o){for(;e.isCont()&&(u=e.head(),co.isWhitespace(u));)e=e.step();if(e.isCont()){if(41===u)return e=e.step(),we.done(r.attr(n.bind()));o=5}else if(e.isDone())return we.error(oe.expected(")",e))}if(5===o){for(void 0===i&&(i=r.parseBlock(e));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())o=6;else if(i.isError())return i.asError()}if(6===o){for(;e.isCont()&&(u=e.head(),co.isWhitespace(u));)e=e.step();if(e.isCont())return 41===u?(e=e.step(),we.done(r.attr(n.bind(),i.bind()))):we.error(oe.expected(")",e));if(e.isDone())return we.error(oe.expected(")",e))}return new t(r,n,i,o)},t}(we),yo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.fieldParser=n,u.valueParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);for(var s=0;;){if(1===u)if(e.isCont())if(64===(s=e.head()))i=r.parseAttr(e),u=2;else if(123===s)n=n||r.recordBuilder(),o=r.parseRecord(e,n),u=5;else if(91===s)n=n||r.recordBuilder(),o=r.parseMarkup(e,n),u=5;else if(co.isIdentStartChar(s))o=r.parseIdent(e),u=4;else if(34===s||39===s)o=r.parseString(e),u=4;else if(96===s)o=r.parseRawString(e),u=4;else if(45===s||s>=48&&s<=57)o=r.parseNumber(e),u=4;else if(37===s)o=r.parseData(e),u=4;else{if(36!==s)return void 0===n?we.done(r.extant()):we.done(n.bind());o=r.parseSelector(e),u=4}else if(e.isDone())return void 0===n?we.done(r.extant()):we.done(n.bind());if(2===u){for(;i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())(n=n||r.valueBuilder()).push(i.bind()),i=void 0,u=3;else if(i.isError())return i.asError()}if(3===u){for(;e.isCont()&&co.isSpace(e.head());)e=e.step();if(e.isCont()){u=1;continue}if(e.isDone())return we.done(n.bind())}if(4===u){for(;o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())(n=n||r.valueBuilder()).push(r.item(o.bind())),o=void 0,u=6;else if(o.isError())return o}if(5===u){for(;o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())o=void 0,u=6;else if(o.isError())return o}if(6===u){for(;e.isCont()&&co.isSpace(e.head());)e=e.step();if(e.isCont()){if(64!==e.head())return we.done(n.bind());u=1}else if(e.isDone())return we.done(n.bind())}break}return new t(r,n,i,o,u)},t}(we),vo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.fieldParser=n,u.valueParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u)if(e.isCont())if(64===(s=e.head()))i=r.parseAttr(e),u=2;else if(123===s)void 0!==n?(o=r.parseRecord(e,n),u=5):(o=r.parseRecord(e),u=4);else{if(91!==s)return void 0===n?we.done(r.extant()):we.done(n.bind());void 0!==n?(o=r.parseMarkup(e,n),u=5):(o=r.parseMarkup(e),u=4)}else if(e.isDone())return void 0===n?we.done(r.extant()):we.done(n.bind());if(2===u){for(;i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())(n=n||r.valueBuilder()).push(i.bind()),i=void 0,u=3;else if(i.isError())return i.asError()}if(3===u)if(e.isCont())if(123===(s=e.head()))o=r.parseRecord(e,n),u=5;else{if(91!==s)return we.done(n.bind());o=r.parseMarkup(e,n),u=5}else if(e.isDone())return we.done(n.bind());if(4===u){for(;o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())return(n=n||r.valueBuilder()).push(r.item(o.bind())),we.done(n.bind());if(o.isError())return o}if(5===u){for(;o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())return we.done(n.bind());if(o.isError())return o}return new t(r,n,i,o,u)},t}(we),bo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.keyParser=n,u.valueParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.keyParser,this.valueParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u)if(e.isCont()){if(123!==(s=e.head()))return we.error(oe.expected(123,e));e=e.step(),u=2}else if(e.isDone())return we.error(oe.expected(123,e));e:for(;;){if(2===u){for(;e.isCont()&&(s=e.head(),co.isWhitespace(s));)e=e.step();if(e.isCont()){if(n=n||r.recordBuilder(),125===s)return e=e.step(),we.done(n.bind());35===s?(e=e.step(),u=8):u=3}else if(e.isDone())return we.error(oe.expected(125,e))}if(3===u){for(void 0===i&&(i=r.parseBlockExpression(e));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=4;else if(i.isError())return i}if(4===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont())58===s?(e=e.step(),u=5):(n.push(r.item(i.bind())),i=void 0,u=7);else if(e.isDone())return we.error(oe.expected(125,e))}if(5===u){for(;e.isCont()&&co.isSpace(e.head());)e=e.step();if(e.isCont())u=6;else if(e.isDone())return n.push(r.slot(i.bind())),we.done(n.bind())}if(6===u){for(void 0===o&&(o=r.parseBlockExpression(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())n.push(r.slot(i.bind(),o.bind())),i=void 0,o=void 0,u=7;else if(o.isError())return o}if(7===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(44===s||59===s||co.isNewline(s)){e=e.step(),u=2;continue}if(35!==s)return 125===s?(e=e.step(),we.done(n.bind())):we.error(oe.expected("'}', ';', ',', or newline",e));e=e.step(),u=8}else if(e.isDone())return we.error(oe.expected(125,e))}if(8===u){for(;e.isCont();){if(s=e.head(),co.isNewline(s)){u=2;continue e}e=e.step()}if(e.isDone()){u=2;continue}}break}return new t(r,n,i,o,u)},t}(we),mo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.textOutput=n,u.valueParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.textOutput,this.valueParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u)if(e.isCont()){if(91!==(s=e.head()))return we.error(oe.expected(91,e));e=e.step(),u=2}else if(e.isDone())return we.error(oe.expected(91,e));for(;;){if(2===u){for(;e.isCont()&&64!==(s=e.head())&&91!==s&&92!==s&&93!==s&&123!==s&&125!==s;)e=e.step(),(i=i||r.textOutput()).write(s);if(e.isCont()){if(93===s)return e=e.step(),n=n||r.recordBuilder(),void 0!==i&&n.push(r.item(i.bind())),we.done(n.bind());if(64===s)n=n||r.recordBuilder(),void 0!==i&&(n.push(r.item(i.bind())),i=void 0),o=r.parseInlineItem(e),u=3;else if(123===s)n=n||r.recordBuilder(),void 0!==i&&(n.push(r.item(i.bind())),i=void 0),o=r.parseRecord(e,n),u=4;else if(91===s)n=n||r.recordBuilder(),void 0!==i&&(n.push(r.item(i.bind())),i=void 0),o=r.parseMarkup(e,n),u=4;else{if(92!==s)return we.error(oe.unexpected(e));e=e.step(),u=5}}else if(e.isDone())return we.error(oe.unexpected(e))}if(3===u){for(;o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){n.push(r.item(o.bind())),o=void 0,u=2;continue}if(o.isError())return o}if(4===u){for(;o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){o=void 0,u=2;continue}if(o.isError())return o}if(5===u){if(e.isCont()){if(s=e.head(),i=i||r.textOutput(),34===s||36===s||39===s||47===s||64===s||91===s||92===s||93===s||123===s||125===s)e=e.step(),i.write(s),u=2;else if(98===s)e=e.step(),i.write(8),u=2;else if(102===s)e=e.step(),i.write(12),u=2;else if(110===s)e=e.step(),i.write(10),u=2;else if(114===s)e=e.step(),i.write(13),u=2;else{if(116!==s)return we.error(oe.expected("escape character",e));e=e.step(),i.write(9),u=2}continue}if(e.isDone())return we.error(oe.expected("escape character",e))}break}return new t(r,n,i,o,u)},t}(we),go=function(e){function t(t,r,n){var i=e.call(this)||this;return i.recon=t,i.base64Parser=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.base64Parser,this.step)},t.parse=function(e,r,n,i){void 0===i&&(i=1);if(1===i)if(e.isCont()){if(37!==e.head())return we.error(oe.expected(37,e));e=e.step(),i=2}else if(e.isDone())return we.error(oe.expected(37,e));if(2===i){for(void 0===n&&(n=We.standard().parse(e,r.dataOutput()));n.isCont()&&!e.isEmpty();)n=n.feed(e);if(n.isDone())return n;if(n.isError())return n}return new t(r,n,i)},t}(we),wo=function(e){function t(t,r,n){var i=e.call(this)||this;return i.recon=t,i.output=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.output,this.step)},t.parse=function(e,r,n,i){void 0===i&&(i=1);var o=0;if(1===i)if(e.isCont()){if(o=e.head(),!co.isIdentStartChar(o))return we.error(oe.expected("identifier",e));e=e.step(),n=(n=n||r.textOutput()).write(o),i=2}else if(e.isDone())return we.error(oe.expected("identifier",e));if(2===i){for(;e.isCont()&&(o=e.head(),co.isIdentChar(o));)e=e.step(),n.write(o);if(!e.isEmpty())return we.done(r.ident(n.bind()))}return new t(r,n,i)},t}(we),Oo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.output=r,u.quote=n,u.code=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.output,this.quote,this.code,this.step)},t.parse=function(e,r,n,i,o,u){void 0===i&&(i=0),void 0===o&&(o=0),void 0===u&&(u=1);var s=0;if(1===u){for(;e.isCont()&&(s=e.head(),co.isWhitespace(s));)e=e.step();if(e.isCont()){if(34!==s&&39!==s||i!==s&&0!==i)return we.error(oe.expected("string",e));e=e.step(),n=n||r.textOutput(),i=s,u=2}else if(e.isDone())return we.error(oe.expected("string",e))}e:for(;;){if(2===u){for(;e.isCont()&&(s=e.head())>=32&&s!==i&&92!==s;)e=e.step(),n=n.write(s);if(e.isCont()){if(s===i)return e=e.step(),we.done(n.bind());if(92!==s)return we.error(oe.expected(i,e));e=e.step(),u=3}else if(e.isDone())return we.error(oe.expected(i,e))}if(3===u)if(e.isCont()){if(34===(s=e.head())||36===s||39===s||47===s||64===s||91===s||92===s||93===s||123===s||125===s){e=e.step(),n=n.write(s),u=2;continue}if(98===s){e=e.step(),n=n.write(8),u=2;continue}if(102===s){e=e.step(),n=n.write(12),u=2;continue}if(110===s){e=e.step(),n=n.write(10),u=2;continue}if(114===s){e=e.step(),n=n.write(13),u=2;continue}if(116===s){e=e.step(),n=n.write(9),u=2;continue}if(117!==s)return we.error(oe.expected("escape character",e));e=e.step(),u=4}else if(e.isDone())return we.error(oe.expected("escape character",e));if(u>=4)for(;;){if(e.isCont()){if(s=e.head(),Ve.isDigit(s)){if(e=e.step(),o=16*o+Ve.decodeDigit(s),u<=6){u+=1;continue}n=n.write(o),o=0,u=2;continue e}return we.error(oe.expected("hex digit",e))}if(e.isDone())return we.error(oe.expected("hex digit",e));break}break}return new t(r,n,i,o,u)},t}(we),Po=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.recon=t,o.output=r,o.count=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.output,this.count,this.step)},t.parse=function(e,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var u=0;if(1===o){for(;e.isCont()&&(u=e.head(),co.isWhitespace(u));)e=e.step();if(e.isCont()&&96===u)e=e.step(),i=1,o=2;else if(e.isDone())return we.error(oe.expected("raw string",e))}if(2===o)if(e.isCont())96===e.head()?(e=e.step(),i=2,o=3):(n=n||r.textOutput(),o=4);else if(e.isDone())return we.error(oe.expected("raw string",e));if(3===o)if(e.isCont()){if(96!==e.head())return n=n||r.textOutput(),we.done(n.bind());e=e.step(),n=n||r.textOutput(),i=3,o=4}else if(e.isDone())return n=n||r.textOutput(),we.done(n.bind());for(;;){if(4===o){for(;e.isCont()&&(u=e.head(),(1!==i||u>=32)&&96!==u&&92!==u);)e=e.step(),n=n.write(u);if(e.isCont())if(92===u)e=e.step(),o=5;else{if(96!==u)return we.error(oe.expected(96,e));if(e=e.step(),1===i)return we.done(n.bind());o=6}else if(e.isDone())return we.error(oe.expected(96,e))}if(5===o){if(e.isCont()){u=e.head(),e=e.step(),92!==u&&96!==u&&(n=n.write(92)),n=n.write(u),o=4;continue}if(e.isDone())return we.error(oe.expected("escape character",e))}if(6===o)if(e.isCont()){if(96!==e.head()){n=n.write(96),o=4;continue}e=e.step(),o=7}else if(e.isDone())return we.error(oe.message("unclosed raw string",e));if(7===o){if(e.isCont()){if(96===e.head())return e=e.step(),we.done(n.bind());n=(n=n.write(96)).write(96),o=4;continue}if(e.isDone())return we.error(oe.message("unclosed raw string",e))}break}return new t(r,n,i,o)},t}(we),xo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.sign=r,u.value=n,u.mode=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.sign,this.value,this.mode,this.step)},t.parse=function(e,r,n,i,o,u){void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=2),void 0===u&&(u=1);var s=0;if(1===u){for(;e.isCont()&&(s=e.head(),co.isWhitespace(s));)e=e.step();if(e.isCont())45===s&&(e=e.step(),n=-1),u=2;else if(e.isDone())return we.error(oe.expected("number",e))}if(2===u)if(e.isCont())if(48===(s=e.head()))e=e.step(),u=4;else{if(!(s>=49&&s<=57))return we.error(oe.expected("digit",e));e=e.step(),i=n*(s-48),u=3}else if(e.isDone())return we.error(oe.expected("digit",e));if(3===u){for(;e.isCont()&&(s=e.head())>=48&&s<=57;){var a=10*i+n*(s-48);if(!(-9007199254740991<=a&&a<=9007199254740992))return we.error(oe.message("integer overflow",e));i=a,e=e.step()}if(e.isCont())u=4;else if(e.isDone())return we.done(r.num(i))}if(4===u){if(e.isCont()){if(s=e.head(),o>0&&46===s||o>1&&(69===s||101===s)){var p=re.stringOutput();return p=n<0&&0===i?p.write(45).write(48):p.write(""+i),jo.parse(e,r,p,o)}return 120===s&&n>0&&0===i?(e=e.step(),Co.parse(e,r)):we.done(r.num(i))}if(e.isDone())return we.done(r.num(i))}return new t(r,n,i,o,u)},t.parseInteger=function(e,r){return t.parse(e,r,void 0,void 0,0)},t.parseDecimal=function(e,r){return t.parse(e,r,void 0,void 0,1)},t}(we),jo=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.recon=t,o.output=r,o.mode=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.output,this.mode,this.step)},t.parse=function(e,r,n,i,o){void 0===i&&(i=2),void 0===o&&(o=1);var u=0;if(1===o)if(e.isCont())if(46===(u=e.head()))e=e.step(),n=n.write(u),o=2;else{if(!(i>1)||69!==u&&101!==u)return we.error(oe.expected("decimal or exponent",e));e=e.step(),n=n.write(u),o=5}else if(e.isDone())return we.error(oe.expected("decimal or exponent",e));if(2===o)if(e.isCont()){if(!((u=e.head())>=48&&u<=57))return we.error(oe.expected("digit",e));e=e.step(),n=n.write(u),o=3}else if(e.isDone())return we.error(oe.expected("digit",e));if(3===o){for(;e.isCont()&&(u=e.head())>=48&&u<=57;)e=e.step(),n=n.write(u);if(e.isCont()){if(!(i>1))return we.done(r.num(n.bind()));o=4}else if(e.isDone())return we.done(r.num(n.bind()))}if(4===o){if(69!==(u=e.head())&&101!==u)return we.done(r.num(n.bind()));e=e.step(),n=n.write(u),o=5}if(5===o)if(e.isCont())43!==(u=e.head())&&45!==u||(e=e.step(),n=n.write(u)),o=6;else if(e.isDone())return we.error(oe.unexpected(e));if(6===o)if(e.isCont()){if(!((u=e.head())>=48&&u<=57))return we.error(oe.expected("digit",e));e=e.step(),n=n.write(u),o=7}else if(e.isDone())return we.error(oe.expected("digit",e));if(7===o){for(;e.isCont()&&(u=e.head())>=48&&u<=57;)e=e.step(),n=n.write(u);if(!e.isEmpty())return we.done(r.num(n.bind()))}return new t(r,n,i,o)},t}(we),Co=function(e){function t(t,r,n){var i=e.call(this)||this;return i.recon=t,i.value=r,i.size=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.value,this.size)},t.parse=function(e,r,n,i){void 0===n&&(n=0),void 0===i&&(i=0);for(var o=0;e.isCont()&&(o=e.head(),Ve.isDigit(o));)e=e.step(),n=16*n+Ve.decodeDigit(o),i+=1;return e.isEmpty()?new t(r,n,i):i>0?i<=8?we.done(r.uint32(n)):we.done(r.uint64(n)):we.error(oe.expected("hex digit",e))},t}(we),Eo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.bindingsParser=n,u.templateParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.bindingsParser,this.templateParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);if(1===u){for(void 0===i&&(i=r.parseConditionalOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u)if(e.isCont()){if(62!==e.head())return i;e=e.step(),u=3}else if(e.isDone())return i;if(3===u){for(void 0===o&&(o=r.parseConditionalOperator(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){var s=i.bind(),a=o.bind();return we.done(r.lambda(s,a))}if(o.isError())return o.asError()}return new t(r,n,i,o,u)},t}(we),So=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return s.recon=t,s.builder=r,s.ifParser=n,s.thenParser=i,s.elseParser=o,s.step=u,s}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.ifParser,this.thenParser,this.elseParser,this.step)},t.parse=function(e,r,n,i,o,u,s){void 0===s&&(s=1);var a=0;if(1===s){for(void 0===i&&(i=r.parseOrOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;e.isCont()&&(a=e.head(),co.isSpace(a));)e=e.step();if(e.isCont()){if(63!==a)return i;e=e.step(),s=3}else if(e.isDone())return i}if(3===s){for(void 0===o&&(o=r.parseConditionalOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())s=4;else if(o.isError())return o.asError()}if(4===s){for(;e.isCont()&&(a=e.head(),co.isSpace(a));)e=e.step();if(e.isCont()){if(58!==a)return we.error(oe.expected(58,e));e=e.step(),s=5}else if(e.isDone())return we.error(oe.expected(58,e))}if(5===s){for(void 0===u&&(u=r.parseConditionalOperator(e,n));u.isCont()&&!e.isEmpty();)u=u.feed(e);if(u.isDone()){var p=i.bind(),f=o.bind(),c=u.bind();return we.done(r.conditional(p,f,c))}if(u.isError())return u.asError()}return new t(r,n,i,o,u,s)},t}(we),ko=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.lhsParser=n,u.rhsParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);for(;;){if(1===u){for(void 0===i&&(i=r.parseAndOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u)if(e.isCont()){if(124!==e.head())return i;e=e.step(),u=3}else if(e.isDone())return i;if(3===u){for(void 0===o&&(o=r.parseAndOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){var s=i.bind(),a=o.bind();i=we.done(r.or(s,a)),o=void 0,u=2;continue}if(o.isError())return o.asError()}break}return new t(r,n,i,o,u)},t}(we),Mo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.lhsParser=n,u.rhsParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);for(;;){if(1===u){for(void 0===i&&(i=r.parseBitwiseOrOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u)if(e.isCont()){if(38!==e.head())return i;e=e.step(),u=3}else if(e.isDone())return i;if(3===u){for(void 0===o&&(o=r.parseBitwiseOrOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){var s=i.bind(),a=o.bind();i=we.done(r.and(s,a)),o=void 0,u=2;continue}if(o.isError())return o.asError()}break}return new t(r,n,i,o,u)},t}(we),Ao=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.lhsParser=n,u.rhsParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);for(var s=0;;){if(1===u){for(void 0===i&&(i=r.parseBitwiseXorOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(124!==s)return i;e=e.step(),u=3}else if(e.isDone())return i}if(3===u)if(e.isCont()){if(124===(s=e.head()))return i;u=4}else if(e.isDone())return we.error(oe.unexpected(e));if(4===u){for(void 0===o&&(o=r.parseBitwiseXorOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){var a=i.bind(),p=o.bind();i=we.done(r.bitwiseOr(a,p)),o=void 0,u=2;continue}if(o.isError())return o.asError()}break}return new t(r,n,i,o,u)},t}(we),Do=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.lhsParser=n,u.rhsParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);for(var s=0;;){if(1===u){for(void 0===i&&(i=r.parseBitwiseAndOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(94!==s)return i;e=e.step(),u=3}else if(e.isDone())return i}if(3===u){for(void 0===o&&(o=r.parseBitwiseAndOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){var a=i.bind(),p=o.bind();i=we.done(r.bitwiseXor(a,p)),o=void 0,u=2;continue}if(o.isError())return o.asError()}break}return new t(r,n,i,o,u)},t}(we),Io=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.lhsParser=n,u.rhsParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);for(var s=0;;){if(1===u){for(void 0===i&&(i=r.parseComparisonOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(38!==s)return i;e=e.step(),u=3}else if(e.isDone())return i}if(3===u)if(e.isCont()){if(38===(s=e.head()))return i;u=4}else if(e.isDone())return we.error(oe.unexpected(e));if(4===u){for(void 0===o&&(o=r.parseComparisonOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){var a=i.bind(),p=o.bind();i=we.done(r.bitwiseAnd(a,p)),o=void 0,u=2;continue}if(o.isError())return o.asError()}break}return new t(r,n,i,o,u)},t}(we),To=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return s.recon=t,s.builder=r,s.lhsParser=n,s.operator=i,s.rhsParser=o,s.step=u,s}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u,s){void 0===s&&(s=1);var a=0;if(1===s){for(void 0===i&&(i=r.parseAttrExpression(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;e.isCont()&&(a=e.head(),co.isSpace(a));)e=e.step();if(e.isCont())if(33===a)e=e.step(),s=3;else if(60===a)e=e.step(),s=4;else if(62===a)e=e.step(),s=5;else{if(61!==a)return i;e=e.step(),s=6}else if(e.isDone())return i}if(3===s)if(e.isCont())61===(a=e.head())?(e=e.step(),o="!=",s=7):(o="!",s=7);else if(e.isDone())return we.error(oe.unexpected(e));if(4===s)if(e.isCont())61===(a=e.head())?(e=e.step(),o="<=",s=7):(o="<",s=7);else if(e.isDone())return we.error(oe.unexpected(e));if(5===s)if(e.isCont())61===(a=e.head())?(e=e.step(),o=">=",s=7):(o=">",s=7);else if(e.isDone())return we.error(oe.unexpected(e));if(6===s)if(e.isCont())if(61===(a=e.head()))e=e.step(),o="==",s=7;else{if(62===a)return i;o="=",s=7}else if(e.isDone())return we.error(oe.unexpected(e));if(7===s){for(void 0===u&&(u=r.parseAttrExpression(e,n));u.isCont()&&!e.isEmpty();)u=u.feed(e);if(u.isDone()){var p=i.bind(),f=u.bind();return"<"===o?we.done(r.lt(p,f)):"<="===o?we.done(r.le(p,f)):"=="===o?we.done(r.eq(p,f)):"!="===o?we.done(r.ne(p,f)):">="===o?we.done(r.ge(p,f)):">"===o?we.done(r.gt(p,f)):we.error(oe.message(o,e))}if(u.isError())return u.asError()}return new t(r,n,i,o,u,s)},t}(we),Vo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.fieldParser=n,u.valueParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);for(var s=0;;){if(1===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont())if(64===s)u=2;else if(123===s||91===s)n=n||r.recordBuilder(),u=5;else if(40===s)u=4;else{if(!(33===s||34===s||36===s||37===s||39===s||43===s||45===s||s>=48&&s<=57||96===s||126===s||co.isIdentStartChar(s)))return void 0===n?we.done(r.extant()):we.done(n.bind());u=3}else if(e.isDone())return void 0===n?we.done(r.extant()):we.done(n.bind())}if(2===u){for(void 0===i&&(i=r.parseAttr(e));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone()){(n=n||r.recordBuilder()).push(i.bind()),i=void 0,u=1;continue}if(i.isError())return i.asError()}if(3===u){for(void 0===o&&(o=r.parseAdditiveOperator(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())(n=n||r.valueBuilder()).push(r.item(o.bind())),o=void 0,u=6;else if(o.isError())return o.asError()}if(4===u){for(void 0===o&&(o=r.parseAdditiveOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())void 0===n&&(n=r.valueBuilder()).push(r.item(o.bind())),o=void 0,u=6;else if(o.isError())return o.asError()}if(5===u){for(void 0===o&&(o=r.parseAdditiveOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())o=void 0,u=6;else if(o.isError())return o.asError()}if(6===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(64===s){u=1;continue}return we.done(n.bind())}if(e.isDone())return we.done(n.bind())}break}return new t(r,n,i,o,u)},t}(we),qo=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return s.recon=t,s.builder=r,s.lhsParser=n,s.operator=i,s.rhsParser=o,s.step=u,s}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u,s){void 0===s&&(s=1);for(var a=0;;){if(1===s){for(void 0===i&&(i=r.parseMultiplicativeOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;e.isCont()&&(a=e.head(),co.isSpace(a));)e=e.step();if(e.isCont())if(43===a)e=e.step(),o="+",s=3;else{if(45!==a)return i;e=e.step(),o="-",s=3}else if(e.isDone())return i}if(3===s){for(void 0===u&&(u=r.parseMultiplicativeOperator(e,n));u.isCont()&&!e.isEmpty();)u=u.feed(e);if(u.isDone()){var p=i.bind(),f=u.bind();if("+"===o)i=we.done(r.plus(p,f));else{if("-"!==o)return we.error(oe.message(o,e));i=we.done(r.minus(p,f))}u=void 0,o=void 0,s=2;continue}if(u.isError())return u.asError()}break}return new t(r,n,i,o,u,s)},t}(we),Ro=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return s.recon=t,s.builder=r,s.lhsParser=n,s.operator=i,s.rhsParser=o,s.step=u,s}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},t.parse=function(e,r,n,i,o,u,s){void 0===s&&(s=1);for(var a=0;;){if(1===s){for(void 0===i&&(i=r.parsePrefixOperator(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;e.isCont()&&(a=e.head(),co.isSpace(a));)e=e.step();if(e.isCont())if(42===a)e=e.step(),o="*",s=3;else if(47===a)e=e.step(),o="/",s=3;else{if(37!==a)return i;e=e.step(),o="%",s=3}else if(e.isDone())return i}if(3===s){for(void 0===u&&(u=r.parsePrefixOperator(e,n));u.isCont()&&!e.isEmpty();)u=u.feed(e);if(u.isDone()){var p=i.bind(),f=u.bind();if("*"===o)i=we.done(r.times(p,f));else if("/"===o)i=we.done(r.divide(p,f));else{if("%"!==o)return we.error(oe.message(o,e));i=we.done(r.modulo(p,f))}u=void 0,o=void 0,s=2;continue}if(u.isError())return u.asError()}break}return new t(r,n,i,o,u,s)},t}(we),Uo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.operator=n,u.operandParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.operator,this.operandParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(33===s)e=e.step(),i="!";else if(126===s)e=e.step(),i="~";else if(45===s)e=e.step(),i="-";else{if(43!==s)return r.parseInvokeOperator(e,n);e=e.step(),i="+"}u=2}else if(e.isDone())return r.parseInvokeOperator(e,n)}if(2===u){for(void 0===o&&(o=r.parsePrefixOperator(e,n));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone()){var a=o.bind();return r.isDistinct(a)?"!"===i?we.done(r.not(a)):"~"===i?we.done(r.bitwiseNot(a)):"-"===i?we.done(r.negative(a)):"+"===i?we.done(r.positive(a)):we.error(oe.message(i,e)):we.error(oe.expected("value",e))}if(o.isError())return o.asError()}return new t(r,n,i,o,u)},t}(we),No=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.exprParser=n,u.argsParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.exprParser,this.argsParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u){for(void 0===i&&(i=r.parsePrimary(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())u=2;else if(i.isError())return i.asError()}for(;;){if(2===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(40!==s)return i;e=e.step(),u=3}else if(e.isDone())return i}if(3===u){for(;e.isCont()&&(s=e.head(),co.isWhitespace(s));)e=e.step();if(e.isCont()){if(41===s){e=e.step();var a=i.bind();i=we.done(r.invoke(a,r.extant())),u=2;continue}u=4}else if(e.isDone())return we.error(oe.expected(41,e))}if(4===u){for(void 0===o&&(o=r.parseBlock(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())u=5;else if(o.isError())return o.asError()}if(5===u){for(;e.isCont()&&(s=e.head(),co.isWhitespace(s));)e=e.step();if(e.isCont()){if(41===s){e=e.step();a=i.bind();var p=o.bind();i=we.done(r.invoke(a,p)),o=void 0,u=2;continue}return we.error(oe.expected(41,e))}if(e.isDone())return we.error(oe.expected(41,e))}break}return new t(r,n,i,o,u)},t}(we),zo=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.recon=t,o.builder=r,o.exprParser=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.exprParser,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o){for(;e.isCont()&&(u=e.head(),co.isSpace(u));)e=e.step();e.isCont()?40===u?(e=e.step(),o=3):o=2:e.isDone()&&(o=2)}if(2===o){for(void 0===i&&(i=r.parseLiteral(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())return i;if(i.isError())return i.asError()}if(3===o){for(void 0===i&&(i=r.parseBlockExpression(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())o=4;else if(i.isError())return i.asError()}for(;;){if(4===o){for(;e.isCont()&&(u=e.head(),co.isSpace(u));)e=e.step();if(e.isCont()){if(44!==u)return 41===u?(e=e.step(),void 0!==i?i:we.done(n.bind())):we.error(oe.expected(41,e));e=e.step(),void 0!==i&&(void 0===n&&(n=r.recordBuilder()).push(r.item(i.bind())),i=void 0),o=5}else if(e.isDone())return we.error(oe.expected(41,e))}if(5===o){for(void 0===i&&(i=r.parseBlockExpression(e,n));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone()){i=void 0,o=4;continue}if(i.isError())return i.asError()}break}return new t(r,n,i,o)},t}(we),Fo=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.recon=t,o.builder=r,o.valueParser=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.valueParser,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o){for(;e.isCont()&&(u=e.head(),co.isSpace(u));)e=e.step();if(e.isCont())if(40===u)e=e.step(),o=4;else if(123===u)n=n||r.recordBuilder(),i=r.parseRecord(e,n),o=3;else if(91===u)n=n||r.recordBuilder(),i=r.parseMarkup(e,n),o=3;else if(co.isIdentStartChar(u))i=r.parseIdent(e),o=2;else if(34===u||39===u)i=r.parseString(e),o=2;else if(96===u)i=r.parseRawString(e),o=2;else if(45===u||u>=48&&u<=57)i=r.parseNumber(e),o=2;else if(37===u)i=r.parseData(e),o=2;else{if(36!==u)return void 0===n?we.done(r.extant()):we.done(n.bind());i=r.parseSelector(e),o=2}else if(e.isDone())return void 0===n?we.done(r.extant()):we.done(n.bind())}if(2===o){for(;i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())return(n=n||r.valueBuilder()).push(r.item(i.bind())),we.done(n.bind());if(i.isError())return i.asError()}if(3===o){for(;i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())return we.done(n.bind());if(i.isError())return i.asError()}if(4===o){for(void 0===i&&(i=r.parseBlockExpression(e));i.isCont()&&!e.isEmpty();)i=i.feed(e);if(i.isDone())o=5;else if(i.isError())return i.asError()}if(5===o){for(;e.isCont()&&(u=e.head(),co.isWhitespace(u));)e=e.step();if(e.isCont())return 41===u?(e=e.step(),(n=n||r.valueBuilder()).push(r.item(i.bind())),we.done(n.bind())):we.error(oe.expected(41,e));if(e.isDone())return we.error(oe.expected(41,e))}return new t(r,n,i,o)},t}(we),Lo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.builder=r,u.selector=n,u.valueParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.recon,this.builder,this.selector,this.valueParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()&&36===s)e=e.step(),i=i||r.selector(),u=2;else if(e.isDone())return we.error(oe.expected(36,e))}if(2===u)if(e.isCont())91===(s=e.head())?(e=e.step(),u=8):64===s?(e=e.step(),u=7):58===s?(e=e.step(),u=6):42===s?(e=e.step(),u=5):35===s?(e=e.step(),u=4):u=3;else if(e.isDone())return we.error(oe.unexpected(e));for(;;){if(3===u){for(void 0===o&&(o=r.parseLiteral(e,r.valueBuilder()));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())i=r.get(i,o.bind()),o=void 0,u=10;else if(o.isError())return o.asError()}if(4===u){for(void 0===o&&(o=r.parseInteger(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())i=r.value(r.getItem(i,o.bind())),o=void 0,u=10;else if(o.isError())return o.asError()}if(5===u&&(e.isCont()?58===(s=e.head())?(e=e.step(),i=r.keys(i),u=10):42===s?(e=e.step(),i=r.descendants(i),u=10):(i=r.children(i),u=10):e.isDone()&&(i=r.children(i),u=10)),6===u)if(e.isCont()){if(42!==(s=e.head()))return we.error(oe.expected(42,e));e=e.step(),i=r.values(i),u=10}else if(e.isDone())return we.error(oe.expected(42,e));if(7===u){for(void 0===o&&(o=r.parseIdent(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())i=r.getAttr(i,o.bind()),o=void 0,u=10;else if(o.isError())return o.asError()}if(8===u){for(void 0===o&&(o=r.parseBlockExpression(e));o.isCont()&&!e.isEmpty();)o=o.feed(e);if(o.isDone())u=9;else if(o.isError())return o.asError()}if(9===u){for(;e.isCont()&&(s=e.head(),co.isSpace(s));)e=e.step();if(e.isCont()){if(93!==s)return we.error(oe.expected(93,e));e=e.step(),i=r.filter(i,o.bind()),o=void 0,u=10}else if(e.isDone())return we.error(oe.expected(93,e))}if(10===u)if(e.isCont()){if(91===(s=e.head())){e=e.step(),u=8;continue}if(35===s){e=e.step(),u=4;continue}if(46!==s)return void 0!==n?(n.push(r.item(i)),we.done(n.bind())):we.done(i);e=e.step(),u=11}else if(e.isDone())return void 0!==n?(n.push(r.item(i)),we.done(n.bind())):we.done(i);if(11===u){if(e.isCont()){if(64===(s=e.head())){e=e.step(),u=7;continue}if(58===s){e=e.step(),u=6;continue}if(42===s){e=e.step(),u=5;continue}u=3;continue}if(e.isDone())return we.error(oe.unexpected(e))}break}return new t(r,n,i,o,u)},t}(we),Ko=function(){function e(){}return e.prototype.parseBlock=function(e){return lo.parse(e,this)},e.prototype.parseAttr=function(e){return ho.parse(e,this)},e.prototype.parseBlockItem=function(e){return yo.parse(e,this)},e.prototype.parseInlineItem=function(e){return vo.parse(e,this)},e.prototype.parseRecord=function(e,t){return bo.parse(e,this,t)},e.prototype.parseMarkup=function(e,t){return mo.parse(e,this,t)},e.prototype.parseData=function(e){return go.parse(e,this)},e.prototype.parseIdent=function(e){return wo.parse(e,this)},e.prototype.parseString=function(e){return Oo.parse(e,this)},e.prototype.parseRawString=function(e){return Po.parse(e,this)},e.prototype.parseNumber=function(e){return xo.parse(e,this)},e.prototype.parseInteger=function(e){return xo.parseInteger(e,this)},e.prototype.parseBlockExpression=function(e,t){return this.parseLambdaFunc(e,t)},e.prototype.parseLambdaFunc=function(e,t){return Eo.parse(e,this,t)},e.prototype.parseConditionalOperator=function(e,t){return So.parse(e,this,t)},e.prototype.parseOrOperator=function(e,t){return ko.parse(e,this,t)},e.prototype.parseAndOperator=function(e,t){return Mo.parse(e,this,t)},e.prototype.parseBitwiseOrOperator=function(e,t){return Ao.parse(e,this,t)},e.prototype.parseBitwiseXorOperator=function(e,t){return Do.parse(e,this,t)},e.prototype.parseBitwiseAndOperator=function(e,t){return Io.parse(e,this,t)},e.prototype.parseComparisonOperator=function(e,t){return To.parse(e,this,t)},e.prototype.parseAttrExpression=function(e,t){return Vo.parse(e,this,t)},e.prototype.parseAdditiveOperator=function(e,t){return qo.parse(e,this,t)},e.prototype.parseMultiplicativeOperator=function(e,t){return Ro.parse(e,this,t)},e.prototype.parsePrefixOperator=function(e,t){return Uo.parse(e,this,t)},e.prototype.parseInvokeOperator=function(e,t){return No.parse(e,this,t)},e.prototype.parsePrimary=function(e,t){return zo.parse(e,this,t)},e.prototype.parseLiteral=function(e,t){return Fo.parse(e,this,t)},e.prototype.parseSelector=function(e,t){return Lo.parse(e,this,t)},e.prototype.blockParser=function(){return new lo(this)},e.prototype.parseBlockString=function(e){for(var t=re.stringInput(e);t.isCont()&&co.isWhitespace(t.head());)t=t.step();var r=this.parseBlock(t);if(r.isDone())for(;t.isCont()&&co.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e}(),Bo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.isDistinct=function(e){return e.isDistinct()},t.prototype.item=function(e){return e},t.prototype.value=function(e){return e.toValue()},t.prototype.attr=function(e,t){return 1===arguments.length?tr.of(e):tr.of(e,t)},t.prototype.slot=function(e,t){return 1===arguments.length?$t.of(e):$t.of(e,t)},t.prototype.valueBuilder=function(){return ir.builder()},t.prototype.recordBuilder=function(){return or.create()},t.prototype.dataOutput=function(){return cr.output()},t.prototype.textOutput=function(){return hr.output()},t.prototype.ident=function(e){if(e instanceof hr){var t=e.stringValue();if("true"===t)return br.from(!0);if("false"===t)return br.from(!1)}return e},t.prototype.num=function(e){if("number"==typeof e)return yr.from(e);if("string"==typeof e)return yr.from(+e);throw new TypeError(""+e)},t.prototype.uint32=function(e){return yr.uint32(e)},t.prototype.uint64=function(e){return yr.uint64(e)},t.prototype.bool=function(e){return br.from(e)},t.prototype.selector=function(){return $r.identity()},t.prototype.extant=function(){return ir.extant()},t.prototype.absent=function(){return ir.absent()},t.prototype.conditional=function(e,t,r){return e.conditional(t,r)},t.prototype.or=function(e,t){return new Dr(e,t)},t.prototype.and=function(e,t){return new Ir(e,t)},t.prototype.bitwiseOr=function(e,t){return new Tr(e,t)},t.prototype.bitwiseXor=function(e,t){return new Vr(e,t)},t.prototype.bitwiseAnd=function(e,t){return new qr(e,t)},t.prototype.lt=function(e,t){return new Rr(e,t)},t.prototype.le=function(e,t){return new Ur(e,t)},t.prototype.eq=function(e,t){return new Nr(e,t)},t.prototype.ne=function(e,t){return new zr(e,t)},t.prototype.ge=function(e,t){return new Fr(e,t)},t.prototype.gt=function(e,t){return new Lr(e,t)},t.prototype.plus=function(e,t){return new Kr(e,t)},t.prototype.minus=function(e,t){return new Br(e,t)},t.prototype.times=function(e,t){return new Wr(e,t)},t.prototype.divide=function(e,t){return new Hr(e,t)},t.prototype.modulo=function(e,t){return new Xr(e,t)},t.prototype.not=function(e){return new Yr(e)},t.prototype.bitwiseNot=function(e){return new Gr(e)},t.prototype.negative=function(e){return e instanceof yr?e.negative():new _r(e)},t.prototype.positive=function(e){return new Qr(e)},t.prototype.invoke=function(e,t){return new Zr(e,t)},t.prototype.lambda=function(e,t){return e.lambda(t)},t.prototype.get=function(e,t){return e.get(t)},t.prototype.getAttr=function(e,t){return e.getAttr(t)},t.prototype.getItem=function(e,t){return e.getItem(t)},t.prototype.children=function(e){return $r.literal(e).children()},t.prototype.descendants=function(e){return $r.literal(e).descendants()},t.prototype.keys=function(e){return $r.literal(e).keys()},t.prototype.values=function(e){return $r.literal(e).values()},t.prototype.filter=function(e,t){return e.filter(t)},t}(Ko),Wo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.key=r,u.value=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.key,this.value,this.part,this.step)},t.sizeOf=function(e,t,r){var n=0;return n+=1,n+=e.sizeOfValue(t),e.isExtant(e.item(r))||(n+=1,n+=e.sizeOfBlockValue(r),n+=1),n},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u&&e.isCont()&&(e=e.write(64),u=2),2===u)if((o=void 0===o?r.writeValue(e,n):o.pull(e)).isDone()){if(o=void 0,r.isExtant(r.item(i)))return ee.end();u=3}else if(o.isError())return o.asError();if(3===u&&e.isCont()&&(e=e.write(40),u=4),4===u)if((o=void 0===o?r.writeBlockValue(e,i):o.pull(e)).isDone())o=void 0,u=5;else if(o.isError())return o.asError();return 5===u&&e.isCont()?(e=e.write(41),ee.end()):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t}(ee),Ho=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.key=r,u.value=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.key,this.value,this.part,this.step)},t.sizeOf=function(e,t,r){var n=0;return n+=e.sizeOfValue(t),n+=1,e.isExtant(e.item(r))||(n+=e.sizeOfValue(r)),n},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u)if((o=void 0===o?r.writeValue(e,n):o.pull(e)).isDone())o=void 0,u=2;else if(o.isError())return o.asError();if(2===u&&e.isCont()){if(e=e.write(58),r.isExtant(r.item(i)))return ee.end();u=3}if(3===u){if((o=void 0===o?r.writeValue(e,i):o.pull(e)).isDone())return ee.end();if(o.isError())return o.asError()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t}(ee),Xo=function(e){function t(t,r,n,i,o,u,s,a,p,f,c,l){var h=e.call(this)||this;return h.recon=t,h.items=r,h.inBlock=n,h.inMarkup=i,h.inBraces=o,h.inBrackets=u,h.first=s,h.markupSafe=a,h.item=p,h.next=f,h.part=c,h.step=l,h}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.items,this.inBlock,this.inMarkup,this.inBraces,this.inBrackets,this.first,this.markupSafe,this.item,this.next,this.part,this.step)},t.sizeOf=function(e,r,n,i){for(var o,u=0,s=!1,a=!1,p=!0,f=!0;void 0!==o||r.hasNext();){var c=void 0;void 0===o?c=r.next().value:(c=o,o=void 0),r.hasNext()&&(o=r.next().value),e.isExpression(c)&&(f=!1),a&&e.isAttr(c)&&(s&&(u+=1,s=!1),u+=1,a=!1),e.isAttr(c)?(s?(u+=1,s=!1):a&&(u+=1,a=!1),u+=e.sizeOfItem(c),p=!1):a&&e.isText(c)?(s&&(u+=1,s=!1),u+=e.sizeOfMarkupText(c)):s?(p?p=!1:u+=1,u+=t.sizeOfBlockItem(e,c)):a?e.isRecord(c)&&e.isMarkupSafe(e.items(c))?(u+=e.sizeOfBlock(e.items(c),!1,!0),void 0!==o&&e.isText(o)?(u+=e.sizeOfMarkupText(o),o=void 0):void 0===o||e.isAttr(o)?(u+=1,a=!1):(u+=1,s=!0,p=!0)):(u+=1,u+=e.sizeOfItem(c),s=!0,p=!1):!f||!e.isText(c)||void 0===o||e.isField(o)||e.isText(o)||e.isBool(o)?n&&!s?(p?p=!1:u+=1,u+=t.sizeOfBlockItem(e,c)):i&&e.isText(c)&&void 0===o?(u+=1,u+=e.sizeOfMarkupText(c),u+=1):!i&&e.isValue(c)&&!e.isRecord(c)&&(!p&&void 0===o||void 0!==o&&e.isAttr(o))?(!p&&(e.isText(c)&&e.isIdent(c)||e.isNum(c)||e.isBool(c))&&(u+=1),u+=e.sizeOfItem(c)):(u+=1,u+=e.sizeOfItem(c),s=!0,p=!1):(u+=1,u+=e.sizeOfMarkupText(c),a=!0)}return s&&(u+=1),a&&(u+=1),u},t.sizeOfBlockItem=function(e,t){var r=0;return e.isField(t)?r+=e.sizeOfSlot(e.key(t),e.value(t)):r+=e.sizeOfItem(t),r},t.write=function(e,r,n,i,o,u,s,a,p,f,c,l,h){for(void 0===u&&(u=!1),void 0===s&&(s=!1),void 0===a&&(a=!0),void 0===p&&(p=!0),void 0===h&&(h=1);;){if(1===h){if(void 0===c&&!n.hasNext()){h=10;break}void 0===c?f=n.next().value:(f=c,c=void 0),n.hasNext()&&(c=n.next().value),r.isExpression(f)&&(p=!1),h=2}if(2===h&&e.isCont()&&(s&&r.isAttr(f)?(u&&(e=e.write(125),u=!1),h=3):h=4),3===h&&e.isCont()&&(e=e.write(93),s=!1,h=4),4===h&&e.isCont()&&(r.isAttr(f)?(u?(e=e.write(125),u=!1):s&&(e=e.write(93),s=!1),l=r.writeItem(e,f),a=!1,h=7):s&&r.isText(f)?(u&&(e=e.write(125),u=!1),l=r.writeMarkupText(e,f),h=7):u?(a?a=!1:e=e.write(44),l=t.writeBlockItem(e,r,f),h=7):s?r.isRecord(f)&&r.isMarkupSafe(r.items(f))?(l=r.writeBlock(e,r.items(f),!1,!0),h=5):(e=e.write(123),l=r.writeItem(e,f),u=!0,a=!1,h=7):!p||!r.isText(f)||void 0===c||r.isField(c)||r.isText(c)||r.isBool(c)?i&&!u?(a?a=!1:e=e.write(44),l=t.writeBlockItem(e,r,f),h=7):o&&r.isText(f)&&void 0===c?(e=e.write(91),l=r.writeMarkupText(e,f),h=8):!o&&r.isValue(f)&&!r.isRecord(f)&&(!a&&void 0===c||void 0!==c&&r.isAttr(c))?(!a&&(r.isText(f)&&r.isIdent(f)||r.isNum(f)||r.isBool(f))&&(e=e.write(32)),l=r.writeItem(e,f),h=7):(e=e.write(123),l=r.writeItem(e,f),u=!0,a=!1,h=7):(e=e.write(91),l=r.writeMarkupText(e,f),s=!0,h=7)),5===h)if((l=l.pull(e)).isDone())l=void 0,h=6;else if(l.isError())return l.asError();if(6===h&&e.isCont()){if(void 0===c||!r.isText(c)){if(void 0===c||r.isAttr(c)){e=e.write(93),s=!1,h=1;continue}e=e.write(123),u=!0,a=!0,h=1;continue}l=r.writeMarkupText(e,c),c=void 0,h=7}if(7===h){if((l=l.pull(e)).isDone()){l=void 0,h=1;continue}if(l.isError())return l.asError()}if(8===h)if((l=l.pull(e)).isDone())l=void 0,h=9;else if(l.isError())return l.asError();if(9!==h||!e.isCont())break;e=e.write(93),h=1}if(10===h&&(u?e.isCont()&&(e=e.write(125),h=11):h=11),11===h){if(!s)return ee.end();if(e.isCont())return e=e.write(93),ee.end()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u,s,a,p,f,c,l,h)},t.writeBlockItem=function(e,t,r){return t.isField(r)?t.writeSlot(e,t.key(r),t.value(r)):t.writeItem(e,r)},t}(ee),Yo=function(e){function t(t,r,n,i,o,u,s,a){var p=e.call(this)||this;return p.recon=t,p.items=r,p.inParens=n,p.first=i,p.item=o,p.next=u,p.part=s,p.step=a,p}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.items,this.inParens,this.first,this.item,this.next,this.part,this.step)},t.sizeOf=function(e,t){for(var r,n=0,i=!1,o=!0;void 0!==r||t.hasNext();){var u=void 0;void 0===r?u=t.next().value:(u=r,r=void 0),t.hasNext()&&(r=t.next().value),i||o||(n+=1),e.isAttr(u)?(i&&(n+=1,i=!1),n+=e.sizeOfItem(u),o=!1):i?(o?o=!1:n+=1,n+=e.sizeOfBlockItem(u)):e.isValue(u)&&!e.isRecord(u)&&(!o&&void 0===r||void 0!==r&&e.isAttr(r))?n+=e.sizeOfItem(u):(n+=1,n+=e.sizeOfItem(u),i=!0,o=!1)}return i&&(n+=1),n},t.write=function(e,r,n,i,o,u,s,a,p){for(void 0===i&&(i=!1),void 0===o&&(o=!0),void 0===p&&(p=1);;){if(1===p){if(void 0===s&&!n.hasNext()){p=5;break}void 0===s?u=n.next().value:(u=s,s=void 0),n.hasNext()&&(s=n.next().value),p=2}if(2===p&&e.isCont()&&(i||o||(e=e.write(32)),p=3),3===p&&e.isCont()&&(r.isAttr(u)?(i&&(e=e.write(41),i=!1),a=r.writeItem(e,u),o=!1,p=4):i?(o?o=!1:e=e.write(44),a=r.writeBlockItem(e,u),p=4):r.isValue(u)&&!r.isRecord(u)&&(!o&&void 0===s||void 0!==s&&r.isAttr(s))?(a=r.writeItem(e,u),p=4):(e=e.write(40),a=r.writeItem(e,u),i=!0,o=!1,p=4)),4===p){if((a=a.pull(e)).isDone()){a=void 0,p=1;continue}if(a.isError())return a.asError()}break}if(5===p){if(!i)return ee.end();if(e.isCont())return e=e.write(41),ee.end()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u,s,a,p)},t}(ee),Go=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.text=t,o.index=r,o.escape=n,o.step=i,o}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.text,this.index,this.escape,this.step)},t.sizeOf=function(e){for(var t=0,r=0,n=e.length;r<n;r=e.offsetByCodePoints(r,1)){var i=e.codePointAt(r);void 0===i&&(i=e.charCodeAt(r)),t+=36===i||64===i||91===i||92===i||93===i||123===i||125===i||8===i||12===i||10===i||13===i||9===i?2:i<32?6:Ue.sizeOf(i)}return t},t.write=function(e,r,n,i,o){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=1);for(var u=r.length;e.isCont();)if(1===o){if(!(n<u))return ee.end();var s=r.codePointAt(n);void 0===s&&(s=r.charCodeAt(n)),n=r.offsetByCodePoints(n,1),36===s||64===s||91===s||92===s||93===s||123===s||125===s?(e=e.write(92),i=s,o=2):8===s?(e=e.write(92),i=98,o=2):12===s?(e=e.write(92),i=102,o=2):10===s?(e=e.write(92),i=110,o=2):13===s?(e=e.write(92),i=114,o=2):9===s?(e=e.write(92),i=116,o=2):s<32?(e=e.write(92),i=s,o=3):e=e.write(s)}else 2===o?(e=e.write(i),i=0,o=1):3===o?(e=e.write(117),o=4):4===o?(e=e.write(Ve.uppercase.encodeDigit(i>>>12&15)),o=5):5===o?(e=e.write(Ve.uppercase.encodeDigit(i>>>8&15)),o=6):6===o?(e=e.write(Ve.uppercase.encodeDigit(i>>>4&15)),o=7):7===o&&(e=e.write(Ve.uppercase.encodeDigit(15&i)),i=0,o=1);return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o)},t}(ee),_o=function(e){function t(t,r,n){var i=e.call(this)||this;return i.array=t,i.part=r,i.step=n,i}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.array,this.part,this.step)},t.sizeOf=function(e){return 1+(Math.floor(4*e/3)+3&-4)},t.write=function(e,r,n,i){if(void 0===i&&(i=1),1===i&&e.isCont()&&(e=e.write(37),i=2),2===i){if((n=void 0===n?We.standard().writeUint8Array(e,r):n.pull(e)).isDone())return n=void 0,ee.end();if(n.isError())return n.asError()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i)},t}(ee),Qo=function(e){function t(t,r){var n=e.call(this)||this;return n.ident=t,n.index=r,n}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.ident,this.index)},t.sizeOf=function(e){return Ue.sizeOf(e)},t.write=function(e,r,n){var i;void 0===n&&(n=0);var o=r.length;if(0===o)return ee.error(new $("empty identifier"));for(0===n&&e.isCont()&&(void 0===(i=r.codePointAt(0))&&(i=r.charCodeAt(0)),co.isIdentStartChar(i)&&(e=e.write(i),n=r.offsetByCodePoints(0,1)));n<o&&e.isCont();){if(void 0===(i=r.codePointAt(n))&&(i=r.charCodeAt(n)),!co.isIdentChar(i))return ee.error(new $("invalid identifier"));e=e.write(i),n=r.offsetByCodePoints(n,1)}return n>=o?ee.end():e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n)},t}(ee),Zo=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.string=t,o.index=r,o.escape=n,o.step=i,o}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.string,this.index,this.escape,this.step)},t.sizeOf=function(e){var t=0;t+=1;for(var r=0,n=e.length;r<n;r=e.offsetByCodePoints(r,1)){var i=e.codePointAt(r);void 0===i&&(i=e.charCodeAt(r)),t+=34===i||92===i||8===i||12===i||10===i||13===i||9===i?2:i<32?6:Ue.sizeOf(i)}return t+=1},t.write=function(e,r,n,i,o){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=1),1===o&&e.isCont()&&(e=e.write(34),o=2);for(var u=r.length;o>=2&&o<=8&&e.isCont();)if(2===o){if(!(n<u)){o=9;break}var s=r.codePointAt(n);void 0===s&&(s=r.charCodeAt(n)),n=r.offsetByCodePoints(n,1),34===s||92===s?(e=e.write(92),i=s,o=3):8===s?(e=e.write(92),i=98,o=3):12===s?(e=e.write(92),i=102,o=3):10===s?(e=e.write(92),i=110,o=3):13===s?(e=e.write(92),i=114,o=3):9===s?(e=e.write(92),i=116,o=3):s<32?(e=e.write("\\"),i=s,o=4):e=e.write(s)}else 3===o?(e=e.write(i),i=0,o=2):4===o?(e=e.write(117),o=5):5===o?(e=e.write(Ve.uppercase.encodeDigit(i>>>12&15)),o=6):6===o?(e=e.write(Ve.uppercase.encodeDigit(i>>>8&15)),o=7):7===o?(e=e.write(Ve.uppercase.encodeDigit(i>>>4&15)),o=8):8===o&&(e=e.write(Ve.uppercase.encodeDigit(15&i)),i=0,o=2);return 9===o&&e.isCont()?(e=e.write(34),ee.end()):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o)},t}(ee),Jo=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.bindings=r,u.template=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.bindings,this.template,this.part,this.step)},t.sizeOf=function(e,t,r){var n=0;return n+=e.sizeOfPrimary(t),n+=4,n+=e.sizeOfValue(r)},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u)if((o=void 0===o?r.writePrimary(e,n):o.pull(e)).isDone())o=void 0,u=2;else if(o.isError())return o.asError();if(2===u&&e.isCont()&&(e=e.write(32),u=3),3===u&&e.isCont()&&(e=e.write(61),u=4),4===u&&e.isCont()&&(e=e.write(62),u=5),5===u&&e.isCont()&&(e=e.write(32),u=6),6===u){if((o=void 0===o?r.writeValue(e,i):o.pull(e)).isDone())return ee.end();if(o.isError())return o.asError()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t}(ee),$o=function(e){function t(t,r,n,i,o,u,s){var a=e.call(this)||this;return a.recon=t,a.ifTerm=r,a.thenTerm=n,a.elseTerm=i,a.precedence=o,a.part=u,a.step=s,a}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.ifTerm,this.thenTerm,this.elseTerm,this.precedence,this.part,this.step)},t.sizeOf=function(e,t,r,n,i){var o=0;return e.precedence(t)>0&&e.precedence(t)<=i?(o+=1,o+=e.sizeOfItem(t),o+=1):o+=e.sizeOfItem(t),o+=3,o+=e.sizeOfItem(r),o+=3,o+=e.sizeOfItem(n)},t.write=function(e,r,n,i,o,u,s,a){if(void 0===a&&(a=1),1===a&&(r.precedence(n)>0&&r.precedence(n)<=u?e.isCont()&&(e=e.write(40),a=2):a=2),2===a)if((s=void 0===s?r.writeItem(e,n):s.pull(e)).isDone())s=void 0,a=3;else if(s.isError())return s.asError();if(3===a&&(r.precedence(n)>0&&r.precedence(n)<=u?e.isCont()&&(e=e.write(41),a=4):a=4),4===a&&e.isCont()&&(e=e.write(32),a=5),5===a&&e.isCont()&&(e=e.write(63),a=6),6===a&&e.isCont()&&(e=e.write(32),a=7),7===a)if((s=void 0===s?r.writeItem(e,i):s.pull(e)).isDone())s=void 0,a=8;else if(s.isError())return s.asError();if(8===a&&e.isCont()&&(e=e.write(32),a=9),9===a&&e.isCont()&&(e=e.write(58),a=10),10===a&&e.isCont()&&(e=e.write(32),a=11),11===a){if((s=void 0===s?r.writeItem(e,o):s.pull(e)).isDone())return ee.end();if(s.isError())return s.asError()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u,s,a)},t}(ee),eu=function(e){function t(t,r,n,i,o,u,s){var a=e.call(this)||this;return a.recon=t,a.lhs=r,a.operator=n,a.rhs=i,a.precedence=o,a.part=u,a.step=s,a}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.lhs,this.operator,this.rhs,this.precedence,this.part,this.step)},t.sizeOf=function(e,t,r,n,i){var o=0;return e.precedence(t)<i?(o+=1,o+=e.sizeOfItem(t),o+=1):o+=e.sizeOfItem(t),o+=1,o+=Ue.sizeOf(r),o+=1,e.precedence(n)<i?(o+=1,o+=e.sizeOfItem(n),o+=1):o+=e.sizeOfItem(n),o},t.write=function(e,r,n,i,o,u,s,a){if(void 0===a&&(a=1),1===a&&(r.precedence(n)<u?e.isCont()&&(e=e.write(40),a=2):a=2),2===a)if((s=void 0===s?r.writeItem(e,n):s.pull(e)).isDone())s=void 0,a=3;else if(s.isError())return s.asError();if(3===a&&(r.precedence(n)<u?e.isCont()&&(e=e.write(41),a=4):a=4),4===a&&e.isCont()&&(e=e.write(32),a=5),5===a)if((s=void 0===s?re.writeString(e,i):s.pull(e)).isDone())s=void 0,a=6;else if(s.isError())return s.asError();if(6===a&&e.isCont()&&(e=e.write(32),a=7),7===a&&(r.precedence(o)<u?e.isCont()&&(e=e.write(40),a=8):a=8),8===a)if((s=void 0===s?r.writeItem(e,o):s.pull(e)).isDone())s=void 0,a=9;else if(s.isError())return s.asError();if(9===a){if(!(r.precedence(o)<u))return ee.end();if(e.isCont())return e=e.write(41),ee.end()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u,s,a)},t}(ee),tu=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return s.recon=t,s.operator=r,s.rhs=n,s.precedence=i,s.part=o,s.step=u,s}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.operator,this.rhs,this.precedence,this.part,this.step)},t.sizeOf=function(e,t,r,n){var i=0;return i+=Ue.sizeOf(t),e.precedence(r)<n?(i+=1,i+=e.sizeOfItem(r),i+=1):i+=e.sizeOfItem(r),i},t.write=function(e,r,n,i,o,u,s){if(void 0===s&&(s=1),1===s)if((u=void 0===u?re.writeString(e,n):u.pull(e)).isDone())u=void 0,s=2;else if(u.isError())return u.asError();if(2===s&&(r.precedence(i)<o?e.isCont()&&(e=e.write(40),s=3):s=3),3===s)if((u=void 0===u?r.writeItem(e,i):u.pull(e)).isDone())u=void 0,s=4;else if(u.isError())return u.asError();if(4===s){if(!(r.precedence(i)<o))return ee.end();if(e.isCont())return e=e.write(41),ee.end()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u,s)},t}(ee),ru=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.func=r,u.args=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.func,this.args,this.part,this.step)},t.sizeOf=function(e,t,r){var n=0;return n+=e.sizeOfValue(t),n+=1,n+=e.sizeOfBlockValue(r),n+=1},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u)if((o=void 0===o?r.writeValue(e,n):o.pull(e)).isDone())o=void 0,u=2;else if(o.isError())return o.asError();if(2===u&&e.isCont()&&(e=e.write(40),u=3),3===u)if((o=void 0===o?r.writeBlockValue(e,i):o.pull(e)).isDone())o=void 0,u=4;else if(o.isError())return o.asError();return 4===u&&e.isCont()?(e=e.write(41),ee.end()):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t}(ee),nu=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.item=r,u.then=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.item,this.then,this.part,this.step)},t.sizeOf=function(e,t,r){var n=0;return e.precedence(t)<e.precedence(e.item(r))?(n+=1,n+=e.sizeOfItem(t),n+=1):n+=e.sizeOfItem(t),n+=e.sizeOfThen(r)},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u&&(r.precedence(n)<r.precedence(r.item(i))?e.isCont()&&(e=e.write(40),u=2):u=2),2===u)if((o=void 0===o?r.writeItem(e,n):o.pull(e)).isDone())o=void 0,u=3;else if(o.isError())return o.asError();return 3===u&&(r.precedence(n)<r.precedence(r.item(i))?e.isCont()&&(e=e.write(41),u=4):u=4),4===u?r.writeThen(e,i):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t}(ee),iu=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.key=r,u.then=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.key,this.then,this.part,this.step)},t.sizeOf=function(e,t,r){var n=1;return e.isRecord(e.item(t))?(n+=1,n+=e.sizeOfBlockValue(t),n+=1):n+=e.sizeOfValue(t),n+=e.sizeOfThen(r)},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u&&e.isCont()?(e=e.write(36),u=3):2===u&&e.isCont()&&(e=e.write(46),u=3),3===u&&(r.isRecord(r.item(n))?e.isCont()&&(e=e.write(123),u=4):u=4),4===u)if((o=void 0===o?r.isRecord(r.item(n))?r.writeBlockValue(e,n):r.writeValue(e,n):o.pull(e)).isDone())o=void 0,u=5;else if(o.isError())return o.asError();return 5===u&&(r.isRecord(r.item(n))?e.isCont()&&(e=e.write(125),u=6):u=6),6===u?r.writeThen(e,i):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t.writeThen=function(e,r,n,i){return t.write(e,r,n,i,void 0,2)},t}(ee),ou=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.key=r,u.then=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.key,this.then,this.part,this.step)},t.sizeOf=function(e,t,r){var n=2;return n+=e.sizeOfValue(t),n+=e.sizeOfThen(r)},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u&&e.isCont()?(e=e.write(36),u=3):2===u&&e.isCont()&&(e=e.write(46),u=3),3===u&&e.isCont()&&(e=e.write(64),u=4),4===u){if((o=void 0===o?r.writeValue(e,n):o.pull(e)).isDone())return r.writeThen(e,i);if(o.isError())return o.asError()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t.writeThen=function(e,r,n,i){return t.write(e,r,n,i,void 0,2)},t}(ee),uu=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.index=r,u.then=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.index,this.then,this.part,this.step)},t.sizeOf=function(e,t,r){var n=2;return n+=e.sizeOfValue(t),n+=e.sizeOfThen(r)},t.sizeOfThen=function(e,t,r){var n=1;return n+=e.sizeOfValue(t),n+=e.sizeOfThen(r)},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u&&e.isCont()&&(e=e.write(36),u=2),2===u&&e.isCont()&&(e=e.write(35),u=3),3===u){if((o=void 0===o?r.writeValue(e,n):o.pull(e)).isDone())return r.writeThen(e,i);if(o.isError())return o.asError()}return e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t.writeThen=function(e,r,n,i){return t.write(e,r,n,i,void 0,2)},t}(ee),su=function(e){function t(t,r,n){var i=e.call(this)||this;return i.recon=t,i.then=r,i.step=n,i}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.then,this.step)},t.sizeOf=function(e,t){var r=3;return r+=e.sizeOfThen(t)},t.write=function(e,r,n,i){return void 0===i&&(i=1),1===i&&e.isCont()?(e=e.write(36),i=3):2===i&&e.isCont()&&(e=e.write(46),i=3),3===i&&e.isCont()&&(e=e.write(42),i=4),4===i&&e.isCont()?(e=e.write(58),r.writeThen(e,n)):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i)},t.writeThen=function(e,r,n){return t.write(e,r,n,2)},t}(ee),au=function(e){function t(t,r,n){var i=e.call(this)||this;return i.recon=t,i.then=r,i.step=n,i}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.then,this.step)},t.sizeOf=function(e,t){var r=3;return r+=e.sizeOfThen(t)},t.write=function(e,r,n,i){return void 0===i&&(i=1),1===i&&e.isCont()?(e=e.write(36),i=3):2===i&&e.isCont()&&(e=e.write(46),i=3),3===i&&e.isCont()&&(e=e.write(58),i=4),4===i&&e.isCont()?(e=e.write(42),r.writeThen(e,n)):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i)},t.writeThen=function(e,r,n){return t.write(e,r,n,2)},t}(ee),pu=function(e){function t(t,r,n){var i=e.call(this)||this;return i.recon=t,i.then=r,i.step=n,i}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.then,this.step)},t.sizeOf=function(e,t){var r=2;return r+=e.sizeOfThen(t)},t.write=function(e,r,n,i){return void 0===i&&(i=1),1===i&&e.isCont()?(e=e.write(36),i=3):2===i&&e.isCont()&&(e=e.write(46),i=3),3===i&&e.isCont()?(e=e.write(42),r.writeThen(e,n)):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i)},t.writeThen=function(e,r,n){return t.write(e,r,n,2)},t}(ee),fu=function(e){function t(t,r,n){var i=e.call(this)||this;return i.recon=t,i.then=r,i.step=n,i}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.then,this.step)},t.sizeOf=function(e,t){var r=3;return r+=e.sizeOfThen(t)},t.write=function(e,r,n,i){return void 0===i&&(i=1),1===i&&e.isCont()?(e=e.write(36),i=3):2===i&&e.isCont()&&(e=e.write(46),i=3),3===i&&e.isCont()&&(e=e.write(42),i=4),4===i&&e.isCont()?(e=e.write(42),r.writeThen(e,n)):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i)},t.writeThen=function(e,r,n){return t.write(e,r,n,2)},t}(ee),cu=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.recon=t,u.predicate=r,u.then=n,u.part=i,u.step=o,u}return C(t,e),t.prototype.pull=function(e){return t.write(e,this.recon,this.predicate,this.then,this.part,this.step)},t.sizeOf=function(e,t,r){var n=2;return n+=e.sizeOfValue(t),n+=1,n+=e.sizeOfThen(r)},t.sizeOfThen=function(e,t,r){var n=1;return n+=e.sizeOfValue(t),n+=1,n+=e.sizeOfThen(r)},t.write=function(e,r,n,i,o,u){if(void 0===u&&(u=1),1===u&&e.isCont()&&(e=e.write(36),u=2),2===u&&e.isCont()&&(e=e.write(91),u=3),3===u)if((o=void 0===o?r.writeValue(e,n):o.pull(e)).isDone())o=void 0,u=4;else if(o.isError())return o.asError();return 4===u&&e.isCont()?(e=e.write(93),r.writeThen(e,i)):e.isDone()?ee.error(new $("truncated")):e.isError()?ee.error(e.trap()):new t(r,n,i,o,u)},t.writeThen=function(e,r,n,i){return t.write(e,r,n,i,void 0,2)},t}(ee),lu=function(){function e(){}return e.prototype.sizeOfAttr=function(e,t){return Wo.sizeOf(this,e,t)},e.prototype.writeAttr=function(e,t,r){return Wo.write(e,this,t,r)},e.prototype.sizeOfSlot=function(e,t){return Ho.sizeOf(this,e,t)},e.prototype.writeSlot=function(e,t,r){return Ho.write(e,this,t,r)},e.prototype.sizeOfBlock=function(e,t,r){if(3===arguments.length)return Xo.sizeOf(this,e,t,r);var n=this.items(e);return n.hasNext()?Xo.sizeOf(this,n,this.isBlockSafe(this.items(e)),!1):2},e.prototype.writeBlock=function(e,t,r,n){if(4===arguments.length)return Xo.write(e,this,t,r,n);var i=this.items(t);return i.hasNext()?Xo.write(e,this,i,this.isBlockSafe(this.items(t)),!1):re.writeString(e,"{}")},e.prototype.sizeOfRecord=function(e){var t=this.items(e);return t.hasNext()?Xo.sizeOf(this,t,!1,!1):2},e.prototype.writeRecord=function(e,t){var r=this.items(t);return r.hasNext()?Xo.write(e,this,r,!1,!1):re.writeString(e,"{}")},e.prototype.sizeOfPrimary=function(e){if(this.isRecord(this.item(e))){var t=this.items(this.item(e));if(t.hasNext())return Yo.sizeOf(this,t)}else if(!this.isExtant(this.item(e)))return this.sizeOfValue(e);return 2},e.prototype.writePrimary=function(e,t){if(this.isRecord(this.item(t))){var r=this.items(this.item(t));if(r.hasNext())return Yo.write(e,this,r)}else if(!this.isExtant(this.item(t)))return this.writeValue(e,t);return re.writeString(e,"()")},e.prototype.isBlockSafe=function(e){for(;e.hasNext();)if(this.isAttr(e.next().value))return!1;return!0},e.prototype.isMarkupSafe=function(e){if(!e.hasNext()||!this.isAttr(e.next().value))return!1;for(;e.hasNext();)if(this.isAttr(e.next().value))return!1;return!0},e.prototype.sizeOfMarkupText=function(e){return"string"!=typeof e&&(e=this.string(e)),Go.sizeOf(e)},e.prototype.writeMarkupText=function(e,t){return"string"!=typeof t&&(t=this.string(t)),Go.write(e,t)},e.prototype.sizeOfData=function(e){return _o.sizeOf(e)},e.prototype.writeData=function(e,t){return void 0!==t?_o.write(e,t):re.writeString(e,"%")},e.prototype.isIdent=function(e){"string"!=typeof e&&(e=this.string(e));var t,r=e.length;if(0===r||void 0!==(t=e.codePointAt(0))&&!co.isIdentStartChar(t))return!1;for(var n=e.offsetByCodePoints(0,1);n<r;n=e.offsetByCodePoints(n,1))if(void 0===(t=e.codePointAt(n))||!co.isIdentChar(t))return!1;return!0},e.prototype.sizeOfText=function(e){return this.isIdent(e)?Qo.sizeOf(e):Zo.sizeOf(e)},e.prototype.writeText=function(e,t){return this.isIdent(t)?Qo.write(e,t):Zo.write(e,t)},e.prototype.sizeOfNum=function(e){if(isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<2147483648){var t=ie.countDigits(e);return e<0&&(t+=1),t}return(""+e).length},e.prototype.writeNum=function(e,t){return isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<2147483648?ie.writeInteger(e,t):re.writeString(e,""+t)},e.prototype.sizeOfUint32=function(e){return 10},e.prototype.writeUint32=function(e,t){return Ve.lowercase.writeIntegerLiteral(e,t,8)},e.prototype.sizeOfUint64=function(e){return 18},e.prototype.writeUint64=function(e,t){return Ve.lowercase.writeIntegerLiteral(e,t,16)},e.prototype.sizeOfBool=function(e){return e?4:5},e.prototype.writeBool=function(e,t){return re.writeString(e,t?"true":"false")},e.prototype.sizeOfLambdaFunc=function(e,t){return Jo.sizeOf(this,e,t)},e.prototype.writeLambdaFunc=function(e,t,r){return Jo.write(e,this,t,r)},e.prototype.sizeOfConditionalOperator=function(e,t,r,n){return $o.sizeOf(this,e,t,r,n)},e.prototype.writeConditionalOperator=function(e,t,r,n,i){return $o.write(e,this,t,r,n,i)},e.prototype.sizeOfInfixOperator=function(e,t,r,n){return eu.sizeOf(this,e,t,r,n)},e.prototype.writeInfixOperator=function(e,t,r,n,i){return eu.write(e,this,t,r,n,i)},e.prototype.sizeOfPrefixOperator=function(e,t,r){return tu.sizeOf(this,e,t,r)},e.prototype.writePrefixOperator=function(e,t,r,n){return tu.write(e,this,t,r,n)},e.prototype.sizeOfInvokeOperator=function(e,t){return ru.sizeOf(this,e,t)},e.prototype.writeInvokeOperator=function(e,t,r){return ru.write(e,this,t,r)},e.prototype.sizeOfIdentitySelector=function(){return 0},e.prototype.writeIdentitySelector=function(e){return ee.end()},e.prototype.sizeOfThenIdentitySelector=function(){return 0},e.prototype.writeThenIdentitySelector=function(e){return ee.end()},e.prototype.sizeOfLiteralSelector=function(e,t){return nu.sizeOf(this,e,t)},e.prototype.writeLiteralSelector=function(e,t,r){return nu.write(e,this,t,r)},e.prototype.sizeOfThenLiteralSelector=function(e,t){return 0},e.prototype.writeThenLiteralSelector=function(e,t,r){return ee.end()},e.prototype.sizeOfGetSelector=function(e,t){return iu.sizeOf(this,e,t)},e.prototype.writeGetSelector=function(e,t,r){return iu.write(e,this,t,r)},e.prototype.sizeOfThenGetSelector=function(e,t){return iu.sizeOf(this,e,t)},e.prototype.writeThenGetSelector=function(e,t,r){return iu.writeThen(e,this,t,r)},e.prototype.sizeOfGetAttrSelector=function(e,t){return ou.sizeOf(this,e,t)},e.prototype.writeGetAttrSelector=function(e,t,r){return ou.write(e,this,t,r)},e.prototype.sizeOfThenGetAttrSelector=function(e,t){return ou.sizeOf(this,e,t)},e.prototype.writeThenGetAttrSelector=function(e,t,r){return ou.writeThen(e,this,t,r)},e.prototype.sizeOfGetItemSelector=function(e,t){return uu.sizeOf(this,e,t)},e.prototype.writeGetItemSelector=function(e,t,r){return uu.write(e,this,t,r)},e.prototype.sizeOfThenGetItemSelector=function(e,t){return uu.sizeOfThen(this,e,t)},e.prototype.writeThenGetItemSelector=function(e,t,r){return uu.writeThen(e,this,t,r)},e.prototype.sizeOfKeysSelector=function(e){return su.sizeOf(this,e)},e.prototype.writeKeysSelector=function(e,t){return su.write(e,this,t)},e.prototype.sizeOfThenKeysSelector=function(e){return su.sizeOf(this,e)},e.prototype.writeThenKeysSelector=function(e,t){return su.writeThen(e,this,t)},e.prototype.sizeOfValuesSelector=function(e){return au.sizeOf(this,e)},e.prototype.writeValuesSelector=function(e,t){return au.write(e,this,t)},e.prototype.sizeOfThenValuesSelector=function(e){return au.sizeOf(this,e)},e.prototype.writeThenValuesSelector=function(e,t){return au.writeThen(e,this,t)},e.prototype.sizeOfChildrenSelector=function(e){return pu.sizeOf(this,e)},e.prototype.writeChildrenSelector=function(e,t){return pu.write(e,this,t)},e.prototype.sizeOfThenChildrenSelector=function(e){return pu.sizeOf(this,e)},e.prototype.writeThenChildrenSelector=function(e,t){return pu.writeThen(e,this,t)},e.prototype.sizeOfDescendantsSelector=function(e){return fu.sizeOf(this,e)},e.prototype.writeDescendantsSelector=function(e,t){return fu.write(e,this,t)},e.prototype.sizeOfThenDescendantsSelector=function(e){return fu.sizeOf(this,e)},e.prototype.writeThenDescendantsSelector=function(e,t){return fu.writeThen(e,this,t)},e.prototype.sizeOfFilterSelector=function(e,t){return cu.sizeOf(this,e,t)},e.prototype.writeFilterSelector=function(e,t,r){return cu.write(e,this,t,r)},e.prototype.sizeOfThenFilterSelector=function(e,t){return cu.sizeOfThen(this,e,t)},e.prototype.writeThenFilterSelector=function(e,t,r){return cu.writeThen(e,this,t,r)},e.prototype.sizeOfExtant=function(){return 0},e.prototype.writeExtant=function(e){return ee.end()},e.prototype.sizeOfAbsent=function(){return 0},e.prototype.writeAbsent=function(e){return ee.end()},e}(),hu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.isField=function(e){return e instanceof Jt},t.prototype.isAttr=function(e){return e instanceof tr},t.prototype.isSlot=function(e){return e instanceof $t},t.prototype.isValue=function(e){return e instanceof ir},t.prototype.isRecord=function(e){return e instanceof or},t.prototype.isText=function(e){return e instanceof hr},t.prototype.isNum=function(e){return e instanceof yr},t.prototype.isBool=function(e){return e instanceof br},t.prototype.isExpression=function(e){return e instanceof wr},t.prototype.isExtant=function(e){return e instanceof mr},t.prototype.items=function(e){return e.iterator()},t.prototype.item=function(e){return e},t.prototype.key=function(e){return e.key},t.prototype.value=function(e){return e.toValue()},t.prototype.string=function(e){return e.stringValue("")},t.prototype.precedence=function(e){return e.precedence},t.prototype.sizeOfItem=function(e){if(e instanceof Jt){if(e instanceof tr)return this.sizeOfAttr(e.key,e.value);if(e instanceof $t)return this.sizeOfSlot(e.key,e.value)}else if(e instanceof ir)return this.sizeOfValue(e);throw new $("No Recon serialization for "+e)},t.prototype.writeItem=function(e,t){if(t instanceof Jt){if(t instanceof tr)return this.writeAttr(e,t.key,t.value);if(t instanceof $t)return this.writeSlot(e,t.key,t.value)}else if(t instanceof ir)return this.writeValue(e,t);return ee.error(new $("No Recon serialization for "+t))},t.prototype.sizeOfValue=function(e){if(e instanceof or)return this.sizeOfRecord(e);if(e instanceof cr)return this.sizeOfData(e.size);if(e instanceof hr)return this.sizeOfText(e.value);if(e instanceof yr)return e.isUint32()?this.sizeOfUint32(e.value):e.isUint64()?this.sizeOfUint64(e.value):this.sizeOfNum(e.value);if(e instanceof br)return this.sizeOfBool(e.value);if(e instanceof $r)return this.sizeOfSelector(e);if(e instanceof Or)return this.sizeOfOperator(e);if(e instanceof cn)return this.sizeOfFunc(e);if(e instanceof mr)return this.sizeOfExtant();if(e instanceof gr)return this.sizeOfAbsent();throw new $("No Recon serialization for "+e)},t.prototype.writeValue=function(e,t){return t instanceof or?this.writeRecord(e,t):t instanceof cr?this.writeData(e,t.asUint8Array()):t instanceof hr?this.writeText(e,t.value):t instanceof yr?t.isUint32()?this.writeUint32(e,t.value):t.isUint64()?this.writeUint64(e,t.value):this.writeNum(e,t.value):t instanceof br?this.writeBool(e,t.value):t instanceof $r?this.writeSelector(e,t):t instanceof Or?this.writeOperator(e,t):t instanceof cn?this.writeFunc(e,t):t instanceof mr?this.writeExtant(e):t instanceof gr?this.writeAbsent(e):ee.error(new $("No Recon serialization for "+t))},t.prototype.sizeOfSelector=function(e){if(e instanceof en)return this.sizeOfIdentitySelector();if(e instanceof fn)return this.sizeOfLiteralSelector(e.item,e.then);if(e instanceof tn)return this.sizeOfGetSelector(e.item,e.then);if(e instanceof rn)return this.sizeOfGetAttrSelector(e.item,e.then);if(e instanceof nn)return this.sizeOfGetItemSelector(e.item,e.then);if(e instanceof on)return this.sizeOfKeysSelector(e.then);if(e instanceof un)return this.sizeOfValuesSelector(e.then);if(e instanceof sn)return this.sizeOfChildrenSelector(e.then);if(e instanceof an)return this.sizeOfDescendantsSelector(e.then);if(e instanceof pn)return this.sizeOfFilterSelector(e.predicate,e.then);throw new $("No Recon serialization for "+e)},t.prototype.writeSelector=function(e,t){return t instanceof en?this.writeIdentitySelector(e):t instanceof fn?this.writeLiteralSelector(e,t.item,t.then):t instanceof tn?this.writeGetSelector(e,t.item,t.then):t instanceof rn?this.writeGetAttrSelector(e,t.item,t.then):t instanceof nn?this.writeGetItemSelector(e,t.item,t.then):t instanceof on?this.writeKeysSelector(e,t.then):t instanceof un?this.writeValuesSelector(e,t.then):t instanceof sn?this.writeChildrenSelector(e,t.then):t instanceof an?this.writeDescendantsSelector(e,t.then):t instanceof pn?this.writeFilterSelector(e,t.predicate,t.then):ee.error(new $("No Recon serialization for "+t))},t.prototype.sizeOfOperator=function(e){if(e instanceof Pr)return this.sizeOfInfixOperator(e.operand1,e.operator,e.operand2,e.precedence);if(e instanceof jr)return this.sizeOfPrefixOperator(e.operator,e.operand,e.precedence);if(e instanceof Zr)return this.sizeOfInvokeOperator(e.func,e.args);if(e instanceof Er)return this.sizeOfConditionalOperator(e.ifTerm,e.thenTerm,e.elseTerm,e.precedence);throw new $("No Recon serialization for "+e)},t.prototype.writeOperator=function(e,t){return t instanceof Pr?this.writeInfixOperator(e,t.operand1,t.operator,t.operand2,t.precedence):t instanceof jr?this.writePrefixOperator(e,t.operator,t.operand,t.precedence):t instanceof Zr?this.writeInvokeOperator(e,t.func,t.args):t instanceof Er?this.writeConditionalOperator(e,t.ifTerm,t.thenTerm,t.elseTerm,t.precedence):ee.error(new $("No Recon serialization for "+t))},t.prototype.sizeOfFunc=function(e){if(e instanceof ln)return this.sizeOfLambdaFunc(e.bindings,e.template);if(e instanceof hn)return 0;throw new $("No Recon serialization for "+e)},t.prototype.writeFunc=function(e,t){return t instanceof ln?this.writeLambdaFunc(e,t.bindings,t.template):t instanceof hn?ee.end():ee.error(new $("No Recon serialization for "+t))},t.prototype.sizeOfBlockItem=function(e){if(e instanceof Jt)return this.sizeOfItem(e);if(e instanceof ir)return this.sizeOfBlockValue(e);throw new $("No Recon serialization for "+e)},t.prototype.writeBlockItem=function(e,t){return t instanceof Jt?this.writeItem(e,t):t instanceof ir?this.writeBlockValue(e,t):ee.error(new $("No Recon serialization for "+t))},t.prototype.sizeOfBlockValue=function(e){return e instanceof or?this.sizeOfBlock(e):this.sizeOfValue(e)},t.prototype.writeBlockValue=function(e,t){return t instanceof or?this.writeBlock(e,t):this.writeValue(e,t)},t.prototype.sizeOfThen=function(e){if(e instanceof $r){if(e instanceof en)return this.sizeOfThenIdentitySelector();if(e instanceof fn)return this.sizeOfThenLiteralSelector(e.item,e.then);if(e instanceof tn)return this.sizeOfThenGetSelector(e.item,e.then);if(e instanceof rn)return this.sizeOfThenGetAttrSelector(e.item,e.then);if(e instanceof nn)return this.sizeOfThenGetItemSelector(e.item,e.then);if(e instanceof on)return this.sizeOfThenKeysSelector(e.then);if(e instanceof un)return this.sizeOfThenValuesSelector(e.then);if(e instanceof sn)return this.sizeOfThenChildrenSelector(e.then);if(e instanceof an)return this.sizeOfThenDescendantsSelector(e.then);if(e instanceof pn)return this.sizeOfThenFilterSelector(e.predicate,e.then)}throw new $("No Recon serialization for "+e)},t.prototype.writeThen=function(e,t){if(t instanceof $r){if(t instanceof en)return this.writeThenIdentitySelector(e);if(t instanceof fn)return this.writeThenLiteralSelector(e,t.item,t.then);if(t instanceof tn)return this.writeThenGetSelector(e,t.item,t.then);if(t instanceof rn)return this.writeThenGetAttrSelector(e,t.item,t.then);if(t instanceof nn)return this.writeThenGetItemSelector(e,t.item,t.then);if(t instanceof on)return this.writeThenKeysSelector(e,t.then);if(t instanceof un)return this.writeThenValuesSelector(e,t.then);if(t instanceof sn)return this.writeThenChildrenSelector(e,t.then);if(t instanceof an)return this.writeThenDescendantsSelector(e,t.then);if(t instanceof pn)return this.writeThenFilterSelector(e,t.predicate,t.then)}return ee.error(new $("No Recon serialization for "+t))},t}(lu),du=function(e){function t(r){var n=e.call(this,r instanceof oe?r.message:r)||this;return Object.setPrototypeOf(n,t.prototype),Object.defineProperty(n,"diagnostic",{value:r instanceof oe?r:null,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.toString=function(){return null!==this.diagnostic?this.diagnostic.toString():e.prototype.toString.call(this)},t}(Error),yu=function(){function e(e,t,r,n,i){Object.defineProperty(this,"scheme",{value:e,enumerable:!0}),Object.defineProperty(this,"authority",{value:t,enumerable:!0}),Object.defineProperty(this,"path",{value:r,enumerable:!0}),Object.defineProperty(this,"query",{value:n,enumerable:!0}),Object.defineProperty(this,"fragment",{value:i,enumerable:!0}),Object.defineProperty(this,"hashValue",{value:void 0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"stringValue",{value:void 0,enumerable:!0,configurable:!0})}return e.prototype.isDefined=function(){return this.scheme.isDefined()||this.authority.isDefined()||this.path.isDefined()||this.query.isDefined()||this.fragment.isDefined()},e.prototype.isEmpty=function(){return!this.scheme.isDefined()&&!this.authority.isDefined()&&this.path.isEmpty()&&!this.query.isDefined()&&!this.fragment.isDefined()},e.prototype.withScheme=function(e){return(e=vu.fromAny(e))!==this.scheme?this.copy(e,this.authority,this.path,this.query,this.fragment):this},Object.defineProperty(e.prototype,"schemePart",{get:function(){return this.scheme.toString()},enumerable:!1,configurable:!0}),e.prototype.withSchemePart=function(e){return this.withScheme(vu.parse(e))},Object.defineProperty(e.prototype,"schemeName",{get:function(){return this.scheme.name},enumerable:!1,configurable:!0}),e.prototype.withSchemeName=function(e){return this.withScheme(vu.create(e))},e.prototype.withAuthority=function(e){return(e=bu.fromAny(e))!==this.authority?this.copy(this.scheme,e,this.path,this.query,this.fragment):this},Object.defineProperty(e.prototype,"authorityPart",{get:function(){return this.authority.toString()},enumerable:!1,configurable:!0}),e.prototype.withAuthorityPart=function(e){return this.withAuthority(bu.parse(e))},Object.defineProperty(e.prototype,"user",{get:function(){return this.authority.user},enumerable:!1,configurable:!0}),e.prototype.withUser=function(e){return this.withAuthority(this.authority.withUser(e))},Object.defineProperty(e.prototype,"userPart",{get:function(){return this.authority.userPart},enumerable:!1,configurable:!0}),e.prototype.withUserPart=function(e){return this.withAuthority(this.authority.withUserPart(e))},Object.defineProperty(e.prototype,"username",{get:function(){return this.authority.username},enumerable:!1,configurable:!0}),e.prototype.withUsername=function(e,t){return 1===arguments.length?this.withAuthority(this.authority.withUsername(e)):this.withAuthority(this.authority.withUsername(e,t))},Object.defineProperty(e.prototype,"password",{get:function(){return this.authority.password},enumerable:!1,configurable:!0}),e.prototype.withPassword=function(e){return this.withAuthority(this.authority.withPassword(e))},Object.defineProperty(e.prototype,"host",{get:function(){return this.authority.host},enumerable:!1,configurable:!0}),e.prototype.withHost=function(e){return this.withAuthority(this.authority.withHost(e))},Object.defineProperty(e.prototype,"hostPart",{get:function(){return this.authority.hostPart},enumerable:!1,configurable:!0}),e.prototype.withHostPart=function(e){return this.withAuthority(this.authority.withHostPart(e))},Object.defineProperty(e.prototype,"hostAddress",{get:function(){return this.authority.hostAddress},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostName",{get:function(){return this.authority.hostName},enumerable:!1,configurable:!0}),e.prototype.withHostName=function(e){return this.withAuthority(this.authority.withHostName(e))},Object.defineProperty(e.prototype,"hostIPv4",{get:function(){return this.authority.hostIPv4},enumerable:!1,configurable:!0}),e.prototype.withHostIPv4=function(e){return this.withAuthority(this.authority.withHostIPv4(e))},Object.defineProperty(e.prototype,"hostIPv6",{get:function(){return this.authority.hostIPv6},enumerable:!1,configurable:!0}),e.prototype.withHostIPv6=function(e){return this.withAuthority(this.authority.withHostIPv6(e))},Object.defineProperty(e.prototype,"port",{get:function(){return this.authority.port},enumerable:!1,configurable:!0}),e.prototype.withPort=function(e){return this.withAuthority(this.authority.withPort(e))},Object.defineProperty(e.prototype,"portPart",{get:function(){return this.authority.portPart},enumerable:!1,configurable:!0}),e.prototype.withPortPart=function(e){return this.withAuthority(this.authority.withPortPart(e))},Object.defineProperty(e.prototype,"portNumber",{get:function(){return this.authority.portNumber},enumerable:!1,configurable:!0}),e.prototype.withPortNumber=function(e){return this.withAuthority(this.authority.withPortNumber(e))},e.prototype.withPath=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Cu.of.apply(Cu,e);return r!==this.path?this.copy(this.scheme,this.authority,r,this.query,this.fragment):this},Object.defineProperty(e.prototype,"pathPart",{get:function(){return this.path.toString()},enumerable:!1,configurable:!0}),e.prototype.withPathPart=function(e){return this.withPath(Cu.parse(e))},Object.defineProperty(e.prototype,"pathName",{get:function(){return this.path.name},enumerable:!1,configurable:!0}),e.prototype.withPathName=function(e){return this.withPath(this.path.withName(e))},e.prototype.parentPath=function(){return this.path.parent()},e.prototype.basePath=function(){return this.path.base()},e.prototype.parent=function(){return e.create(this.scheme,this.authority,this.path.parent())},e.prototype.base=function(){return e.create(this.scheme,this.authority,this.path.base())},e.prototype.appendedPath=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.withPath((e=this.path).appended.apply(e,t))},e.prototype.appendedSlash=function(){return this.withPath(this.path.appendedSlash())},e.prototype.appendedSegment=function(e){return this.withPath(this.path.appendedSegment(e))},e.prototype.prependedPath=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.withPath((e=this.path).prepended.apply(e,t))},e.prototype.prependedSlash=function(){return this.withPath(this.path.prependedSlash())},e.prototype.prependedSegment=function(e){return this.withPath(this.path.prependedSegment(e))},e.prototype.withQuery=function(e){return(e=Du.fromAny(e))!==this.query?this.copy(this.scheme,this.authority,this.path,e,this.fragment):this},Object.defineProperty(e.prototype,"queryPart",{get:function(){return this.query.toString()},enumerable:!1,configurable:!0}),e.prototype.withQueryPart=function(e){return this.withQuery(Du.parse(e))},e.prototype.updatedQuery=function(e,t){return this.withQuery(this.query.updated(e,t))},e.prototype.removedQuery=function(e){return this.withQuery(this.query.removed(e))},e.prototype.appendedQuery=function(e,t){return this.withQuery(this.query.appended(e,t))},e.prototype.prependedQuery=function(e,t){return this.withQuery(this.query.prepended(e,t))},e.prototype.withFragment=function(t){return(t=qu.fromAny(t))!==this.fragment?e.create(this.scheme,this.authority,this.path,this.query,t):this},Object.defineProperty(e.prototype,"fragmentPart",{get:function(){return this.fragment.toString()},enumerable:!1,configurable:!0}),e.prototype.withFragmentPart=function(e){return this.withFragment(qu.parse(e))},Object.defineProperty(e.prototype,"fragmentIdentifier",{get:function(){return this.fragment.identifier},enumerable:!1,configurable:!0}),e.prototype.withFragmentIdentifier=function(e){return this.withFragment(qu.create(e))},e.prototype.endpoint=function(){return this.path.isDefined()||this.query.isDefined()||this.fragment.isDefined()?e.create(this.scheme,this.authority):this},e.prototype.resolve=function(t){var r=e.fromAny(t);return r.scheme.isDefined()?this.copy(r.scheme,r.authority,r.path.removeDotSegments(),r.query,r.fragment):r.authority.isDefined()?this.copy(this.scheme,r.authority,r.path.removeDotSegments(),r.query,r.fragment):r.path.isEmpty()?this.copy(this.scheme,this.authority,this.path,r.query.isDefined()?r.query:this.query,r.fragment):r.path.isAbsolute()?this.copy(this.scheme,this.authority,r.path.removeDotSegments(),r.query,r.fragment):this.copy(this.scheme,this.authority,this.merge(r.path).removeDotSegments(),r.query,r.fragment)},e.prototype.merge=function(e){return this.authority.isDefined()&&this.path.isEmpty()?e.prependedSlash():this.path.isEmpty()?e:this.path.merge(e)},e.prototype.unresolve=function(t){var r=e.fromAny(t);return this.scheme.equals(r.scheme)&&this.authority.equals(r.authority)?e.create(vu.undefined(),bu.undefined(),this.path.unmerge(r.path),r.query,r.fragment):r},e.prototype.copy=function(t,r,n,i,o){return e.create(t,r,n,i,o)},e.prototype.toAny=function(){var e={};return e.scheme=this.scheme.toAny(),this.authority.toAny(e),e.path=this.path.toAny(),e.query=this.query.toAny(),e.fragment=this.fragment.toAny(),e},e.prototype.compareTo=function(t){return t instanceof e?this.toString().localeCompare(t.toString()):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.toString()===t.toString()},e.prototype.hashCode=function(){var e=this.hashValue;return void 0===e&&(e=m.hash(this.toString()),Object.defineProperty(this,"hashValue",{value:e,enumerable:!0,configurable:!0})),e},e.prototype.debug=function(e){return e=e.write("Uri").write(46),e=this.isDefined()?e.write("parse").write(40).write(34).display(this).write(34).write(41):e.write("empty").write(40).write(41)},e.prototype.display=function(e){var t=this.stringValue;return void 0!==t?e=e.write(t):(this.scheme.isDefined()&&(e=e.display(this.scheme).write(58)),this.authority.isDefined()&&(e=e.write(47).write(47).display(this.authority)),e=e.display(this.path),this.query.isDefined()&&(e=e.write(63).display(this.query)),this.fragment.isDefined()&&(e=e.write(35).display(this.fragment))),e},e.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=ne.display(this),Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},e.empty=function(){return new e(vu.undefined(),bu.undefined(),Cu.empty(),Du.undefined(),qu.undefined())},e.create=function(t,r,n,i,o){return void 0===t&&(t=vu.undefined()),void 0===r&&(r=bu.undefined()),void 0===n&&(n=Cu.empty()),void 0===i&&(i=Du.undefined()),void 0===o&&(o=qu.undefined()),t.isDefined()||r.isDefined()||n.isDefined()||i.isDefined()||o.isDefined()?new e(t,r,n,i,o):e.empty()},e.fromInit=function(t){var r=vu.fromAny(t.scheme),n=bu.fromAny(void 0!==t.authority?t.authority:t),i=Cu.fromAny(t.path),o=Du.fromAny(t.query),u=qu.fromAny(t.fragment);return r.isDefined()||n.isDefined()||i.isDefined()||o.isDefined()||u.isDefined()?new e(r,n,i,o,u):e.empty()},e.fromAny=function(t){if(null==t)return e.empty();if(t instanceof e)return t;if("object"==typeof t)return e.fromInit(t);if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.scheme=function(t){return t=vu.fromAny(t),e.create(t,void 0,void 0,void 0,void 0)},e.schemePart=function(t){var r=vu.parse(t);return e.create(r,void 0,void 0,void 0,void 0)},e.schemeName=function(t){var r=vu.create(t);return e.create(r,void 0,void 0,void 0,void 0)},e.authority=function(t){return t=bu.fromAny(t),e.create(void 0,t,void 0,void 0,void 0)},e.authorityPart=function(t){var r=bu.parse(t);return e.create(void 0,r,void 0,void 0,void 0)},e.user=function(t){var r=bu.user(t);return e.create(void 0,r,void 0,void 0,void 0)},e.userPart=function(t){var r=bu.userPart(t);return e.create(void 0,r,void 0,void 0,void 0)},e.username=function(t,r){var n=bu.username(t,r);return e.create(void 0,n,void 0,void 0,void 0)},e.password=function(t){var r=bu.password(t);return e.create(void 0,r,void 0,void 0,void 0)},e.host=function(t){var r=bu.host(t);return e.create(void 0,r,void 0,void 0,void 0)},e.hostPart=function(t){var r=bu.hostPart(t);return e.create(void 0,r,void 0,void 0,void 0)},e.hostName=function(t){var r=bu.hostName(t);return e.create(void 0,r,void 0,void 0,void 0)},e.hostIPv4=function(t){var r=bu.hostIPv4(t);return e.create(void 0,r,void 0,void 0,void 0)},e.hostIPv6=function(t){var r=bu.hostIPv6(t);return e.create(void 0,r,void 0,void 0,void 0)},e.port=function(t){var r=bu.port(t);return e.create(void 0,r,void 0,void 0,void 0)},e.portPart=function(t){var r=bu.portPart(t);return e.create(void 0,r,void 0,void 0,void 0)},e.portNumber=function(t){var r=bu.portNumber(t);return e.create(void 0,r,void 0,void 0,void 0)},e.path=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=Cu.of.apply(Cu,t);return e.create(void 0,void 0,n,void 0,void 0)},e.pathPart=function(t){var r=Cu.parse(t);return e.create(void 0,void 0,r,void 0,void 0)},e.query=function(t){return t=Du.fromAny(t),e.create(void 0,void 0,void 0,t,void 0)},e.queryPart=function(t){var r=Du.parse(t);return e.create(void 0,void 0,void 0,r,void 0)},e.fragment=function(t){return t=qu.fromAny(t),e.create(void 0,void 0,void 0,void 0,t)},e.fragmentPart=function(t){var r=qu.parse(t);return e.create(void 0,void 0,void 0,void 0,r)},e.fragmentIdentifier=function(t){var r=qu.create(t);return e.create(void 0,void 0,void 0,void 0,r)},Object.defineProperty(e,"standardParser",{get:function(){return new Nu},enumerable:!1,configurable:!0}),e.parse=function(t){return e.standardParser.parseAbsoluteString(t)},e.pathBuilder=function(){return new Mu},e.queryBuilder=function(){return new Vu},e.form=function(){return new Ru(e.empty())},e.isUnreservedChar=function(e){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||45===e||46===e||95===e||126===e},e.isSubDelimChar=function(e){return 33===e||36===e||38===e||40===e||41===e||42===e||43===e||44===e||59===e||61===e||39===e},e.isSchemeChar=function(e){return e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||43===e||45===e||46===e},e.isUserInfoChar=function(t){return e.isUnreservedChar(t)||e.isSubDelimChar(t)||58===t},e.isUserChar=function(t){return e.isUnreservedChar(t)||e.isSubDelimChar(t)},e.isHostChar=function(t){return e.isUnreservedChar(t)||e.isSubDelimChar(t)},e.isPathChar=function(t){return e.isUnreservedChar(t)||e.isSubDelimChar(t)||58===t||64===t},e.isQueryChar=function(t){return e.isUnreservedChar(t)||e.isSubDelimChar(t)||47===t||58===t||63===t||64===t},e.isParamChar=function(t){return e.isUnreservedChar(t)||33===t||36===t||40===t||41===t||42===t||43===t||44===t||47===t||58===t||59===t||63===t||64===t||39===t},e.isFragmentChar=function(t){return e.isUnreservedChar(t)||e.isSubDelimChar(t)||47===t||58===t||63===t||64===t},e.isAlpha=function(e){return e>=65&&e<=90||e>=97&&e<=122},e.toLowerCase=function(e){return e>=65&&e<=90?e+32:e},e.writeScheme=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=n>0&&e.isSchemeChar(o)||0===n&&e.isAlpha(o)?t.write(o):Z.error(new du("Invalid scheme: "+r))}return t},e.writeUserInfo=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isUserInfoChar(o)?t.write(o):e.writeEncoded(t,o)}return t},e.writeUser=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isUserChar(o)?t.write(o):e.writeEncoded(t,o)}return t},e.writeHost=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isHostChar(o)?t.write(o):e.writeEncoded(t,o)}return t},e.writeHostLiteral=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isHostChar(o)||58===o?t.write(o):e.writeEncoded(t,o)}return t},e.writePathSegment=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isPathChar(o)?t.write(o):e.writeEncoded(t,o)}return t},e.writeQuery=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isQueryChar(o)?t.write(o):e.writeEncoded(t,o)}return t},e.writeParam=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isParamChar(o)?t.write(o):e.writeEncoded(t,o)}return t},e.writeFragment=function(t,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);t=e.isFragmentChar(o)?t.write(o):e.writeEncoded(t,o)}return t},e.writeEncoded=function(t,r){return 0===r?(t=e.writePctEncoded(t,192),t=e.writePctEncoded(t,128)):r>=0&&r<=127?t=e.writePctEncoded(t,r):r>=128&&r<=2047?(t=e.writePctEncoded(t,192|r>>>6),t=e.writePctEncoded(t,128|63&r)):r>=2048&&r<=65535?(t=e.writePctEncoded(t,224|r>>>12),t=e.writePctEncoded(t,128|r>>>6&63),t=e.writePctEncoded(t,128|63&r)):r>=65536&&r<=1114111?(t=e.writePctEncoded(t,240|r>>>18),t=e.writePctEncoded(t,128|r>>>12&63),t=e.writePctEncoded(t,128|r>>>6&63),t=e.writePctEncoded(t,128|63&r)):(t=e.writePctEncoded(t,239),t=e.writePctEncoded(t,191),t=e.writePctEncoded(t,189)),t},e.writePctEncoded=function(e,t){var r=Ve.lowercase;return e=e.write(37).write(r.encodeDigit(t>>>4&15)).write(r.encodeDigit(15&t))},E([s],e,"empty",null),E([s],e,"standardParser",null),E([s],e,"form",null),e}(),vu=function(){function e(e){Object.defineProperty(this,"name",{value:e,enumerable:!0})}return e.prototype.isDefined=function(){return 0!==this.name.length},e.prototype.toAny=function(){return 0!==this.name.length?this.name:void 0},e.prototype.compareTo=function(t){return t instanceof e?this.name.localeCompare(t.name):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.name===t.name},e.prototype.hashCode=function(){return m.hash(this.name)},e.prototype.debug=function(e){return e=e.write("UriScheme").write(46),e=this.isDefined()?e.write("parse").write(40).write(34).display(this).write(34).write(41):e.write("undefined").write(40).write(41)},e.prototype.display=function(e){return e=yu.writeScheme(e,this.name)},e.prototype.toString=function(){return this.name},e.undefined=function(){return new e("")},e.create=function(t){var r=e.cache,n=r.get(t);return void 0!==n?n:r.put(t,new e(t))},e.fromAny=function(t){if(null==t)return e.undefined();if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.parse=function(e){return yu.standardParser.parseSchemeString(e)},Object.defineProperty(e,"cache",{get:function(){return new R(4)},enumerable:!1,configurable:!0}),E([s],e,"undefined",null),E([s],e,"cache",null),e}(),bu=function(){function e(e,t,r){Object.defineProperty(this,"user",{value:e,enumerable:!0}),Object.defineProperty(this,"host",{value:t,enumerable:!0}),Object.defineProperty(this,"port",{value:r,enumerable:!0}),Object.defineProperty(this,"hashValue",{value:void 0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"stringValue",{value:void 0,enumerable:!0,configurable:!0})}return e.prototype.isDefined=function(){return this.user.isDefined()||this.host.isDefined()||this.port.isDefined()},e.prototype.withUser=function(e){return(e=mu.fromAny(e))!==this.user?this.copy(e,this.host,this.port):this},Object.defineProperty(e.prototype,"userPart",{get:function(){return this.user.toString()},enumerable:!1,configurable:!0}),e.prototype.withUserPart=function(e){return this.withUser(mu.parse(e))},Object.defineProperty(e.prototype,"username",{get:function(){return this.user.username},enumerable:!1,configurable:!0}),e.prototype.withUsername=function(e,t){return 1===arguments.length?this.withUser(this.user.withUsername(e)):this.withUser(mu.create(e,t))},Object.defineProperty(e.prototype,"password",{get:function(){return this.user.password},enumerable:!1,configurable:!0}),e.prototype.withPassword=function(e){return this.withUser(this.user.withPassword(e))},e.prototype.withHost=function(e){return(e=gu.fromAny(e))!==this.host?this.copy(this.user,e,this.port):this},Object.defineProperty(e.prototype,"hostPart",{get:function(){return this.host.toString()},enumerable:!1,configurable:!0}),e.prototype.withHostPart=function(e){return this.withHost(gu.parse(e))},Object.defineProperty(e.prototype,"hostAddress",{get:function(){return this.host.address},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostName",{get:function(){return this.host.name},enumerable:!1,configurable:!0}),e.prototype.withHostName=function(e){return this.withHost(gu.hostname(e))},Object.defineProperty(e.prototype,"hostIPv4",{get:function(){return this.host.ipv4},enumerable:!1,configurable:!0}),e.prototype.withHostIPv4=function(e){return this.withHost(gu.ipv4(e))},Object.defineProperty(e.prototype,"hostIPv6",{get:function(){return this.host.ipv6},enumerable:!1,configurable:!0}),e.prototype.withHostIPv6=function(e){return this.withHost(gu.ipv6(e))},e.prototype.withPort=function(e){return(e=ju.fromAny(e))!==this.port?this.copy(this.user,this.host,e):this},Object.defineProperty(e.prototype,"portPart",{get:function(){return this.port.toString()},enumerable:!1,configurable:!0}),e.prototype.withPortPart=function(e){return this.withPort(ju.parse(e))},Object.defineProperty(e.prototype,"portNumber",{get:function(){return this.port.number},enumerable:!1,configurable:!0}),e.prototype.withPortNumber=function(e){return this.withPort(ju.create(e))},e.prototype.copy=function(t,r,n){return e.create(t,r,n)},e.prototype.toAny=function(e){return this.isDefined()&&(void 0===e&&(e={}),this.user.toAny(e),this.host.isDefined()&&(e.host=this.host.toAny()),this.port.isDefined()&&(e.port=this.port.toAny())),e},e.prototype.compareTo=function(t){return t instanceof e?this.toString().localeCompare(t.toString()):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.toString()===t.toString()},e.prototype.hashCode=function(){var e=this.hashValue;return void 0===e&&(e=m.hash(this.toString()),Object.defineProperty(this,"hashValue",{value:e,enumerable:!0,configurable:!0})),e},e.prototype.debug=function(e){return e=e.write("UriAuthority").write(46),e=this.isDefined()?e.write("parse").write(40).write(34).display(this).write(34).write(41):e.write("undefined").write(40).write(41)},e.prototype.display=function(e){var t=this.stringValue;if(void 0!==t)e=e.write(t);else{var r=this.user;r.isDefined()&&(e=e.display(r).write(64)),e=e.display(this.host);var n=this.port;n.isDefined()&&(e=e.write(58).display(n))}return e},e.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=ne.display(this),Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},e.undefined=function(){return new e(mu.undefined(),gu.undefined(),ju.undefined())},e.create=function(t,r,n){return void 0===t&&(t=mu.undefined()),void 0===r&&(r=gu.undefined()),void 0===n&&(n=ju.undefined()),t.isDefined()||r.isDefined()||n.isDefined()?new e(t,r,n):e.undefined()},e.fromInit=function(t){var r=mu.fromAny(void 0!==t.user?t.user:t),n=gu.fromAny(t.host),i=ju.fromAny(t.port);return e.create(r,n,i)},e.fromAny=function(t){if(null==t)return e.undefined();if(t instanceof e)return t;if("object"==typeof t)return e.fromInit(t);if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.user=function(t){return t=mu.fromAny(t),e.create(t,void 0,void 0)},e.userPart=function(t){var r=mu.parse(t);return e.create(r,void 0,void 0)},e.username=function(t,r){var n=mu.create(t,r);return e.create(n,void 0,void 0)},e.password=function(t){var r=mu.create("",t);return e.create(r,void 0,void 0)},e.host=function(t){return t=gu.fromAny(t),e.create(void 0,t,void 0)},e.hostPart=function(t){var r=gu.parse(t);return e.create(void 0,r,void 0)},e.hostName=function(t){var r=gu.hostname(t);return e.create(void 0,r,void 0)},e.hostIPv4=function(t){var r=gu.ipv4(t);return e.create(void 0,r,void 0)},e.hostIPv6=function(t){var r=gu.ipv6(t);return e.create(void 0,r,void 0)},e.port=function(t){return t=ju.fromAny(t),e.create(void 0,void 0,t)},e.portPart=function(t){var r=ju.parse(t);return e.create(void 0,void 0,r)},e.portNumber=function(t){var r=ju.create(t);return e.create(void 0,void 0,r)},e.parse=function(e){return yu.standardParser.parseAuthorityString(e)},E([s],e,"undefined",null),e}(),mu=function(){function e(e,t){Object.defineProperty(this,"username",{value:e,enumerable:!0}),Object.defineProperty(this,"password",{value:t,enumerable:!0})}return e.prototype.isDefined=function(){return void 0!==this.username},e.prototype.withUsername=function(e){return e!==this.username?this.copy(e,this.password):this},e.prototype.withPassword=function(e){return e!==this.password?this.copy(this.username,e):this},e.prototype.copy=function(t,r){return e.create(t,r)},e.prototype.toAny=function(e){return void 0!==this.username&&(void 0===e&&(e={}),e.username=this.username,void 0!==this.password&&(e.password=this.password)),e},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.username===t.username&&this.password===t.password)},e.prototype.hashCode=function(){return m.hash(this.toString())},e.prototype.debug=function(e){return e=e.write("UriUser").write(46),e=this.isDefined()?e.write("parse").write(40).write(34).display(this).write(34).write(41):e.write("undefined").write(40).write(41)},e.prototype.display=function(e){return void 0!==this.username&&(e=yu.writeUser(e,this.username),void 0!==this.password&&(e=e.write(58),e=yu.writeUser(e,this.password))),e},e.prototype.toString=function(){return ne.display(this)},e.undefined=function(){return new e(void 0,void 0)},e.create=function(t,r){return void 0!==t||void 0!==r?new e(t,r):e.undefined()},e.fromInit=function(t){return e.create(t.username,t.password)},e.fromAny=function(t){if(null==t)return e.undefined();if(t instanceof e)return t;if("object"==typeof t)return e.fromInit(t);if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.parse=function(e){return yu.standardParser.parseUserString(e)},E([s],e,"undefined",null),e}(),gu=function(){function e(){}return e.prototype.isDefined=function(){return!0},Object.defineProperty(e.prototype,"name",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ipv4",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ipv6",{get:function(){},enumerable:!1,configurable:!0}),e.prototype.toAny=function(){return this.toString()},e.prototype.compareTo=function(t){return t instanceof e?this.toString().localeCompare(t.toString()):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.toString()===t.toString()},e.prototype.hashCode=function(){return m.hash(this.toString())},e.undefined=function(){return new xu},e.hostname=function(t){var r=e.cache,n=r.get(t);return n instanceof wu?n:r.put(t,new wu(t))},e.ipv4=function(t){var r=e.cache,n=r.get(t);return n instanceof Ou?n:r.put(t,new Ou(t))},e.ipv6=function(t){var r=e.cache,n=r.get(t);return n instanceof Pu?n:r.put(t,new Pu(t))},e.fromAny=function(t){if(null==t)return e.undefined();if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.parse=function(e){return yu.standardParser.parseHostString(e)},Object.defineProperty(e,"cache",{get:function(){return new R(16)},enumerable:!1,configurable:!0}),E([s],e,"undefined",null),E([s],e,"cache",null),e}(),wu=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"address",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this.address},enumerable:!1,configurable:!0}),t.prototype.debug=function(e){return e=e.write("UriHost").write(46).write("hostname").write(40).debug(this.address).write(41)},t.prototype.display=function(e){return e=yu.writeHost(e,this.address)},t.prototype.toString=function(){return this.address},t}(gu),Ou=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"address",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"ipv4",{get:function(){return this.address},enumerable:!1,configurable:!0}),t.prototype.debug=function(e){return e=e.write("UriHost").write(46).write("ipv4").write(40).debug(this.address).write(41)},t.prototype.display=function(e){return e=yu.writeHost(e,this.address)},t.prototype.toString=function(){return this.address},t}(gu),Pu=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"address",{value:t,enumerable:!0}),Object.defineProperty(r,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"ipv6",{get:function(){return this.address},enumerable:!1,configurable:!0}),t.prototype.debug=function(e){return e=e.write("UriHost").write(46).write("ipv6").write(40).debug(this.address).write(41)},t.prototype.display=function(e){var t=this.stringValue;return void 0!==t?e=e.write(t):(e=e.write(91),e=(e=yu.writeHostLiteral(e,this.address)).write(93)),e},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e="["+this.address+"]",Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t}(gu),xu=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isDefined=function(){return!1},Object.defineProperty(t.prototype,"address",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.debug=function(e){return e=e.write("UriHost").write(46).write("undefined").write(40).write(41)},t.prototype.display=function(e){return e},t.prototype.toString=function(){return""},t}(gu),ju=function(){function e(e){Object.defineProperty(this,"number",{value:e,enumerable:!0})}return e.prototype.isDefined=function(){return 0!==this.number},e.prototype.valueOf=function(){return this.number},e.prototype.toAny=function(){return this.number},e.prototype.compareTo=function(t){return t instanceof e?this.number<t.number?-1:this.number>t.number?1:0:NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.number===t.number},e.prototype.hashCode=function(){return m.hash(this.toString())},e.prototype.debug=function(e){return e=e.write("UriPort").write(46),this.isDefined()?(e=e.write("create").write(40),e=ne.displayNumber(e,this.number)):e=e.write("undefined").write(40),e=e.write(41)},e.prototype.display=function(e){return e=ne.displayNumber(e,this.number)},e.prototype.toString=function(){return""+this.number},e.undefined=function(){return new e(0)},e.create=function(t){if(0===t)return e.undefined();if(t>0){var r=e.cache,n=r.get(t);return void 0!==n?n:r.put(t,new e(t))}throw new TypeError(""+t)},e.fromAny=function(t){if(null==t)return e.undefined();if(t instanceof e)return t;if("number"==typeof t)return e.create(t);if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.parse=function(e){return yu.standardParser.parsePortString(e)},Object.defineProperty(e,"cache",{get:function(){return new R(16)},enumerable:!1,configurable:!0}),E([s],e,"undefined",null),E([s],e,"cache",null),e}(),Cu=function(){function e(){}return Object.defineProperty(e.prototype,"length",{get:function(){for(var e=0,t=this;!t.isEmpty();)e+=1,t=t.tail();return e},enumerable:!1,configurable:!0}),e.prototype.get=function(e){for(var t=0,r=this;!r.isEmpty();){if(!(t<e))return r.head();t+=1,r=r.tail()}},Object.defineProperty(e.prototype,"name",{get:function(){if(this.isEmpty())return"";for(var e=this;;){var t=e.tail();if(t.isEmpty())return e.isRelative()?e.head():"";e=t}},enumerable:!1,configurable:!0}),e.prototype.withName=function(e){var t=new Mu;return t.addPath(this.base()),t.addSegment(e),t.bind()},e.prototype.foot=function(){if(this.isEmpty())return this;for(var e=this;;){var t=e.tail();if(t.isEmpty())return e;e=t}},e.prototype.isSubpathOf=function(t){t=e.fromAny(t);for(var r=this;!r.isEmpty()&&!t.isEmpty();){if(r.head()!==t.head())return!1;r=r.tail(),t=t.tail()}return t.isEmpty()},e.prototype.appended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(arguments.length>0){var r=new Mu;return r.addPath(this),r.push.apply(r,e),r.bind()}return this},e.prototype.appendedSlash=function(){var e=new Mu;return e.addPath(this),e.addSlash(),e.bind()},e.prototype.appendedSegment=function(e){var t=new Mu;return t.addPath(this),t.addSegment(e),t.bind()},e.prototype.prepended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(arguments.length>0){var r=new Mu;return r.push.apply(r,e),r.addPath(this),r.bind()}return this},e.prototype.prependedSlash=function(){return new Su(this)},e.prototype.prependedSegment=function(t){return this.isEmpty()||this.isAbsolute()?e.segment(t,this):e.segment(t,this.prependedSlash())},e.prototype.resolve=function(e){return e.isEmpty()?this:e.isAbsolute()||this.isEmpty()?e.removeDotSegments():this.merge(e).removeDotSegments()},e.prototype.removeDotSegments=function(){for(var t=this,r=new Mu;!t.isEmpty();){var n=t.head();if("."===n||".."===n)(t=t.tail()).isEmpty()||(t=t.tail());else if(t.isAbsolute()){var i=t.tail();if(i.isEmpty())r.push(t.head()),t=t.tail();else{var o=i.head();"."===o?(t=i.tail()).isEmpty()&&(t=e.slash()):".."===o?((t=i.tail()).isEmpty()&&(t=e.slash()),r.isEmpty()||r.pop().isAbsolute()||r.isEmpty()||r.pop()):(r.push(n,o),t=i.tail())}}else r.push(t.head()),t=t.tail()}return r.bind()},e.prototype.merge=function(e){if(this.isEmpty())return e;for(var t=new Mu,r=this;;){var n=r.tail();if(n.isEmpty()){r.isAbsolute()&&t.addSlash();break}r.isAbsolute()?t.addSlash():t.addSegment(r.head()),r=n}return t.addPath(e),t.bind()},e.prototype.unmerge=function(t,r){void 0===r&&(r=t);for(var n=this;;){if(n.isEmpty())return t.isEmpty()||t.tail().isEmpty()?t:t.tail();if(n.isRelative())return t;if(t.isRelative())return t.prependedSlash();var i=n.tail(),o=t.tail();if(!i.isEmpty()&&o.isEmpty())return e.slash();if(i.isEmpty()||o.isEmpty()||i.head()!==o.head())return o;if(i=i.tail(),o=o.tail(),!i.isEmpty()&&o.isEmpty())return r;n=i,t=o}},e.prototype.toAny=function(){for(var e=[],t=this;!t.isEmpty();)e.push(t.head()),t=t.tail();return e},e.prototype.compareTo=function(t){return t instanceof e?this.toString().localeCompare(t.toString()):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.toString()===t.toString()},e.prototype.hashCode=function(){return m.hash(this.toString())},e.prototype.display=function(e){for(var t=this;!t.isEmpty();)e=t.isAbsolute()?e.write(47):yu.writePathSegment(e,t.head()),t=t.tail();return e},e.empty=function(){return new ku},e.slash=function(){return new Su(e.empty())},e.segment=function(t,r){return void 0===r&&(r=e.empty()),t=this.cacheSegment(t),new Eu(t,r)},e.of=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new Mu;return r.push.apply(r,e),r.bind()},e.fromAny=function(t){if(null==t)return e.empty();if(t instanceof e)return t;if(Array.isArray(t))return e.of.apply(e,t);if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.parse=function(e){return yu.standardParser.parsePathString(e)},e.builder=function(){return new Mu},e.pathForm=function(){return new Au(e.empty())},Object.defineProperty(e,"segmentCache",{get:function(){return new N(64)},enumerable:!1,configurable:!0}),e.cacheSegment=function(e){return e.length<=32?this.segmentCache.put(e):e},E([s],e,"empty",null),E([s],e,"slash",null),E([s],e,"pathForm",null),E([s],e,"segmentCache",null),e}(),Eu=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"segment",{value:t,enumerable:!0}),Object.defineProperty(n,"rest",{value:r,enumerable:!0,configurable:!0}),Object.defineProperty(n,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.isDefined=function(){return!0},t.prototype.isAbsolute=function(){return!1},t.prototype.isRelative=function(){return!0},t.prototype.isEmpty=function(){return!1},t.prototype.head=function(){return this.segment},t.prototype.tail=function(){return this.rest},t.prototype.setTail=function(e){if(e instanceof t)throw new Error("adjacent path segments");Object.defineProperty(this,"rest",{value:e,enumerable:!0,configurable:!0})},t.prototype.dealias=function(){return new t(this.segment,this.rest)},t.prototype.parent=function(){var e=this.rest;return e.isEmpty()||e.tail().isEmpty()?Cu.empty():new t(this.segment,e.parent())},t.prototype.base=function(){var e=this.rest;return e.isEmpty()?Cu.empty():new t(this.segment,e.base())},t.prototype.prependedSegment=function(e){return Cu.segment(e,this.prependedSlash())},t.prototype.debug=function(e){return e=e.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},t.prototype.display=function(t){var r=this.stringValue;return t=void 0!==r?t.write(r):e.prototype.display.call(this,t)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=ne.display(this),Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t}(Cu),Su=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"rest",{value:t,enumerable:!0,configurable:!0}),Object.defineProperty(r,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.isDefined=function(){return!0},t.prototype.isAbsolute=function(){return!0},t.prototype.isRelative=function(){return!1},t.prototype.isEmpty=function(){return!1},t.prototype.head=function(){return"/"},t.prototype.tail=function(){return this.rest},t.prototype.setTail=function(e){Object.defineProperty(this,"rest",{value:e,enumerable:!0,configurable:!0})},t.prototype.dealias=function(){return new t(this.rest)},t.prototype.parent=function(){var e=this.rest;return e.isEmpty()?Cu.empty():e.tail().isEmpty()?Cu.slash():new t(e.parent())},t.prototype.base=function(){var e=this.rest;return e.isEmpty()?this:new t(e.base())},t.prototype.prependedSegment=function(e){return Cu.segment(e,this)},t.prototype.debug=function(e){return e=e.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},t.prototype.display=function(t){var r=this.stringValue;return t=void 0!==r?t.write(r):e.prototype.display.call(this,t)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=ne.display(this),Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t}(Cu),ku=function(e){function t(){return e.call(this)||this}return C(t,e),t.prototype.isDefined=function(){return!1},t.prototype.isAbsolute=function(){return!1},t.prototype.isRelative=function(){return!0},t.prototype.isEmpty=function(){return!0},t.prototype.head=function(){throw new Error("empty path")},t.prototype.tail=function(){throw new Error("empty path")},t.prototype.setTail=function(e){throw new Error("empty path")},t.prototype.dealias=function(){return this},t.prototype.parent=function(){return this},t.prototype.base=function(){return this},t.prototype.appended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Cu.of.apply(Cu,e)},t.prototype.appendedSlash=function(){return Cu.slash()},t.prototype.appendedSegment=function(e){return Cu.segment(e)},t.prototype.prepended=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Cu.of.apply(Cu,e)},t.prototype.prependedSlash=function(){return Cu.slash()},t.prototype.prependedSegment=function(e){return Cu.segment(e)},t.prototype.merge=function(e){return e},t.prototype.debug=function(e){return e=e.write("UriPath").write(46).write("empty").write(40).write(41)},t.prototype.display=function(e){return e},t.prototype.toString=function(){return""},t}(Cu),Mu=function(){function e(){this.first=Cu.empty(),this.last=null,this.size=0,this.aliased=0}return e.prototype.isEmpty=function(){return 0===this.size},e.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0;r<e.length;r+=1){var n=e[r];n instanceof Cu?this.addPath(n):Array.isArray(n)?this.push.apply(this,n):"/"===n?this.addSlash():this.addSegment(n)}},e.prototype.bind=function(){return this.aliased=0,this.first},e.prototype.addSlash=function(){var e=Cu.slash().dealias(),t=this.size;0===t?this.first=e:this.dealias(t-1).setTail(e),this.last=e,this.size=t+1,this.aliased+=1},e.prototype.addSegment=function(e){var t=Cu.segment(e,Cu.empty()),r=this.size;if(0===r)this.first=t;else{var n=this.dealias(r-1);n.isAbsolute()?n.setTail(t):(n.setTail(t.prependedSlash()),r+=1,this.aliased+=1)}this.last=t,this.size=r+1,this.aliased+=1},e.prototype.addPath=function(e){if(!e.isEmpty()){var t=this.size;if(0===t)this.first=e;else{var r=this.dealias(t-1);r.isAbsolute()||e.isAbsolute()?r.setTail(e):(r.setTail(e.prependedSlash()),t+=1,this.aliased+=1)}for(t+=1;;){var n=e.tail();if(n.isEmpty())break;e=n,t+=1}this.last=e,this.size=t}},e.prototype.pop=function(){var e=this.size,t=this.aliased;if(0===e)throw new Error("Empty UriPath");if(1===e){var r=this.first;return this.first=r.tail(),r.tail().isEmpty()&&(this.last=null),this.size=e-1,t>0&&(this.aliased=t-1),r}var n=this.dealias(e-2);return n.setTail(Cu.empty()),this.last=n,this.size=e-1,this.aliased=t-1,n.tail()},e.prototype.dealias=function(e){var t=0,r=null,n=this.first;if(this.aliased<=e){for(;t<this.aliased;)r=n,n=n.tail(),t+=1;for(;t<=e;){var i=n.dealias();0===t?this.first=i:r.setTail(i),r=i,n=n.tail(),t+=1}t===this.size&&(this.last=r),this.aliased=t}else if(0===e)r=this.first;else if(e===this.size-1)r=this.last;else for(;t<=e;)r=n,n=n.tail(),t+=1;return r},e}(),Au=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return e=Cu.fromAny(e),void 0===t?hr.from(e.toString()):t.concat(hr.from(e.toString()))},t.prototype.cast=function(e,t){var r=e.target;try{var n=r.stringValue();if("string"==typeof n)return Cu.parse(n)}catch(e){}},t}(En),Du=function(){function e(){}return Object.defineProperty(e.prototype,"length",{get:function(){for(var e=0,t=this;!t.isEmpty();)e+=1,t=t.tail();return e},enumerable:!1,configurable:!0}),e.prototype.has=function(e){for(var t=this;!t.isEmpty();){if(e===t.key)return!0;t=t.tail()}return!1},e.prototype.get=function(e){for(var t=this;!t.isEmpty();){if(e===t.key)return t.value;t=t.tail()}},e.prototype.updated=function(e,t){for(var r=this,n=new Vu,i=!1;!r.isEmpty();)e===r.key?(n.addParam(e,t),i=!0):n.addParam(r.key,r.value),r=r.tail();return i||n.addParam(e,t),n.bind()},e.prototype.removed=function(e){for(var t=this,r=new Vu,n=!1;!t.isEmpty();)e===t.key?n=!0:r.addParam(t.key,t.value),t=t.tail();return n?r.bind():this},e.prototype.appended=function(e,t){var r=new Vu;return r.addQuery(this),r.add(e,t),r.bind()},e.prototype.prepended=function(e,t){var r=new Vu;return r.add(e,t),r.addQuery(this),r.bind()},e.prototype.toAny=function(e){if(this.isDefined()){e=e||{};for(var t=this,r=0;!t.isEmpty();){var n=t.key;void 0!==n?e[n]=t.value:e["$"+r]=t.value,t=t.tail(),r+=1}}return e},e.prototype.compareTo=function(t){return t instanceof e?this.toString().localeCompare(t.toString()):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.toString()===t.toString()},e.prototype.hashCode=function(){return m.hash(this.toString())},e.prototype.display=function(e){for(var t=this,r=!0;!t.isEmpty();){r?r=!1:e=e.write(38);var n=t.key;void 0!==n&&(e=(e=yu.writeParam(e,n)).write(61)),e=yu.writeQuery(e,t.value),t=t.tail()}return e},e.undefined=function(){return new Tu},e.param=function(t,r,n){return void 0===n?(n=r,r=t,t=void 0):void 0!==t&&(t=this.cacheKey(t)),void 0===n&&(n=e.undefined()),new Iu(t,r,n)},e.fromAny=function(t){if(null==t)return e.undefined();if(t instanceof e)return t;if("object"==typeof t){var r=new Vu;return r.add(t),r.bind()}if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.parse=function(e){return yu.standardParser.parseQueryString(e)},e.builder=function(){return new Vu},Object.defineProperty(e,"keyCache",{get:function(){return new N(64)},enumerable:!1,configurable:!0}),e.cacheKey=function(t){return t.length<=32?e.keyCache.put(t):t},E([s],e,"undefined",null),E([s],e,"keyCache",null),e}(),Iu=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"key",{value:t,enumerable:!0}),Object.defineProperty(i,"value",{value:r,enumerable:!0}),Object.defineProperty(i,"rest",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(i,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),i}return C(t,e),t.prototype.isDefined=function(){return!0},t.prototype.isEmpty=function(){return!1},t.prototype.head=function(){return[this.key,this.value]},t.prototype.tail=function(){return this.rest},t.prototype.setTail=function(e){Object.defineProperty(this,"rest",{value:e,enumerable:!0,configurable:!0})},t.prototype.dealias=function(){return new t(this.key,this.value,this.rest)},t.prototype.debug=function(e){return e=e.write("UriQuery").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},t.prototype.display=function(t){var r=this.stringValue;return t=void 0!==r?t.write(r):e.prototype.display.call(this,t)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=ne.display(this),Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t}(Du),Tu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.isDefined=function(){return!1},t.prototype.isEmpty=function(){return!0},t.prototype.head=function(){throw new Error("undefined query")},Object.defineProperty(t.prototype,"key",{get:function(){throw new Error("undefined query")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw new Error("undefined query")},enumerable:!1,configurable:!0}),t.prototype.tail=function(){throw new Error("undefined query")},t.prototype.setTail=function(e){throw new Error("undefined query")},t.prototype.dealias=function(){return this},t.prototype.updated=function(e,t){return Du.param(e,t,this)},t.prototype.removed=function(e){return this},t.prototype.appended=function(e,t){var r=new Vu;return r.add(e,t),r.bind()},t.prototype.prepended=function(e,t){var r=new Vu;return r.add(e,t),r.bind()},t.prototype.debug=function(e){return e=e.write("UriQuery").write(46).write("undefined").write(40).write(41)},t.prototype.display=function(e){return e},t.prototype.toString=function(){return""},t}(Du),Vu=function(){function e(){this.first=Du.undefined(),this.last=null,this.size=0,this.aliased=0}return e.prototype.isEmpty=function(){return 0===this.size},e.prototype.add=function(e,t){if(void 0!==t)this.addParam(e,t);else if("string"==typeof e)this.addParam(void 0,e);else if(e instanceof Du)this.addQuery(e);else{var r=e;for(var n in r){var i=n,o=r[n];36===n.charCodeAt(0)&&(i=void 0),this.addParam(i,o)}}},e.prototype.bind=function(){return this.aliased=0,this.first},e.prototype.addParam=function(e,t){void 0===t&&(t=e,e=void 0);var r=Du.param(e,t,Du.undefined()),n=this.size;0===n?this.first=r:this.dealias(n-1).setTail(r),this.last=r,this.size=n+1,this.aliased+=1},e.prototype.addQuery=function(e){if(!e.isEmpty()){var t=this.size;for(0===t?this.first=e:this.dealias(t-1).setTail(e),t+=1;;){var r=e.tail();if(r.isEmpty())break;e=r,t+=1}this.last=e,this.size=t}},e.prototype.dealias=function(e){var t=0,r=null,n=this.first;if(this.aliased<=e){for(;t<this.aliased;)r=n,n=n.tail(),t+=1;for(;t<=e;){var i=n.dealias();0===t?this.first=i:r.setTail(i),r=i,n=n.tail(),t+=1}t===this.size&&(this.last=r),this.aliased=t}else if(0===e)r=this.first;else if(e===this.size-1)r=this.last;else for(;t<=e;)r=n,n=n.tail(),t+=1;return r},e}(),qu=function(){function e(e){Object.defineProperty(this,"identifier",{value:e,enumerable:!0}),Object.defineProperty(this,"stringValue",{value:void 0,enumerable:!0,configurable:!0})}return e.prototype.isDefined=function(){return void 0!==this.identifier},e.prototype.toAny=function(){return this.identifier},e.prototype.compareTo=function(t){return t instanceof e?this.toString().localeCompare(t.toString()):NaN},e.prototype.equals=function(t){return this===t||t instanceof e&&this.identifier===t.identifier},e.prototype.hashCode=function(){return m.hash(this.identifier)},e.prototype.debug=function(e){return e=e.write("UriFragment").write(46),e=this.isDefined()?e.write("parse").write(40).write(34).display(this).write(34).write(41):e.write("undefined").write(40).write(41)},e.prototype.display=function(e){var t=this.stringValue;return void 0!==t?e=e.write(t):void 0!==this.identifier&&(e=yu.writeFragment(e,this.identifier)),e},e.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=ne.display(this),Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},e.undefined=function(){return new e(void 0)},e.create=function(t){if(void 0!==t){var r=e.cache,n=r.get(t);return void 0!==n?n:r.put(t,new e(t))}return e.undefined()},e.fromAny=function(t){if(null==t)return e.undefined();if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.parse=function(e){return yu.standardParser.parseFragmentString(e)},Object.defineProperty(e,"cache",{get:function(){return new R(32)},enumerable:!1,configurable:!0}),E([s],e,"undefined",null),E([s],e,"cache",null),e}(),Ru=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e,t){return e=yu.fromAny(e),void 0===t?hr.from(e.toString()):t.concat(hr.from(e.toString()))},t.prototype.cast=function(e,t){var r=e.target;try{var n=r.stringValue();if("string"==typeof n)return yu.parse(n)}catch(e){}},t}(En),Uu=function(){function e(e,t){void 0===t&&(t=32),Object.defineProperty(this,"base",{value:e,enumerable:!0}),Object.defineProperty(this,"resolveCache",{value:new R(t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"unresolveCache",{value:new R(t),enumerable:!0,configurable:!0})}return e.prototype.resolve=function(e){e=yu.fromAny(e);var t=this.resolveCache.get(e);return void 0===t&&(t=this.base.resolve(e),this.resolveCache.put(e,t)),t},e.prototype.unresolve=function(e){e=yu.fromAny(e);var t=this.unresolveCache.get(e);return void 0===t&&(t=this.base.unresolve(e),this.unresolveCache.put(e,t)),t},e}(),Nu=function(){function e(){}return e.prototype.absolute=function(e,t,r,n,i){return yu.create(e,t,r,n,i)},e.prototype.scheme=function(e){return vu.create(e)},e.prototype.authority=function(e,t,r){return bu.create(e,t,r)},e.prototype.user=function(e,t){return mu.create(e,t)},e.prototype.hostName=function(e){return gu.hostname(e)},e.prototype.hostIPv4=function(e){return gu.ipv4(e)},e.prototype.hostIPv6=function(e){return gu.ipv6(e)},e.prototype.port=function(e){return ju.create(e)},e.prototype.pathEmpty=function(){return Cu.empty()},e.prototype.pathBuilder=function(){return new Mu},e.prototype.queryBuilder=function(){return new Vu},e.prototype.fragment=function(e){return qu.create(e)},e.prototype.absoluteParser=function(){return new zu(this)},e.prototype.parseAbsolute=function(e){return zu.parse(e,this)},e.prototype.parseAbsoluteString=function(e){var t=re.stringInput(e),r=this.parseAbsolute(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.schemeParser=function(){return new Fu(this)},e.prototype.parseScheme=function(e){return Fu.parse(e,this)},e.prototype.parseSchemeString=function(e){var t=re.stringInput(e),r=this.parseScheme(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.authorityParser=function(){return new Lu(this)},e.prototype.parseAuthority=function(e){return Lu.parse(e,this)},e.prototype.parseAuthorityString=function(e){var t=re.stringInput(e),r=this.parseAuthority(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.userParser=function(){return new Ku(this)},e.prototype.parseUser=function(e){return Ku.parse(e,this)},e.prototype.parseUserString=function(e){var t=re.stringInput(e),r=this.parseUser(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.hostParser=function(){return new Bu(this)},e.prototype.parseHost=function(e){return Bu.parse(e,this)},e.prototype.parseHostString=function(e){var t=re.stringInput(e),r=this.parseHost(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.hostAddressParser=function(){return new Wu(this)},e.prototype.parseHostAddress=function(e){return Wu.parse(e,this)},e.prototype.hostLiteralParser=function(){return new Hu(this)},e.prototype.parseHostLiteral=function(e){return Hu.parse(e,this)},e.prototype.portParser=function(){return new Xu(this)},e.prototype.parsePort=function(e){return Xu.parse(e,this)},e.prototype.parsePortString=function(e){var t=re.stringInput(e),r=this.parsePort(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.pathParser=function(e){return new Yu(this,e)},e.prototype.parsePath=function(e,t){return Yu.parse(e,this,t)},e.prototype.parsePathString=function(e){var t=re.stringInput(e),r=this.parsePath(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.queryParser=function(e){return new Gu(this,e)},e.prototype.parseQuery=function(e,t){return Gu.parse(e,this,t)},e.prototype.parseQueryString=function(e){var t=re.stringInput(e),r=this.parseQuery(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.prototype.fragmentParser=function(){return new _u(this)},e.prototype.parseFragment=function(e){return _u.parse(e,this)},e.prototype.parseFragmentString=function(e){var t=re.stringInput(e),r=this.parseFragment(t);return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e}(),zu=function(e){function t(t,r,n,i,o,u,s){var a=e.call(this)||this;return a.uri=t,a.schemeParser=r,a.authorityParser=n,a.pathParser=i,a.queryParser=o,a.fragmentParser=u,a.step=s,a}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.schemeParser,this.authorityParser,this.pathParser,this.queryParser,this.fragmentParser,this.step)},t.parse=function(e,r,n,i,o,u,s,a){void 0===a&&(a=1);var p=0;if(1===a)if(e.isCont()){for(var f=e.clone();f.isCont()&&(p=f.head(),yu.isSchemeChar(p));)f.step();a=f.isCont()&&58===p?2:3}else e.isDone()&&(a=3);if(2===a)if((n=void 0===n?r.parseScheme(e):n.feed(e)).isDone()){if(e.isCont()&&58===e.head())e=e.step(),a=3;else if(!e.isEmpty())return we.error(oe.expected(58,e))}else if(n.isError())return n.asError();if(3===a)if(e.isCont())47===(p=e.head())?(e=e.step(),a=4):63===p?(e=e.step(),a=7):35===p?(e=e.step(),a=8):a=6;else if(e.isDone())return we.done(r.absolute(void 0!==n?n.bind():void 0));if(4===a)if(e.isCont()&&47===e.head())e=e.step(),a=5;else if(e.isCont()){var c=r.pathBuilder();c.addSlash(),o=r.parsePath(e,c),a=6}else if(e.isDone())return we.done(r.absolute(void 0!==n?n.bind():void 0,void 0,Cu.slash()));if(5===a)if((i=void 0===i?r.parseAuthority(e):i.feed(e)).isDone()){if(e.isCont())63===(p=e.head())?(e=e.step(),a=7):35===p?(e=e.step(),a=8):a=6;else if(e.isDone())return we.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0))}else if(i.isError())return i.asError();if(6===a)if((o=void 0===o?r.parsePath(e):o.feed(e)).isDone()){if(e.isCont()&&63===e.head())e=e.step(),a=7;else if(e.isCont()&&35===e.head())e=e.step(),a=8;else if(!e.isEmpty())return we.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0,o.bind()))}else if(o.isError())return o.asError();if(7===a)if((u=void 0===u?r.parseQuery(e):u.feed(e)).isDone()){if(e.isCont()&&35===e.head())e=e.step(),a=8;else if(!e.isEmpty())return we.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0,void 0!==o?o.bind():void 0,u.bind()))}else if(u.isError())return u.asError();if(8===a){if((s=void 0===s?r.parseFragment(e):s.feed(e)).isDone())return we.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0,void 0!==o?o.bind():void 0,void 0!==u?u.bind():void 0,s.bind()));if(s.isError())return s.asError()}return new t(r,n,i,o,u,s,a)},t}(we),Fu=function(e){function t(t,r,n){var i=e.call(this)||this;return i.uri=t,i.output=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.output,this.step)},t.parse=function(e,r,n,i){void 0===i&&(i=1);var o=0;if(1===i)if(e.isCont()&&(o=e.head(),yu.isAlpha(o)))e=e.step(),n=(n=n||Ue.decodedString()).write(yu.toLowerCase(o)),i=2;else if(!e.isEmpty())return we.error(oe.expected("scheme",e));if(2===i){for(;e.isCont()&&(o=e.head(),yu.isSchemeChar(o));)e=e.step(),n.write(yu.toLowerCase(o));if(!e.isEmpty())return we.done(r.scheme(n.bind()))}return new t(r,n,i)},t}(we),Lu=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.uri=t,u.userParser=r,u.hostParser=n,u.portParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.userParser,this.hostParser,this.portParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u)if(e.isCont()){for(var a=e.clone();a.isCont()&&(64!==(s=a.head())&&47!==s);)a.step();u=a.isCont()&&64===s?2:3}else e.isDone()&&(u=3);if(2===u)if((n=void 0===n?r.parseUser(e):n.feed(e)).isDone()){if(e.isCont()&&64===e.head())e=e.step(),u=3;else if(!e.isEmpty())return we.error(oe.expected(64,e))}else if(n.isError())return n.asError();if(3===u)if((i=void 0===i?r.parseHost(e):i.feed(e)).isDone()){if(e.isCont()&&58===e.head())e=e.step(),u=4;else if(!e.isEmpty())return we.done(r.authority(void 0!==n?n.bind():void 0,i.bind()))}else if(i.isError())return i.asError();if(4===u){if((o=void 0===o?r.parsePort(e):o.feed(e)).isDone())return we.done(r.authority(void 0!==n?n.bind():void 0,i.bind(),o.bind()));if(o.isError())return o.asError()}return new t(r,n,i,o,u)},t}(we),Ku=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.uri=t,u.usernameOutput=r,u.passwordOutput=n,u.c1=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.usernameOutput,this.passwordOutput,this.c1,this.step)},t.parse=function(e,r,n,i,o,u){void 0===o&&(o=0),void 0===u&&(u=1);for(var s=0;;){if(1===u){for(n=n||Ue.decodedString();e.isCont()&&(s=e.head(),yu.isUserChar(s));)e=e.step(),n.write(s);if(e.isCont()&&58===s)e=e.step(),u=4;else if(e.isCont()&&37===s)e=e.step(),u=2;else if(!e.isEmpty())return we.done(r.user(n.bind()))}if(2===u)if(e.isCont()&&(s=e.head(),Ve.isDigit(s)))e=e.step(),o=s,u=3;else if(!e.isEmpty())return we.error(oe.expected("hex digit",e));if(3===u){if(e.isCont()&&(s=e.head(),Ve.isDigit(s))){e=e.step(),n.write(Ve.decodeDigit(o)<<4|Ve.decodeDigit(s)),o=0,u=1;continue}if(!e.isEmpty())return we.error(oe.expected("hex digit",e))}if(4===u){for(i=i||Ue.decodedString();e.isCont()&&(s=e.head(),yu.isUserInfoChar(s));)e=e.step(),i.write(s);if(e.isCont()&&37===s)e=e.step(),u=5;else if(!e.isEmpty())return we.done(r.user(n.bind(),i.bind()))}if(5===u)if(e.isCont()&&(s=e.head(),Ve.isDigit(s)))e=e.step(),o=s,u=6;else if(!e.isEmpty())return we.error(oe.expected("hex digit",e));if(6===u){if(e.isCont()&&(s=e.head(),Ve.isDigit(s))){e=e.step(),i.write(Ve.decodeDigit(o)<<4|Ve.decodeDigit(s)),o=0,u=4;continue}if(!e.isEmpty())return we.error(oe.expected("hex digit",e))}break}return new t(r,n,i,o,u)},t}(we),Bu=function(e){function t(t){var r=e.call(this)||this;return r.uri=t,r}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri)},t.parse=function(e,r){return e.isCont()?91===e.head()?r.parseHostLiteral(e):r.parseHostAddress(e):e.isDone()?we.done(r.hostName("")):new t(r)},t}(we),Wu=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.uri=t,u.output=r,u.c1=n,u.x=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.output,this.c1,this.x,this.step)},t.parse=function(e,r,n,i,o,u){void 0===i&&(i=0),void 0===o&&(o=0),void 0===u&&(u=1);var s=0;for(n=n||Ue.decodedString();u<=4;){for(;e.isCont()&&(s=e.head(),ie.isDigit(s));)e=e.step(),n=n.write(s),o=10*o+ie.decodeDigit(s);if(!e.isCont()){if(e.isEmpty())break;return 4===u&&o<=255?we.done(r.hostIPv4(n.bind())):we.done(r.hostName(n.bind()))}if(!(46===s&&u<4&&o<=255)){if(!yu.isHostChar(s)&&37!==s&&4===u&&o<=255)return we.done(r.hostIPv4(n.bind()));o=0,u=5;break}e=e.step(),n=n.write(s),o=0,u+=1}for(;;){if(5===u){for(;e.isCont()&&(s=e.head(),yu.isHostChar(s));)e=e.step(),n.write(yu.toLowerCase(s));if(e.isCont()&&37===s)e=e.step(),u=6;else if(!e.isEmpty())return we.done(r.hostName(n.bind()))}if(6===u)if(e.isCont()&&(s=e.head(),Ve.isDigit(s)))e=e.step(),i=s,u=7;else if(!e.isEmpty())return we.error(oe.expected("hex digit",e));if(7===u){if(e.isCont()&&(s=e.head(),Ve.isDigit(s))){e=e.step(),n.write(Ve.decodeDigit(i)<<4|Ve.decodeDigit(s)),i=0,u=5;continue}if(!e.isEmpty())return we.error(oe.expected("hex digit",e))}break}return new t(r,n,i,o,u)},t}(we),Hu=function(e){function t(t,r,n){var i=e.call(this)||this;return i.uri=t,i.output=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.output,this.step)},t.parse=function(e,r,n,i){void 0===i&&(i=1);var o=0;if(1===i)if(e.isCont()&&91===e.head())e=e.step(),i=2;else if(!e.isEmpty())return we.error(oe.expected(91,e));if(2===i){for(n=n||Ue.decodedString();e.isCont()&&(o=e.head(),yu.isHostChar(o)||58===o);)e=e.step(),n=n.write(yu.toLowerCase(o));if(e.isCont()&&93===o)return e=e.step(),we.done(r.hostIPv6(n.bind()));if(!e.isEmpty())return we.error(oe.expected(93,e))}return new t(r,n,i)},t}(we),Xu=function(e){function t(t,r){var n=e.call(this)||this;return n.uri=t,n.number=r,n}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.number)},t.parse=function(e,r,n){void 0===n&&(n=0);for(var i=0;e.isCont()&&(i=e.head(),ie.isDigit(i));)e=e.step(),n=10*n+ie.decodeDigit(i);return e.isEmpty()?new t(r,n):we.done(r.port(n))},t}(we),Yu=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.uri=t,u.builder=r,u.output=n,u.c1=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.builder,this.output,this.c1,this.step)},t.parse=function(e,r,n,i,o,u){void 0===o&&(o=0),void 0===u&&(u=1);for(var s=0;;){if(1===u){for(;e.isCont()&&(s=e.head(),yu.isPathChar(s));)i=i||Ue.decodedString(),e=e.step(),i=i.write(s);if(e.isCont()&&47===s){e=e.step(),n=n||r.pathBuilder(),void 0!==i&&(n.addSegment(i.bind()),i=void 0),n.addSlash();continue}if(e.isCont()&&37===s)e=e.step(),u=2;else if(!e.isEmpty())return void 0!==i&&(n=n||r.pathBuilder()).addSegment(i.bind()),void 0!==n?we.done(n.bind()):we.done(r.pathEmpty())}if(2===u)if(e.isCont()&&(s=e.head(),Ve.isDigit(s)))e=e.step(),o=s,u=3;else if(!e.isEmpty())return we.error(oe.expected("hex digit",e));if(3===u){if(e.isCont()&&(s=e.head(),Ve.isDigit(s))){i=i||Ue.decodedString(),e=e.step(),i=i.write(Ve.decodeDigit(o)<<4|Ve.decodeDigit(s)),o=0,u=1;continue}if(!e.isEmpty())return we.error(oe.expected("hex digit",e))}break}return new t(r,n,i,o,u)},t}(we),Gu=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return s.uri=t,s.builder=r,s.keyOutput=n,s.valueOutput=i,s.c1=o,s.step=u,s}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.builder,this.keyOutput,this.valueOutput,this.c1,this.step)},t.parse=function(e,r,n,i,o,u,s){void 0===u&&(u=0),void 0===s&&(s=1);for(var a=0;;){if(1===s){for(i=i||Ue.decodedString();e.isCont()&&(a=e.head(),yu.isParamChar(a));)e=e.step(),i.write(a);if(e.isCont()&&61===a)e=e.step(),s=4;else{if(e.isCont()&&38===a){e=e.step(),(n=n||r.queryBuilder()).addParam(i.bind()),i=void 0;continue}if(e.isCont()&&37===a)e=e.step(),s=2;else if(!e.isEmpty())return(n=n||r.queryBuilder()).addParam(i.bind()),we.done(n.bind())}}if(2===s)if(e.isCont()&&(a=e.head(),Ve.isDigit(a)))e=e.step(),u=a,s=3;else if(!e.isEmpty())return we.error(oe.expected("hex digit",e));if(3===s){if(e.isCont()&&(a=e.head(),Ve.isDigit(a))){e=e.step(),i.write(Ve.decodeDigit(u)<<4|Ve.decodeDigit(a)),u=0,s=1;continue}if(!e.isEmpty())return we.error(oe.expected("hex digit",e))}if(4===s){for(o=o||Ue.decodedString();e.isCont()&&(a=e.head(),yu.isParamChar(a)||61===a);)e=e.step(),o.write(a);if(e.isCont()&&38===a){e=e.step(),(n=n||r.queryBuilder()).addParam(i.bind(),o.bind()),i=void 0,o=void 0,s=1;continue}if(e.isCont()&&37===a)e=e.step(),s=5;else if(!e.isEmpty())return(n=n||r.queryBuilder()).addParam(i.bind(),o.bind()),we.done(n.bind())}if(5===s)if(e.isCont()&&(a=e.head(),Ve.isDigit(a)))e=e.step(),u=a,s=6;else if(!e.isEmpty())return we.error(oe.expected("hex digit",e));if(6===s){if(e.isCont()&&(a=e.head(),Ve.isDigit(a))){e=e.step(),o.write(Ve.decodeDigit(u)<<4|Ve.decodeDigit(a)),u=0,s=4;continue}if(!e.isEmpty())return we.error(oe.expected("hex digit",e))}break}return new t(r,n,i,o,u,s)},t}(we),_u=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.uri=t,o.output=r,o.c1=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.uri,this.output,this.c1,this.step)},t.parse=function(e,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var u=0;for(n=n||Ue.decodedString();;){if(1===o){for(;e.isCont()&&(u=e.head(),yu.isFragmentChar(u));)e=e.step(),n=n.write(u);if(e.isCont()&&37===u)e=e.step(),o=2;else if(!e.isEmpty())return we.done(r.fragment(n.bind()))}if(2===o)if(e.isCont()&&(u=e.head(),Ve.isDigit(u)))e=e.step(),i=u,o=3;else if(!e.isEmpty())return we.error(oe.expected("hex digit",e));if(3===o){if(e.isCont()&&(u=e.head(),Ve.isDigit(u))){e=e.step(),n=n.write(Ve.decodeDigit(i)<<4|Ve.decodeDigit(u)),i=0,o=1;continue}if(!e.isEmpty())return we.error(oe.expected("hex digit",e))}break}return new t(r,n,i,o)},t}(we),Qu=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return C(t,e),t}(Error),Zu=function(){function e(){}return e.prototype.isDefined=function(){return isFinite(this.value)},e.prototype.plus=function(t,r,n){return void 0===r&&(r=this.units),t=e.fromAny(t),e.create(this.toValue(r,n)+t.toValue(r,n),r)},e.prototype.negative=function(t,r){return void 0===t&&(t=this.units),e.create(-this.toValue(t,r),t)},e.prototype.minus=function(t,r,n){return void 0===r&&(r=this.units),t=e.fromAny(t),e.create(this.toValue(r,n)-t.toValue(r,n),r)},e.prototype.times=function(t,r,n){return void 0===r&&(r=this.units),e.create(this.toValue(r,n)*t,r)},e.prototype.divide=function(t,r,n){return void 0===r&&(r=this.units),e.create(this.toValue(r,n)/t,r)},e.prototype.combine=function(t,r,n,i){return void 0===r&&(r=1),void 0===n&&(n=this.units),t=e.fromAny(t),e.create(this.toValue(n,i)+t.toValue(n,i)*r,n)},e.prototype.emValue=function(t){return 0!==this.value?this.pxValue(t)/e.emUnit(t):0},e.prototype.remValue=function(t){return 0!==this.value?this.pxValue(t)/e.remUnit(t):0},e.prototype.pctValue=function(t){return 0!==this.value?this.pxValue(t)/e.pctUnit(t):0},e.prototype.px=function(t){return e.px(this.pxValue(t))},e.prototype.em=function(t){return e.em(this.emValue(t))},e.prototype.rem=function(t){return e.rem(this.remValue(t))},e.prototype.pct=function(t){return e.pct(this.pctValue(t))},e.prototype.toValue=function(e,t){if(void 0===e)return hr.from(this.toString());switch(e){case"px":return this.pxValue(t);case"em":return this.emValue(t);case"rem":return this.remValue(t);case"%":return this.pctValue(t);default:throw new Qu("unknown length units: "+e)}},e.prototype.to=function(e,t){switch(e){case"px":return this.px(t);case"em":return this.em(t);case"rem":return this.rem(t);case"%":return this.pct(t);default:throw new Qu("unknown length units: "+e)}},e.prototype.interpolateTo=function(t){return t instanceof e?ns(this,t):null},e.zero=function(e){switch(e){case void 0:case"px":return Ju.zero();case"em":return $u.zero();case"rem":return es.zero();case"%":return ts.zero();case"":return rs.zero();default:throw new Qu("unknown length units: "+e)}},e.px=function(e){return new Ju(e)},e.em=function(e){return new $u(e)},e.rem=function(e){return new es(e)},e.pct=function(e){return new ts(e)},e.unitless=function(e){return new rs(e)},e.create=function(t,r){switch(r){case void 0:case"px":return e.px(t);case"em":return e.em(t);case"rem":return e.rem(t);case"%":return e.pct(t);case"":return e.unitless(t);default:throw new Qu("unknown length units: "+r)}},e.fromCssValue=function(t){if(t instanceof CSSUnitValue)return e.create(t.value,t.unit);throw new TypeError(""+t)},e.fromAny=function(t,r){if(null==t||t instanceof e)return t;if("number"==typeof t)return e.create(t,r);if("string"==typeof t)return e.parse(t,r);throw new TypeError(""+t)},e.fromValue=function(t){if(2===t.length){var r=t.getItem(0).numberValue(void 0),n=t.getItem(1);if(void 0!==r&&isFinite(r)&&n instanceof tr&&n.value===ir.extant())switch(n.key.value){case"px":return e.px(r);case"em":return e.em(r);case"rem":return e.rem(r);case"pct":return e.pct(r)}}return null},e.parse=function(e,t){for(var r=re.stringInput(e);r.isCont()&&re.isWhitespace(r.head());)r=r.step();var n=os.parse(r,t);if(n.isDone())for(;r.isCont()&&re.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=we.error(oe.unexpected(r))),n.bind()},e.form=function(){return new is(void 0,e.zero())},e.isAny=function(t){return t instanceof e||"number"==typeof t||"string"==typeof t},e.emUnit=function(e){if("object"==typeof e&&"number"==typeof e.emUnit)return e.emUnit;if("object"==typeof e&&e.emUnit instanceof Node)for(var t=e.emUnit;null!==t;){if(t instanceof Element){var r=getComputedStyle(t).fontSize;if("string"==typeof r)return parseFloat(r)}t=t.parentNode}throw new Qu("unknown em unit")},e.remUnit=function(e){if("object"==typeof e&&"number"==typeof e.remUnit)return e.remUnit;var t=getComputedStyle(document.documentElement).fontSize;if("string"==typeof t)return parseFloat(t);throw new Qu("unknown rem unit")},e.pctUnit=function(e){if("number"==typeof e)return e;if("object"==typeof e&&"number"==typeof e.pctUnit)return e.pctUnit;throw new Qu("unknown percentage unit")},E([s],e,"form",null),e}(),Ju=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"px"},enumerable:!1,configurable:!0}),t.prototype.pxValue=function(e){return this.value},t.prototype.px=function(e){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"px"):null},t.prototype.compareTo=function(e){if(e instanceof Zu){var t=this.value,r=e.pxValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof Zu&&b.equivalent(this.value,e.pxValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Length").write(46).write("px").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"px"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(Zu),$u=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"em"},enumerable:!1,configurable:!0}),t.prototype.pxValue=function(e){return 0!==this.value?this.value*Zu.emUnit(e):0},t.prototype.emValue=function(e){return this.value},t.prototype.em=function(e){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"em"):null},t.prototype.compareTo=function(e){if(e instanceof Zu){var t=this.value,r=e.emValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof Zu&&b.equivalent(this.value,e.emValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Length").write(46).write("em").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"em"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(Zu),es=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"rem"},enumerable:!1,configurable:!0}),t.prototype.pxValue=function(e){return 0!==this.value?this.value*Zu.remUnit(e):0},t.prototype.remValue=function(e){return this.value},t.prototype.rem=function(e){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"rem"):null},t.prototype.compareTo=function(e){if(e instanceof t){var r=this.value,n=e.remValue();return r<n?-1:r>n?1:isNaN(n)?isNaN(r)?0:-1:isNaN(r)?1:0}return NaN},t.prototype.equivalentTo=function(e,r){return e instanceof t&&b.equivalent(this.value,e.remValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Length").write(46).write("rem").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"rem"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(Zu),ts=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"%"},enumerable:!1,configurable:!0}),t.prototype.pxValue=function(e){return 0!==this.value?this.value*Zu.pctUnit(e)/100:0},t.prototype.pctValue=function(e){return this.value},t.prototype.pct=function(e){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"percent"):null},t.prototype.compareTo=function(e){if(e instanceof Zu){var t=this.value,r=e.pctValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof Zu&&b.equivalent(this.value,e.pctValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Length").write(46).write("pct").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"%"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(Zu),rs=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.pxValue=function(e){throw new Qu("unitless length")},t.prototype.toCssValue=function(){return null},t.prototype.compareTo=function(e){if(e instanceof Zu){var t=this.value,r=e.value;return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof Zu&&b.equivalent(this.value,e.value)},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Length").write(46).write("unitless").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+""},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(Zu),ns=function(e,t){var r=function(e){var t=r[0],n=r[1];return Zu.create(t.value+e*(n.value-t.value),n.units)};return Object.setPrototypeOf(r,ns.prototype),Object.defineProperty(r,0,{value:e.to(t.units),enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};ns.prototype=Object.create($e.prototype);var is=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"defaultUnits",{value:t,enumerable:!0}),Object.defineProperty(n,"unit",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(this.defaultUnits,e):this},t.prototype.mold=function(e){return e=Zu.fromAny(e,this.defaultUnits),hr.from(e.toString())},t.prototype.cast=function(e){var t=e.toValue(),r=null;try{if(void 0!==(r=Zu.fromValue(t))){var n=t.stringValue(void 0);void 0!==n&&(r=Zu.parse(n,this.defaultUnits))}}catch(e){}return null!==r?r:void 0},t}(En),os=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.defaultUnits=t,o.valueParser=r,o.unitsOutput=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.defaultUnits,this.valueParser,this.unitsOutput,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o)if((n=void 0===n?ie.parseDecimal(e):n.feed(e)).isDone())o=2;else if(n.isError())return n.asError();if(2===o){for(i=i||re.stringOutput();e.isCont()&&(u=e.head(),re.isAlpha(u)||37===u);)e=e.step(),i.push(u);if(!e.isEmpty()){var s=n.bind(),a=i.bind()||r;switch(a){case"px":return we.done(Zu.px(s));case"em":return we.done(Zu.em(s));case"rem":return we.done(Zu.rem(s));case"%":return we.done(Zu.pct(s));case"":case void 0:return we.done(Zu.unitless(s));default:return we.error(oe.message("unknown length units: "+a,e))}}}return new t(r,n,i,o)},t}(we),us=function(){function e(){}return e.prototype.isDefined=function(){return isFinite(this.value)},e.prototype.plus=function(t,r){return void 0===r&&(r=this.units),t=e.fromAny(t),e.create(this.toValue(r)+t.toValue(r),r)},e.prototype.negative=function(t){return void 0===t&&(t=this.units),e.create(-this.toValue(t),t)},e.prototype.minus=function(t,r){return void 0===r&&(r=this.units),t=e.fromAny(t),e.create(this.toValue(r)-t.toValue(r),r)},e.prototype.times=function(t,r){return void 0===r&&(r=this.units),e.create(this.toValue(r)*t,r)},e.prototype.divide=function(t,r){return void 0===r&&(r=this.units),e.create(this.toValue(r)/t,r)},e.prototype.combine=function(t,r,n){return void 0===r&&(r=1),void 0===n&&(n=this.units),t=e.fromAny(t),e.create(this.toValue(n)+t.toValue(n)*r,n)},e.prototype.norm=function(t,r){return void 0===r&&(r=this.units),t=e.fromAny(t),e.create(this.toValue(r)/t.toValue(r),r)},e.prototype.deg=function(){return e.deg(this.degValue())},e.prototype.rad=function(){return e.rad(this.radValue())},e.prototype.grad=function(){return e.grad(this.gradValue())},e.prototype.turn=function(){return e.turn(this.turnValue())},e.prototype.toValue=function(e){if(void 0===e)return hr.from(this.toString());switch(e){case"deg":return this.degValue();case"rad":return this.radValue();case"grad":return this.gradValue();case"turn":return this.turnValue();default:throw new Error("unknown angle units: "+e)}},e.prototype.to=function(e){switch(e){case"deg":return this.deg();case"rad":return this.rad();case"grad":return this.grad();case"turn":return this.turn();default:throw new Error("unknown angle units: "+e)}},e.prototype.interpolateTo=function(t){return t instanceof e?cs(this,t):null},e.zero=function(e){switch(e){case"deg":return ss.zero();case void 0:case"rad":return as.zero();case"grad":return ps.zero();case"turn":return fs.zero();default:throw new Error("unknown angle units: "+e)}},e.deg=function(e){return new ss(e)},e.rad=function(e){return new as(e)},e.grad=function(e){return new ps(e)},e.turn=function(e){return new fs(e)},e.create=function(t,r){switch(r){case"deg":return e.deg(t);case void 0:case"rad":return e.rad(t);case"grad":return e.grad(t);case"turn":return e.turn(t);default:throw new Error("unknown angle units: "+r)}},e.fromCssValue=function(t){if(t instanceof CSSUnitValue)return e.create(t.value,t.unit);throw new TypeError(""+t)},e.fromAny=function(t,r){if(null==t||t instanceof e)return t;if("number"==typeof t)return e.create(t,r);if("string"==typeof t)return e.parse(t,r);throw new TypeError(""+t)},e.fromValue=function(t){if(2===t.length){var r=t.getItem(0).numberValue(),n=t.getItem(1);if(void 0!==r&&isFinite(r)&&n instanceof tr&&n.toValue()===ir.extant())switch(n.key.value){case"deg":return e.deg(r);case"rad":return e.rad(r);case"grad":return e.grad(r);case"turn":return e.turn(r)}}return null},e.parse=function(e,t){for(var r=re.stringInput(e);r.isCont()&&re.isWhitespace(r.head());)r=r.step();var n=hs.parse(r,t);if(n.isDone())for(;r.isCont()&&re.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=we.error(oe.unexpected(r))),n.bind()},e.form=function(){return new ls(void 0,e.zero())},e.isAny=function(t){return t instanceof e||"number"==typeof t||"string"==typeof t},E([s],e,"form",null),e}(),ss=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"deg"},enumerable:!1,configurable:!0}),t.prototype.degValue=function(){return this.value},t.prototype.gradValue=function(){return 10*this.value/9},t.prototype.radValue=function(){return this.value*Math.PI/180},t.prototype.turnValue=function(){return this.value/360},t.prototype.deg=function(){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"deg"):null},t.prototype.compareTo=function(e){if(e instanceof us){var t=this.value,r=e.degValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof us&&b.equivalent(this.value,e.degValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Angle").write(46).write("deg").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"deg"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(us),as=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"rad"},enumerable:!1,configurable:!0}),t.prototype.degValue=function(){return 180*this.value/Math.PI},t.prototype.gradValue=function(){return 200*this.value/Math.PI},t.prototype.radValue=function(){return this.value},t.prototype.turnValue=function(){return this.value/(2*Math.PI)},t.prototype.rad=function(){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"rad"):null},t.prototype.compareTo=function(e){if(e instanceof us){var t=this.value,r=e.radValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof us&&b.equivalent(this.value,e.radValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Angle").write(46).write("rad").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"rad"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(us),ps=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"grad"},enumerable:!1,configurable:!0}),t.prototype.degValue=function(){return.9*this.value},t.prototype.gradValue=function(){return this.value},t.prototype.radValue=function(){return this.value*Math.PI/200},t.prototype.turnValue=function(){return this.value/400},t.prototype.grad=function(){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"grad"):null},t.prototype.compareTo=function(e){if(e instanceof us){var t=this.value,r=e.gradValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof us&&b.equivalent(this.value,e.gradValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Angle").write(46).write("grad").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"grad"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(us),fs=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"value",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"units",{get:function(){return"turn"},enumerable:!1,configurable:!0}),t.prototype.degValue=function(){return 360*this.value},t.prototype.gradValue=function(){return 400*this.value},t.prototype.radValue=function(){return this.value*(2*Math.PI)},t.prototype.turnValue=function(){return this.value},t.prototype.turn=function(){return this},t.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"turn"):null},t.prototype.compareTo=function(e){if(e instanceof us){var t=this.value,r=e.turnValue();return t<r?-1:t>r?1:isNaN(r)?isNaN(t)?0:-1:isNaN(t)?1:0}return NaN},t.prototype.equivalentTo=function(e,t){return e instanceof us&&b.equivalent(this.value,e.turnValue())},t.prototype.equals=function(e){return e instanceof t&&this.value===e.value},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),b.hash(this.value)))},t.prototype.debug=function(e){return e=e.write("Angle").write(46).write("turn").write(40).debug(this.value).write(41)},t.prototype.toString=function(){return this.value+"turn"},t.zero=function(){return new t(0)},E([s],t,"zero",null),t}(us),cs=function(e,t){var r=function(e){var t=r[0],n=r[1];return us.create(t.value+e*(n.value-t.value),n.units)};return Object.setPrototypeOf(r,cs.prototype),Object.defineProperty(r,0,{value:e.to(t.units),enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};cs.prototype=Object.create($e.prototype);var ls=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"defaultUnits",{value:t,enumerable:!0}),Object.defineProperty(n,"unit",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(this.defaultUnits,e):this},t.prototype.mold=function(e){return e=us.fromAny(e,this.defaultUnits),hr.from(e.toString())},t.prototype.cast=function(e){var t=e.toValue(),r=null;try{if(void 0===(r=us.fromValue(t))){var n=t.stringValue(void 0);void 0!==n&&(r=us.parse(n,this.defaultUnits))}}catch(e){}return null!==r?r:void 0},t}(En),hs=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.defaultUnits=t,o.valueParser=r,o.unitsOutput=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.defaultUnits,this.valueParser,this.unitsOutput,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o)if((n=void 0===n?ie.parseDecimal(e):n.feed(e)).isDone())o=2;else if(n.isError())return n.asError();if(2===o){for(i=i||re.stringOutput();e.isCont()&&(u=e.head(),re.isAlpha(u));)e=e.step(),i.push(u);if(!e.isEmpty()){var s=n.bind(),a=i.bind()||r;switch(a){case"deg":return we.done(us.deg(s));case"":case"rad":return we.done(us.rad(s));case"grad":return we.done(us.grad(s));case"turn":return we.done(us.turn(s));default:return we.error(oe.message("unknown units: "+a,e))}}}return new t(r,n,i,o)},t}(we),ds=function(){function e(e,t){Object.defineProperty(this,"x",{value:e,enumerable:!0}),Object.defineProperty(this,"y",{value:t,enumerable:!0})}return e.prototype.isDefined=function(){return isFinite(this.x)&&isFinite(this.y)},e.prototype.plus=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.negative=function(){return new e(-this.x,-this.y)},e.prototype.minus=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.times=function(t){return new e(this.x*t,this.y*t)},e.prototype.toAny=function(){return{x:this.x,y:this.y}},e.prototype.interpolateTo=function(t){return t instanceof e?ys(this,t):null},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(b.equivalent(this.x,t.x,r)&&b.equivalent(this.y,t.y,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x===t.x&&this.y===t.y)},e.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(e),b.hash(this.x)),b.hash(this.y)))},e.prototype.debug=function(e){return e=e.write("R2Vector").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(41)},e.prototype.toString=function(){return ne.debug(this)},e.zero=function(){return new e(0,0)},e.of=function(t,r){return new e(t,r)},e.fromInit=function(t){return new e(t.x,t.y)},e.fromAny=function(t){if(null==t||t instanceof e)return t;if(e.isInit(t))return e.fromInit(t);throw new TypeError(""+t)},e.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.x&&"number"==typeof t.y}return!1},e.isAny=function(t){return t instanceof e||e.isInit(t)},E([s],e,"zero",null),e}(),ys=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.x+e*(n.x-t.x),o=t.y+e*(n.y-t.y);return new ds(i,o)};return Object.setPrototypeOf(r,ys.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};ys.prototype=Object.create($e.prototype);var vs=function(){function e(){}return e.prototype.union=function(t){return t=e.fromAny(t),new Ns(Math.min(this.xMin,t.xMin),Math.min(this.yMin,t.yMin),Math.max(this.xMax,t.xMax),Math.max(this.yMax,t.yMax))},Object.defineProperty(e.prototype,"bounds",{get:function(){return new Ns(this.xMin,this.yMin,this.xMax,this.yMax)},enumerable:!1,configurable:!0}),e.fromAny=function(t){if(null==t||t instanceof e)return t;if(bs.isInit(t))return bs.fromInit(t);if(bs.isTuple(t))return bs.fromTuple(t);if(Ps.isInit(t))return Ps.fromInit(t);if(Ns.isInit(t))return Ns.fromInit(t);if(Us.isInit(t))return Us.fromInit(t);throw new TypeError(""+t)},e.isAny=function(t){return t instanceof e||bs.isInit(t)||bs.isTuple(t)||Ps.isInit(t)||Ns.isInit(t)||Us.isInit(t)},e}(),bs=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"x",{value:t,enumerable:!0}),Object.defineProperty(n,"y",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.x)&&isFinite(this.y)},Object.defineProperty(t.prototype,"xMin",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.prototype.plus=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.minus=function(e){return e instanceof ds?new t(this.x-e.x,this.y-e.y):new ds(this.x-e.x,this.y-e.y)},t.prototype.contains=function(e,r){return"number"==typeof e?this.x===e&&this.y===r:(e=vs.fromAny(e))instanceof t?this.x===e.x&&this.y===e.y:e instanceof vs&&(this.x<=e.xMin&&e.xMax<=this.x&&this.y<=e.yMin&&e.yMax<=this.y)},t.prototype.intersects=function(e){return(e=vs.fromAny(e)).intersects(this)},t.prototype.transform=function(e){return new t(e.transformX(this.x,this.y),e.transformY(this.x,this.y))},t.prototype.toAny=function(){return{x:this.x,y:this.y}},t.prototype.interpolateTo=function(e){return e instanceof t?ms(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.x,e.x,r)&&b.equivalent(this.y,e.y,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.x===e.x&&this.y===e.y)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),b.hash(this.x)),b.hash(this.y)))},t.prototype.debug=function(e){return e=e.write("R2Point").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.origin=function(){return new t(0,0)},t.undefined=function(){return new t(NaN,NaN)},t.of=function(e,r){return new t(e,r)},t.fromInit=function(e){return new t(e.x,e.y)},t.fromTuple=function(e){return new t(e[0],e[1])},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);if(t.isTuple(e))return t.fromTuple(e);throw new TypeError(""+e)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.x&&"number"==typeof t.y}return!1},t.isTuple=function(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]},t.isAny=function(e){return e instanceof t||t.isInit(e)||t.isTuple(e)},E([s],t,"origin",null),E([s],t,"undefined",null),t}(vs),ms=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.x+e*(n.x-t.x),o=t.y+e*(n.y-t.y);return new bs(i,o)};return Object.setPrototypeOf(r,ms.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};ms.prototype=Object.create($e.prototype);var gs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.draw=function(e){this.drawMove(e),this.drawRest(e)},t.prototype.transformDraw=function(e,t){this.transformDrawMove(e,t),this.transformDrawRest(e,t)},t.prototype.writePath=function(e){return e=this.writeMove(e),e=this.writeRest(e)},t.prototype.toPathString=function(e){var t=re.stringOutput(e);return(t=this.writePath(t)).toString()},t.linear=function(e,t,r,n){return new Ps(e,t,r,n)},t.quadratic=function(e,t,r,n,i,o){return new Cs(e,t,r,n,i,o)},t.cubic=function(e,t,r,n,i,o,u,s){return new Ss(e,t,r,n,i,o,u,s)},t.elliptic=function(e,t,r,n,i,o,u){return new Ms(e,t,r,n,i,o,u)},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=ws.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},t}(vs),ws=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.x0Parser=t,o.y0Parser=r,o.command=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.x0Parser,this.y0Parser,this.command,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o){for(;e.isCont()&&(u=e.head(),re.isSpace(u));)e=e.step();if(e.isCont()){if(77!==u&&109!==u)return we.error(oe.expected("moveto",e));e=e.step(),i=u,o=2}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(2===o){if(void 0===r){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(r=ie.parseDecimal(e))}else r=r.feed(e);if(void 0!==r)if(r.isDone())o=3;else if(r.isError())return r.asError()}if(3===o){for(;e.isCont()&&(u=e.head(),re.isSpace(u));)e=e.step();e.isCont()?(44===u&&(e=e.step()),o=4):e.isEmpty()||(o=4)}if(4===o){if(void 0===n){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(n=ie.parseDecimal(e))}else n=n.feed(e);if(void 0!==n)if(n.isDone())o=5;else if(n.isError())return n.asError()}if(5===o){for(;e.isCont()&&(u=e.head(),re.isSpace(u));)e=e.step();if(e.isCont())switch(u){case 76:case 108:case 72:case 104:case 86:case 118:return js.parse(e,r,n);case 81:case 113:return Es.parse(e,r,n);case 84:return Es.parse(e,r,n,r,n);case 116:return Es.parse(e,r,n,we.done(0),we.done(0));case 67:case 99:return ks.parse(e,r,n);case 83:return ks.parse(e,r,n,r,n);case 115:return ks.parse(e,r,n,we.done(0),we.done(0));case 65:case 97:return As.parse(e,r,n);case 44:e=e.step();case 43:case 45:case 46:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:switch(i){case 77:case 109:return js.parseRest(e,i,r,n)}default:return we.error(oe.expected("draw command",e))}else if(!e.isEmpty())return we.error(oe.unexpected(e))}return new t(r,n,i,o)},t}(we),Os=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t}(gs),Ps=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"x0",{value:t,enumerable:!0}),Object.defineProperty(o,"y0",{value:r,enumerable:!0}),Object.defineProperty(o,"x1",{value:n,enumerable:!0}),Object.defineProperty(o,"y1",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)},Object.defineProperty(t.prototype,"xMin",{get:function(){return Math.min(this.x0,this.x1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return Math.min(this.y0,this.y1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return Math.max(this.x0,this.x1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return Math.max(this.y0,this.y1)},enumerable:!1,configurable:!0}),t.prototype.interpolateX=function(e){return(1-e)*this.x0+e*this.x1},t.prototype.interpolateY=function(e){return(1-e)*this.y0+e*this.y1},t.prototype.interpolate=function(e){var t=1-e,r=t*this.x0+e*this.x1,n=t*this.y0+e*this.y1;return new bs(r,n)},t.prototype.contains=function(e,r){return"number"==typeof e?t.contains(this.x0,this.y0,this.x1,this.y1,e,r):(e=vs.fromAny(e))instanceof bs?this.containsPoint(e):e instanceof t&&this.containsSegment(e)},t.prototype.containsPoint=function(e){return t.contains(this.x0,this.y0,this.x1,this.y1,e.x,e.y)},t.prototype.containsSegment=function(e){return t.contains(this.x0,this.y0,this.x1,this.y1,e.x0,e.y0)&&t.contains(this.x0,this.y0,this.x1,this.y1,e.x1,e.y1)},t.contains=function(e,t,r,n,i,o){return(e<=i&&i<=r||r<=i&&i<=e)&&(t<=o&&o<=n||n<=o&&o<=t)&&(r-e)*(o-t)==(i-e)*(n-t)},t.prototype.intersects=function(e){return(e=vs.fromAny(e))instanceof bs?this.intersectsPoint(e):e instanceof t?this.intersectsSegment(e):e.intersects(this)},t.prototype.intersectsPoint=function(e){return t.contains(this.x0,this.y0,this.x1,this.y1,e.x,e.y)},t.prototype.intersectsSegment=function(e){return t.intersects(this.x0,this.y0,this.x1-this.x0,this.y1-this.y0,e.x0,e.y0,e.x1-e.x0,e.y1-e.y0)},t.intersects=function(e,t,r,n,i,o,u,s){var a=i-e,p=o-t,f=a*n-p*r,c=r*s-n*u;if(0===f&&0===c){var l=r*r+n*n,h=u*r+s*n,d=(a*r+p*n)/l,y=d+h/l;return h>=0?0<y&&d<1:0<d&&y<1}if(0===c)return!1;var v=(a*s-p*u)/c,b=f/c;return 0<=v&&v<=1&&0<=b&&b<=1},t.prototype.split=function(e){var r=1-e,n=r*this.x0+e*this.x1,i=r*this.y0+e*this.y1;return[new t(this.x0,this.y0,n,i),new t(n,i,this.x1,this.y1)]},t.prototype.transform=function(e){return new t(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0),e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1))},t.prototype.toAny=function(){return{x0:this.x0,y0:this.y0,x1:this.x1,y1:this.y1}},t.prototype.drawMove=function(e){e.moveTo(this.x0,this.y0)},t.prototype.drawRest=function(e){e.lineTo(this.x1,this.y1)},t.prototype.transformDrawMove=function(e,t){e.moveTo(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0))},t.prototype.transformDrawRest=function(e,t){e.lineTo(t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1))},t.prototype.writeMove=function(e){return e=e.write(77),e=(e=ne.displayNumber(e,this.x0)).write(44),e=ne.displayNumber(e,this.y0)},t.prototype.writeRest=function(e){return e=e.write(76),e=(e=ne.displayNumber(e,this.x1)).write(44),e=ne.displayNumber(e,this.y1)},t.prototype.interpolateTo=function(e){return e instanceof t?xs(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.x0,e.x0,r)&&b.equivalent(this.y0,e.y0,r)&&b.equivalent(this.x1,e.x1,r)&&b.equivalent(this.y1,e.y1,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.x0===e.x0&&this.y0===e.y0&&this.x1===e.x1&&this.y1===e.y1)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.x0)),b.hash(this.y0)),b.hash(this.x1)),b.hash(this.y1)))},t.prototype.debug=function(e){return e=e.write("R2Segment").write(46).write("of").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.of=function(e,r,n,i){return new t(e,r,n,i)},t.fromInit=function(e){return new t(e.x0,e.y0,e.x1,e.y1)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);throw new TypeError(""+e)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.x0&&"number"==typeof t.y0&&"number"==typeof t.x1&&"number"==typeof t.y1}return!1},t.isAny=function(e){return e instanceof t||t.isInit(e)},t}(Os),xs=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.x0+e*(n.x0-t.x0),o=t.y0+e*(n.y0-t.y0),u=t.x1+e*(n.x1-t.x1),s=t.y1+e*(n.y1-t.y1);return new Ps(i,o,u,s)};return Object.setPrototypeOf(r,xs.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};xs.prototype=Object.create($e.prototype);var js=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return s.x0Parser=t,s.y0Parser=r,s.x1Parser=n,s.y1Parser=i,s.command=o,s.step=u,s}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.command,this.step)},t.parse=function(e,r,n,i,o,u,s){void 0===s&&(s=1);var a=0;if(1===s){for(;e.isCont()&&(a=e.head(),re.isSpace(a));)e=e.step();if(e.isCont())switch(a){case 77:case 109:case 76:case 108:e=e.step(),u=a,s=2;break;case 72:e=e.step(),o=n,u=a,s=2;break;case 104:e=e.step(),o=we.done(0),u=a,s=2;break;case 86:e=e.step(),i=r,u=a,s=4;break;case 118:e=e.step(),i=we.done(0),u=a,s=4;break;default:return we.error(oe.expected("lineto",e))}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(2===s){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(i=ie.parseDecimal(e))}else i=i.feed(e);if(void 0!==i)if(i.isDone())s=void 0!==o&&o.isDone()?4:3;else if(i.isError())return i.asError()}if(3===s){for(;e.isCont()&&(a=e.head(),re.isSpace(a));)e=e.step();e.isCont()?(44===a&&(e=e.step()),s=4):e.isEmpty()||(s=4)}if(4===s){if(void 0===o){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(o=ie.parseDecimal(e))}else o=o.feed(e);if(void 0!==o){if(o.isDone()){var p=r.bind(),f=n.bind(),c=i.bind(),l=o.bind();return 109!==u&&108!==u&&104!==u&&118!==u||(c+=p,l+=f),we.done(new Ps(p,f,c,l))}if(o.isError())return o.asError()}}return new t(r,n,i,o,u,s)},t.parseRest=function(e,t,r,n){var i,o,u;switch(t){case 72:o=n,u=2;break;case 104:o=we.done(0),u=2;break;case 86:i=r,u=4;break;case 118:i=we.done(0),u=4;break;default:u=2}return this.parse(e,r,n,i,o,t,u)},t}(we),Cs=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return Object.defineProperty(s,"x0",{value:t,enumerable:!0}),Object.defineProperty(s,"y0",{value:r,enumerable:!0}),Object.defineProperty(s,"x1",{value:n,enumerable:!0}),Object.defineProperty(s,"y1",{value:i,enumerable:!0}),Object.defineProperty(s,"x2",{value:o,enumerable:!0}),Object.defineProperty(s,"y2",{value:u,enumerable:!0}),s}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)&&isFinite(this.x2)&&isFinite(this.y2)},Object.defineProperty(t.prototype,"xMin",{get:function(){return Math.min(this.x0,this.x1,this.x2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return Math.min(this.y0,this.y1,this.y2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return Math.max(this.x0,this.x1,this.x2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return Math.max(this.y0,this.y1,this.y2)},enumerable:!1,configurable:!0}),t.prototype.interpolateX=function(e){var t=1-e;return t*(t*this.x0+e*this.x1)+e*(t*this.x1+e*this.x2)},t.prototype.interpolateY=function(e){var t=1-e;return t*(t*this.y0+e*this.y1)+e*(t*this.y1+e*this.y2)},t.prototype.interpolate=function(e){var t=1-e,r=t*this.x0+e*this.x1,n=t*this.y0+e*this.y1,i=t*this.x1+e*this.x2,o=t*this.y1+e*this.y2;return new bs(t*r+e*i,t*n+e*o)},t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.split=function(e){var r=1-e,n=r*this.x0+e*this.x1,i=r*this.y0+e*this.y1,o=r*this.x1+e*this.x2,u=r*this.y1+e*this.y2,s=r*n+e*o,a=r*i+e*u;return[new t(this.x0,this.y0,n,i,s,a),new t(s,a,o,u,this.x2,this.y2)]},t.prototype.transform=function(e){return new t(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0),e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1),e.transformX(this.x2,this.y2),e.transformY(this.x2,this.y2))},t.prototype.drawMove=function(e){e.moveTo(this.x0,this.y0)},t.prototype.drawRest=function(e){e.quadraticCurveTo(this.x1,this.y1,this.x2,this.y2)},t.prototype.transformDrawMove=function(e,t){e.moveTo(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0))},t.prototype.transformDrawRest=function(e,t){e.quadraticCurveTo(t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1),t.transformX(this.x2,this.y2),t.transformY(this.x2,this.y2))},t.prototype.writeMove=function(e){return e=e.write(77),e=(e=ne.displayNumber(e,this.x0)).write(44),e=ne.displayNumber(e,this.y0)},t.prototype.writeRest=function(e){return e=e.write(81),e=(e=ne.displayNumber(e,this.x1)).write(44),e=(e=ne.displayNumber(e,this.y1)).write(44),e=(e=ne.displayNumber(e,this.x2)).write(44),e=ne.displayNumber(e,this.y2)},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.x0,e.x0,r)&&b.equivalent(this.y0,e.y0,r)&&b.equivalent(this.x1,e.x1,r)&&b.equivalent(this.y1,e.y1,r)&&b.equivalent(this.x2,e.x2,r)&&b.equivalent(this.y2,e.y2,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.x0===e.x0&&this.y0===e.y0&&this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2)},t.prototype.debug=function(e){return e=e.write("R2Curve").write(46).write("quadratic").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.x2).write(", ").debug(this.y2).write(41)},t.prototype.toString=function(){return ne.debug(this)},t}(Os),Es=function(e){function t(t,r,n,i,o,u,s,a){var p=e.call(this)||this;return p.x0Parser=t,p.y0Parser=r,p.x1Parser=n,p.y1Parser=i,p.x2Parser=o,p.y2Parser=u,p.command=s,p.step=a,p}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.x2Parser,this.y2Parser,this.command,this.step)},t.parse=function(e,r,n,i,o,u,s,a,p){void 0===p&&(p=1);var f=0;if(1===p){for(;e.isCont()&&(f=e.head(),re.isSpace(f));)e=e.step();if(e.isCont())switch(f){case 81:case 113:e=e.step(),a=f,p=2;break;case 84:case 116:e=e.step(),a=f,p=6;break;default:return we.error(oe.expected("curveto",e))}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(2===p){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(i=ie.parseDecimal(e))}else i=i.feed(e);if(void 0!==i)if(i.isDone())p=3;else if(i.isError())return i.asError()}if(3===p){for(;e.isCont()&&(f=e.head(),re.isSpace(f));)e=e.step();e.isCont()?(44===f&&(e=e.step()),p=4):e.isEmpty()||(p=4)}if(4===p){if(void 0===o){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(o=ie.parseDecimal(e))}else o=o.feed(e);if(void 0!==o)if(o.isDone())p=5;else if(o.isError())return o.asError()}if(5===p){for(;e.isCont()&&(f=e.head(),re.isSpace(f));)e=e.step();e.isCont()?(44===f&&(e=e.step()),p=6):e.isEmpty()||(p=6)}if(6===p){if(void 0===u){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(u=ie.parseDecimal(e))}else u=u.feed(e);if(void 0!==u)if(u.isDone())p=7;else if(u.isError())return u.asError()}if(7===p){for(;e.isCont()&&(f=e.head(),re.isSpace(f));)e=e.step();e.isCont()?(44===f&&(e=e.step()),p=8):e.isEmpty()||(p=8)}if(8===p){if(void 0===s){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(s=ie.parseDecimal(e))}else s=s.feed(e);if(void 0!==s){if(s.isDone()){var c=r.bind(),l=n.bind(),h=i.bind(),d=o.bind(),y=u.bind(),v=s.bind();return 113!==a&&116!==a||(h+=c,d+=l,y+=c,v+=l),we.done(new Cs(c,l,h,d,y,v))}if(s.isError())return s.asError()}}return new t(r,n,i,o,u,s,a,p)},t.parseRest=function(e,r,n,i,o,u){var s=84===r||116===r?6:2;return t.parse(e,n,i,o,u,void 0,void 0,r,s)},t}(we),Ss=function(e){function t(t,r,n,i,o,u,s,a){var p=e.call(this)||this;return Object.defineProperty(p,"x0",{value:t,enumerable:!0}),Object.defineProperty(p,"y0",{value:r,enumerable:!0}),Object.defineProperty(p,"x1",{value:n,enumerable:!0}),Object.defineProperty(p,"y1",{value:i,enumerable:!0}),Object.defineProperty(p,"x2",{value:o,enumerable:!0}),Object.defineProperty(p,"y2",{value:u,enumerable:!0}),Object.defineProperty(p,"x3",{value:s,enumerable:!0}),Object.defineProperty(p,"y3",{value:a,enumerable:!0}),p}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)&&isFinite(this.x2)&&isFinite(this.y2)&&isFinite(this.x3)&&isFinite(this.y3)},Object.defineProperty(t.prototype,"xMin",{get:function(){return Math.min(this.x0,this.x1,this.x2,this.x3)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return Math.min(this.y0,this.y1,this.y2,this.y3)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return Math.max(this.x0,this.x1,this.x2,this.x3)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return Math.max(this.y0,this.y1,this.y2,this.y3)},enumerable:!1,configurable:!0}),t.prototype.interpolateX=function(e){var t=1-e,r=t*this.x0+e*this.x1,n=t*this.x1+e*this.x2;return t*(t*r+e*n)+e*(t*n+e*(t*this.x2+e*this.x3))},t.prototype.interpolateY=function(e){var t=1-e,r=t*this.y0+e*this.y1,n=t*this.y1+e*this.y2;return t*(t*r+e*n)+e*(t*n+e*(t*this.y2+e*this.y3))},t.prototype.interpolate=function(e){var t=1-e,r=t*this.x0+e*this.x1,n=t*this.y0+e*this.y1,i=t*this.x1+e*this.x2,o=t*this.y1+e*this.y2,u=t*this.x2+e*this.x3,s=t*this.y2+e*this.y3;return new bs(t*(t*r+e*i)+e*(t*i+e*u),t*(t*n+e*o)+e*(t*o+e*s))},t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.split=function(e){var r=1-e,n=r*this.x0+e*this.x1,i=r*this.y0+e*this.y1,o=r*this.x1+e*this.x2,u=r*this.y1+e*this.y2,s=r*this.x2+e*this.x3,a=r*this.y2+e*this.y3,p=r*n+e*o,f=r*i+e*u,c=r*o+e*s,l=r*u+e*a,h=r*p+e*c,d=r*f+e*l;return[new t(this.x0,this.y0,n,i,p,f,h,d),new t(h,d,c,l,s,a,this.x3,this.y3)]},t.prototype.transform=function(e){return new t(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0),e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1),e.transformX(this.x2,this.y2),e.transformY(this.x2,this.y2),e.transformX(this.x3,this.y3),e.transformY(this.x3,this.y3))},t.prototype.drawMove=function(e){e.moveTo(this.x0,this.y0)},t.prototype.drawRest=function(e){e.bezierCurveTo(this.x1,this.y1,this.x2,this.y2,this.x3,this.y3)},t.prototype.transformDrawMove=function(e,t){e.moveTo(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0))},t.prototype.transformDrawRest=function(e,t){e.bezierCurveTo(t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1),t.transformX(this.x2,this.y2),t.transformY(this.x2,this.y2),t.transformX(this.x3,this.y3),t.transformY(this.x3,this.y3))},t.prototype.writeMove=function(e){return e=e.write(77),e=(e=ne.displayNumber(e,this.x0)).write(44),e=ne.displayNumber(e,this.y0)},t.prototype.writeRest=function(e){return e=e.write(67),e=(e=ne.displayNumber(e,this.x1)).write(44),e=(e=ne.displayNumber(e,this.y1)).write(44),e=(e=ne.displayNumber(e,this.x2)).write(44),e=(e=ne.displayNumber(e,this.y2)).write(44),e=(e=ne.displayNumber(e,this.x3)).write(44),e=ne.displayNumber(e,this.y3)},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.x0,e.x0,r)&&b.equivalent(this.y0,e.y0,r)&&b.equivalent(this.x1,e.x1,r)&&b.equivalent(this.y1,e.y1,r)&&b.equivalent(this.x2,e.x2,r)&&b.equivalent(this.y2,e.y2,r)&&b.equivalent(this.x3,e.x3,r)&&b.equivalent(this.y3,e.y3,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.x0===e.x0&&this.y0===e.y0&&this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2&&this.x3===e.x3&&this.y3===e.y3)},t.prototype.debug=function(e){return e=e.write("R2Curve").write(46).write("cubic").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.x2).write(", ").debug(this.y2).write(", ").debug(this.x3).write(", ").debug(this.y3).write(41)},t.prototype.toString=function(){return ne.debug(this)},t}(Os),ks=function(e){function t(t,r,n,i,o,u,s,a,p,f){var c=e.call(this)||this;return c.x0Parser=t,c.y0Parser=r,c.x1Parser=n,c.y1Parser=i,c.x2Parser=o,c.y2Parser=u,c.x3Parser=s,c.y3Parser=a,c.command=p,c.step=f,c}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.x2Parser,this.y2Parser,this.x3Parser,this.y3Parser,this.command,this.step)},t.parse=function(e,r,n,i,o,u,s,a,p,f,c){void 0===c&&(c=1);var l=0;if(1===c){for(;e.isCont()&&(l=e.head(),re.isSpace(l));)e=e.step();if(e.isCont())switch(l){case 67:case 99:e=e.step(),f=l,c=2;break;case 83:case 115:e=e.step(),f=l,c=6;break;default:return we.error(oe.expected("curveto",e))}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(2===c){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(i=ie.parseDecimal(e))}else i=i.feed(e);if(void 0!==i)if(i.isDone())c=3;else if(i.isError())return i.asError()}if(3===c){for(;e.isCont()&&(l=e.head(),re.isSpace(l));)e=e.step();e.isCont()?(44===l&&(e=e.step()),c=4):e.isEmpty()||(c=4)}if(4===c){if(void 0===o){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(o=ie.parseDecimal(e))}else o=o.feed(e);if(void 0!==o)if(o.isDone())c=5;else if(o.isError())return o.asError()}if(5===c){for(;e.isCont()&&(l=e.head(),re.isSpace(l));)e=e.step();e.isCont()?(44===l&&(e=e.step()),c=6):e.isEmpty()||(c=6)}if(6===c){if(void 0===u){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(u=ie.parseDecimal(e))}else u=u.feed(e);if(void 0!==u)if(u.isDone())c=7;else if(u.isError())return u.asError()}if(7===c){for(;e.isCont()&&(l=e.head(),re.isSpace(l));)e=e.step();e.isCont()?(44===l&&(e=e.step()),c=8):e.isEmpty()||(c=8)}if(8===c){if(void 0===s){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(s=ie.parseDecimal(e))}else s=s.feed(e);if(void 0!==s)if(s.isDone())c=9;else if(s.isError())return s.asError()}if(9===c){for(;e.isCont()&&(l=e.head(),re.isSpace(l));)e=e.step();e.isCont()?(44===l&&(e=e.step()),c=10):e.isEmpty()||(c=10)}if(10===c){if(void 0===a){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(a=ie.parseDecimal(e))}else a=a.feed(e);if(void 0!==a)if(a.isDone())c=11;else if(a.isError())return a.asError()}if(11===c){for(;e.isCont()&&(l=e.head(),re.isSpace(l));)e=e.step();e.isCont()?(44===l&&(e=e.step()),c=12):e.isEmpty()||(c=12)}if(12===c){if(void 0===p){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(p=ie.parseDecimal(e))}else p=p.feed(e);if(void 0!==p){if(p.isDone()){var h=r.bind(),d=n.bind(),y=i.bind(),v=o.bind(),b=u.bind(),m=s.bind(),g=a.bind(),w=p.bind();return 99!==f&&115!==f||(y+=h,v+=d,b+=h,m+=d,g+=h,w+=d),we.done(new Ss(h,d,y,v,b,m,g,w))}if(p.isError())return p.asError()}}return new t(r,n,i,o,u,s,a,p,f,c)},t.parseRest=function(e,r,n,i,o,u){var s=83===r||115===r?6:2;return t.parse(e,n,i,o,u,void 0,void 0,void 0,void 0,r,s)},t}(we),Ms=function(e){function t(t,r,n,i,o,u,s){var a=e.call(this)||this;return Object.defineProperty(a,"cx",{value:t,enumerable:!0}),Object.defineProperty(a,"cy",{value:r,enumerable:!0}),Object.defineProperty(a,"rx",{value:n,enumerable:!0}),Object.defineProperty(a,"ry",{value:i,enumerable:!0}),Object.defineProperty(a,"phi",{value:o,enumerable:!0}),Object.defineProperty(a,"a0",{value:u,enumerable:!0}),Object.defineProperty(a,"da",{value:s,enumerable:!0}),a}return C(t,e),Object.defineProperty(t.prototype,"xMin",{get:function(){return this.cx-Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.cy-Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.cx+Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.cy+Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),t.prototype.interpolateX=function(e){var t=this.a0+e*this.da,r=this.rx*Math.cos(t),n=this.ry*Math.sin(t),i=this.phi;return 0===i?this.cx+r:this.cx+r*Math.cos(i)-n*Math.sin(i)},t.prototype.interpolateY=function(e){var t=this.a0+e*this.da,r=this.rx*Math.cos(t),n=this.ry*Math.sin(t),i=this.phi;return 0===i?this.cy+n:this.cy+r*Math.sin(i)+n*Math.cos(i)},t.prototype.interpolate=function(e){var t=this.a0+e*this.da,r=this.rx*Math.cos(t),n=this.ry*Math.sin(t),i=this.phi;return 0===i?new bs(this.cx+r,this.cy+n):new bs(this.cx+r*Math.cos(i)-n*Math.sin(i),this.cy+r*Math.sin(i)+n*Math.cos(i))},t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.split=function(e){var r=this.a0,n=this.da,i=r+e*n;return[new t(this.cx,this.cy,this.rx,this.ry,this.phi,r,i-r),new t(this.cx,this.cy,this.rx,this.ry,this.phi,i,r+n-i)]},t.prototype.transform=function(e){var r=this.a0,n=r+this.da,i=Math.cos(r),o=Math.sin(r),u=Math.cos(n),s=Math.sin(n),a=e.transformX(i,o),p=e.transformY(i,o),f=e.transformX(u,s),c=e.transformY(u,s),l=Math.atan2(p,a),h=Math.atan2(c,f);return new t(e.transformX(this.cx,this.cy),e.transformY(this.cx,this.cy),e.transformX(this.rx,this.ry),e.transformY(this.rx,this.ry),this.phi,l,h-l)},t.prototype.drawMove=function(e){var t=this.toEndpoints(),r=t.x0,n=t.y0;e.moveTo(r,n)},t.prototype.drawRest=function(e){e.ellipse(this.cx,this.cy,this.rx,this.ry,this.phi,this.a0,this.a0+this.da,this.da<0)},t.prototype.transformDrawMove=function(e,t){var r=this.toEndpoints(),n=r.x0,i=r.y0;e.moveTo(t.transformX(n,i),t.transformY(n,i))},t.prototype.transformDrawRest=function(e,t){var r=this.a0,n=r+this.da,i=Math.cos(r),o=Math.sin(r),u=Math.cos(n),s=Math.sin(n),a=t.transformX(i,o),p=t.transformY(i,o),f=t.transformX(u,s),c=t.transformY(u,s),l=Math.atan2(p,a),h=Math.atan2(c,f);e.ellipse(t.transformX(this.cx,this.cy),t.transformY(this.cx,this.cy),t.transformX(this.rx,this.ry),t.transformY(this.rx,this.ry),this.phi,l,h,h-l<0)},t.prototype.writeMove=function(e){var t=this.toEndpoints(),r=t.x0,n=t.y0;return e=e.write(77),e=(e=ne.displayNumber(e,r)).write(44),e=ne.displayNumber(e,n)},t.prototype.writeRest=function(e){var t=this.toEndpoints(),r=t.rx,n=t.ry,i=t.phi,o=t.large,u=t.sweep,s=t.x1,a=t.y1;return e=e.write(65),e=(e=ne.displayNumber(e,r)).write(44),e=(e=ne.displayNumber(e,n)).write(32),e=(e=(e=(e=(e=(e=ne.displayNumber(e,i)).write(32)).write(o?49:48)).write(44)).write(u?49:48)).write(32),e=(e=ne.displayNumber(e,s)).write(44),e=ne.displayNumber(e,a)},t.prototype.toEndpoints=function(){var e=this.cx,t=this.cy,r=this.rx,n=this.ry,i=this.phi,o=this.a0,u=this.da,s=o+u,a=Math.cos(i),p=Math.sin(i),f=Math.cos(o),c=Math.sin(o),l=Math.cos(s),h=Math.sin(s),d=a*r*l-p*n*h+e,y=p*r*l+a*n*h+t;return{x0:a*r*f-p*n*c+e,y0:p*r*f+a*n*c+t,rx:r,ry:n,phi:i,large:Math.abs(u)>Math.PI,sweep:u>0,x1:d,y1:y}},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.cx,e.cx,r)&&b.equivalent(this.cy,e.cy,r)&&b.equivalent(this.rx,e.rx,r)&&b.equivalent(this.ry,e.ry,r)&&b.equivalent(this.phi,e.phi,r)&&b.equivalent(this.a0,e.a0,r)&&b.equivalent(this.da,e.da,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.cx===e.cx&&this.cy===e.cy&&this.rx===e.rx&&this.ry===e.ry&&this.phi===e.phi&&this.a0===e.a0&&this.da===e.da)},t.prototype.debug=function(e){return e=e.write("R2Curve").write(46).write("elliptic").write(40).debug(this.cx).write(", ").debug(this.cy).write(", ").debug(this.rx).write(", ").debug(this.ry).write(", ").debug(this.phi).write(", ").debug(this.a0).write(", ").debug(this.da).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.fromEndpoints=function(e,r,n,i,o,u,s,a,p){var f=Math.cos(o),c=Math.sin(o),l=f*((e-a)/2)+c*((r-p)/2),h=(e-a)/2*-c+f*((r-p)/2),d=n*n,y=i*i,v=l*l,b=h*h,m=Math.sqrt((d*y-d*b-y*v)/(d*b+y*v));u===s&&(m=-m);var g=m*n*h/i,w=-m*i*l/n,O=f*g-c*w+(e+a)/2,P=c*g+f*w+(r+p)/2;function x(e,t,r,n){var i=e*r+t*n,o=e*e+t*t,u=r*r+n*n,s=Math.acos(i/(Math.sqrt(o)*Math.sqrt(u)));return e*n-t*r<0&&(s=-s),s}var j=x(1,0,(l-g)/n,(h-w)/i),C=x((l-g)/n,(h-w)/i,(-l-g)/n,(-h-w)/i)%(2*Math.PI);return!s&&C>0?C-=2*Math.PI:s&&C<0&&(C+=2*Math.PI),new t(O,P,n,i,o,j,C)},t}(gs),As=function(e){function t(t,r,n,i,o,u,s,a,p,f,c){var l=e.call(this)||this;return l.x0Parser=t,l.y0Parser=r,l.rxParser=n,l.ryParser=i,l.phiParser=o,l.large=u,l.sweep=s,l.x1Parser=a,l.y1Parser=p,l.command=f,l.step=c,l}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.x0Parser,this.y0Parser,this.rxParser,this.ryParser,this.phiParser,this.large,this.sweep,this.x1Parser,this.y1Parser,this.command,this.step)},t.parse=function(e,r,n,i,o,u,s,a,p,f,c,l){void 0===l&&(l=1);var h=0;if(1===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();if(e.isCont())switch(h){case 65:case 97:e=e.step(),c=h,l=2;break;default:return we.error(oe.expected("arcto",e))}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(2===l){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(i=ie.parseDecimal(e))}else i=i.feed(e);if(void 0!==i)if(i.isDone())l=3;else if(i.isError())return i.asError()}if(3===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();e.isCont()?(44===h&&(e=e.step()),l=4):e.isEmpty()||(l=4)}if(4===l){if(void 0===o){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(o=ie.parseDecimal(e))}else o=o.feed(e);if(void 0!==o)if(o.isDone())l=5;else if(o.isError())return o.asError()}if(5===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();e.isCont()?(44===h&&(e=e.step()),l=6):e.isEmpty()||(l=6)}if(6===l){if(void 0===u){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(u=ie.parseDecimal(e))}else u=u.feed(e);if(void 0!==u)if(u.isDone())l=7;else if(u.isError())return u.asError()}if(7===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();e.isCont()?(44===h&&(e=e.step()),l=8):e.isEmpty()||(l=8)}if(8===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();if(e.isCont())if(48===h)e=e.step(),s=!1,l=9;else{if(49!==h)return we.error(oe.expected("flag",e));e=e.step(),s=!0,l=9}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(9===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();e.isCont()?(44===h&&(e=e.step()),l=10):e.isEmpty()||(l=10)}if(10===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();if(e.isCont())if(48===h)e=e.step(),a=!1,l=11;else{if(49!==h)return we.error(oe.expected("flag",e));e=e.step(),a=!0,l=11}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(11===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();e.isCont()?(44===h&&(e=e.step()),l=12):e.isEmpty()||(l=12)}if(12===l){if(void 0===p){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(p=ie.parseDecimal(e))}else p=p.feed(e);if(void 0!==p)if(p.isDone())l=13;else if(p.isError())return p.asError()}if(13===l){for(;e.isCont()&&(h=e.head(),re.isSpace(h));)e=e.step();e.isCont()?(44===h&&(e=e.step()),l=14):e.isEmpty()||(l=14)}if(14===l){if(void 0===f){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(f=ie.parseDecimal(e))}else f=f.feed(e);if(void 0!==f){if(f.isDone()){var d=r.bind(),y=n.bind(),v=i.bind(),b=o.bind(),m=u.bind()*Math.PI/180,g=p.bind(),w=f.bind();return 97===c&&(g+=d,w+=y),we.done(Ms.fromEndpoints(d,y,v,b,m,s,a,g,w))}if(f.isError())return f.asError()}}return new t(r,n,i,o,u,s,a,p,f,c,l)},t.parseRest=function(e,r,n,i){return t.parse(e,n,i,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r,2)},t}(we),Ds=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"curves",{value:t,enumerable:!0}),Object.defineProperty(n,"closed",{value:r,enumerable:!0}),Object.defineProperty(n,"boundingBox",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(n,"pathString",{value:void 0,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.isDefined=function(){return 0!==this.curves.length},t.prototype.isClosed=function(){return this.closed},Object.defineProperty(t.prototype,"xMin",{get:function(){return this.bounds.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.bounds.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.bounds.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.bounds.yMax},enumerable:!1,configurable:!0}),t.prototype.interpolateX=function(e){var t=this.curves,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateX(o)}return NaN},t.prototype.interpolateY=function(e){var t=this.curves,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateY(o)}return NaN},t.prototype.interpolate=function(e){var t=this.curves,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolate(o)}return new bs(NaN,NaN)},t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.split=function(e){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=r[o].split(u),a=s[0],p=s[1],f=new Array(o+1),c=new Array(n-o),l=0;l<o;l+=1)f[l]=r[l];f[o]=a,c[0]=p;for(l=o+1;l<n;l+=1)c[l-o]=r[l];return[new t(f,!1),new t(c,!1)]}return[t.empty(),t.empty()]},t.prototype.subdivide=function(e){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=r[o].split(u),a=s[0],p=s[1],f=new Array(n+1),c=0;c<o;c+=1)f[c]=r[c];f[o]=a,f[o+1]=p;for(c=o+1;c<n;c+=1)f[c+1]=r[c];return new t(f,this.closed)}return t.empty()},t.prototype.transform=function(e){var r=this.curves,n=r.length;if(n>0){for(var i=new Array(n),o=0;o<n;o+=1)i[o]=r[o].transform(e);return new t(i,this.closed)}return t.empty()},Object.defineProperty(t.prototype,"bounds",{get:function(){var e=this.boundingBox;if(null===e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,o=this.curves,u=0,s=o.length;u<s;u+=1){var a=o[u];t=Math.min(t,a.xMin),r=Math.min(r,a.yMin),n=Math.max(a.xMax,n),i=Math.max(a.yMax,i)}e=new Ns(t,r,n,i),Object.defineProperty(this,"boundingBox",{value:e,enumerable:!0,configurable:!0})}return e},enumerable:!1,configurable:!0}),t.prototype.drawMove=function(e){var t=this.curves;0!==t.length&&t[0].drawMove(e)},t.prototype.drawRest=function(e){for(var t=this.curves,r=this.closed,n=t.length-(r&&void 0!==e.closePath?1:0),i=0;i<n;i+=1)t[i].drawRest(e);r&&void 0!==e.closePath&&e.closePath()},t.prototype.transformDrawMove=function(e,t){var r=this.curves;0!==r.length&&r[0].transformDrawMove(e,t)},t.prototype.transformDrawRest=function(e,t){for(var r=this.curves,n=this.closed,i=r.length-(n&&void 0!==e.closePath?1:0),o=0;o<i;o+=1)r[o].transformDrawRest(e,t);n&&void 0!==e.closePath&&e.closePath()},t.prototype.writeMove=function(e){var t=this.curves;return 0!==t.length&&(e=t[0].writeMove(e)),e},t.prototype.writeRest=function(e){for(var t=this.curves,r=this.closed,n=t.length-(r?1:0),i=0;i<n;i+=1)e=t[i].writeRest(e);return r&&(e=e.write(90)),e},t.prototype.toPathString=function(e){var t;if(void 0!==e||void 0===(t=this.pathString)){var r=re.stringOutput(e);this.writePath(r),t=r.bind(),void 0===e&&Object.defineProperty(this,"pathString",{value:t,enumerable:!0,configurable:!0})}return t},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(x.equivalent(this.curves,e.curves,r)&&this.closed===e.closed)},t.prototype.equals=function(e){return this===e||e instanceof t&&(x.equal(this.curves,e.curves)&&this.closed===e.closed)},t.prototype.debug=function(e){var t=this.curves,r=t.length;if(e=e.write("R2Spline").write(46),0===r)e=e.write("empty").write(40);else if(0!==r){e=(e=e.write(this.closed?"closed":"open").write(40)).debug(t[0]);for(var n=1;n<r;n+=1)e=e.write(", ").debug(t[n])}return e=e.write(41)},t.prototype.toString=function(){return ne.debug(this)},t.empty=function(){return new t([],!1)},t.open=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e,!1)},t.closed=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e,!0)},t.builder=function(){return new Is},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=Ts.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},t}(gs),Is=function(){function e(){this.curves=[],this.closed=!1,this.aliased=!1,this.x0=0,this.y0=0,this.x=0,this.y=0}return e.prototype.dealias=function(){this.aliased&&(this.curves=this.curves.slice(0),this.aliased=!1)},e.prototype.moveTo=function(e,t){this.aliased?(this.curves=[],this.aliased=!1):this.curves.length=0,this.closed=!1,this.x0=e,this.y0=t,this.x=e,this.y=t},e.prototype.closePath=function(){this.dealias(),this.curves.push(new Ps(this.x,this.y,this.x0,this.y0)),this.closed=!0,this.x=this.x0,this.y=this.y0},e.prototype.lineTo=function(e,t){this.dealias(),this.curves.push(new Ps(this.x,this.y,e,t)),this.x=e,this.y=t},e.prototype.quadraticCurveTo=function(e,t,r,n){this.dealias(),this.curves.push(new Cs(this.x,this.y,e,t,r,n)),this.x=r,this.y=n},e.prototype.bezierCurveTo=function(e,t,r,n,i,o){this.dealias(),this.curves.push(new Ss(this.x,this.y,e,t,r,n,i,o)),this.x=i,this.y=o},e.prototype.arcTo=function(t,r,n,i,o){this.dealias();var u=this.x,s=this.y,a=t-u,p=r-s,f=n-t,c=i-r,l=Math.atan2(p,a)-Math.PI/2,h=Math.atan2(c,f)-Math.PI/2,d=h-l,y=Math.cos(l),v=Math.sin(l),b=Math.cos(h),m=Math.sin(h),g=u-y,w=s-v,O=t-y,P=r-v,x=t-b,j=r-m,C=n-b,E=i-m,S=e.intersection(g,w,O-g,P-w,x,j,C-x,E-j),k=g+S*(O-g),M=w+S*(P-w);this.curves.push(new Ms(k,M,o,o,0,l,d)),this.x=n,this.y=i},e.intersection=function(e,t,r,n,i,o,u,s){var a=i-e,p=o-t,f=a*n-p*r,c=r*s-n*u;if(0===f&&0===c){var l=r*r+n*n,h=u*r+s*n,d=(a*r+p*n)/l,y=d+h/l;return(h>=0?0<y&&d<1:0<d&&y<1)?d:NaN}if(0===c)return NaN;var v=(a*s-p*u)/c,b=f/c;return 0<=v&&v<=1&&0<=b&&b<=1?v:NaN},e.prototype.arc=function(e,t,r,n,i,o){void 0===o&&(o=!1),this.dealias();var u=i-n;!0===o&&u>0?u-=2*Math.PI:!1===o&&u<0&&(u+=2*Math.PI);var s=new Ms(e,t,r,r,0,n,u);this.curves.push(s);var a=s.interpolate(1),p=a.x,f=a.y;this.x=p,this.y=f},e.prototype.ellipse=function(e,t,r,n,i,o,u,s){this.dealias();var a=u-o;!0===s&&a>0?a-=2*Math.PI:!1===s&&a<0&&(a+=2*Math.PI);var p=new Ms(e,t,r,n,i,o,a);this.curves.push(p);var f=p.interpolate(1),c=f.x,l=f.y;this.x=c,this.y=l},e.prototype.rect=function(e,t,r,n){this.dealias(),this.curves.push(new Ps(e,t,e+r,t),new Ps(e+r,t,e+r,t+n),new Ps(e+r,t+n,e,t+n),new Ps(e,t+n,e,t)),this.x=e,this.y=t},e.prototype.bind=function(){return this.aliased=!0,new Ds(this.curves,this.closed)},e}(),Ts=function(e){function t(t,r,n,i,o,u,s,a){var p=e.call(this)||this;return p.x0Parser=t,p.y0Parser=r,p.xParser=n,p.yParser=i,p.curveParser=o,p.curves=u,p.command=s,p.step=a,p}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.x0Parser,this.y0Parser,this.xParser,this.yParser,this.curveParser,this.curves,this.command,this.step)},t.parse=function(e,r,n,i,o,u,s,a,p){void 0===p&&(p=1);var f=0;if(1===p){for(;e.isCont()&&(f=e.head(),re.isSpace(f));)e=e.step();if(e.isCont()){if(77!==f&&109!==f)return we.error(oe.expected("moveto",e));e=e.step(),a=f,p=2}else if(!e.isEmpty())return we.error(oe.unexpected(e))}if(2===p){if(void 0===r){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(r=ie.parseDecimal(e))}else r=r.feed(e);if(void 0!==r)if(r.isDone())i=r,p=3;else if(r.isError())return r.asError()}if(3===p){for(;e.isCont()&&(f=e.head(),re.isSpace(f));)e=e.step();e.isCont()?(44===f&&(e=e.step()),p=4):e.isEmpty()||(p=4)}if(4===p){if(void 0===n){for(;e.isCont()&&re.isSpace(e.head());)e=e.step();e.isEmpty()||(n=ie.parseDecimal(e))}else n=n.feed(e);if(void 0!==n)if(n.isDone())o=n,p=5;else if(n.isError())return n.asError()}for(;;){if(5===p){if(void 0===u){for(;e.isCont()&&(f=e.head(),re.isSpace(f));)e=e.step();if(e.isCont()){var c=void 0!==s&&0!==s.length?s[s.length-1]:null;switch(f){case 76:case 108:case 72:case 104:case 86:case 118:u=js.parse(e,i,o),a=f;break;case 81:case 113:u=Es.parse(e,i,o),a=f;break;case 84:if(c instanceof Cs){var l=c.x2-c.x1,h=c.y2-c.y1,d=i.bind()+l,y=o.bind()+h;u=Es.parse(e,i,o,we.done(d),we.done(y))}else u=Es.parse(e,i,o,i,o);a=f;break;case 116:if(c instanceof Cs){l=c.x2-c.x1,h=c.y2-c.y1;u=Es.parse(e,i,o,we.done(l),we.done(h))}else u=Es.parse(e,i,o,we.done(0),we.done(0));a=f;break;case 67:case 99:u=ks.parse(e,i,o),a=f;break;case 83:if(c instanceof Ss){l=c.x3-c.x2,h=c.y3-c.y2,d=i.bind()+l,y=o.bind()+h;u=ks.parse(e,i,o,we.done(d),we.done(y))}else u=ks.parse(e,i,o,i,o);a=f;break;case 115:if(c instanceof Ss){l=c.x3-c.x2,h=c.y3-c.y2;u=ks.parse(e,i,o,we.done(l),we.done(h))}else u=ks.parse(e,i,o,we.done(0),we.done(0));a=f;break;case 65:case 97:u=As.parse(e,i,o),a=f;break;case 90:case 122:return e=e.step(),void 0===s&&(s=[]),s.push(new Ps(i.bind(),o.bind(),r.bind(),n.bind())),we.done(new Ds(s,!0));case 44:e=e.step();case 43:case 45:case 46:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:switch(a){case 77:case 109:case 76:case 108:case 72:case 104:case 86:case 118:u=js.parseRest(e,a,i,o);break;case 81:case 113:u=Es.parseRest(e,a,i,o);break;case 84:if(c instanceof Cs){l=c.x2-c.x1,h=c.y2-c.y1,d=i.bind()+l,y=o.bind()+h;u=Es.parseRest(e,a,i,o,we.done(d),we.done(y))}else u=Es.parseRest(e,a,i,o,i,o);break;case 116:if(c instanceof Cs){l=c.x2-c.x1,h=c.y2-c.y1;u=Es.parseRest(e,a,i,o,we.done(l),we.done(h))}else u=Es.parseRest(e,a,i,o,we.done(0),we.done(0));break;case 67:case 99:u=ks.parseRest(e,a,i,o);break;case 83:if(c instanceof Ss){l=c.x3-c.x2,h=c.y3-c.y2,d=i.bind()+l,y=o.bind()+h;u=ks.parseRest(e,a,i,o,we.done(d),we.done(y))}else u=ks.parseRest(e,a,i,o,i,o);break;case 115:if(c instanceof Ss){l=c.x3-c.x2,h=c.y3-c.y2;u=ks.parseRest(e,a,i,o,we.done(l),we.done(h))}else u=ks.parseRest(e,a,i,o,we.done(0),we.done(0));break;case 65:case 97:u=As.parseRest(e,a,i,o);break;default:return void 0!==s?we.done(new Ds(s,!1)):we.done(Ds.empty())}break;default:return void 0!==s?we.done(new Ds(s,!1)):we.done(Ds.empty())}}else if(!e.isEmpty())return void 0!==s?we.done(new Ds(s,!1)):we.done(Ds.empty())}else u=u.feed(e);if(void 0!==u){if(u.isDone()){var v=u.bind();u=void 0,void 0===s&&(s=[]),s.push(v),i=we.done(v.interpolateX(1)),o=we.done(v.interpolateY(1));continue}if(u.isError())return u.asError()}}break}return new t(r,n,i,o,u,s,a,p)},t}(we),Vs=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"splines",{value:t,enumerable:!0}),Object.defineProperty(r,"boundingBox",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(r,"pathString",{value:void 0,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.isDefined=function(){return 0!==this.splines.length},Object.defineProperty(t.prototype,"xMin",{get:function(){return this.bounds.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.bounds.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.bounds.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.bounds.yMax},enumerable:!1,configurable:!0}),t.prototype.interpolateX=function(e){var t=this.splines,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateX(o)}return NaN},t.prototype.interpolateY=function(e){var t=this.splines,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateY(o)}return NaN},t.prototype.interpolate=function(e){var t=this.splines,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolate(o)}return new bs(NaN,NaN)},t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.split=function(e){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=r[o].split(u),a=s[0],p=s[1],f=new Array(o+1),c=new Array(n-o),l=0;l<o;l+=1)f[l]=r[l];f[o]=a,c[0]=p;for(l=o+1;l<n;l+=1)c[l-o]=r[l];return[new t(f),new t(c)]}return[t.empty(),t.empty()]},t.prototype.subdivide=function(e){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=new Array(n),a=0;a<o;a+=1)s[a]=r[a];s[o]=r[o].subdivide(u);for(a=o+1;a<n;a+=1)s[a]=r[a];return new t(s)}return t.empty()},t.prototype.transform=function(e){var r=this.splines,n=r.length;if(n>0){for(var i=new Array(n),o=0;o<n;o+=1)i[o]=r[o].transform(e);return new t(i)}return t.empty()},Object.defineProperty(t.prototype,"bounds",{get:function(){var e=this.boundingBox;if(null===e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,o=this.splines,u=0,s=o.length;u<s;u+=1){var a=o[u];t=Math.min(t,a.xMin),r=Math.min(r,a.yMin),n=Math.max(a.xMax,n),i=Math.max(a.yMax,i)}e=new Ns(t,r,n,i),Object.defineProperty(this,"boundingBox",{value:e,enumerable:!0,configurable:!0})}return e},enumerable:!1,configurable:!0}),t.prototype.draw=function(e){for(var t=this.splines,r=0,n=t.length;r<n;r+=1)t[r].draw(e)},t.prototype.transformDraw=function(e,t){for(var r=this.splines,n=0,i=r.length;n<i;n+=1)r[n].transformDraw(e,t)},t.prototype.writePath=function(e){var t=this.splines,r=t.length;if(e.settings===W.standard())for(var n=0;n<r;n+=1)e=e.write(t[n].toPathString());else for(n=0;n<r;n+=1)e=t[n].writePath(e);return e},t.prototype.toPathString=function(e){var t;if(void 0!==e||void 0===(t=this.pathString)){var r=re.stringOutput(e);this.writePath(r),t=r.bind(),void 0===e&&Object.defineProperty(this,"pathString",{value:t,enumerable:!0,configurable:!0})}return t},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&x.equivalent(this.splines,e.splines,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&x.equal(this.splines,e.splines)},t.prototype.debug=function(e){var t=this.splines,r=t.length;if(e=e.write("R2Path").write(46),0===r)e=e.write("empty").write(40);else if(1===r){var n=t[0];e=e.write(n.closed?"closed":"open").write(40);var i=n.curves,o=i.length;if(0!==o){e=e.debug(i[0]);for(var u=1;u<o;u+=1)e=e.write(", ").debug(i[u])}}else{e=(e=e.write("of").write(40)).debug(t[0]);for(u=1;u<r;u+=1)e=e.write(", ").debug(t[u])}return e=e.write(41)},t.prototype.toAttributeString=function(){return this.toPathString()},t.prototype.toString=function(){return ne.debug(this)},t.empty=function(){return new t([])},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e)},t.open=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t([new Ds(e,!1)])},t.closed=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t([new Ds(e,!0)])},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.builder=function(){return new qs},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=Rs.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},t}(vs),qs=function(){function e(){this.splines=[],this.builder=null}return e.prototype.moveTo=function(e,t){var r=this.builder;if(null!==r){var n=r.bind();n.isDefined()&&this.splines.push(n)}r=new Is,this.builder=r,r.moveTo(e,t)},e.prototype.closePath=function(){var e=this.builder;if(null===e)throw new Error;e.closePath()},e.prototype.lineTo=function(e,t){var r=this.builder;if(null===r)throw new Error;r.lineTo(e,t)},e.prototype.quadraticCurveTo=function(e,t,r,n){var i=this.builder;if(null===i)throw new Error;i.quadraticCurveTo(e,t,r,n)},e.prototype.bezierCurveTo=function(e,t,r,n,i,o){var u=this.builder;if(null===u)throw new Error;u.bezierCurveTo(e,t,r,n,i,o)},e.prototype.arcTo=function(e,t,r,n,i){var o=this.builder;if(null===o)throw new Error;o.arcTo(e,t,r,n,i)},e.prototype.arc=function(e,t,r,n,i,o){var u=this.builder;if(null===u)throw new Error;u.arc(e,t,r,n,i,o)},e.prototype.ellipse=function(e,t,r,n,i,o,u,s){var a=this.builder;if(null===a)throw new Error;a.ellipse(e,t,r,n,i,o,u,s)},e.prototype.rect=function(e,t,r,n){var i=this.builder;if(null===i)throw new Error;i.rect(e,t,r,n)},e.prototype.bind=function(){var e=this.splines.slice(0),t=this.builder;if(null!==t){var r=t.bind();r.isDefined()&&e.push(r)}return new Vs(e)},e}(),Rs=function(e){function t(t,r,n){var i=e.call(this)||this;return i.splineParser=t,i.splines=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.splineParser,this.splines,this.step)},t.parse=function(e,r,n,i){void 0===i&&(i=1);for(var o=0;;){if(1===i){if(void 0===r){for(;e.isCont()&&(o=e.head(),re.isSpace(o));)e=e.step();if(e.isCont())switch(o){case 77:case 109:r=Ts.parse(e);break;case 110:i=2;break;default:return void 0!==n?we.done(new Vs(n)):we.done(Vs.empty())}else if(!e.isEmpty())return void 0!==n?we.done(new Vs(n)):we.done(Vs.empty())}else r=r.feed(e);if(void 0!==r){if(r.isDone()){var u=r.bind();r=void 0,u.isDefined()&&(void 0===n&&(n=[]),n.push(u));continue}if(r.isError())return r.asError()}}break}if(i>=2&&i<=5)for(;;){if(e.isCont()){if(e.head()==="none".charCodeAt(i-2)){if(e=e.step(),i<5){i+=1;continue}return we.done(Vs.empty())}return we.error(oe.expected("none",e))}if(!e.isEmpty())return we.error(oe.unexpected(e));break}return new t(r,n,i)},t}(we),Us=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"cx",{value:t,enumerable:!0}),Object.defineProperty(i,"cy",{value:r,enumerable:!0}),Object.defineProperty(i,"r",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.cx)&&isFinite(this.cy)&&isFinite(this.r)},Object.defineProperty(t.prototype,"xMin",{get:function(){return this.cx-this.r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.cy-this.r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.cx+this.r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.cy+this.r},enumerable:!1,configurable:!0}),t.prototype.contains=function(e,r){if("number"==typeof e){var n=e-this.cx,i=r-this.cy;return n*n+i*i<=this.r*this.r}return(e=vs.fromAny(e))instanceof bs?this.containsPoint(e):e instanceof Ps?this.containsSegment(e):e instanceof Ns?this.containsBox(e):e instanceof t&&this.containsCircle(e)},t.prototype.containsPoint=function(e){var t=e.x-this.cx,r=e.y-this.cy;return t*t+r*r<=this.r*this.r},t.prototype.containsSegment=function(e){var t=e.x0-this.cx,r=e.y0-this.cy,n=e.x1-this.cx,i=e.y1-this.cy,o=this.r*this.r;return t*t+r*r<=o&&n*n+i*i<=o},t.prototype.containsBox=function(e){var t=e.xMin-this.cx,r=e.yMin-this.cy,n=e.xMax-this.cx,i=e.yMax-this.cy,o=this.r*this.r;return t*t+r*r<=o&&t*t+i*i<=o&&n*n+r*r<=o&&n*n+i*i<=o},t.prototype.containsCircle=function(e){var t=e.cx-this.cx,r=e.cy-this.cy;return t*t+r*r+e.r*e.r<=this.r*this.r},t.prototype.intersects=function(e){return(e=vs.fromAny(e))instanceof bs?this.intersectsPoint(e):e instanceof Ps?this.intersectsSegment(e):e instanceof Ns?this.intersectsBox(e):e instanceof t?this.intersectsCircle(e):e.intersects(this)},t.prototype.intersectsPoint=function(e){var t=e.x-this.cx,r=e.y-this.cy;return t*t+r*r<=this.r*this.r},t.prototype.intersectsSegment=function(e){var t=this.cx,r=this.cy,n=this.r,i=e.x0,o=e.y0,u=e.x1,s=e.y1,a=u-i,p=s-o,f=Math.sqrt(a*a+p*p),c=a/f,l=p/f,h=(t-i)*l-(r-o)*c;if(h<-n||n<h)return!1;var d=i-t,y=o-r,v=u-t,b=s-r,m=n*n;if(d*d+y*y<=m||v*v+b*b<=m)return!0;var g=c*t+l*r,w=c*i+l*o,O=c*u+l*s;return w<g&&g<=O||O<g&&g<=w},t.prototype.intersectsBox=function(e){var t=(this.cx<e.xMin?e.xMin:e.xMax<this.cx?e.xMax:this.cx)-this.cx,r=(this.cy<e.yMin?e.yMin:e.yMax<this.cy?e.yMax:this.cy)-this.cy;return t*t+r*r<=this.r*this.r},t.prototype.intersectsCircle=function(e){var t=e.cx-this.cx,r=e.cy-this.cy,n=this.r+e.r;return t*t+r*r<=n*n},t.prototype.transform=function(e){var r=e.transformX(this.cx,this.cy),n=e.transformY(this.cx,this.cy),i=e.transformX(this.cx+this.r,this.cy)-r,o=e.transformY(this.cx+this.r,this.cy)-n;return new t(r,n,Math.sqrt(i*i+o*o))},t.prototype.toAny=function(){return{cx:this.cx,cy:this.cy,r:this.r}},t.prototype.interpolateTo=function(e){return e instanceof t?Fs(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.cx,e.cx,r)&&b.equivalent(this.cy,e.cy,r)&&b.equivalent(this.r,e.r,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.cx===e.cx&&this.cy===e.cy&&this.r===e.r)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.cx)),b.hash(this.cy)),b.hash(this.r)))},t.prototype.debug=function(e){return e=e.write("R2Circle").write(46).write("of").write(40).debug(this.cx).write(", ").debug(this.cy).write(", ").debug(this.r).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.of=function(e,r,n){return new t(e,r,n)},t.fromInit=function(e){return new t(e.cx,e.cy,e.r)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);throw new TypeError(""+e)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.cx&&"number"==typeof t.cy&&"number"==typeof t.r}return!1},t.isAny=function(e){return e instanceof t||t.isInit(e)},t}(vs),Ns=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"xMin",{value:t,enumerable:!0}),Object.defineProperty(o,"yMin",{value:r,enumerable:!0}),Object.defineProperty(o,"xMax",{value:n,enumerable:!0}),Object.defineProperty(o,"yMax",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.xMin)&&isFinite(this.yMin)&&isFinite(this.xMax)&&isFinite(this.yMax)},Object.defineProperty(t.prototype,"x",{get:function(){return this.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.xMax-this.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.yMax-this.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.yMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return new bs((this.xMin+this.xMax)/2,(this.yMin+this.yMax)/2)},enumerable:!1,configurable:!0}),t.prototype.contains=function(e,r){return"number"==typeof e?this.xMin<=e&&e<=this.xMax&&this.yMin<=r&&r<=this.yMax:(e=vs.fromAny(e))instanceof vs&&(e instanceof bs?this.containsPoint(e):e instanceof Ps?this.containsSegment(e):e instanceof t?this.containsBox(e):e instanceof Us?this.containsCircle(e):this.xMin<=e.xMin&&e.xMax<=this.xMax&&this.yMin<=e.yMin&&e.yMax<=this.yMax)},t.prototype.containsPoint=function(e){return this.xMin<=e.x&&e.x<=this.xMax&&this.yMin<=e.y&&e.y<=this.yMax},t.prototype.containsSegment=function(e){return this.xMin<=e.x0&&e.x0<=this.xMax&&this.yMin<=e.y0&&e.y0<=this.yMax&&this.xMin<=e.x1&&e.x1<=this.xMax&&this.yMin<=e.y1&&e.y1<=this.yMax},t.prototype.containsBox=function(e){return this.xMin<=e.xMin&&e.xMax<=this.xMax&&this.yMin<=e.yMin&&e.yMax<=this.yMax},t.prototype.containsCircle=function(e){return this.xMin<=e.cx-e.r&&e.cx+e.r<=this.xMax&&this.yMin<=e.cy-e.r&&e.cy+e.r<=this.yMax},t.prototype.intersects=function(e){return(e=vs.fromAny(e))instanceof bs?this.intersectsPoint(e):e instanceof Ps?this.intersectsSegment(e):e instanceof t?this.intersectsBox(e):e instanceof Us?this.intersectsCircle(e):e.intersects(this)},t.prototype.intersectsPoint=function(e){return this.xMin<=e.x&&e.x<=this.xMax&&this.yMin<=e.y&&e.y<=this.yMax},t.prototype.intersectsSegment=function(e){var r=this.xMin,n=this.yMin,i=this.xMax,o=this.yMax,u=e.x0,s=e.y0,a=e.x1,p=e.y1;return!(u<r&&a<r||u>i&&a>i||s<n&&p<n||s>o&&p>o)&&(u>r&&u<i&&s>n&&s<o||!!(t.intersectsSegment(u-r,a-r,u,s,a,p)&&t.hitY>n&&t.hitY<o||t.intersectsSegment(s-n,p-n,u,s,a,p)&&t.hitX>r&&t.hitX<i||t.intersectsSegment(u-i,a-i,u,s,a,p)&&t.hitY>n&&t.hitY<o||t.intersectsSegment(s-o,p-o,u,s,a,p)&&t.hitX>r&&t.hitX<i))},t.intersectsSegment=function(e,r,n,i,o,u){if(e!==r||e*r<0){var s=-e/(r-e);return t.hitX=n+(o-n)*s,t.hitY=i+(u-i)*s,!0}return!1},t.prototype.intersectsBox=function(e){return this.xMin<=e.xMax&&e.xMin<=this.xMax&&this.yMin<=e.yMax&&e.yMin<=this.yMax},t.prototype.intersectsCircle=function(e){var t=(e.cx<this.xMin?this.xMin:this.xMax<e.cx?this.xMax:e.cx)-e.cx,r=(e.cy<this.yMin?this.yMin:this.yMax<e.cy?this.yMax:e.cy)-e.cy;return t*t+r*r<=e.r*e.r},t.prototype.union=function(t){return e.prototype.union.call(this,t)},t.prototype.transform=function(e){return new t(e.transformX(this.xMin,this.yMin),e.transformY(this.xMin,this.yMin),e.transformX(this.xMax,this.yMax),e.transformY(this.xMax,this.yMax))},Object.defineProperty(t.prototype,"bounds",{get:function(){return this},enumerable:!1,configurable:!0}),t.prototype.toAny=function(){return{xMin:this.xMin,yMin:this.yMin,xMax:this.xMax,yMax:this.yMax}},t.prototype.interpolateTo=function(e){return e instanceof t?zs(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.xMin,e.xMin,r)&&b.equivalent(this.yMin,e.yMin,r)&&b.equivalent(this.xMax,e.xMax,r)&&b.equivalent(this.yMax,e.yMax,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.xMin===e.xMin&&this.yMin===e.yMin&&this.xMax===e.xMax&&this.yMax===e.yMax)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.xMin)),b.hash(this.yMin)),b.hash(this.xMax)),b.hash(this.yMax)))},t.prototype.debug=function(e){return e=e.write("R2Box").write(46).write("of").write(40).debug(this.xMin).write(", ").debug(this.yMin).write(", ").debug(this.xMax).write(", ").debug(this.yMax).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.undefined=function(){return new t(1/0,1/0,-1/0,-1/0)},t.of=function(e,r,n,i){return void 0===n&&(n=e),void 0===i&&(i=r),new t(e,r,n,i)},t.fromInit=function(e){return new t(e.xMin,e.yMin,e.xMax,e.yMax)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);throw new TypeError(""+e)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.xMin&&"number"==typeof t.yMin&&"number"==typeof t.xMax&&"number"==typeof t.yMax}return!1},t.isAny=function(e){return e instanceof t||t.isInit(e)},t.hitX=0,t.hitY=0,E([s],t,"undefined",null),t}(vs),zs=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.xMin+e*(n.xMin-t.xMin),o=t.yMin+e*(n.yMin-t.yMin),u=t.xMax+e*(n.xMax-t.xMax),s=t.yMax+e*(n.yMax-t.yMax);return new Ns(i,o,u,s)};return Object.setPrototypeOf(r,zs.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};zs.prototype=Object.create($e.prototype);var Fs=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.cx+e*(n.cx-t.cx),o=t.cy+e*(n.cy-t.cy),u=t.r+e*(n.r-t.r);return new Us(i,o,u)};return Object.setPrototypeOf(r,Fs.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Fs.prototype=Object.create($e.prototype);var Ls=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"shapes",{value:t,enumerable:!0}),Object.defineProperty(r,"boundingBox",{value:null,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.isDefined=function(){return 0!==this.shapes.length},Object.defineProperty(t.prototype,"xMin",{get:function(){return this.bounds.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMin",{get:function(){return this.bounds.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xMax",{get:function(){return this.bounds.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yMax",{get:function(){return this.bounds.yMax},enumerable:!1,configurable:!0}),t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.transform=function(e){var r=this.shapes,n=r.length;if(n>0){for(var i=new Array(n),o=0;o<n;o+=1)i[o]=r[o].transform(e);return new t(i)}return t.empty()},Object.defineProperty(t.prototype,"bounds",{get:function(){var e=this.boundingBox;if(null===e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,o=this.shapes,u=0,s=o.length;u<s;u+=1){var a=o[u];t=Math.min(t,a.xMin),r=Math.min(r,a.yMin),n=Math.max(a.xMax,n),i=Math.max(a.yMax,i)}e=new Ns(t,r,n,i),Object.defineProperty(this,"boundingBox",{value:e,enumerable:!0,configurable:!0})}return e},enumerable:!1,configurable:!0}),t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&x.equivalent(this.shapes,e.shapes,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&x.equal(this.shapes,e.shapes)},t.prototype.debug=function(e){var t=this.shapes,r=t.length;if(e=e.write("R2Group").write(46),0===r)e=e.write("empty").write(40);else{e=(e=e.write("of").write(40)).debug(t[0]);for(var n=1;n<r;n+=1)e=e.write(", ").debug(t[n])}return e=e.write(41)},t.prototype.toString=function(){return ne.debug(this)},t.empty=function(){return new t(x.empty)},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e)},E([s],t,"empty",null),t}(vs),Ks=function(){function e(){}return e.prototype.translate=function(t,r){return this.transform(e.translate(t,r))},e.prototype.translateX=function(t){return this.transform(e.translateX(t))},e.prototype.translateY=function(t){return this.transform(e.translateY(t))},e.prototype.scale=function(t,r){return this.transform(e.scale(t,r))},e.prototype.scaleX=function(t){return this.transform(e.scaleX(t))},e.prototype.scaleY=function(t){return this.transform(e.scaleY(t))},e.prototype.rotate=function(t){return this.transform(e.rotate(t))},e.prototype.skew=function(t,r){return this.transform(e.skew(t,r))},e.prototype.skewX=function(t){return this.transform(e.skewX(t))},e.prototype.skewY=function(t){return this.transform(e.skewY(t))},e.prototype.toMatrix=function(){return this.toAffine().toMatrix()},e.prototype.toCssTransformComponent=function(){return null},e.prototype.toCssValue=function(){if("undefined"!=typeof CSSTransformValue){var e=this.toCssTransformComponent();if(null!==e)return new CSSTransformValue([e])}return null},e.prototype.interpolateTo=function(t){return t instanceof e?oa(this.toAffine(),t.toAffine()):null},e.prototype.toAttributeString=function(){return this.toString()},e.identity=function(){return new Hs},e.translate=function(e,t){return e=Zu.fromAny(e),t=Zu.fromAny(t),new Xs(e,t)},e.translateX=function(e){return e=Zu.fromAny(e),new Xs(e,Ju.zero())},e.translateY=function(e){return e=Zu.fromAny(e),new Xs(Ju.zero(),e)},e.scale=function(e,t){return new _s(e,t)},e.scaleX=function(e){return new _s(e,1)},e.scaleY=function(e){return new _s(1,e)},e.rotate=function(e){return e=us.fromAny(e,"deg"),new Js(e)},e.skew=function(e,t){return e=us.fromAny(e,"deg"),t=us.fromAny(t,"deg"),new ta(e,t)},e.skewX=function(e){return e=us.fromAny(e,"deg"),new ta(e,ss.zero())},e.skewY=function(e){return e=us.fromAny(e,"deg"),new ta(ss.zero(),e)},e.affine=function(e,t,r,n,i,o){return void 0===e&&(e=1),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=0),new ia(e,t,r,n,i,o)},e.list=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=[],i=0;i<t.length;i+=1){var o=e.fromAny(t[i]);o instanceof sa?n.push.apply(n,o.transforms):o instanceof Hs||n.push(o)}return new sa(n)},e.fromCssValue=function(t){if(t instanceof CSSTransformValue)return e.fromCssTransform(t);throw new TypeError(""+t)},e.fromCssTransform=function(t){var r=t.length;if(1===r)return e.fromCssTransformComponent(t[0]);for(var n=new Array(r),i=0;i<r;i+=1)n[i]=e.fromCssTransformComponent(t[i]);return new sa(n)},e.fromCssTransformComponent=function(e){if(e instanceof CSSTranslate)return Xs.fromCssTransformComponent(e);if(e instanceof CSSRotate)return Js.fromCssTransformComponent(e);if(e instanceof CSSScale)return _s.fromCssTransformComponent(e);if(e instanceof CSSSkew)return ta.fromCssTransformComponent(e);if(e instanceof CSSMatrixComponent)return ia.fromCssTransformComponent(e);throw new TypeError(""+e)},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(e){switch(e.tag){case"identity":return Hs.fromValue(e);case"translate":return Xs.fromValue(e);case"scale":return _s.fromValue(e);case"rotate":return Js.fromValue(e);case"skew":return ta.fromValue(e);case"matrix":return ia.fromValue(e);default:return sa.fromValue(e)}},e.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=pa.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},e.form=function(){return new Bs(e.identity())},e.isAny=function(t){return t instanceof e||"string"==typeof t},E([s],e,"identity",null),E([s],e,"form",null),e}(),Bs=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e){return(e=Ks.fromAny(e)).toValue()},t.prototype.cast=function(e){var t=e.toValue();try{if(t instanceof or){var r=Ks.fromValue(t);return null!==r?r:void 0}var n=t.stringValue(void 0);if(void 0!==n)return Ks.parse(n)}catch(e){}},t}(En),Ws=function(e){function t(t){var r=e.call(this)||this;return r.identOutput=t,r}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.identOutput)},t.parse=function(e,r){var n=0;for(r=r||re.stringOutput();e.isCont()&&(n=e.head(),re.isAlpha(n)||re.isDigit(n)||45===n);)e=e.step(),r.write(n);if(!e.isEmpty()){var i=r.bind();switch(i){case"translate3d":case"translateX":case"translateY":case"translate":return Gs.parseRest(e,r);case"scaleX":case"scaleY":case"scale":return Zs.parseRest(e,r);case"rotate":return ea.parseRest(e,r);case"skewX":case"skewY":case"skew":return na.parseRest(e,r);case"matrix":return ua.parseRest(e,r);case"none":return we.done(Ks.identity());default:return we.error(oe.message("unknown transform function: "+i,e))}}return new t(r)},t}(we),Hs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.transform=function(e,t){return 1===arguments.length?e:new bs(e,t)},t.prototype.transformX=function(e,t){return e},t.prototype.transformY=function(e,t){return t},t.prototype.inverse=function(){return this},t.prototype.toAffine=function(){return new ia(1,0,0,1,0,0)},t.prototype.toCssValue=function(){return new CSSKeywordValue("identity")},t.prototype.toValue=function(){return or.create(1).attr("identity")},t.prototype.interpolateTo=function(r){return r instanceof t?tt(this):e.prototype.interpolateTo.call(this,r)},t.prototype.conformsTo=function(e){return e instanceof t},t.prototype.equivalentTo=function(e,r){return e instanceof t},t.prototype.equals=function(e){return e instanceof t},t.prototype.hashCode=function(){return w.hash(t)},t.prototype.debug=function(e){return e=e.write("Transform").write(46).write("identity").write(40).write(41)},t.prototype.toString=function(){return"none"},t.fromValue=function(e){return"identity"===e.tag?Ks.identity():null},t}(Ks),Xs=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"x",{value:t,enumerable:!0}),Object.defineProperty(n,"y",{value:r,enumerable:!0}),Object.defineProperty(n,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.transform=function(e,r){return 1===arguments.length?e instanceof Hs?this:e instanceof t?new t(this.x.plus(e.x),this.y.plus(e.y)):Ks.list(this,e):new bs(this.x.pxValue()+e,this.y.pxValue()+r)},t.prototype.transformX=function(e,t){return this.x.pxValue()+e},t.prototype.transformY=function(e,t){return this.y.pxValue()+t},t.prototype.inverse=function(){return new t(this.x.negative(),this.y.negative())},t.prototype.toAffine=function(){return new ia(1,0,0,1,this.x.pxValue(),this.y.pxValue())},t.prototype.toCssTransformComponent=function(){if("undefined"!=typeof CSSTranslate){var e=this.x.toCssValue(),t=this.y.toCssValue();return new CSSTranslate(e,t)}return null},t.prototype.toValue=function(){return or.create(1).attr("translate",or.create(2).slot("x",this.x.toValue()).slot("y",this.y.toValue()))},t.prototype.interpolateTo=function(r){return r instanceof t?Ys(this,r):e.prototype.interpolateTo.call(this,r)},t.prototype.conformsTo=function(e){return e instanceof t},t.prototype.equivalentTo=function(e,r){return e instanceof t&&(this.x.equivalentTo(e.x,r)&&this.y.equivalentTo(e.y,r))},t.prototype.equals=function(e){return e instanceof t&&(this.x.equals(e.x)&&this.y.equals(e.y))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.x.hashCode()),this.y.hashCode()))},t.prototype.debug=function(e){return e=e.write("Transform").write(46).write("translate"),e=(e=this.x.isDefined()&&!this.y.isDefined()?e.write("X").write(40).debug(this.x):!this.x.isDefined()&&this.y.isDefined()?e.write("Y").write(40).debug(this.y):e.write(40).debug(this.x).write(", ").debug(this.y)).write(41)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=this.x.isDefined()&&!this.y.isDefined()?"translate("+this.x+",0)":!this.x.isDefined()&&this.y.isDefined()?"translate(0,"+this.y+")":"translate("+this.x+","+this.y+")",Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t.prototype.toAttributeString=function(){return this.x.isDefined()&&!this.y.isDefined()?"translate("+this.x.pxValue()+",0)":!this.x.isDefined()&&this.y.isDefined()?"translate(0,"+this.y.pxValue()+")":"translate("+this.x.pxValue()+","+this.y.pxValue()+")"},t.fromCssTransformComponent=function(e){return new t("number"==typeof e.x?Zu.px(e.x):Zu.fromCssValue(e.x),"number"==typeof e.y?Zu.px(e.y):Zu.fromCssValue(e.y))},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=e.header("translate");if(r.isDefined()){var n=Zu.zero(),i=Zu.zero();return r.forEach((function(e,t){var r=e.key.stringValue();void 0!==r?"x"===r?n=e.toValue().cast(Zu.form(),n):"y"===r&&(i=e.toValue().cast(Zu.form(),i)):e instanceof ir&&(0===t?n=e.cast(Zu.form(),n):1===t&&(i=e.cast(Zu.form(),i)))}),this),new t(n,i)}return null},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=Gs.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},t}(Ks),Ys=function(e,t){var r=function(e){var t=r[0],n=r[1],i=Zu.create(t.x.value+e*(n.x.value-t.x.value),n.x.units),o=Zu.create(t.y.value+e*(n.y.value-t.y.value),n.y.units);return new Xs(i,o)};return Object.setPrototypeOf(r,Ys.prototype),Object.defineProperty(r,0,{value:e.x.units===t.x.units&&e.y.units===t.y.units?e:new Xs(e.x.to(t.x.units),e.y.to(t.y.units)),enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Ys.prototype=Object.create($e.prototype);var Gs=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.identOutput=t,u.xParser=r,u.yParser=n,u.zParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.identOutput,this.xParser,this.yParser,this.zParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===u&&(u=1);var s=0;if(1===u){for(r=r||re.stringOutput();e.isCont()&&(s=e.head(),re.isAlpha(s)||re.isDigit(s)||45===s);)e=e.step(),r.write(s);if(!e.isEmpty())switch(a=r.bind()){case"translate3d":case"translateX":case"translateY":case"translate":u=2;break;default:return we.error(oe.message("unknown transform function: "+a,e))}}if(2===u){for(;e.isCont()&&(s=e.head(),re.isSpace(s));)e=e.step();if(e.isCont()&&40===s)e.step(),u=3;else if(!e.isEmpty())return we.error(oe.expected("(",e))}if(3===u){if(void 0===n){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(n=os.parse(e,"px"))}else n=n.feed(e);if(void 0!==n)if(n.isDone())u=4;else if(n.isError())return n.asError()}if(4===u){for(;e.isCont()&&re.isSpace(e.head());)e.step();if(e.isCont())if(41===(s=e.head())){switch(e.step(),a=r.bind()){case"translateX":return we.done(new Xs(n.bind(),Ju.zero()));case"translateY":return we.done(new Xs(Ju.zero(),n.bind()));default:return we.error(oe.message("unknown transform function: "+a,e))}}else{if(44!==s)return we.error(oe.expected(",",e));e.step(),u=5}else if(e.isDone())return we.error(oe.unexpected(e))}if(5===u){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(i=os.parse(e,"px"))}else i=i.feed(e);if(void 0!==i)if(i.isDone())u=6;else if(i.isError())return i.asError()}if(6===u){for(;e.isCont()&&re.isSpace(e.head());)e.step();if(e.isCont())if(41===(s=e.head())){switch(e.step(),a=r.bind()){case"translate":return we.done(new Xs(n.bind(),i.bind()));default:return we.error(oe.message("unknown transform function: "+a,e))}}else{if(44!==s)return we.error(oe.expected(",",e));e.step(),u=7}else if(e.isDone())return we.error(oe.unexpected(e))}if(7===u){if(void 0===o){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(o=os.parse(e,"px"))}else o=o.feed(e);if(void 0!==o)if(o.isDone())u=8;else if(o.isError())return o.asError()}if(8===u){for(;e.isCont()&&re.isSpace(e.head());)e.step();var a;if(e.isCont()&&41===e.head())switch(e.step(),a=r.bind()){case"translate3d":if(0===o.bind().value)return we.done(new Xs(n.bind(),i.bind()));default:return we.error(oe.message("unknown transform function: "+a,e))}else if(!e.isEmpty())return we.error(oe.expected(")",e))}return new t(r,n,i,o,u)},t.parseRest=function(e,r){return t.parse(e,r,void 0,void 0,void 0,2)},t}(we),_s=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"x",{value:t,enumerable:!0}),Object.defineProperty(n,"y",{value:r,enumerable:!0}),Object.defineProperty(n,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.transform=function(e,t){return 1===arguments.length?e instanceof Hs?this:Ks.list(this,e):new bs(this.x*e,this.y*t)},t.prototype.transformX=function(e,t){return this.x*e},t.prototype.transformY=function(e,t){return this.y*t},t.prototype.inverse=function(){return new t(1/(this.x||1),1/(this.y||1))},t.prototype.toAffine=function(){return new ia(this.x,0,0,this.y,0,0)},t.prototype.toCssTransformComponent=function(){return"undefined"!=typeof CSSTranslate?new CSSScale(this.x,this.y):null},t.prototype.toValue=function(){return or.create(1).attr("scale",or.create(2).slot("x",this.x).slot("y",this.y))},t.prototype.interpolateTo=function(r){return r instanceof t?Qs(this,r):e.prototype.interpolateTo.call(this,r)},t.prototype.conformsTo=function(e){return e instanceof t},t.prototype.equivalentTo=function(e,r){return e instanceof t&&(b.equivalent(this.x,e.x,r)&&b.equivalent(this.y,e.y,r))},t.prototype.equals=function(e){return e instanceof t&&(this.x===e.x&&this.y===e.y)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),b.hash(this.x)),b.hash(this.y)))},t.prototype.debug=function(e){return e=e.write("Transform").write(46).write("scale"),e=(e=0!==this.x&&0===this.y?e.write("X").write(40).debug(this.x):0===this.x&&0!==this.y?e.write("Y").write(40).debug(this.y):e.write(40).debug(this.x).write(", ").debug(this.y)).write(41)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=0!==this.x&&0===this.y?"scaleX("+this.x+")":0===this.x&&0!==this.y?"scaleY("+this.y+")":"scale("+this.x+","+this.y+")",Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t.fromCssTransformComponent=function(e){return new t("number"==typeof e.x?e.x:e.x.to("number").value,"number"==typeof e.y?e.y:e.y.to("number").value)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=e.header("scale");if(r.isDefined()){var n=0,i=0;return r.forEach((function(e,t){var r=e.key.stringValue();void 0!==r?"x"===r?n=e.toValue().numberValue(n):"y"===r&&(i=e.toValue().numberValue(i)):e instanceof ir&&(0===t?n=e.numberValue(n):1===t&&(i=e.numberValue(i)))}),this),new t(n,i)}return null},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=Zs.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},t}(Ks),Qs=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.x+e*(n.x-t.x),o=t.y+e*(n.y-t.y);return new _s(i,o)};return Object.setPrototypeOf(r,Qs.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Qs.prototype=Object.create($e.prototype);var Zs=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.identOutput=t,o.xParser=r,o.yParser=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.identOutput,this.xParser,this.yParser,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o){for(r=r||re.stringOutput();e.isCont()&&(u=e.head(),re.isAlpha(u));)e=e.step(),r.write(u);if(!e.isEmpty())switch(s=r.bind()){case"scaleX":case"scaleY":case"scale":o=2;break;default:return we.error(oe.message("unknown transform function: "+s,e))}}if(2===o){for(;e.isCont()&&(u=e.head(),re.isSpace(u));)e=e.step();if(e.isCont()&&40===u)e.step(),o=3;else if(!e.isEmpty())return we.error(oe.expected("(",e))}if(3===o){if(void 0===n){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(n=ie.parseNumber(e))}else n=n.feed(e);if(void 0!==n)if(n.isDone())o=4;else if(n.isError())return n.asError()}if(4===o){for(;e.isCont()&&re.isSpace(e.head());)e.step();if(e.isCont())if(41===(u=e.head())){switch(e.step(),s=r.bind()){case"scaleX":return we.done(new _s(n.bind(),1));case"scaleY":return we.done(new _s(1,n.bind()));default:return we.error(oe.message("unknown transform function: "+s,e))}}else{if(44!==u)return we.error(oe.expected(",",e));e.step(),o=5}else if(e.isDone())return we.error(oe.unexpected(e))}if(5===o){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(i=ie.parseNumber(e))}else i=i.feed(e);if(void 0!==i)if(i.isDone())o=6;else if(i.isError())return i.asError()}if(6===o){for(;e.isCont()&&re.isSpace(e.head());)e.step();var s;if(e.isCont()&&41===e.head())switch(e.step(),s=r.bind()){case"scale":return we.done(new _s(n.bind(),i.bind()));default:return we.error(oe.message("unknown transform function: "+s,e))}else if(!e.isEmpty())return we.error(oe.expected(")",e))}return new t(r,n,i,o)},t.parseRest=function(e,r){return t.parse(e,r,void 0,void 0,2)},t}(we),Js=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"angle",{value:t,enumerable:!0}),Object.defineProperty(r,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.transform=function(e,t){if(1===arguments.length)return e instanceof Hs?this:Ks.list(this,e);var r=this.angle.radValue(),n=Math.cos(r),i=Math.sin(r);return new bs(e*n-t*i,e*i+t*n)},t.prototype.transformX=function(e,t){var r=this.angle.radValue();return e*Math.cos(r)-t*Math.sin(r)},t.prototype.transformY=function(e,t){var r=this.angle.radValue();return e*Math.sin(r)+t*Math.cos(r)},t.prototype.inverse=function(){return new t(this.angle.negative())},t.prototype.toAffine=function(){var e=this.angle.radValue();return new ia(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0)},t.prototype.toCssTransformComponent=function(){if("undefined"!=typeof CSSTranslate){var e=this.angle.toCssValue();return new CSSRotate(e)}return null},t.prototype.toValue=function(){return or.create(1).attr("rotate",this.angle.toString())},t.prototype.interpolateTo=function(r){return r instanceof t?$s(this,r):e.prototype.interpolateTo.call(this,r)},t.prototype.conformsTo=function(e){return e instanceof t},t.prototype.equivalentTo=function(e,r){return e instanceof t&&this.angle.equivalentTo(e.angle,r)},t.prototype.equals=function(e){return e instanceof t&&this.angle.equals(e.angle)},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(t),this.angle.hashCode()))},t.prototype.debug=function(e){return e=e.write("Transform").write(46).write("rotate").write(40).debug(this.angle).write(41)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e="rotate("+this.angle+")",Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t.prototype.toAttributeString=function(){return"rotate("+this.angle.degValue()+")"},t.fromCssTransformComponent=function(e){return new t(us.fromCssValue(e.angle))},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=e.header("rotate");if(r.isDefined()){var n=us.zero();return r.forEach((function(e,t){"angle"===e.key.stringValue()?n=e.toValue().cast(us.form(),n):e instanceof ir&&0===t&&(n=e.cast(us.form(),n))}),this),new t(n)}return null},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=ea.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},t}(Ks),$s=function(e,t){var r=function(e){var t=r[0],n=r[1],i=us.create(t.angle.value+e*(n.angle.value-t.angle.value),n.angle.units);return new Js(i)};return Object.setPrototypeOf(r,$s.prototype),Object.defineProperty(r,0,{value:e.angle.units===t.angle.units?e:new Js(e.angle.to(t.angle.units)),enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};$s.prototype=Object.create($e.prototype);var ea=function(e){function t(t,r,n){var i=e.call(this)||this;return i.identOutput=t,i.angleParser=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.identOutput,this.angleParser,this.step)},t.parse=function(e,r,n,i){void 0===i&&(i=1);var o=0;if(1===i){for(r=r||re.stringOutput();e.isCont()&&(o=e.head(),re.isAlpha(o));)e=e.step(),r.write(o);if(!e.isEmpty())switch(u=r.bind()){case"rotate":i=2;break;default:return we.error(oe.message("unknown transform function: "+u,e))}}if(2===i){for(;e.isCont()&&(o=e.head(),re.isSpace(o));)e=e.step();if(e.isCont()&&40===o)e.step(),i=3;else if(!e.isEmpty())return we.error(oe.expected("(",e))}if(3===i){if(void 0===n){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(n=hs.parse(e,"deg"))}else n=n.feed(e);if(void 0!==n)if(n.isDone())i=4;else if(n.isError())return n.asError()}if(4===i){for(;e.isCont()&&re.isSpace(e.head());)e.step();var u;if(e.isCont()&&41===e.head())switch(e.step(),u=r.bind()){case"rotate":return we.done(new Js(n.bind()));default:return we.error(oe.message("unknown transform function: "+u,e))}else if(!e.isEmpty())return we.error(oe.expected(")",e))}return new t(r,n,i)},t.parseRest=function(e,r){return t.parse(e,r,void 0,2)},t}(we),ta=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"x",{value:t,enumerable:!0}),Object.defineProperty(n,"y",{value:r,enumerable:!0}),Object.defineProperty(n,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.transform=function(e,t){return 1===arguments.length?e instanceof Hs?this:Ks.list(this,e):new bs(Math.tan(this.x.radValue())*t+e,Math.tan(this.y.radValue())*e+t)},t.prototype.transformX=function(e,t){return Math.tan(this.x.radValue())*t+e},t.prototype.transformY=function(e,t){return Math.tan(this.y.radValue())*e+t},t.prototype.inverse=function(){return new t(this.x.negative(),this.y.negative())},t.prototype.toAffine=function(){var e=this.x.radValue(),t=this.y.radValue();return new ia(1,Math.tan(t),Math.tan(e),1,0,0)},t.prototype.toCssTransformComponent=function(){if("undefined"!=typeof CSSTranslate){var e=this.x.toCssValue(),t=this.y.toCssValue();return new CSSSkew(e,t)}return null},t.prototype.toValue=function(){return or.create(1).attr("skew",or.create(2).slot("x",this.x.toValue()).slot("y",this.y.toValue()))},t.prototype.interpolateTo=function(r){return r instanceof t?ra(this,r):e.prototype.interpolateTo.call(this,r)},t.prototype.conformsTo=function(e){return e instanceof t},t.prototype.equivalentTo=function(e,r){return e instanceof t&&(this.x.equivalentTo(e.x,r)&&this.y.equivalentTo(e.y,r))},t.prototype.equals=function(e){return e instanceof t&&(this.x.equals(e.x)&&this.y.equals(e.y))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),this.x.hashCode()),this.y.hashCode()))},t.prototype.debug=function(e){return e=e.write("Transform").write(46).write("skew"),e=(e=this.x.isDefined()&&!this.y.isDefined()?e.write("X").write(40).debug(this.x):!this.x.isDefined()&&this.y.isDefined()?e.write("Y").write(40).debug(this.y):e.write(40).debug(this.x).write(", ").debug(this.y)).write(41)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e=this.x.isDefined()&&!this.y.isDefined()?"skewX("+this.x+")":!this.x.isDefined()&&this.y.isDefined()?"skewY("+this.y+")":"skew("+this.x+","+this.y+")",Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t.prototype.toAttributeString=function(){return this.x.isDefined()&&!this.y.isDefined()?"skewX("+this.x.degValue()+")":!this.x.isDefined()&&this.y.isDefined()?"skewY("+this.y.degValue()+")":"skew("+this.x.degValue()+","+this.y.degValue()+")"},t.fromCssTransformComponent=function(e){return new t("number"==typeof e.ax?us.rad(e.ax):us.fromCssValue(e.ax),"number"==typeof e.ay?us.rad(e.ay):us.fromCssValue(e.ay))},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=e.header("skew");if(r.isDefined()){var n=us.zero(),i=us.zero();return r.forEach((function(e,t){var r=e.key.stringValue();void 0!==r?"x"===r?n=e.toValue().cast(us.form(),n):"y"===r&&(i=e.toValue().cast(us.form(),i)):e instanceof ir&&(0===t?n=e.cast(us.form(),n):1===t&&(i=e.cast(us.form(),i)))}),this),new t(n,i)}return null},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=na.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},t}(Ks),ra=function(e,t){var r=function(e){var t=r[0],n=r[1],i=us.create(t.x.value+e*(n.x.value-t.x.value),n.x.units),o=us.create(t.y.value+e*(n.y.value-t.y.value),n.y.units);return new ta(i,o)};return Object.setPrototypeOf(r,ra.prototype),Object.defineProperty(r,0,{value:e.x.units===t.x.units&&e.y.units===t.y.units?e:new ta(e.x.to(t.x.units),e.y.to(t.y.units)),enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};ra.prototype=Object.create($e.prototype);var na=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.identOutput=t,o.xParser=r,o.yParser=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.identOutput,this.xParser,this.yParser,this.step)},t.parse=function(e,r,n,i,o){void 0===o&&(o=1);var u=0;if(1===o){for(r=r||re.stringOutput();e.isCont()&&(u=e.head(),re.isAlpha(u));)e=e.step(),r.write(u);if(!e.isEmpty())switch(s=r.bind()){case"skewX":case"skewY":case"skew":o=2;break;default:return we.error(oe.message("unknown transform function: "+s,e))}}if(2===o){for(;e.isCont()&&(u=e.head(),re.isSpace(u));)e=e.step();if(e.isCont()&&40===u)e.step(),o=3;else if(!e.isEmpty())return we.error(oe.expected("(",e))}if(3===o){if(void 0===n){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(n=hs.parse(e,"deg"))}else n=n.feed(e);if(void 0!==n)if(n.isDone())o=4;else if(n.isError())return n.asError()}if(4===o){for(;e.isCont()&&re.isSpace(e.head());)e.step();if(e.isCont())if(41===(u=e.head())){switch(e.step(),s=r.bind()){case"skewX":return we.done(new ta(n.bind(),ss.zero()));case"skewY":return we.done(new ta(ss.zero(),n.bind()));default:return we.error(oe.message("unknown transform function: "+s,e))}}else{if(44!==u)return we.error(oe.expected(",",e));e.step(),o=5}else if(e.isDone())return we.error(oe.unexpected(e))}if(5===o){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(i=hs.parse(e,"deg"))}else i=i.feed(e);if(void 0!==i)if(i.isDone())o=6;else if(i.isError())return i.asError()}if(6===o){for(;e.isCont()&&re.isSpace(e.head());)e.step();var s;if(e.isCont()&&41===e.head())switch(e.step(),s=r.bind()){case"skew":return we.done(new ta(n.bind(),i.bind()));default:return we.error(oe.message("unknown transform function: "+s,e))}else if(!e.isEmpty())return we.error(oe.expected(")",e))}return new t(r,n,i,o)},t.parseRest=function(e,r){return t.parse(e,r,void 0,void 0,2)},t}(we),ia=function(e){function t(t,r,n,i,o,u){var s=e.call(this)||this;return Object.defineProperty(s,"x0",{value:t,enumerable:!0}),Object.defineProperty(s,"y0",{value:r,enumerable:!0}),Object.defineProperty(s,"x1",{value:n,enumerable:!0}),Object.defineProperty(s,"y1",{value:i,enumerable:!0}),Object.defineProperty(s,"tx",{value:o,enumerable:!0}),Object.defineProperty(s,"ty",{value:u,enumerable:!0}),Object.defineProperty(s,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),s}return C(t,e),t.prototype.transform=function(e,t){return 1===arguments.length?e instanceof Hs?this:this.multiply(e.toAffine()):new bs(this.x0*e+this.x1*t+this.tx,this.y0*e+this.y1*t+this.ty)},t.prototype.transformX=function(e,t){return this.x0*e+this.x1*t+this.tx},t.prototype.transformY=function(e,t){return this.y0*e+this.y1*t+this.ty},t.prototype.inverse=function(){var e=this.x0,r=this.y0,n=this.x1,i=this.y1,o=this.tx,u=this.ty,s=e*i-n*r;if(Math.abs(s)>=Number.MIN_VALUE)return new t(i/s,-r/s,-n/s,e/s,(n*u-i*o)/s,(r*o-e*u)/s);throw new Error("non-invertible affine transform with determinant "+s)},t.prototype.multiply=function(e){return new t(this.x0*e.x0+this.x1*e.y0,this.y0*e.x0+this.y1*e.y0,this.x0*e.x1+this.x1*e.y1,this.y0*e.x1+this.y1*e.y1,this.x0*e.tx+this.x1*e.ty,this.y0*e.tx+this.y1*e.ty)},t.prototype.toAffine=function(){return this},t.prototype.toMatrix=function(){return new DOMMatrix([this.x0,this.y0,this.x1,this.y1,this.tx,this.ty])},t.prototype.toCssTransformComponent=function(){return"undefined"!=typeof CSSTranslate?new CSSMatrixComponent(this.toMatrix()):null},t.prototype.toValue=function(){return or.create(1).attr("matrix",or.create(6).item(this.x0).item(this.y0).item(this.x1).item(this.y1).item(this.tx).item(this.ty))},t.prototype.interpolateTo=function(r){return r instanceof t?oa(this,r):e.prototype.interpolateTo.call(this,r)},t.prototype.conformsTo=function(e){return e instanceof t},t.prototype.equivalentTo=function(e,r){return e instanceof t&&(b.equivalent(this.x0,e.x0,r)&&b.equivalent(this.y0,e.y0,r)&&b.equivalent(this.x1,e.x1,r)&&b.equivalent(this.y1,e.y1,r)&&b.equivalent(this.tx,e.tx,r)&&b.equivalent(this.ty,e.ty,r))},t.prototype.equals=function(e){return e instanceof t&&(this.x0===e.x0&&this.y0===e.y0&&this.x1===e.x1&&this.y1===e.y1&&this.tx===e.tx&&this.ty===e.ty)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.x0)),b.hash(this.y0)),b.hash(this.x1)),b.hash(this.y1)),b.hash(this.tx)),b.hash(this.ty)))},t.prototype.debug=function(e){return e=e.write("Transform").write(46).write("affine").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.tx).write(", ").debug(this.ty).write(41)},t.prototype.toString=function(){var e=this.stringValue;return void 0===e&&(e="matrix("+this.x0+","+this.y0+","+this.x1+","+this.y1+","+this.tx+","+this.ty+")",Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})),e},t.identity=function(){return new t(1,0,0,1,0,0)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromMatrix=function(e){return new t(e.a,e.b,e.c,e.d,e.e,e.f)},t.fromCssTransformComponent=function(e){return t.fromMatrix(e.matrix)},t.fromValue=function(e){var r=e.header("matrix");if(r.isDefined()){var n=0,i=0,o=0,u=0,s=0,a=0;return r.forEach((function(e,t){var r=e.key.stringValue();if(void 0!==r)"x0"===r?n=e.toValue().numberValue(n):"y0"===r?i=e.toValue().numberValue(i):"x1"===r?o=e.toValue().numberValue(o):"y1"===r?u=e.toValue().numberValue(u):"tx"===r?s=e.toValue().numberValue(s):"ty"===r&&(a=e.toValue().numberValue(a));else if(e instanceof ir)switch(t){case 0:n=e.numberValue(n);break;case 1:i=e.numberValue(i);break;case 2:o=e.numberValue(o);break;case 3:u=e.numberValue(u);break;case 4:s=e.numberValue(s);break;case 5:a=e.numberValue(a)}}),this),new t(n,i,o,u,s,a)}return null},t.parse=function(e){for(var t=re.stringInput(e);t.isCont()&&re.isWhitespace(t.head());)t=t.step();var r=ua.parse(t);if(r.isDone())for(;t.isCont()&&re.isWhitespace(t.head());)t=t.step();return t.isCont()&&!r.isError()&&(r=we.error(oe.unexpected(t))),r.bind()},E([s],t,"identity",null),t}(Ks),oa=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.x0+e*(n.x0-t.x0),o=t.y0+e*(n.y0-t.y0),u=t.x1+e*(n.x1-t.x1),s=t.y1+e*(n.y1-t.y1),a=t.tx+e*(n.tx-t.tx),p=t.ty+e*(n.ty-t.ty);return new ia(i,o,u,s,a,p)};return Object.setPrototypeOf(r,oa.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};oa.prototype=Object.create($e.prototype);var ua=function(e){function t(t,r,n,i){var o=e.call(this)||this;return o.identOutput=t,o.entries=r,o.entryParser=n,o.step=i,o}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.identOutput,this.entries,this.entryParser,this.step)},t.parse=function(e,r,n,i,o){void 0===n&&(n=[]),void 0===o&&(o=1);var u=0;if(1===o){for(r=r||re.stringOutput();e.isCont()&&(u=e.head(),re.isAlpha(u));)e=e.step(),r.write(u);if(!e.isEmpty())switch(s=r.bind()){case"matrix":o=2;break;default:return we.error(oe.message("unknown transform function: "+s,e))}}if(2===o){for(;e.isCont()&&(u=e.head(),re.isSpace(u));)e=e.step();if(e.isCont()&&40===u)e.step(),o=3;else if(!e.isEmpty())return we.error(oe.expected("(",e))}for(;;){if(3===o){if(void 0===i){for(;e.isCont()&&re.isSpace(e.head());)e.step();e.isEmpty()||(i=ie.parseNumber(e))}else i=i.feed(e);if(void 0!==i)if(i.isDone())n.push(i.bind()),i=void 0,o=4;else if(i.isError())return i.asError()}if(4===o){for(;e.isCont()&&re.isSpace(e.head());)e.step();if(e.isCont()){if(41!==(u=e.head())){if(n.length>=6)return we.error(oe.expected(")",e));if(44===u){e.step(),o=3;continue}return we.error(oe.expected(",",e))}var s;switch(e.step(),s=r.bind()){case"matrix":return we.done(Ks.affine.apply(Ks,n));default:return we.error(oe.message("unknown transform function: "+s,e))}}else if(e.isDone())return we.error(oe.unexpected(e))}break}return new t(r,n,i,o)},t.parseRest=function(e,r){return t.parse(e,r,void 0,void 0,2)},t}(we),sa=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"transforms",{value:t,enumerable:!0}),Object.defineProperty(r,"stringValue",{value:void 0,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.transform=function(e,t){if(1===arguments.length)return e instanceof Hs?this:Ks.list(this,e);for(var r=this.transforms,n=0,i=r.length;n<i;n+=1){var o=r[n],u=o.transformX(e,t),s=o.transformY(e,t);e=u,t=s}return new bs(e,t)},t.prototype.transformX=function(e,t){for(var r=this.transforms,n=0,i=r.length;n<i;n+=1){var o=r[n],u=o.transformX(e,t),s=o.transformY(e,t);e=u,t=s}return e},t.prototype.transformY=function(e,t){for(var r=this.transforms,n=0,i=r.length;n<i;n+=1){var o=r[n],u=o.transformX(e,t),s=o.transformY(e,t);e=u,t=s}return t},t.prototype.inverse=function(){for(var e=this.transforms,r=e.length,n=new Array(r),i=0;i<r;i+=1)n[i]=e[r-i-1].inverse();return new t(n)},t.prototype.toAffine=function(){for(var e=ia.identity(),t=this.transforms,r=0,n=t.length;r<n;r+=1)e=e.multiply(t[r].toAffine());return e},t.prototype.toCssTransformComponent=function(){return"undefined"!=typeof CSSTranslate?new CSSMatrixComponent(this.toMatrix()):null},t.prototype.toCssValue=function(){if("undefined"!=typeof CSSTransformValue){for(var e=this.transforms,t=e.length,r=new Array(t),n=0,i=e.length;n<i;n+=1){var o=e[n].toCssTransformComponent();if(null===o)return null;r[n]=o}return new CSSTransformValue(r)}return null},t.prototype.toValue=function(){for(var e=this.transforms,t=e.length,r=or.create(t),n=0;n<t;n+=1)r.push(e[n].toValue());return r},t.prototype.interpolateTo=function(r){return r instanceof t?aa(this,r):e.prototype.interpolateTo.call(this,r)},t.prototype.conformsTo=function(e){if(e instanceof t){var r=this.transforms.length;if(r===e.transforms.length){for(var n=0;n<r;n+=1)if(!this.transforms[n].conformsTo(e.transforms[n]))return!1;return!0}}return!1},t.prototype.equivalentTo=function(e,r){if(e instanceof t){var n=this.transforms.length;if(n===e.transforms.length){for(var i=0;i<n;i+=1)if(!this.transforms[i].equivalentTo(e.transforms[i],r))return!1;return!0}}return!1},t.prototype.equals=function(e){if(e instanceof t){var r=this.transforms.length;if(r===e.transforms.length){for(var n=0;n<r;n+=1)if(!this.transforms[n].equals(e.transforms[n]))return!1;return!0}}return!1},t.prototype.hashCode=function(){for(var e=w.hash(t),r=this.transforms,n=0,i=r.length;n<i;n+=1)e=c.mix(e,r[n].hashCode());return c.mash(e)},t.prototype.debug=function(e){e=e.write("Transform").write(46).write("list").write(40);var t=this.transforms,r=t.length;if(r>0){e=e.debug(t[0]);for(var n=1;n<r;n+=1)e=e.write(", ").debug(t[n])}return e=e.write(41)},t.prototype.toString=function(){var e=this.stringValue;if(void 0===e){var t=this.transforms,r=t.length;if(r>0){e=t[0].toString();for(var n=1;n<r;n+=1)e+=" ",e+=t[n].toString()}else e="none";Object.defineProperty(this,"stringValue",{value:e,enumerable:!0,configurable:!0})}return e},t.prototype.toAttributeString=function(){var e=this.transforms,t=e.length;if(t>0){for(var r=e[0].toAttributeString(),n=1;n<t;n+=1)r+=" ",r+=e[n].toAttributeString();return r}return""},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=[];return e.forEach((function(e){var t=Ks.fromValue(e.toValue());null!==t&&r.push(t)}),this),0!==r.length?new t(r):null},t.parse=function(e){var r=Ks.parse(e);return r instanceof t?r:new t([r])},t}(Ks),aa=function(e,t){var r=function(e){for(var t=r.interpolators,n=t.length,i=new Array(n),o=0;o<n;o+=1)i[o]=t[o](e);return new sa(i)};Object.setPrototypeOf(r,aa.prototype);for(var n=e.transforms,i=t.transforms,o=Math.min(n.length,i.length),u=new Array(o),s=0;s<o;s+=1)u[s]=n[s].interpolateTo(i[s]);return Object.defineProperty(r,"interpolators",{value:u,enumerable:!0}),r};aa.prototype=Object.create($e.prototype),Object.defineProperty(aa.prototype,0,{get:function(){for(var e=this.interpolators,t=e.length,r=new Array(t),n=0;n<t;n+=1)r[n]=e[n][0];return new sa(r)},enumerable:!0,configurable:!0}),Object.defineProperty(aa.prototype,1,{get:function(){for(var e=this.interpolators,t=e.length,r=new Array(t),n=0;n<t;n+=1)r[n]=e[n][1];return new sa(r)},enumerable:!0,configurable:!0}),aa.prototype.equals=function(e){if(this===e)return!0;if(e instanceof aa){var t=this.interpolators.length;if(t===e.interpolators.length){for(var r=0;r<t;r+=1)if(!this.interpolators[r].equals(e.interpolators[r]))return!1;return!0}}return!1};var pa=function(e){function t(t,r){var n=e.call(this)||this;return n.transform=t,n.transformParser=r,n}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.transform,this.transformParser)},t.parse=function(e,r,n){for(void 0===r&&(r=Ks.identity());;){if(void 0===n){for(;e.isCont()&&re.isSpace(e.head());)e.step();if(e.isCont())n=Ws.parse(e);else if(e.isDone())return we.done(r)}if(void 0!==n){if((n=n.feed(e)).isDone()){r=r.transform(n.bind()),n=void 0;continue}if(n.isError())return n.asError()}break}return new t(r,n)},t}(we),fa={is:function(e){if(null!=e){var t=e;return"function"==typeof t.project&&"function"==typeof t.unproject}return!1}},ca=function(){function e(){}return e.prototype.union=function(t){return t=e.fromAny(t),new Oa(Math.min(this.lngMin,t.lngMin),Math.min(this.latMin,t.latMin),Math.max(this.lngMax,t.lngMax),Math.max(this.latMax,t.latMax))},Object.defineProperty(e.prototype,"bounds",{get:function(){return new Oa(this.lngMin,this.latMin,this.lngMax,this.latMax)},enumerable:!1,configurable:!0}),e.fromAny=function(t){if(null==t||t instanceof e)return t;if(la.isInit(t))return la.fromInit(t);if(la.isTuple(t))return la.fromTuple(t);if(ya.isInit(t))return ya.fromInit(t);if(Pa.isInit(t))return Pa.fromInit(t);if(Pa.isTuple(t))return Pa.fromTuple(t);if(Oa.isInit(t))return Oa.fromInit(t);throw new TypeError(""+t)},e.isAny=function(t){return t instanceof e||la.isInit(t)||la.isTuple(t)||ya.isInit(t)||Pa.isInit(t)||Oa.isInit(t)},e}(),la=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"lng",{value:t,enumerable:!0}),Object.defineProperty(n,"lat",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.lng)&&isFinite(this.lat)},Object.defineProperty(t.prototype,"lngMin",{get:function(){return this.lng},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMin",{get:function(){return this.lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngMax",{get:function(){return this.lng},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMax",{get:function(){return this.lat},enumerable:!1,configurable:!0}),t.prototype.contains=function(e,r){return"number"==typeof e?this.lng===e&&this.lat===r:(e=ca.fromAny(e))instanceof t?this.lng===e.lng&&this.lat===e.lat:e instanceof ca&&(this.lng<=e.lngMin&&e.lngMax<=this.lng&&this.lat<=e.latMin&&e.latMax<=this.lat)},t.prototype.intersects=function(e){return(e=ca.fromAny(e)).intersects(this)},t.prototype.project=function(e){return e.project(this)},t.prototype.normalized=function(){var e=this.lng,r=this.lat,n=t.normalizeLng(e),i=t.normalizeLat(r);return e===n&&r===i?this:new t(n,i)},t.prototype.toAny=function(){return{lng:this.lng,lat:this.lat}},t.prototype.interpolateTo=function(e){return e instanceof t?ha(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.lng,e.lng,r)&&b.equivalent(this.lat,e.lat,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.lng===e.lng&&this.lat===e.lat)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(t),b.hash(this.lng)),b.hash(this.lat)))},t.prototype.debug=function(e){return e=e.write("GeoPoint").write(46).write("of").write(40).debug(this.lng).write(", ").debug(this.lat).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.origin=function(){return new t(0,0)},t.undefined=function(){return new t(NaN,NaN)},t.of=function(e,r){return new t(e,r)},t.fromInit=function(e){return new t(e.lng,e.lat)},t.fromTuple=function(e){return new t(e[0],e[1])},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);if(t.isTuple(e))return t.fromTuple(e);throw new TypeError(""+e)},t.normalized=function(e,r){return e=t.normalizeLng(e),r=t.normalizeLat(r),new t(e,r)},t.normalizeLng=function(e){return e<-180?e=180-(180-e)%360:e>180&&(e=(e-180)%360-180),e},t.normalizeLat=function(e){return e=Math.min(Math.max(-90+n.Epsilon,e),90-n.Epsilon)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.lng&&"number"==typeof t.lat}return!1},t.isTuple=function(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]},t.isAny=function(e){return e instanceof t||t.isInit(e)||t.isTuple(e)},E([s],t,"origin",null),E([s],t,"undefined",null),t}(ca),ha=function(e,t){var r=function(e){var t,n=r[0],i=n.lng,o=n.lat,u=r[1],s=u.lng,a=u.lat;if(i>0&&s<0&&i-s>180)t=e<(l=(f=180-i)/(f+(p=180+s)))?i+e/l*f:(e-l)/(c=1-l)*p-180;else if(i<0&&s>0&&s-i>180){var p,f,c,l;if(e<(c=(p=180+i)/(p+(f=180-s))))t=i-e/c*p;else t=180-(e-c)/(l=1-c)*f}else t=i+e*(s-i);return new la(t,o+e*(a-o))};return Object.setPrototypeOf(r,ha.prototype),Object.defineProperty(r,0,{value:e.normalized(),enumerable:!0}),Object.defineProperty(r,1,{value:t.normalized(),enumerable:!0}),r};ha.prototype=Object.create($e.prototype);var da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t}(ca),ya=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"lng0",{value:t,enumerable:!0}),Object.defineProperty(o,"lat0",{value:r,enumerable:!0}),Object.defineProperty(o,"lng1",{value:n,enumerable:!0}),Object.defineProperty(o,"lat1",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.lng0)&&isFinite(this.lat0)&&isFinite(this.lng1)&&isFinite(this.lat1)},Object.defineProperty(t.prototype,"lngMin",{get:function(){return Math.min(this.lng0,this.lng1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMin",{get:function(){return Math.min(this.lat0,this.lat1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngMax",{get:function(){return Math.max(this.lng0,this.lng1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMax",{get:function(){return Math.max(this.lat0,this.lat1)},enumerable:!1,configurable:!0}),t.prototype.interpolateLng=function(e){return(1-e)*this.lng0+e*this.lng1},t.prototype.interpolateLat=function(e){return(1-e)*this.lat0+e*this.lat1},t.prototype.interpolate=function(e){var t=1-e,r=t*this.lng0+e*this.lng1,n=t*this.lat0+e*this.lat1;return new la(r,n)},t.prototype.contains=function(e,r){return"number"==typeof e?Ps.contains(this.lng0,this.lat0,this.lng1,this.lat1,e,r):(e=ca.fromAny(e))instanceof la?this.containsPoint(e):e instanceof t&&this.containsSegment(e)},t.prototype.containsPoint=function(e){return Ps.contains(this.lng0,this.lat0,this.lng1,this.lat1,e.lng,e.lat)},t.prototype.containsSegment=function(e){return Ps.contains(this.lng0,this.lat0,this.lng1,this.lat1,e.lng0,e.lat0)&&Ps.contains(this.lng0,this.lat0,this.lng1,this.lat1,e.lng1,e.lat1)},t.prototype.intersects=function(e){return(e=ca.fromAny(e))instanceof la?this.intersectsPoint(e):e instanceof t?this.intersectsSegment(e):e.intersects(this)},t.prototype.intersectsPoint=function(e){return Ps.contains(this.lng0,this.lat0,this.lng1,this.lat1,e.lng,e.lat)},t.prototype.intersectsSegment=function(e){return Ps.intersects(this.lng0,this.lat0,this.lng1-this.lat0,this.lng1-this.lat0,e.lng0,e.lat0,e.lng1-e.lat0,e.lng1-e.lat0)},t.prototype.split=function(e){var r=1-e,n=r*this.lng0+e*this.lng1,i=r*this.lat0+e*this.lat1;return[new t(this.lng0,this.lat0,n,i),new t(n,i,this.lng1,this.lat1)]},t.prototype.project=function(e){var t=e.project(this.lng0,this.lat0),r=e.project(this.lng1,this.lat1);return new Ps(t.x,t.y,r.x,r.y)},t.prototype.forEachCoord=function(e,t){var r;return void 0!==(r=e.call(t,this.lng0,this.lat0))||void 0!==(r=e.call(t,this.lng1,this.lat1))?r:void 0},t.prototype.forEachCoordRest=function(e,t){var r=e.call(t,this.lng1,this.lat1);if(void 0!==r)return r},t.prototype.toAny=function(){return{lng0:this.lng0,lat0:this.lat0,lng1:this.lng1,lat1:this.lat1}},t.prototype.interpolateTo=function(e){return e instanceof t?va(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.lng0,e.lng0,r)&&b.equivalent(this.lat0,e.lat0,r)&&b.equivalent(this.lng1,e.lng1,r)&&b.equivalent(this.lat1,e.lat1,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.lng0===e.lng0&&this.lat0===e.lat0&&this.lng1===e.lng1&&this.lat1===e.lat1)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.lng0)),b.hash(this.lat0)),b.hash(this.lng1)),b.hash(this.lat1)))},t.prototype.debug=function(e){return e=e.write("GeoSegment").write(46).write("of").write(40).debug(this.lng0).write(", ").debug(this.lat0).write(", ").debug(this.lng1).write(", ").debug(this.lat1).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.of=function(e,r,n,i){return new t(e,r,n,i)},t.fromInit=function(e){return new t(e.lng0,e.lat0,e.lng1,e.lat1)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);throw new TypeError(""+e)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.lng0&&"number"==typeof t.lat0&&"number"==typeof t.lng1&&"number"==typeof t.lat1}return!1},t.isAny=function(e){return e instanceof t||t.isInit(e)},t}(da),va=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.lng0+e*(n.lng0-t.lng0),o=t.lat0+e*(n.lat0-t.lat0),u=t.lng1+e*(n.lng1-t.lng1),s=t.lat1+e*(n.lat1-t.lat1);return new ya(i,o,u,s)};return Object.setPrototypeOf(r,va.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};va.prototype=Object.create($e.prototype);var ba=function(e){function t(t,r){var n=e.call(this)||this;return Object.defineProperty(n,"curves",{value:t,enumerable:!0}),Object.defineProperty(n,"closed",{value:r,enumerable:!0}),Object.defineProperty(n,"boundingBox",{value:null,enumerable:!0,configurable:!0}),n}return C(t,e),t.prototype.isDefined=function(){return 0!==this.curves.length},t.prototype.isClosed=function(){return this.closed},Object.defineProperty(t.prototype,"lngMin",{get:function(){return this.bounds.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMin",{get:function(){return this.bounds.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngMax",{get:function(){return this.bounds.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMax",{get:function(){return this.bounds.latMax},enumerable:!1,configurable:!0}),t.prototype.interpolateLng=function(e){var t=this.curves,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateLng(o)}return NaN},t.prototype.interpolateLat=function(e){var t=this.curves,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateLat(o)}return NaN},t.prototype.interpolate=function(e){var t=this.curves,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolate(o)}return new la(NaN,NaN)},t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.split=function(e){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=r[o].split(u),a=s[0],p=s[1],f=new Array(o+1),c=new Array(n-o),l=0;l<o;l+=1)f[l]=r[l];f[o]=a,c[0]=p;for(l=o+1;l<n;l+=1)c[l-o]=r[l];return[new t(f,!1),new t(c,!1)]}return[t.empty(),t.empty()]},t.prototype.subdivide=function(e){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=r[o].split(u),a=s[0],p=s[1],f=new Array(n+1),c=0;c<o;c+=1)f[c]=r[c];f[o]=a,f[o+1]=p;for(c=o+1;c<n;c+=1)f[c+1]=r[c];return new t(f,this.closed)}return t.empty()},t.prototype.project=function(e){var t=this.curves,r=t.length;if(r>0){var n=0,i=new Array(r),o=t[0];if(o instanceof ya)for(var u=e.project(o.lng0,o.lat0);n<r&&(o=t[n])instanceof ya;){var s=e.project(o.lng1,o.lat1);i[n]=new Ps(u.x,u.y,s.x,s.y),u=s,n+=1}for(;n<r;)o=t[n],i[n]=o.project(e),n+=1;return new Ds(i,this.closed)}return Ds.empty()},Object.defineProperty(t.prototype,"bounds",{get:function(){var e=this.boundingBox;if(null===e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,o=this.curves,u=0,s=o.length;u<s;u+=1){var a=o[u];t=Math.min(t,a.lngMin),r=Math.min(r,a.latMin),n=Math.max(a.lngMax,n),i=Math.max(a.latMax,i)}e=new Oa(t,r,n,i),Object.defineProperty(this,"boundingBox",{value:e,enumerable:!0,configurable:!0})}return e},enumerable:!1,configurable:!0}),t.prototype.forEachCoord=function(e,t){var r=this.curves,n=r.length;if(n>0){var i=r[0],o=i.forEachCoord(e,t);if(void 0!==o)return o;for(var u=1;u<n;u+=1)if(void 0!==(o=(i=r[u]).forEachCoordRest(e,t)))return o}},t.prototype.forEachCoordRest=function(e,t){for(var r=this.curves,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachCoordRest(e,t);if(void 0!==o)return o}},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(x.equivalent(this.curves,e.curves,r)&&this.closed===e.closed)},t.prototype.equals=function(e){return this===e||e instanceof t&&(x.equal(this.curves,e.curves)&&this.closed===e.closed)},t.prototype.debug=function(e){var t=this.curves,r=t.length;if(e=e.write("GeoSpline").write(46),0===r)e=e.write("empty").write(40);else if(0!==r){e=(e=e.write(this.closed?"closed":"open").write(40)).debug(t[0]);for(var n=1;n<r;n+=1)e=e.write(", ").debug(t[n])}return e=e.write(41)},t.prototype.toString=function(){return ne.debug(this)},t.empty=function(){return new t([],!1)},t.open=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e,!1)},t.closed=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e,!0)},t.fromPoints=function(e){var r=e.length;if(r>1){for(var n=new Array(r-1),i=la.fromAny(e[0]),o=i,u=1;u<r;u+=1){var s=la.fromAny(e[u]);n[u-1]=new ya(o.lng,o.lat,s.lng,s.lat),o=s}return new t(n,i.equals(o))}return t.empty()},t.fromAny=function(e){return null==e||e instanceof t?e:t.isPoints(e)?t.fromPoints(e):ca.fromAny(e)},t.builder=function(){return new ma},t.isPoints=function(e){return Array.isArray(e)&&e.length>=2&&la.isAny(e[0])},t.isAnySpline=function(e){return e instanceof t||t.isPoints(e)},t}(da),ma=function(){function e(){this.curves=[],this.closed=!1,this.aliased=!1,this.lng0=0,this.lat0=0,this.lng=0,this.lat=0}return e.prototype.dealias=function(){this.aliased&&(this.curves=this.curves.slice(0),this.aliased=!1)},e.prototype.moveTo=function(e,t){this.aliased?(this.curves=[],this.aliased=!1):this.curves.length=0,this.closed=!1,this.lng0=e,this.lat0=t,this.lng=e,this.lat=t},e.prototype.closePath=function(){this.dealias(),this.curves.push(new ya(this.lng,this.lat,this.lng0,this.lat0)),this.closed=!0,this.lng=this.lng0,this.lat=this.lat0},e.prototype.lineTo=function(e,t){this.dealias(),this.curves.push(new ya(this.lng,this.lat,e,t)),this.lng=e,this.lat=t},e.prototype.bind=function(){return this.aliased=!0,new ba(this.curves,this.closed)},e}(),ga=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"splines",{value:t,enumerable:!0}),Object.defineProperty(r,"boundingBox",{value:null,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.isDefined=function(){return 0!==this.splines.length},Object.defineProperty(t.prototype,"lngMin",{get:function(){return this.bounds.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMin",{get:function(){return this.bounds.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngMax",{get:function(){return this.bounds.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMax",{get:function(){return this.bounds.latMax},enumerable:!1,configurable:!0}),t.prototype.interpolateLng=function(e){var t=this.splines,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateLng(o)}return NaN},t.prototype.interpolateLat=function(e){var t=this.splines,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolateLat(o)}return NaN},t.prototype.interpolate=function(e){var t=this.splines,r=t.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(e/n)),r),o=e*r-i*n;return t[i].interpolate(o)}return new la(NaN,NaN)},t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.split=function(e){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=r[o].split(u),a=s[0],p=s[1],f=new Array(o+1),c=new Array(n-o),l=0;l<o;l+=1)f[l]=r[l];f[o]=a,c[0]=p;for(l=o+1;l<n;l+=1)c[l-o]=r[l];return[new t(f),new t(c)]}return[t.empty(),t.empty()]},t.prototype.subdivide=function(e){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(e/i)),n),u=e*n-o*i,s=new Array(n),a=0;a<o;a+=1)s[a]=r[a];s[o]=r[o].subdivide(u);for(a=o+1;a<n;a+=1)s[a]=r[a];return new t(s)}return t.empty()},t.prototype.project=function(e){var t=this.splines,r=t.length;if(r>0){for(var n=new Array(r),i=0;i<r;i+=1)n[i]=t[i].project(e);return new Vs(n)}return Vs.empty()},Object.defineProperty(t.prototype,"bounds",{get:function(){var e=this.boundingBox;if(null===e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,o=this.splines,u=0,s=o.length;u<s;u+=1){var a=o[u];t=Math.min(t,a.lngMin),r=Math.min(r,a.latMin),n=Math.max(a.lngMax,n),i=Math.max(a.latMax,i)}e=new Oa(t,r,n,i),Object.defineProperty(this,"boundingBox",{value:e,enumerable:!0,configurable:!0})}return e},enumerable:!1,configurable:!0}),t.prototype.centroid=function(){var e=0,t=0,r=0;return this.forEachCoord((function(n,i){e+=n,t+=i,r+=1}),this),0!==r?new la(e/r,t/r):la.undefined()},t.prototype.forEachCoord=function(e,t){for(var r=this.splines,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachCoord(e,t);if(void 0!==o)return o}},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&x.equivalent(this.splines,e.splines,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&x.equal(this.splines,e.splines)},t.prototype.debug=function(e){var t=this.splines,r=t.length;if(e=e.write("GeoPath").write(46),0===r)e=e.write("empty").write(40);else if(1===r){var n=t[0];e=e.write(n.closed?"closed":"open").write(40);var i=n.curves,o=i.length;if(0!==o){e=e.debug(i[0]);for(var u=1;u<o;u+=1)e=e.write(", ").debug(i[u])}}else{e=(e=e.write("of").write(40)).debug(t[0]);for(u=1;u<r;u+=1)e=e.write(", ").debug(t[u])}return e=e.write(41)},t.prototype.toString=function(){return ne.debug(this)},t.empty=function(){return new t([])},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e)},t.open=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t([new ba(e,!1)])},t.closed=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t([new ba(e,!0)])},t.fromPoints=function(e){return new t([ba.fromPoints(e)])},t.fromSplines=function(e){for(var r=e.length,n=new Array(r),i=0;i<r;i+=1)n[i]=ba.fromAny(e[i]);return new t(n)},t.fromAny=function(e){return null==e||e instanceof t?e:t.isSplines(e)?t.fromSplines(e):ba.isAnySpline(e)?t.of(ba.fromAny(e)):ca.fromAny(e)},t.builder=function(){return new wa},t.isSplines=function(e){return Array.isArray(e)&&e.length>0&&ba.isAnySpline(e[0])},t.isAnyPath=function(e){return e instanceof t||t.isSplines(e)},t}(ca),wa=function(){function e(){this.splines=[],this.builder=null}return e.prototype.moveTo=function(e,t){var r=this.builder;if(null!==r){var n=r.bind();n.isDefined()&&this.splines.push(n)}r=new ma,this.builder=r,r.moveTo(e,t)},e.prototype.closePath=function(){var e=this.builder;if(null===e)throw new Error;e.closePath()},e.prototype.lineTo=function(e,t){var r=this.builder;if(null===r)throw new Error;r.lineTo(e,t)},e.prototype.bind=function(){var e=this.splines.slice(0),t=this.builder;if(null!==t){var r=t.bind();r.isDefined()&&e.push(r)}return new ga(e)},e}(),Oa=function(e){function t(t,r,n,i){var o=e.call(this)||this;return Object.defineProperty(o,"lngMin",{value:t,enumerable:!0}),Object.defineProperty(o,"latMin",{value:r,enumerable:!0}),Object.defineProperty(o,"lngMax",{value:n,enumerable:!0}),Object.defineProperty(o,"latMax",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.isDefined=function(){return isFinite(this.lngMin)&&isFinite(this.latMin)&&isFinite(this.lngMax)&&isFinite(this.latMax)},Object.defineProperty(t.prototype,"west",{get:function(){return this.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"south",{get:function(){return this.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"east",{get:function(){return this.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"north",{get:function(){return this.latMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southWest",{get:function(){return new la(this.lngMin,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northWest",{get:function(){return new la(this.lngMin,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southEast",{get:function(){return new la(this.lngMax,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northEast",{get:function(){return new la(this.lngMax,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return new la((this.lngMin+this.lngMax)/2,(this.latMin+this.latMax)/2)},enumerable:!1,configurable:!0}),t.prototype.contains=function(e,r){if("number"==typeof e)return this.lngMin<=e&&e<=this.lngMax&&this.latMin<=r&&r<=this.latMax;if(la.isAny(e))return this.containsPoint(la.fromAny(e));if(ya.isAny(e))return this.containsSegment(ya.fromAny(e));if(Pa.isAny(e))return this.containsTile(Pa.fromAny(e));if(t.isAny(e))return this.containsBox(t.fromAny(e));throw new TypeError(""+e)},t.prototype.containsPoint=function(e){return this.lngMin<=e.lng&&e.lng<=this.lngMax&&this.latMin<=e.lat&&e.lat<=this.latMax},t.prototype.containsSegment=function(e){return this.lngMin<=e.lng0&&e.lng0<=this.lngMax&&this.latMin<=e.lat0&&e.lat0<=this.latMax&&this.lngMin<=e.lng1&&e.lng1<=this.lngMax&&this.latMin<=e.lat1&&e.lat1<=this.latMax},t.prototype.containsTile=function(e){return this.lngMin<=e.lngMin&&e.lngMax<=this.lngMax&&this.latMin<=e.latMin&&e.latMax<=this.latMax},t.prototype.containsBox=function(e){return this.lngMin<=e.lngMin&&e.lngMax<=this.lngMax&&this.latMin<=e.latMin&&e.latMax<=this.latMax},t.prototype.intersects=function(e){if(la.isAny(e))return this.intersectsPoint(la.fromAny(e));if(ya.isAny(e))return this.intersectsSegment(ya.fromAny(e));if(Pa.isAny(e))return this.intersectsTile(Pa.fromAny(e));if(t.isAny(e))return this.intersectsBox(t.fromAny(e));throw new TypeError(""+e)},t.prototype.intersectsPoint=function(e){return this.lngMin<=e.lng&&e.lng<=this.lngMax&&this.latMin<=e.lat&&e.lat<=this.latMax},t.prototype.intersectsSegment=function(e){var t=this.lngMin,r=this.latMin,n=this.lngMax,i=this.latMax,o=e.lng0,u=e.lat0,s=e.lng1,a=e.lat1;return!(o<t&&s<t||o>n&&s>n||u<r&&a<r||u>i&&a>i)&&(o>t&&o<n&&u>r&&u<i||!!(Ns.intersectsSegment(o-t,s-t,o,u,s,a)&&Ns.hitY>r&&Ns.hitY<i||Ns.intersectsSegment(u-r,a-r,o,u,s,a)&&Ns.hitX>t&&Ns.hitX<n||Ns.intersectsSegment(o-n,s-n,o,u,s,a)&&Ns.hitY>r&&Ns.hitY<i||Ns.intersectsSegment(u-i,a-i,o,u,s,a)&&Ns.hitX>t&&Ns.hitX<n))},t.prototype.intersectsTile=function(e){return this.lngMin<=e.lngMax&&e.lngMin<=this.lngMax&&this.latMin<=e.latMax&&e.latMin<=this.latMax},t.prototype.intersectsBox=function(e){return this.lngMin<=e.lngMax&&e.lngMin<=this.lngMax&&this.latMin<=e.latMax&&e.latMin<=this.latMax},t.prototype.union=function(t){return e.prototype.union.call(this,t)},t.prototype.project=function(e){var t=e.project(this.lngMin,this.latMin),r=e.project(this.lngMax,this.latMax),n=t.x,i=t.y,o=r.x,u=r.y;if(n>o){var s=n;n=o,o=s}if(i>u){var a=i;i=u,u=a}return isFinite(n)||(n=-1/0),isFinite(i)||(i=-1/0),isFinite(o)||(o=1/0),isFinite(u)||(u=1/0),new Ns(n,i,o,u)},Object.defineProperty(t.prototype,"bounds",{get:function(){return this},enumerable:!1,configurable:!0}),t.prototype.toAny=function(){return{lngMin:this.lngMin,latMin:this.latMin,lngMax:this.lngMax,latMax:this.latMax}},t.prototype.interpolateTo=function(e){return e instanceof t?xa(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.lngMin,e.lngMin,r)&&b.equivalent(this.latMin,e.latMin,r)&&b.equivalent(this.lngMax,e.lngMax,r)&&b.equivalent(this.latMax,e.latMax,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.lngMin===e.lngMin&&this.latMin===e.latMin&&this.lngMax===e.lngMax&&this.latMax===e.latMax)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.lngMin)),b.hash(this.latMin)),b.hash(this.lngMax)),b.hash(this.latMax)))},t.prototype.debug=function(e){return e=e.write("GeoBox").write(46).write("of").write(40).debug(this.lngMin).write(", ").debug(this.latMin).write(", ").debug(this.lngMax).write(", ").debug(this.latMax).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.undefined=function(){return new t(1/0,1/0,-1/0,-1/0)},t.globe=function(){return new t(-180,-90,180,90)},t.of=function(e,r,n,i){return void 0===n&&(n=e),void 0===i&&(i=r),new t(e,r,n,i)},t.fromInit=function(e){return new t(e.lngMin,e.latMin,e.lngMax,e.latMax)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);throw new TypeError(""+e)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.lngMin&&"number"==typeof t.latMin&&"number"==typeof t.lngMax&&"number"==typeof t.latMax}return!1},t.isAny=function(e){return e instanceof t||t.isInit(e)},E([s],t,"undefined",null),E([s],t,"globe",null),t}(ca),Pa=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"x",{value:t,enumerable:!0}),Object.defineProperty(i,"y",{value:r,enumerable:!0}),Object.defineProperty(i,"z",{value:n,enumerable:!0}),i}return C(t,e),Object.defineProperty(t.prototype,"lngMin",{get:function(){return t.unprojectX(this.x/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMin",{get:function(){return t.unprojectY(this.y/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngMax",{get:function(){return t.unprojectX((this.x+1)/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMax",{get:function(){return t.unprojectY((this.y+1)/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"west",{get:function(){return this.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"south",{get:function(){return this.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"east",{get:function(){return this.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"north",{get:function(){return this.latMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southWest",{get:function(){return new la(this.lngMin,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northWest",{get:function(){return new la(this.lngMin,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southEast",{get:function(){return new la(this.lngMax,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northEast",{get:function(){return new la(this.lngMax,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return new la((this.lngMin+this.lngMax)/2,(this.latMin+this.latMax)/2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southWestTile",{get:function(){return new t(2*this.x,2*this.y,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northWestTile",{get:function(){return new t(2*this.x,2*this.y+1,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southEastTile",{get:function(){return new t(2*this.x+1,2*this.y,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northEastTile",{get:function(){return new t(2*this.x+1,2*this.y+1,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentTile",{get:function(){return new t(this.x>>1,this.y>>1,this.z-1)},enumerable:!1,configurable:!0}),t.prototype.contains=function(e,r){if("number"==typeof e)return this.lngMin<=e&&e<=this.lngMax&&this.latMin<=r&&r<=this.latMax;if(la.isAny(e))return this.containsPoint(la.fromAny(e));if(ya.isAny(e))return this.containsSegment(ya.fromAny(e));if(t.isAny(e))return this.containsTile(t.fromAny(e));if(Oa.isAny(e))return this.containsBox(Oa.fromAny(e));throw new TypeError(""+e)},t.prototype.containsPoint=function(e){return this.lngMin<=e.lng&&e.lng<=this.lngMax&&this.latMin<=e.lat&&e.lat<=this.latMax},t.prototype.containsSegment=function(e){return this.lngMin<=e.lng0&&e.lng0<=this.lngMax&&this.latMin<=e.lat0&&e.lat0<=this.latMax&&this.lngMin<=e.lng1&&e.lng1<=this.lngMax&&this.latMin<=e.lat1&&e.lat1<=this.latMax},t.prototype.containsTile=function(e){return this.lngMin<=e.lngMin&&e.lngMax<=this.lngMax&&this.latMin<=e.latMin&&e.latMax<=this.latMax},t.prototype.containsBox=function(e){return this.lngMin<=e.lngMin&&e.lngMax<=this.lngMax&&this.latMin<=e.latMin&&e.latMax<=this.latMax},t.prototype.intersects=function(e){if(la.isAny(e))return this.intersectsPoint(la.fromAny(e));if(ya.isAny(e))return this.intersectsSegment(ya.fromAny(e));if(t.isAny(e))return this.intersectsTile(t.fromAny(e));if(Oa.isAny(e))return this.intersectsBox(Oa.fromAny(e));throw new TypeError(""+e)},t.prototype.intersectsPoint=function(e){return this.lngMin<=e.lng&&e.lng<=this.lngMax&&this.latMin<=e.lat&&e.lat<=this.latMax},t.prototype.intersectsSegment=function(e){var t=this.lngMin,r=this.latMin,n=this.lngMax,i=this.latMax,o=e.lng0,u=e.lat0,s=e.lng1,a=e.lat1;return!(o<t&&s<t||o>n&&s>n||u<r&&a<r||u>i&&a>i)&&(o>t&&o<n&&u>r&&u<i||!!(Ns.intersectsSegment(o-t,s-t,o,u,s,a)&&Ns.hitY>r&&Ns.hitY<i||Ns.intersectsSegment(u-r,a-r,o,u,s,a)&&Ns.hitX>t&&Ns.hitX<n||Ns.intersectsSegment(o-n,s-n,o,u,s,a)&&Ns.hitY>r&&Ns.hitY<i||Ns.intersectsSegment(u-i,a-i,o,u,s,a)&&Ns.hitX>t&&Ns.hitX<n))},t.prototype.intersectsTile=function(e){return this.lngMin<=e.lngMax&&e.lngMin<=this.lngMax&&this.latMin<=e.latMax&&e.latMin<=this.latMax},t.prototype.intersectsBox=function(e){return this.lngMin<=e.lngMax&&e.lngMin<=this.lngMax&&this.latMin<=e.latMax&&e.latMin<=this.latMax},t.prototype.project=function(e){var t=e.project(this.lngMin,this.latMin),r=e.project(this.lngMax,this.latMax),n=t.x,i=t.y,o=r.x,u=r.y;if(n>o){var s=n;n=o,o=s}if(i>u){var a=i;i=u,u=a}return isFinite(n)||(n=-1/0),isFinite(i)||(i=-1/0),isFinite(o)||(o=1/0),isFinite(u)||(u=1/0),new Ns(n,i,o,u)},t.prototype.toAny=function(){return{x:this.x,y:this.y,z:this.z}},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(b.equivalent(this.x,e.x,r)&&b.equivalent(this.y,e.y,r)&&b.equivalent(this.z,e.z,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.x===e.x&&this.y===e.y&&this.z===e.z)},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(w.hash(t),b.hash(this.x)),b.hash(this.y)),b.hash(this.z)))},t.prototype.debug=function(e){return e=e.write("GeoTile").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(", ").debug(this.z).write(41)},t.prototype.toString=function(){return ne.debug(this)},t.root=function(){return new t(0,0,0)},t.of=function(e,r,n){return new t(e,r,n)},t.fromInit=function(e){return new t(e.x,e.y,e.z)},t.fromTuple=function(e){return new t(e[0],e[1],e[2])},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);if(t.isTuple(e))return t.fromTuple(e);throw new TypeError(""+e)},t.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.z}return!1},t.isTuple=function(e){return Array.isArray(e)&&3===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]},t.isAny=function(e){return e instanceof t||t.isInit(e)||t.isTuple(e)},t.unprojectX=function(e){return(e*Math.PI*2-Math.PI)*(180/Math.PI)},t.unprojectY=function(e){return(2*Math.atan(Math.exp(e*Math.PI*2-Math.PI))-Math.PI/2)*(180/Math.PI)},E([s],t,"root",null),t}(ca),xa=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.lngMin+e*(n.lngMin-t.lngMin),o=t.latMin+e*(n.latMin-t.latMin),u=t.lngMax+e*(n.lngMax-t.lngMax),s=t.latMax+e*(n.latMax-t.latMax);return new Oa(i,o,u,s)};return Object.setPrototypeOf(r,xa.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};xa.prototype=Object.create($e.prototype);var ja=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"shapes",{value:t,enumerable:!0}),Object.defineProperty(r,"boundingBox",{value:null,enumerable:!0,configurable:!0}),r}return C(t,e),t.prototype.isDefined=function(){return 0!==this.shapes.length},Object.defineProperty(t.prototype,"lngMin",{get:function(){return this.bounds.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMin",{get:function(){return this.bounds.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lngMax",{get:function(){return this.bounds.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"latMax",{get:function(){return this.bounds.latMax},enumerable:!1,configurable:!0}),t.prototype.contains=function(e,t){return!1},t.prototype.intersects=function(e){return!1},t.prototype.project=function(e){var t=this.shapes,r=t.length;if(r>0){for(var n=new Array(r),i=0;i<r;i+=1)n[i]=t[i].project(e);return new Ls(n)}return Ls.empty()},Object.defineProperty(t.prototype,"bounds",{get:function(){var e=this.boundingBox;if(null===e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,o=this.shapes,u=0,s=o.length;u<s;u+=1){var a=o[u];t=Math.min(t,a.lngMin),r=Math.min(r,a.latMin),n=Math.max(a.lngMax,n),i=Math.max(a.latMax,i)}e=new Oa(t,r,n,i),Object.defineProperty(this,"boundingBox",{value:e,enumerable:!0,configurable:!0})}return e},enumerable:!1,configurable:!0}),t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&x.equivalent(this.shapes,e.shapes,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&x.equal(this.shapes,e.shapes)},t.prototype.debug=function(e){var t=this.shapes,r=t.length;if(e=e.write("GeoGroup").write(46),0===r)e=e.write("empty").write(40);else{e=(e=e.write("of").write(40)).debug(t[0]);for(var n=1;n<r;n+=1)e=e.write(", ").debug(t[n])}return e=e.write(41)},t.prototype.toString=function(){return ne.debug(this)},t.empty=function(){return new t(x.empty)},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new t(e)},E([s],t,"empty",null),t}(ca),Ca={is:function(e){return Ea.is(e)||Va.is(e)||qa.is(e)},toShape:function(e){return"Feature"===e.type?Va.toShape(e):"FeatureCollection"===e.type?qa.toShapes(e):Ea.toShape(e)}},Ea={is:function(e){if("object"==typeof e&&null!==e){var t=e;return("Point"===t.type||"MultiPoint"===t.type||"LineString"===t.type||"MultiLineString"===t.type||"Polygon"===t.type||"MultiPolygon"===t.type)&&Array.isArray(t.coordinates)||"GeometryCollection"===t.type&&Array.isArray(t.geometries)}return!1},toShape:function(e){if("Point"===e.type)return Sa.toShape(e);if("MultiPoint"===e.type)return ka.toShape(e);if("LineString"===e.type)return Ma.toShape(e);if("MultiLineString"===e.type)return Aa.toShape(e);if("Polygon"===e.type)return Da.toShape(e);if("MultiPolygon"===e.type)return Ia.toShape(e);if("GeometryCollection"===e.type)return Ta.toShape(e);throw new TypeError(""+e)}},Sa={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"Point"===t.type&&Array.isArray(t.coordinates)}return!1},toShape:function(e){var t=e.coordinates;return new la(t[0],t[1])}},ka={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"MultiPoint"===t.type&&Array.isArray(t.coordinates)}return!1},toShape:function(e){for(var t=e.coordinates,r=t.length,n=new Array(r),i=0;i<r;i+=1){var o=t[i];n[i]=new la(o[0],o[1])}return new ja(n)}},Ma={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"LineString"===t.type&&Array.isArray(t.coordinates)}return!1},toShape:function(e){var t=e.coordinates,r=t.length;if(r>0){for(var n=new Array(r-1),i=t[0],o=i[0],u=i[1],s=1;s<r;s+=1)i=t[s],n[s-1]=new ya(o,u,o=i[0],u=i[1]);return new ba(n,!1)}return ba.empty()}},Aa={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"MultiLineString"===t.type&&Array.isArray(t.coordinates)}return!1},toShape:function(e){for(var t=e.coordinates,r=t.length,n=new Array(r),i=0;i<r;i+=1){var o=t[i],u=o.length;if(u>0){for(var s=new Array(u-1),a=o[0],p=a[0],f=a[1],c=1;c<u;c+=1)a=o[c],s[c-1]=new ya(p,f,p=a[0],f=a[1]);n[i]=new ba(s,!1)}else n[i]=ba.empty()}return new ja(n)}},Da={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"Polygon"===t.type&&Array.isArray(t.coordinates)}return!1},toShape:function(e){for(var t=e.coordinates,r=t.length,n=new Array(r),i=0;i<r;i+=1){var o=t[i],u=o.length;if(u>0){for(var s=new Array(u-1),a=o[0],p=a[0],f=a[1],c=1;c<u;c+=1)a=o[c],s[c-1]=new ya(p,f,p=a[0],f=a[1]);n[i]=new ba(s,!0)}else n[i]=ba.empty()}return new ga(n)}},Ia={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"MultiPolygon"===t.type&&Array.isArray(t.coordinates)}return!1},toShape:function(e){for(var t=e.coordinates,r=t.length,n=new Array(r),i=0;i<r;i+=1){for(var o=t[i],u=o.length,s=new Array(u),a=0;a<u;a+=1){var p=o[a],f=p.length;if(f>0){for(var c=new Array(f-1),l=p[0],h=l[0],d=l[1],y=1;y<f;y+=1)l=p[y],c[y-1]=new ya(h,d,h=l[0],d=l[1]);s[a]=new ba(c,!0)}else s[a]=ba.empty()}n[i]=new ga(s)}return new ja(n)}},Ta={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"GeometryCollection"===t.type&&Array.isArray(t.geometries)}return!1},toShape:function(e){for(var t=e.geometries,r=t.length,n=new Array(r),i=0;i<r;i+=1)n[i]=Ea.toShape(t[i]);return new ja(n)}},Va={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"Feature"===t.type&&Ea.is(t.geometry)&&"object"==typeof t.properties}return!1},toShape:function(e){var t=e.geometry;return null!==t?Ea.toShape(t):null}},qa={is:function(e){if("object"==typeof e&&null!==e){var t=e;return"FeatureCollection"===t.type&&Array.isArray(t.features)}return!1},toShapes:function(e){for(var t=e.features,r=t.length,n=new Array(r),i=0;i<r;i+=1)n[i]=Va.toShape(t[i]);return n}},Ra=function(){function e(e,t){Object.defineProperty(this,"name",{value:e,enumerable:!0}),Object.defineProperty(this,"offset",{value:t,enumerable:!0})}return e.prototype.isUTC=function(){return 0===this.offset},e.prototype.isLocal=function(){return this.offset===-(new Date).getTimezoneOffset()},e.prototype.equals=function(t){return this===t||t instanceof e&&this.offset===t.offset},e.prototype.hashCode=function(){return c.mash(c.mix(w.hash(e),b.hash(this.offset)))},e.prototype.debug=function(e){return e=e.write("TimeZone").write(46),e=(e="UTC"===this.name&&0===this.offset?e.write("utc").write(40):void 0===this.name?e.write("forOffset").write(40).debug(this.offset):e.write("create").write(40).debug(this.name).write(", ").debug(this.offset)).write(41)},e.prototype.toString=function(){return ne.debug(this)},Object.defineProperty(e,"utc",{get:function(){return new e("UTC",0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"local",{get:function(){return e.forOffset(-(new Date).getTimezoneOffset())},enumerable:!1,configurable:!0}),e.create=function(t,r){return"UTC"===t&&0===r?e.utc:new e(t,r)},e.forName=function(t){switch(t){case"UTC":return e.utc;default:return null}},e.forOffset=function(t){switch(t){case 0:return e.utc;default:return new e(void 0,t)}},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t){var r=e.forName(t);if(null!==r)return r}else if("number"==typeof t)return e.forOffset(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.stringValue(void 0);if(void 0!==r)return e.forName(r);var n=t.numberValue(void 0);return void 0!==n?e.forOffset(n):null},e.isAny=function(t){return t instanceof e||"string"==typeof t||"number"==typeof t},e.form=function(){return new Ua(e.utc)},E([s],e,"utc",null),E([s],e,"local",null),E([s],e,"form",null),e}(),Ua=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e){var t=(e=Ra.fromAny(e)).name;return void 0!==t?hr.from(t):yr.from(e.offset)},t.prototype.cast=function(e){var t=e.toValue(),r=Ra.fromValue(t);return null!==r?r:void 0},t}(En),Na=function(){function e(e,t){void 0===t&&(t=Ra.utc),Object.defineProperty(this,"time",{value:e,enumerable:!0}),Object.defineProperty(this,"zone",{value:t,enumerable:!0})}return e.prototype.isDefined=function(){return isFinite(new Date(this.time).getTime())},Object.defineProperty(e.prototype,"year",{get:function(){return this.toUTCLocalDate().getUTCFullYear()},enumerable:!1,configurable:!0}),e.prototype.withYear=function(t,r,n,i,o,u,s){var a=this.toUTCLocalDate();return a.setUTCFullYear(t),void 0!==r&&a.setUTCMonth(r),void 0!==n&&a.setUTCDate(n),void 0!==i&&a.setUTCHours(i),void 0!==o&&a.setUTCMinutes(o),void 0!==u&&a.setUTCSeconds(u),void 0!==s&&a.setUTCMilliseconds(s),e.fromUTCLocalDate(a,this.zone)},Object.defineProperty(e.prototype,"month",{get:function(){return this.toUTCLocalDate().getUTCMonth()},enumerable:!1,configurable:!0}),e.prototype.withMonth=function(t,r,n,i,o,u){var s=this.toUTCLocalDate();return s.setUTCMonth(t),void 0!==r&&s.setUTCDate(r),void 0!==n&&s.setUTCHours(n),void 0!==i&&s.setUTCMinutes(i),void 0!==o&&s.setUTCSeconds(o),void 0!==u&&s.setUTCMilliseconds(u),e.fromUTCLocalDate(s,this.zone)},Object.defineProperty(e.prototype,"day",{get:function(){return this.toUTCLocalDate().getUTCDate()},enumerable:!1,configurable:!0}),e.prototype.withDay=function(t,r,n,i,o){var u=this.toUTCLocalDate();return u.setUTCDate(t),void 0!==r&&u.setUTCHours(r),void 0!==n&&u.setUTCMinutes(n),void 0!==i&&u.setUTCSeconds(i),void 0!==o&&u.setUTCMilliseconds(o),e.fromUTCLocalDate(u,this.zone)},Object.defineProperty(e.prototype,"hour",{get:function(){return this.toUTCLocalDate().getUTCHours()},enumerable:!1,configurable:!0}),e.prototype.withHour=function(t,r,n,i){var o=this.toUTCLocalDate();return o.setUTCHours(t),void 0!==r&&o.setUTCMinutes(r),void 0!==n&&o.setUTCSeconds(n),void 0!==i&&o.setUTCMilliseconds(i),e.fromUTCLocalDate(o,this.zone)},Object.defineProperty(e.prototype,"minute",{get:function(){return this.toUTCLocalDate().getUTCMinutes()},enumerable:!1,configurable:!0}),e.prototype.withMinute=function(t,r,n){var i=this.toUTCLocalDate();return i.setUTCMinutes(t),void 0!==r&&i.setUTCSeconds(r),void 0!==n&&i.setUTCMilliseconds(n),e.fromUTCLocalDate(i,this.zone)},Object.defineProperty(e.prototype,"second",{get:function(){return this.toUTCLocalDate().getUTCSeconds()},enumerable:!1,configurable:!0}),e.prototype.withSecond=function(t,r){var n=this.toUTCLocalDate();return n.setUTCSeconds(t),void 0!==r&&n.setUTCMilliseconds(r),e.fromUTCLocalDate(n,this.zone)},Object.defineProperty(e.prototype,"millisecond",{get:function(){return this.toUTCLocalDate().getUTCMilliseconds()},enumerable:!1,configurable:!0}),e.prototype.withMillisecond=function(t){var r=this.toUTCLocalDate();return r.setUTCMilliseconds(t),e.fromUTCLocalDate(r,this.zone)},Object.defineProperty(e.prototype,"weekday",{get:function(){return this.toUTCLocalDate().getUTCDay()},enumerable:!1,configurable:!0}),e.prototype.toUTCLocalDate=function(){return new Date(this.time+6e4*this.zone.offset)},e.prototype.toDate=function(){return new Date(this.time)},e.prototype.valueOf=function(){return this.time},e.prototype.interpolateTo=function(t){return t instanceof e?za(this,t):null},e.prototype.compareTo=function(t){if(t instanceof e){var r=this.time,n=t.time;return r<n?-1:r>n?1:r===n?0:NaN}return NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&b.equivalent(this.time,t.time,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.time===t.time&&this.zone.equals(t.zone))},e.prototype.hashCode=function(){return c.mash(c.mix(c.mix(w.hash(e),b.hash(this.time)),this.zone.hashCode()))},e.prototype.display=function(e,t){return void 0===t&&(t=Wa.iso8601),e=t.writeDate(e,this)},e.prototype.toString=function(e){return void 0===e&&(e=Wa.iso8601),e.format(this)},e.current=function(t){return t=void 0!==t?Ra.fromAny(t):Ra.local,new e(Date.now(),t)},e.fromUTCLocalDate=function(t,r){return new e(t.getTime()-6e4*r.offset,r)},e.fromInit=function(t,r){var n=Date.UTC(void 0!==t.year?t.year:1970,void 0!==t.month?t.month:0,void 0!==t.day?t.day:1,void 0!==t.hour?t.hour:0,void 0!==t.minute?t.minute:0,void 0!==t.second?t.second:0,void 0!==t.millisecond?t.millisecond:0);return void 0!==t.zone&&(r=Ra.fromAny(t.zone)),void 0!==r?n+=6e4*(r=Ra.fromAny(r)).offset:r=Ra.utc,new e(n,r)},e.fromAny=function(t,r){if(null==t||t instanceof e)return t;if(t instanceof Date)return r=void 0!==r?Ra.fromAny(r):Ra.utc,new e(t.getTime(),r);if("number"==typeof t)return new e(t,r=void 0!==r?Ra.fromAny(r):Ra.utc);if("string"==typeof t)return e.parse(t,r);if(e.isInit(t))return e.fromInit(t,r);throw new TypeError(""+t)},e.fromValue=function(t){var r,n=t.header("date");n.isDefined()?(t=n,r=!0):r=!1;var i={};return t.forEach((function(e,t){var n=e.key.stringValue(void 0);void 0!==n?"year"===n?i.year=e.toValue().numberValue(i.year):"month"===n?i.month=e.toValue().numberValue(i.month):"day"===n?i.day=e.toValue().numberValue(i.day):"hour"===n?i.hour=e.toValue().numberValue(i.hour):"minute"===n?i.minute=e.toValue().numberValue(i.minute):"second"===n?i.second=e.toValue().numberValue(i.second):"millisecond"===n?i.millisecond=e.toValue().numberValue(i.millisecond):"zone"===n&&(i.zone=e.toValue().cast(Ra.form(),i.zone)):e instanceof ir&&r&&(0===t?i.year=e.numberValue(i.year):1===t?i.month=e.numberValue(i.month):2===t?i.day=e.numberValue(i.day):3===t?i.hour=e.numberValue(i.hour):4===t?i.minute=e.numberValue(i.minute):5===t?i.second=e.numberValue(i.second):6===t?i.millisecond=e.numberValue(i.millisecond):7===t&&(i.zone=e.cast(Ra.form(),i.zone)))})),e.isInit(i)?e.fromInit(i):null},e.parse=function(e,t){return Wa.iso8601.parse(e)},e.time=function(t){if(t instanceof e)return t.time;if(t instanceof Date)return t.getTime();if("number"==typeof t)return t;if("string"==typeof t)return e.parse(t).time;if(e.isInit(t))return e.fromInit(t).time;throw new TypeError(""+t)},e.zone=function(t){return t instanceof e?t.zone:Ra.utc},e.isInit=function(e){if("object"==typeof e&&null!==e){var t=e;return(void 0===t.year||"number"==typeof t.year)&&(void 0===t.month||"number"==typeof t.month)&&(void 0===t.day||"number"==typeof t.day)&&(void 0===t.hour||"number"==typeof t.hour)&&(void 0===t.minute||"number"==typeof t.minute)&&(void 0===t.second||"number"==typeof t.second)&&(void 0===t.millisecond||"number"==typeof t.millisecond)&&(void 0===t.zone||Ra.isAny(t.zone))&&("number"==typeof t.year||"number"==typeof t.month||"number"==typeof t.day||"number"==typeof t.hour||"number"==typeof t.minute||"number"==typeof t.second||"number"==typeof t.millisecond)}return!1},e.isAny=function(t){return t instanceof e||t instanceof Date||"number"==typeof t||"string"==typeof t||e.isInit(t)},e.form=function(){return new Fa(new e(0))},E([s],e,"form",null),e}(),za=function(e,t){var r=function(e){var t=r[0],n=r[1];return new Na(t.time+e*(n.time-t.time),n.zone)};return Object.setPrototypeOf(r,za.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};za.prototype=Object.create($e.prototype);var Fa=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"unit",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.withUnit=function(e){return e!==this.unit?new t(e):this},t.prototype.mold=function(e){return e=Na.fromAny(e),hr.from(e.toString())},t.prototype.cast=function(e){var t=null;try{if(void 0===(t=Na.fromValue(e))){var r=e.numberValue(void 0);if(void 0!==r)t=new Na(r);else{var n=e.stringValue(void 0);void 0!==n&&(t=Na.parse(n))}}}catch(e){}return null!==t?t:void 0},t}(En),La=function(e){function t(t){var r=e.call(this)||this;return r.dateParser=t,r}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.dateParser)},t.parse=function(e,r){return(r=r.feed(e)).isDone()?we.done(Na.fromAny(r.bind())):r.isError()?r.asError():new t(r)},t}(we),Ka=function(){function e(t,r,n,i,o){void 0===t&&(t=e.Periods),void 0===r&&(r=e.Weekdays),void 0===n&&(n=e.ShortWeekdays),void 0===i&&(i=e.Months),void 0===o&&(o=e.ShortMonths),this.periods=t,this.weekdays=r,this.shortWeekdays=n,this.months=i,this.shortMonths=o}return e.standard=function(){return new e},e.Periods=["AM","PM"],e.Weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.ShortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],e.ShortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],E([s],e,"standard",null),e}(),Ba={standard:function(e){var t;return void 0===e&&(e=Ka.standard()),e===Ka.standard()&&(t=Ba._standard),void 0===t&&(t={Y:Wa.year,m:Wa.monthOfYear,B:Wa.month.withLocale(e),b:Wa.shortMonth.withLocale(e),d:Wa.dayOfMonth,A:Wa.weekday.withLocale(e),a:Wa.shortWeekday.withLocale(e),H:Wa.hour24,I:Wa.hour12,p:Wa.period.withLocale(e),M:Wa.minute,S:Wa.second,L:Wa.millisecond},e===Ka.standard()&&(Ba._standard=t)),t}},Wa=function(){function e(){}return e.prototype.withLocale=function(e){return this},e.prototype.format=function(e){e=Na.fromAny(e);var t=re.stringOutput();return(t=this.writeDate(t,e)).bind()},e.prototype.parse=function(e){for("string"==typeof e&&(e=re.stringInput(e));e.isCont()&&re.isSpace(e.head());)e=e.step();var t=this.parseDate(e,{});if(t.isDone())for(;e.isCont()&&re.isSpace(e.head());)e=e.step();return e.isCont()&&!t.isError()&&(t=we.error(oe.unexpected(e))),t.bind()},e.prototype.parseDate=function(e,t){var r=this.parseDateTime(e,t);return r.isDone()?we.done(Na.fromAny(r.bind())):r.isError()?r.asError():new La(r)},Object.defineProperty(e,"year",{get:function(){return new Ha},enumerable:!1,configurable:!0}),Object.defineProperty(e,"monthOfYear",{get:function(){return new Xa},enumerable:!1,configurable:!0}),Object.defineProperty(e,"month",{get:function(){return new Ya(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"shortMonth",{get:function(){return new Ga(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"dayOfMonth",{get:function(){return new _a},enumerable:!1,configurable:!0}),Object.defineProperty(e,"weekday",{get:function(){return new Qa(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"shortWeekday",{get:function(){return new Za(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"hour24",{get:function(){return new Ja},enumerable:!1,configurable:!0}),Object.defineProperty(e,"hour12",{get:function(){return new $a},enumerable:!1,configurable:!0}),Object.defineProperty(e,"period",{get:function(){return new ep(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"minute",{get:function(){return new tp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"second",{get:function(){return new rp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"millisecond",{get:function(){return new np},enumerable:!1,configurable:!0}),e.pattern=function(e,t){return(void 0===t||t instanceof Ka)&&(t=Ba.standard(t)),new ip(e,t)},Object.defineProperty(e,"iso8601",{get:function(){return new ip("%Y-%m-%dT%H:%M:%S.%LZ",Ba.standard())},enumerable:!1,configurable:!0}),e.parseDateNumber=function(e,t,r,n,i,o,u,s){void 0===u&&(u=0),void 0===s&&(s=0);for(var a=0;s<i&&e.isCont()&&(a=e.head(),ie.isDigit(a));)e.step(),u=10*u+ie.decodeDigit(a),s+=1;return e.isEmpty()?t.cont(void 0!==o?o:{},u,s,e):s>=n?t.term(u,o||{},e):we.error(oe.expected(r,e))},e.parseDateString=function(e,t,r,n,i){var o=0;for(i=void 0!==i?i:re.stringOutput();;){if(!e.isCont()||(o=e.head(),!re.isAlpha(o))){if(!e.isEmpty())return t.term(r,i.bind(),void 0!==n?n:{},e);break}e.step(),i.write(o)}return t.cont(r,void 0!==n?n:{},i,e)},e.writeDateNumber2=function(e,t){var r=48+t%10,n=48+(t/=10)%10;return e=e.write(n).write(r)},e.writeDateNumber3=function(e,t){var r=48+t%10,n=48+(t/=10)%10,i=48+(t/=10)%10;return e=e.write(i).write(n).write(r)},e.writeDateNumber4=function(e,t){var r=48+t%10,n=48+(t/=10)%10,i=48+(t/=10)%10,o=48+(t/=10)%10;return e=e.write(o).write(i).write(n).write(r)},E([s],e,"year",null),E([s],e,"monthOfYear",null),E([s],e,"month",null),E([s],e,"shortMonth",null),E([s],e,"dayOfMonth",null),E([s],e,"weekday",null),E([s],e,"shortWeekday",null),E([s],e,"hour24",null),E([s],e,"hour12",null),E([s],e,"period",null),E([s],e,"minute",null),E([s],e,"second",null),E([s],e,"millisecond",null),E([s],e,"iso8601",null),e}(),Ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){return e=Wa.writeDateNumber4(e,t.year)},t.prototype.parseDateTime=function(e,t){return op.parse(e,t)},t}(Wa),Xa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){return e=Wa.writeDateNumber2(e,t.month+1)},t.prototype.parseDateTime=function(e,t){return up.parse(e,t)},t}(Wa),Ya=function(e){function t(t){var r=e.call(this)||this;return r.locale=t,r}return C(t,e),t.prototype.withLocale=function(e){return e!==this.locale?new t(e):this},t.prototype.writeDate=function(e,t){return e=e.write(this.locale.months[t.month])},t.prototype.parseDateTime=function(e,t){return sp.parse(e,this.locale,t)},t}(Wa),Ga=function(e){function t(t){var r=e.call(this)||this;return r.locale=t,r}return C(t,e),t.prototype.withLocale=function(e){return e!==this.locale?new t(e):this},t.prototype.writeDate=function(e,t){return e=e.write(this.locale.shortMonths[t.month])},t.prototype.parseDateTime=function(e,t){return ap.parse(e,this.locale,t)},t}(Wa),_a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){return e=Wa.writeDateNumber2(e,t.day)},t.prototype.parseDateTime=function(e,t){return pp.parse(e,t)},t}(Wa),Qa=function(e){function t(t){var r=e.call(this)||this;return r.locale=t,r}return C(t,e),t.prototype.withLocale=function(e){return e!==this.locale?new t(e):this},t.prototype.writeDate=function(e,t){return e=e.write(this.locale.weekdays[t.weekday])},t.prototype.parseDateTime=function(e,t){return fp.parse(e,this.locale,t)},t}(Wa),Za=function(e){function t(t){var r=e.call(this)||this;return r.locale=t,r}return C(t,e),t.prototype.withLocale=function(e){return e!==this.locale?new t(e):this},t.prototype.writeDate=function(e,t){return e=e.write(this.locale.shortWeekdays[t.weekday])},t.prototype.parseDateTime=function(e,t){return cp.parse(e,this.locale,t)},t}(Wa),Ja=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){return e=Wa.writeDateNumber2(e,t.hour)},t.prototype.parseDateTime=function(e,t){return lp.parse(e,t)},t}(Wa),$a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){var r=t.hour%12;return 0===r&&(r=12),e=Wa.writeDateNumber2(e,r)},t.prototype.parseDateTime=function(e,t){return hp.parse(e,t)},t}(Wa),ep=function(e){function t(t){var r=e.call(this)||this;return r.locale=t,r}return C(t,e),t.prototype.withLocale=function(e){return e!==this.locale?new t(e):this},t.prototype.writeDate=function(e,t){return e=e.write(this.locale.periods[t.hour>=12?1:0])},t.prototype.parseDateTime=function(e,t){return dp.parse(e,this.locale,t)},t}(Wa),tp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){return e=Wa.writeDateNumber2(e,t.minute)},t.prototype.parseDateTime=function(e,t){return yp.parse(e,t)},t}(Wa),rp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){return e=Wa.writeDateNumber2(e,t.second)},t.prototype.parseDateTime=function(e,t){return vp.parse(e,t)},t}(Wa),np=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.writeDate=function(e,t){return e=Wa.writeDateNumber3(e,t.millisecond)},t.prototype.parseDateTime=function(e,t){return bp.parse(e,t)},t}(Wa),ip=function(e){function t(t,r){var n=e.call(this)||this;return n.pattern=t,n.specifiers=r,n}return C(t,e),t.prototype.writeDate=function(e,t){for(var r=this.pattern,n=this.specifiers,i=0,o=0,u=r.length;o<u;)if(37===r.charCodeAt(o)){i!==o&&(e=e.write(r.slice(i,o)));var s=n[r.charAt(o+1)];void 0!==s&&(e=s.writeDate(e,t)),i=o+=2}else o+=1;return i!==o&&(e=e.write(r.slice(i,o))),e},t.prototype.parseDateTime=function(e,t){return mp.parse(e,this.pattern,this.specifiers,t)},t}(Wa),op=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.year=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.year,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"full year",4,4,r,n,i)},t.term=function(e,t){return t.year=e,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),up=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.month=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.month,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"month number",2,2,r,n,i)},t.term=function(e,t){return t.month=e-1,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),sp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locale=t,i.date=r,i.output=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.locale,this.date,this.output)},t.parse=function(e,r,n,i){return Wa.parseDateString(e,t,r,n,i)},t.term=function(e,t,r,n){var i=e.months.indexOf(t);return i>=0?(r.month=i,we.done(r)):we.error(oe.message("expected month, but found "+t,n))},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),ap=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locale=t,i.date=r,i.output=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.locale,this.date,this.output)},t.parse=function(e,r,n,i){return Wa.parseDateString(e,t,r,n,i)},t.term=function(e,t,r,n){var i=e.shortMonths.indexOf(t);return i>=0?(r.month=i,we.done(r)):we.error(oe.message("expected short month, but found "+t,n))},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),pp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.day=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.day,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"day of month",2,2,r,n,i)},t.term=function(e,t){return t.day=e,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),fp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locale=t,i.date=r,i.output=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.locale,this.date,this.output)},t.parse=function(e,r,n,i){return Wa.parseDateString(e,t,r,n,i)},t.term=function(e,t,r,n){return e.weekdays.indexOf(t)>=0?we.done(r):we.error(oe.message("expected weekday, but found "+t,n))},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),cp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locale=t,i.date=r,i.output=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.locale,this.date,this.output)},t.parse=function(e,r,n,i){return Wa.parseDateString(e,t,r,n,i)},t.term=function(e,t,r,n){return e.shortWeekdays.indexOf(t)>=0?we.done(r):we.error(oe.message("expected short weekday, but found "+t,n))},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),lp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.hour=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.hour,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"hour (24)",2,2,r,n,i)},t.term=function(e,t){return t.hour=e,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),hp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.hour=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.hour,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"hour (12)",2,2,r,n,i)},t.term=function(e,t){return t.hour=(void 0!==t.hour?t.hour:0)+e,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),dp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locale=t,i.date=r,i.output=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.locale,this.date,this.output)},t.parse=function(e,r,n,i){return Wa.parseDateString(e,t,r,n,i)},t.term=function(e,t,r,n){var i=e.months.indexOf(t);return i>=0?(r.hour=(r.hour||0)+12*i,we.done(r)):we.error(oe.message("expected period of day, but found "+t,n))},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),yp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.minute=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.minute,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"minute",2,2,r,n,i)},t.term=function(e,t){return t.minute=e,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),vp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.second=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.second,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"second",2,2,r,n,i)},t.term=function(e,t){return t.second=e,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),bp=function(e){function t(t,r,n){var i=e.call(this)||this;return i.date=t,i.millisecond=r,i.step=n,i}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.date,this.millisecond,this.step)},t.parse=function(e,r,n,i){return Wa.parseDateNumber(e,t,"millisecond",1,3,r,n,i)},t.term=function(e,t){return t.millisecond=e,we.done(t)},t.cont=function(e,r,n){return new t(e,r,n)},t}(we),mp=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return u.pattern=t,u.specifiers=r,u.date=n,u.dateParser=i,u.step=o,u}return C(t,e),t.prototype.feed=function(e){return t.parse(e,this.pattern,this.specifiers,this.date,this.dateParser,this.step)},t.parse=function(e,r,n,i,o,u){void 0===i&&(i={}),void 0===u&&(u=0);for(var s=r.length;u<s;){var a=r.charCodeAt(u);if(37===a){if(void 0===o){var p=r.charAt(u+1),f=n[p];if(void 0===f)return we.error(oe.message("unknown format specifier: "+p,e));o=f.parseDateTime(e,i)}else o=o.feed(e);if(o.isDone()){i=o.bind(),o=void 0,u+=2;continue}if(o.isError())return o.asError()}else{if(e.isCont()){if(e.head()===a){e.step(),u+=1;continue}return we.error(oe.expected(a,e))}if(!e.isEmpty())return we.error(oe.unexpected(e))}break}return u===s?we.done(i):new t(r,n,i,o,u)},t}(we),gp=function(){function e(){}return e.prototype.next=function(e,t){return this.floor(this.offset(e,t))},e.prototype.ceil=function(e){return e=e instanceof Na?new Na(e.time-1,e.zone):Na.time(e)-1,this.next(this.floor(e),1)},e.prototype.round=function(e){var t=Na.fromAny(e),r=this.floor(t),n=this.ceil(t);return t.time-r.time<n.time-t.time?r:n},e.prototype.range=function(e,t,r){var n=this.ceil(e),i=Na.time(t),o=[];if((r="number"==typeof r?Math.floor(r):1)>0)for(;n.isDefined()&&n.time<i;)o.push(n),n=this.next(n,r);return o},e.prototype.filter=function(e){return new Op(this,e)},Object.defineProperty(e,"year",{get:function(){return new Pp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"month",{get:function(){return new jp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"week",{get:function(){return new Cp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"day",{get:function(){return new Ep},enumerable:!1,configurable:!0}),Object.defineProperty(e,"hour",{get:function(){return new Sp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"minute",{get:function(){return new kp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"second",{get:function(){return new Mp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"millisecond",{get:function(){return new Ap},enumerable:!1,configurable:!0}),e.years=function(t,r,n){return e.year.range(t,r,n)},e.months=function(t,r,n){return e.month.range(t,r,n)},e.weeks=function(t,r,n){return e.week.range(t,r,n)},e.days=function(t,r,n){return e.day.range(t,r,n)},e.hours=function(t,r,n){return e.hour.range(t,r,n)},e.minutes=function(t,r,n){return e.minute.range(t,r,n)},e.seconds=function(t,r,n){return e.second.range(t,r,n)},e.milliseconds=function(t,r,n){return e.millisecond.range(t,r,n)},e.MillisPerSecond=1e3,e.MillisPerMinute=60*e.MillisPerSecond,e.MillisPerHour=60*e.MillisPerMinute,E([s],e,"year",null),E([s],e,"month",null),E([s],e,"week",null),E([s],e,"day",null),E([s],e,"hour",null),E([s],e,"minute",null),E([s],e,"second",null),E([s],e,"millisecond",null),e}(),wp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t}(gp),Op=function(e){function t(t,r){var n=e.call(this)||this;return n.unit=t,n.predicate=r,n}return C(t,e),t.prototype.offset=function(e,t){var r=Na.fromAny(e);for(t=Math.max(1,"number"==typeof t?Math.floor(t):1);t<0;){do{r=this.unit.offset(r,-1)}while(r.isDefined()&&!this.predicate(r));t+=1}for(;t>0;){do{r=this.unit.offset(r,1)}while(r.isDefined()&&!this.predicate(r));t-=1}return r},t.prototype.floor=function(e){for(var t=Na.fromAny(e);(t=this.unit.floor(t)).isDefined()&&!this.predicate(t);)t=new Na(t.time-1,t.zone);return t},t}(gp),Pp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.offset=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),r=r.withYear(r.year+t)},t.prototype.next=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),r.withYear(r.year+t).withMonth(0,1).withHour(0,0,0,0)},t.prototype.floor=function(e){return Na.fromAny(e).withMonth(0,1).withHour(0,0,0,0)},t.prototype.ceil=function(e){var t=Na.fromAny(e);return(t=(t=(t=new Na(t.time-1,t.zone)).withMonth(0,1).withHour(0,0,0,0)).withYear(t.year+1)).withMonth(0,1).withHour(0,0,0,0)},t.prototype.every=function(e){if(1===e)return this;if(isFinite(e)&&e>=1)return new xp(e);throw new Error(""+e)},t}(wp),xp=function(e){function t(t){var r=e.call(this)||this;return r.stride=t,r}return C(t,e),t.prototype.offset=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),r.withYear(r.year+t*this.stride)},t.prototype.next=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),(r=r.withYear(Math.floor((r.year+t*this.stride)/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)},t.prototype.floor=function(e){var t=Na.fromAny(e);return(t=t.withYear(Math.floor(t.year/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)},t.prototype.ceil=function(e){var t=Na.fromAny(e);return(t=(t=(t=(t=new Na(t.time-1,t.zone)).withYear(Math.floor(t.year/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)).withYear(Math.floor((t.year+this.stride)/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)},t}(gp),jp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.offset=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),r.withMonth(r.month+t)},t.prototype.next=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),(r=r.withMonth(r.month+t)).withDay(1).withHour(0,0,0,0)},t.prototype.floor=function(e){return Na.fromAny(e).withDay(1).withHour(0,0,0,0)},t.prototype.ceil=function(e){var t=Na.fromAny(e);return(t=(t=(t=new Na(t.time-1,t.zone)).withDay(1).withHour(0,0,0,0)).withMonth(t.month+1)).withDay(1).withHour(0,0,0,0)},t.prototype.every=function(e){if(1===e)return this;if(isFinite(e)&&e>=1)return new Op(this,t.modulo.bind(void 0,e));throw new Error(""+e)},t.modulo=function(e,t){var r=t.month;return isFinite(r)&&r%e==0},t}(wp),Cp=function(e){function t(t){void 0===t&&(t=0);var r=e.call(this)||this;return r.day=t,r}return C(t,e),t.prototype.offset=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),r.withDay(r.day+7*t)},t.prototype.next=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),(r=(r=r.withDay(r.day+7*t)).withDay(r.day-(r.weekday+7-this.day)%7)).withHour(0,0,0,0)},t.prototype.floor=function(e){var t=Na.fromAny(e);return(t=t.withDay(t.day-(t.weekday+7-this.day)%7)).withHour(0,0,0,0)},t.prototype.ceil=function(e){var t=Na.fromAny(e);return(t=(t=(t=(t=new Na(t.time-1,t.zone)).withDay(t.day-(t.weekday+7-this.day)%7)).withHour(0,0,0,0)).withDay(t.day+7)).withHour(0,0,0,0)},t}(gp),Ep=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.offset=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),r.withDay(r.day+t)},t.prototype.next=function(e,t){var r=Na.fromAny(e);return t=Math.max(1,"number"==typeof t?Math.floor(t):1),(r=r.withDay(r.day+t)).withHour(0,0,0,0)},t.prototype.floor=function(e){return Na.fromAny(e).withHour(0,0,0,0)},t.prototype.ceil=function(e){var t=Na.fromAny(e);return(t=(t=(t=new Na(t.time-1,t.zone)).withHour(0,0,0,0)).withDay(t.day+1)).withHour(0,0,0,0)},t.prototype.every=function(e){if(1===e)return this;if(isFinite(e)&&e>=1)return new Op(this,t.modulo.bind(void 0,e));throw new Error(""+e)},t.modulo=function(e,t){var r=t.day;return isFinite(r)&&r%e==0},t}(wp),Sp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.offset=function(e,t){var r=Na.zone(e);return e=Na.time(e),e+=(t=Math.max(1,"number"==typeof t?Math.floor(t):1))*gp.MillisPerHour,new Na(e,r)},t.prototype.next=function(e,t){var r=Na.zone(e);e=Na.time(e),e+=(t=Math.max(1,"number"==typeof t?Math.floor(t):1))*gp.MillisPerHour;var n=r.offset*gp.MillisPerMinute%gp.MillisPerHour;return n<0&&(n+=gp.MillisPerHour),e=Math.floor((e-n)/gp.MillisPerHour)*gp.MillisPerHour+n,new Na(e,r)},t.prototype.floor=function(e){var t=Na.zone(e);e=Na.time(e);var r=t.offset*gp.MillisPerMinute%gp.MillisPerHour;return r<0&&(r+=gp.MillisPerHour),e=Math.floor((e-r)/gp.MillisPerHour)*gp.MillisPerHour+r,new Na(e,t)},t.prototype.ceil=function(e){var t=Na.zone(e);e=Na.time(e),e-=1;var r=t.offset*gp.MillisPerMinute%gp.MillisPerHour;return r<0&&(r+=gp.MillisPerHour),e=Math.floor((e-r)/gp.MillisPerHour)*gp.MillisPerHour+r+gp.MillisPerHour,e=Math.floor((e-r)/gp.MillisPerHour)*gp.MillisPerHour+r,new Na(e,t)},t.prototype.every=function(e){if(1===e)return this;if(isFinite(e)&&e>=1)return new Op(this,t.modulo.bind(void 0,e));throw new Error(""+e)},t.modulo=function(e,t){var r=t.hour;return isFinite(r)&&r%e==0},t}(wp),kp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.offset=function(e,t){var r=Na.zone(e);return e=Na.time(e),e+=(t=Math.max(1,"number"==typeof t?Math.floor(t):1))*gp.MillisPerMinute,new Na(e,r)},t.prototype.next=function(e,t){var r=Na.zone(e);return e=Na.time(e),t=Math.max(1,"number"==typeof t?Math.floor(t):1),e=Math.floor((e+t*gp.MillisPerMinute)/gp.MillisPerMinute)*gp.MillisPerMinute,new Na(e,r)},t.prototype.floor=function(e){var t=Na.zone(e);return e=Na.time(e),e=Math.floor(e/gp.MillisPerMinute)*gp.MillisPerMinute,new Na(e,t)},t.prototype.ceil=function(e){var t=Na.zone(e);return e=Na.time(e),e=Math.floor((Math.floor((e-1)/gp.MillisPerMinute)*gp.MillisPerMinute+gp.MillisPerMinute)/gp.MillisPerMinute)*gp.MillisPerMinute,new Na(e,t)},t.prototype.every=function(e){if(1===e)return this;if(isFinite(e)&&e>=1)return new Op(this,t.modulo.bind(void 0,e));throw new Error(""+e)},t.modulo=function(e,t){var r=t.minute;return isFinite(r)&&r%e==0},t}(wp),Mp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.offset=function(e,t){var r=Na.zone(e);return e=Na.time(e),e+=(t=Math.max(1,"number"==typeof t?Math.floor(t):1))*gp.MillisPerSecond,new Na(e,r)},t.prototype.next=function(e,t){var r=Na.zone(e);return e=Na.time(e),e+=(t=Math.max(1,"number"==typeof t?Math.floor(t):1))*gp.MillisPerSecond,e=Math.floor(e/gp.MillisPerSecond)*gp.MillisPerSecond,new Na(e,r)},t.prototype.floor=function(e){var t=Na.zone(e);return e=Na.time(e),e=Math.floor(e/gp.MillisPerSecond)*gp.MillisPerSecond,new Na(e,t)},t.prototype.ceil=function(e){var t=Na.zone(e);return e=Na.time(e),e=Math.floor((Math.floor((e-1)/gp.MillisPerSecond)*gp.MillisPerSecond+gp.MillisPerSecond)/gp.MillisPerSecond)*gp.MillisPerSecond,new Na(e,t)},t.prototype.every=function(e){if(1===e)return this;if(isFinite(e)&&e>=1)return new Op(this,t.modulo.bind(void 0,e));throw new Error(""+e)},t.modulo=function(e,t){var r=t.second;return isFinite(r)&&r%e==0},t}(wp),Ap=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.offset=function(e,t){var r=Na.zone(e);return e=Na.time(e),t=Math.max(1,"number"==typeof t?Math.floor(t):1),new Na(e+=t,r)},t.prototype.next=function(e,t){var r=Na.zone(e);return e=Na.time(e),t=Math.max(1,"number"==typeof t?Math.floor(t):1),new Na(e+=t,r)},t.prototype.floor=function(e){return Na.fromAny(e)},t.prototype.ceil=function(e){return Na.fromAny(e)},t.prototype.every=function(e){if(1===e)return this;if(isFinite(e)&&e>=1)return new Dp(e);throw new Error(""+e)},t}(wp),Dp=function(e){function t(t){var r=e.call(this)||this;return isFinite(t)||(t=1),r.stride=t,r}return C(t,e),t.prototype.offset=function(e,t){var r=Na.zone(e);return e=Na.time(e),e+=(t=Math.max(1,"number"==typeof t?Math.floor(t):1))*this.stride,new Na(e,r)},t.prototype.next=function(e,t){var r=Na.zone(e);e=Na.time(e),t=Math.max(1,"number"==typeof t?Math.floor(t):1);var n=this.stride;return e=Math.floor((e+t*n)/n)*n,new Na(e,r)},t.prototype.floor=function(e){var t=Na.zone(e);e=Na.time(e);var r=this.stride;return e=Math.floor(e/r)*r,new Na(e,t)},t.prototype.ceil=function(e){var t=Na.zone(e);e=Na.time(e);var r=this.stride;return e=Math.floor((Math.floor((e-1)/r)*r+r)/r)*r,new Na(e,t)},t}(gp),Ip=function(e,t){var r=function(e){var t=r[0].time,n=r[1].time-t;return 0!==n?(e.time-t)/n:0};return Object.setPrototypeOf(r,Ip.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Ip.prototype=Object.create(Qe.prototype),Object.defineProperty(Ip.prototype,"inverse",{get:function(){return Vp(this[0],this[1])},enumerable:!0,configurable:!0}),Ip.prototype.contains=function(e){return e=Na.time(e),this[0].time<=e&&e<=this[1].time},Ip.prototype.interpolateTo=function(e){return e instanceof Ip?Tp(this,e):null},Ip.prototype.canEqual=function(e){return e instanceof Ip},Ip.prototype.equals=function(e){return this===e||e instanceof Ip&&(e.canEqual(this)&&this[0].equals(e[0])&&this[1].equals(e[1]))},Ip.prototype.toString=function(){return"TimeDomain("+this[0]+", "+this[1]+")"};var Tp=function(e,t){var r=function(e){var t=r[0],n=t[0],i=t[1],o=r[1],u=o[0],s=o[1];return Ip(new Na(n.time+e*(u.time-n.time),0===e?n.zone:u.zone),new Na(i.time+e*(s.time-i.time),0===e?i.zone:s.zone))};return Object.setPrototypeOf(r,Tp.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Tp.prototype=Object.create($e.prototype);var Vp=function(e,t){var r=function(e){var t=r[0].time,n=r[1].time;return new Na(t+e*(n-t),0===e?r[0].zone:r[1].zone)};return Object.setPrototypeOf(r,Vp.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Vp.prototype=Object.create(Ze.prototype),Object.defineProperty(Vp.prototype,"inverse",{get:function(){return Ip(this[0],this[1])},enumerable:!0,configurable:!0}),Vp.prototype.interpolateTo=function(e){return e instanceof Vp?qp(this,e):null},Vp.prototype.canEqual=function(e){return e instanceof Vp},Vp.prototype.equals=function(e){return this===e||e instanceof Vp&&(e.canEqual(this)&&this[0].equals(e[0])&&this[1].equals(e[1]))},Vp.prototype.toString=function(){return"TimeRange("+this[0]+", "+this[1]+")"};var qp=function(e,t){var r=function(e){var t=r[0],n=t[0],i=t[1],o=r[1],u=o[0],s=o[1];return Vp(new Na(n.time+e*(u.time-n.time),0===e?n.zone:u.zone),new Na(i.time+e*(s.time-i.time),0===e?i.zone:s.zone))};return Object.setPrototypeOf(r,qp.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};qp.prototype=Object.create($e.prototype);var Rp=function(e,t){var r=function(e){return r.range(r.domain(e))};return Object.setPrototypeOf(r,Rp.prototype),Object.defineProperty(r,"domain",{value:e,enumerable:!0}),Object.defineProperty(r,"range",{value:t,enumerable:!0}),r};Rp.prototype=Object.create(dt.prototype),Object.defineProperty(Rp.prototype,"inverse",{get:function(){return _e(this.range.inverse,this.domain.inverse)},enumerable:!0,configurable:!0}),Rp.prototype.withDomain=function(e,t){var r;return 1===arguments.length?r=e:(e=Na.fromAny(e),t=Na.fromAny(t),r=Ip(e,t)),Rp(r,this.range)},Rp.prototype.overRange=function(e,t){var r;return r=1===arguments.length?e:ct(e,t),Rp(this.domain,r)},Rp.prototype.clampDomain=function(e,t,r,i,o){void 0===o&&(o=n.Epsilon);var u=this.domain[0],s=this.domain[1],a=u.time,p=s.time,f=void 0!==e?e.time:void 0,c=void 0!==t?t.time:void 0;void 0!==f&&void 0!==c&&Math.abs(p-a)>c-f?a<p?(a=f,p=c):(p=f,a=c):(void 0!==f&&(a<p&&a<f?(p+=f-a,a=f):p<a&&p<f&&(a+=f-p,p=f)),void 0!==c&&(a<p&&p>c?(a-=p-c,p=c):p<a&&a>c&&(p-=a-c,a=c)));var l=this(u),h=this(s),d=l<h?h-l:l-h,y=Math.abs(d/(p-a));if(void 0!==r&&y<1/r)a=((b=a+p)-(v=d*r))/2,p=(b+v)/2;else if(void 0!==i&&y>1/i){var v,b;a=((b=a+p)-(v=d*i))/2,p=(b+v)/2}return Math.abs(a-u.time)<o&&Math.abs(p-s.time)<o?this:Rp(Ip(new Na(a,u.zone),new Na(p,s.zone)),this.range)},Rp.prototype.solveDomain=function(e,t,r,i,o,u){void 0===u&&(u=n.Epsilon);var s,a=this.domain[1].time-this.domain[0].time,p=this.range[0],f=this.range[1],c=e.time,l=void 0!==r?r.time:void 0;void 0===l||void 0===i||Math.abs(l-c)<u||Math.abs(i-t)<u?s=(f-p)/(0!==a?a:u):(s=(i-t)/(l-c),void 0!==o&&o||s<0==(f-p)/a<0||(s=-s));var h=t-s*c,d=(p-h)/s,y=(f-h)/s;return Math.abs(d-this.domain[0].time)<u&&Math.abs(y-this.domain[1].time)<u?this:Rp(Ip(new Na(d,this.domain[0].zone),new Na(y,this.domain[1].zone)),this.range)},Rp.prototype.interpolateTo=function(e){return e instanceof Rp?Up(this,e):null},Rp.prototype.canEqual=function(e){return e instanceof Rp},Rp.prototype.equals=function(e){return this===e||e instanceof Rp&&(this.domain.equals(e.domain)&&this.range.equals(e.range))},Rp.prototype.toString=function(){return"TimeScale("+this.domain+", "+this.range+")"};var Up=function(e,t){var r=function(e){var t=r[0],n=r[1],i=t.domain,o=i[0].time,u=i[1].time,s=n.domain,a=s[0].time,p=s[1].time,f=Ip(new Na(o+e*(a-o),0===e?i[0].zone:s[0].zone),new Na(u+e*(p-u),0===e?i[1].zone:s[1].zone)),c=t.range,l=c[0],h=c[1],d=n.range,y=d[0],v=d[1],b=ct(l+e*(y-l),h+e*(v-h));return Rp(f,b)};return Object.setPrototypeOf(r,Up.prototype),Object.defineProperty(r,0,{value:e,enumerable:!0}),Object.defineProperty(r,1,{value:t,enumerable:!0}),r};Up.prototype=Object.create($e.prototype);var Np=function(){function e(){}return Object.defineProperty(e.prototype,"tag",{get:function(){return this.constructor.tag},enumerable:!1,configurable:!0}),e.prototype.withPrio=function(e){return this},e.prototype.withRate=function(e){return this},e.prototype.toRecon=function(){return co.toString(this.toValue())},e.prototype.toString=function(){return ne.debug(this)},e.fromValue=function(e){switch(e.tag){case"event":return Bp.fromValue(e);case"command":return Wp.fromValue(e);case"link":return Hp.fromValue(e);case"linked":return Xp.fromValue(e);case"sync":return Yp.fromValue(e);case"synced":return Gp.fromValue(e);case"unlink":return _p.fromValue(e);case"unlinked":return Qp.fromValue(e);case"auth":return Zp.fromValue(e);case"authed":return Jp.fromValue(e);case"deauth":return $p.fromValue(e);case"deauthed":return ef.fromValue(e);default:return null}},e.parseRecon=function(t){return e.fromValue(co.parse(t))},e}();Object.defineProperty(Np.prototype,"prio",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(Np.prototype,"rate",{get:function(){return 0},enumerable:!0,configurable:!0});var zp,Fp=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"body",{value:t,enumerable:!0}),r}return C(t,e),Object.defineProperty(t.prototype,"node",{get:function(){return yu.empty()},enumerable:!1,configurable:!0}),t.prototype.withNode=function(e){return this},Object.defineProperty(t.prototype,"lane",{get:function(){return yu.empty()},enumerable:!1,configurable:!0}),t.prototype.withLane=function(e){return this},t.prototype.withBody=function(e){return e=ir.fromAny(e),this.copy(e)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.constructor===e.constructor&&this.body.equals(e.body))},t.prototype.hashCode=function(){return c.mash(c.mix(w.hash(this.constructor),this.body.hashCode()))},t.prototype.debug=function(e){return e=e.write(this.constructor.name).write(46).write("create").write(40),this.body.isDefined()&&(e=e.debug(this.body)),e=e.write(41)},t.prototype.toValue=function(){return tr.of(this.tag).concat(this.body)},t.fromValue=function(e){return e.header(this.tag).isDefined()?new this(e.body()):null},t}(Np),Lp=function(e){function t(t,r,n){var i=e.call(this)||this;return Object.defineProperty(i,"node",{value:t,enumerable:!0}),Object.defineProperty(i,"lane",{value:r,enumerable:!0}),Object.defineProperty(i,"body",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.withNode=function(e){return e=yu.fromAny(e),this.copy(e,this.lane,this.body)},t.prototype.withLane=function(e){return e=yu.fromAny(e),this.copy(this.node,e,this.body)},t.prototype.withBody=function(e){return e=ir.fromAny(e),this.copy(this.node,this.lane,e)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.constructor===e.constructor&&this.node.equals(e.node)&&this.lane.equals(e.lane)&&this.body.equals(e.body))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(w.hash(this.constructor),this.node.hashCode()),this.lane.hashCode()),this.body.hashCode()))},t.prototype.debug=function(e){return e=e.write(this.constructor.name).write(46).write("create").write(40).debug(this.node.toString()).write(", ").debug(this.lane.toString()),this.body.isDefined()&&(e=e.write(", ").debug(this.body)),e=e.write(41)},t.prototype.toValue=function(){var e=or.create(2).slot("node",this.node.toString()).slot("lane",this.lane.toString());return tr.of(this.tag,e).concat(this.body)},t.fromValue=function(e){var t,r;if(e.header(this.tag).forEach((function(e,n){var i=e.key.stringValue(void 0);void 0!==i?"node"===i?t=yu.parse(e.toValue().stringValue("")):"lane"===i&&(r=yu.parse(e.toValue().stringValue(""))):e instanceof ir&&(0===n?t=yu.parse(e.stringValue("")):1===n&&(r=yu.parse(e.stringValue(""))))})),void 0!==t&&void 0!==r){var n=e.body();return new this(t,r,n)}return null},t}(Np),Kp=function(e){function t(t,r,n,i,o){var u=e.call(this)||this;return Object.defineProperty(u,"node",{value:t,enumerable:!0}),Object.defineProperty(u,"lane",{value:r,enumerable:!0}),Object.defineProperty(u,"prio",{value:n,enumerable:!0}),Object.defineProperty(u,"rate",{value:i,enumerable:!0}),Object.defineProperty(u,"body",{value:o,enumerable:!0}),u}return C(t,e),t.prototype.withNode=function(e){return e=yu.fromAny(e),this.copy(e,this.lane,this.prio,this.rate,this.body)},t.prototype.withLane=function(e){return e=yu.fromAny(e),this.copy(this.node,e,this.prio,this.rate,this.body)},t.prototype.withPrio=function(e){return this.copy(this.node,this.lane,e,this.rate,this.body)},t.prototype.withRate=function(e){return this.copy(this.node,this.lane,this.prio,e,this.body)},t.prototype.withBody=function(e){return e=ir.fromAny(e),this.copy(this.node,this.lane,this.prio,this.rate,e)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.constructor===e.constructor&&this.node.equals(e.node)&&this.lane.equals(e.lane)&&this.prio===e.prio&&this.rate===e.rate&&this.body.equals(e.body))},t.prototype.hashCode=function(){return c.mash(c.mix(c.mix(c.mix(c.mix(c.mix(w.hash(this.constructor),this.node.hashCode()),this.lane.hashCode()),b.hash(this.prio)),b.hash(this.rate)),this.body.hashCode()))},t.prototype.debug=function(e){return e=e.write(this.constructor.name).write(46).write("create").write(40).debug(this.node.toString()).write(", ").debug(this.lane.toString()),0===this.prio&&0===this.rate||(e=e.write(", ").debug(this.prio).write(", ").debug(this.rate)),this.body.isDefined()&&(e=e.write(", ").debug(this.body)),e=e.write(41)},t.prototype.toValue=function(){var e=or.create(4).slot("node",this.node.toString()).slot("lane",this.lane.toString());return 0!==this.prio&&e.slot("prio",this.prio),0!==this.rate&&e.slot("rate",this.rate),tr.of(this.tag,e).concat(this.body)},t.fromValue=function(e){var t,r,n=0,i=0;if(e.header(this.tag).forEach((function(e,o){var u=e.key.stringValue(void 0);void 0!==u?"node"===u?t=yu.parse(e.toValue().stringValue("")):"lane"===u?r=yu.parse(e.toValue().stringValue("")):"prio"===u?n=e.numberValue(n):"rate"===u&&(i=e.numberValue(i)):e instanceof ir&&(0===o?t=yu.parse(e.stringValue("")):1===o&&(r=yu.parse(e.stringValue(""))))})),void 0!==t&&void 0!==r){var o=e.body();return new this(t,r,n,i,o)}return null},t}(Np),Bp=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return C(t,e),t.prototype.copy=function(e,r,n){return new t(e,r,n)},Object.defineProperty(t,"tag",{get:function(){return"event"},enumerable:!1,configurable:!0}),t.create=function(e,r,n){return void 0===n&&(n=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n=ir.fromAny(n))},t}(Lp),Wp=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return C(t,e),t.prototype.copy=function(e,r,n){return new t(e,r,n)},Object.defineProperty(t,"tag",{get:function(){return"command"},enumerable:!1,configurable:!0}),t.create=function(e,r,n){return void 0===n&&(n=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n=ir.fromAny(n))},t}(Lp),Hp=function(e){function t(t,r,n,i,o){return e.call(this,t,r,n,i,o)||this}return C(t,e),t.prototype.copy=function(e,r,n,i,o){return new t(e,r,n,i,o)},Object.defineProperty(t,"tag",{get:function(){return"link"},enumerable:!1,configurable:!0}),t.create=function(e,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n,i,o=ir.fromAny(o))},t}(Kp),Xp=function(e){function t(t,r,n,i,o){return e.call(this,t,r,n,i,o)||this}return C(t,e),t.prototype.copy=function(e,r,n,i,o){return new t(e,r,n,i,o)},Object.defineProperty(t,"tag",{get:function(){return"linked"},enumerable:!1,configurable:!0}),t.create=function(e,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n,i,o=ir.fromAny(o))},t}(Kp),Yp=function(e){function t(t,r,n,i,o){return e.call(this,t,r,n,i,o)||this}return C(t,e),t.prototype.copy=function(e,r,n,i,o){return new t(e,r,n,i,o)},Object.defineProperty(t,"tag",{get:function(){return"sync"},enumerable:!1,configurable:!0}),t.create=function(e,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n,i,o=ir.fromAny(o))},t}(Kp),Gp=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return C(t,e),t.prototype.copy=function(e,r,n){return new t(e,r,n)},Object.defineProperty(t,"tag",{get:function(){return"synced"},enumerable:!1,configurable:!0}),t.create=function(e,r,n){return void 0===n&&(n=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n=ir.fromAny(n))},t}(Lp),_p=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return C(t,e),t.prototype.copy=function(e,r,n){return new t(e,r,n)},Object.defineProperty(t,"tag",{get:function(){return"unlink"},enumerable:!1,configurable:!0}),t.create=function(e,r,n){return void 0===n&&(n=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n=ir.fromAny(n))},t}(Lp),Qp=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return C(t,e),t.prototype.copy=function(e,r,n){return new t(e,r,n)},Object.defineProperty(t,"tag",{get:function(){return"unlinked"},enumerable:!1,configurable:!0}),t.create=function(e,r,n){return void 0===n&&(n=ir.absent()),new t(e=yu.fromAny(e),r=yu.fromAny(r),n=ir.fromAny(n))},t}(Lp),Zp=function(e){function t(t){return e.call(this,t)||this}return C(t,e),t.prototype.copy=function(e){return new t(e)},Object.defineProperty(t,"tag",{get:function(){return"auth"},enumerable:!1,configurable:!0}),t.create=function(e){return void 0===e&&(e=ir.absent()),new t(e=ir.fromAny(e))},t}(Fp),Jp=function(e){function t(t){return e.call(this,t)||this}return C(t,e),t.prototype.copy=function(e){return new t(e)},Object.defineProperty(t,"tag",{get:function(){return"authed"},enumerable:!1,configurable:!0}),t.create=function(e){return void 0===e&&(e=ir.absent()),new t(e=ir.fromAny(e))},t}(Fp),$p=function(e){function t(t){return e.call(this,t)||this}return C(t,e),t.prototype.copy=function(e){return new t(e)},Object.defineProperty(t,"tag",{get:function(){return"deauth"},enumerable:!1,configurable:!0}),t.create=function(e){return void 0===e&&(e=ir.absent()),new t(e=ir.fromAny(e))},t}(Fp),ef=function(e){function t(t){return e.call(this,t)||this}return C(t,e),t.prototype.copy=function(e){return new t(e)},Object.defineProperty(t,"tag",{get:function(){return"deauthed"},enumerable:!1,configurable:!0}),t.create=function(e){return void 0===e&&(e=ir.absent()),new t(e=ir.fromAny(e))},t}(Fp),tf=function(){},rf=function(e){function t(t,r,n){void 0===n&&(n={});var i=e.call(this)||this;return Object.defineProperty(i,"context",{value:t,enumerable:!0}),Object.defineProperty(i,"hostUri",{value:r,enumerable:!0}),Object.defineProperty(i,"options",{value:n,enumerable:!0,configurable:!0}),Object.defineProperty(i,"authenticated",{value:!1,enumerable:!0,configurable:!0}),Object.defineProperty(i,"session",{value:ir.absent(),enumerable:!0,configurable:!0}),Object.defineProperty(i,"sendBuffer",{value:[],enumerable:!0,configurable:!0}),Object.defineProperty(i,"downlinks",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(i,"downlinkCount",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(i,"uriCache",{value:new Uu(r),enumerable:!0,configurable:!0}),i.reconnectTimer=0,i.reconnectTimeout=0,i.idleTimer=0,i}return C(t,e),Object.defineProperty(t.prototype,"credentials",{get:function(){var e;return null!==(e=this.options.credentials)&&void 0!==e?e:ir.absent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unlinkDelay",{get:function(){var e;return null!==(e=this.options.unlinkDelay)&&void 0!==e?e:t.UnlinkDelay},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxReconnectTimeout",{get:function(){var e;return null!==(e=this.options.maxReconnectTimeout)&&void 0!==e?e:t.MaxReconnectTimeout},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleTimeout",{get:function(){var e;return null!==(e=this.options.idleTimeout)&&void 0!==e?e:t.IdleTimeout},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sendBufferSize",{get:function(){var e;return null!==(e=this.options.sendBufferSize)&&void 0!==e?e:t.SendBufferSize},enumerable:!1,configurable:!0}),t.prototype.isAuthenticated=function(){return this.authenticated},t.prototype.isIdle=function(){return 0===this.sendBuffer.length&&0===this.downlinkCount},t.prototype.resolve=function(e){return this.uriCache.resolve(e)},t.prototype.unresolve=function(e){return this.uriCache.unresolve(e)},t.prototype.authenticate=function(e){if(!(e=ir.fromAny(e)).equals(this.options.credentials))if(this.options.credentials=e,this.isConnected()){var t=new Zp(e);this.push(t)}else this.open()},t.prototype.openDownlink=function(e){this.clearIdle();var t=this.resolve(e.nodeUri),r=e.laneUri;0===this.downlinkCount&&this.open();var n=this.downlinks.get(t);if(void 0===n&&(n=new Ot,this.downlinks.set(t,n)),void 0!==n.get(r))throw new Error("duplicate downlink");n.set(r,e),Object.defineProperty(this,"downlinkCount",{value:this.downlinkCount+1,enumerable:!0,configurable:!0}),e.openUp(this),this.isConnected()&&e.hostDidConnect(this)},t.prototype.unlinkDownlink=function(e){var t=this.resolve(e.nodeUri),r=e.laneUri,n=this.downlinks.get(t);if(void 0!==n&&n.get(r)&&this.isConnected()){var i=new _p(this.unresolve(t),r,ir.absent());e.onUnlinkRequest(i,this),this.push(i)}},t.prototype.closeDownlink=function(e){var t=this.resolve(e.nodeUri),r=e.laneUri,n=this.downlinks.get(t);void 0!==n&&n.get(r)&&(Object.defineProperty(this,"downlinkCount",{value:this.downlinkCount-1,enumerable:!0,configurable:!0}),n.delete(r),n.isEmpty()&&this.downlinks.delete(t),0===this.downlinkCount&&this.watchIdle(),e.closeUp(this))},t.prototype.command=function(e,t,r){e=yu.fromAny(e),e=this.resolve(e),t=yu.fromAny(t),r=ir.fromAny(r);var n=new Wp(this.unresolve(e),t,r);this.push(n)},t.prototype.onEnvelope=function(e){e instanceof Bp?this.onEventMessage(e):e instanceof Wp?this.onCommandMessage(e):e instanceof Hp?this.onLinkRequest(e):e instanceof Xp?this.onLinkedResponse(e):e instanceof Yp?this.onSyncRequest(e):e instanceof Gp?this.onSyncedResponse(e):e instanceof _p?this.onUnlinkRequest(e):e instanceof Qp?this.onUnlinkedResponse(e):e instanceof Zp?this.onAuthRequest(e):e instanceof Jp?this.onAuthedResponse(e):e instanceof $p?this.onDeauthRequest(e):e instanceof ef?this.onDeauthedResponse(e):this.onUnknownEnvelope(e)},t.prototype.onEventMessage=function(e){var t=this.resolve(e.node),r=e.lane,n=this.downlinks.get(t);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=e.withNode(t);i.onEventMessage(o,this)}}},t.prototype.onCommandMessage=function(e){},t.prototype.onLinkRequest=function(e){},t.prototype.onLinkedResponse=function(e){var t=this.resolve(e.node),r=e.lane,n=this.downlinks.get(t);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=e.withNode(t);i.onLinkedResponse(o,this)}}},t.prototype.onSyncRequest=function(e){},t.prototype.onSyncedResponse=function(e){var t=this.resolve(e.node),r=e.lane,n=this.downlinks.get(t);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=e.withNode(t);i.onSyncedResponse(o,this)}}},t.prototype.onUnlinkRequest=function(e){},t.prototype.onUnlinkedResponse=function(e){var t=this.resolve(e.node),r=e.lane,n=this.downlinks.get(t);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=e.withNode(t);i.onUnlinkedResponse(o,this)}}},t.prototype.onAuthRequest=function(e){},t.prototype.onAuthedResponse=function(e){Object.defineProperty(this,"authenticated",{value:!0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"session",{value:e.body,enumerable:!0,configurable:!0}),this.context.hostDidAuthenticate(e.body,this)},t.prototype.onDeauthRequest=function(e){},t.prototype.onDeauthedResponse=function(e){Object.defineProperty(this,"authenticated",{value:!1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"session",{value:ir.absent(),enumerable:!0,configurable:!0}),this.context.hostDidDeauthenticate(e.body,this)},t.prototype.onUnknownEnvelope=function(e){},t.prototype.onConnect=function(){this.reconnectTimeout=0,this.context.hostDidConnect(this),this.downlinks.forEach((function(e,t){t.forEach((function(e,t){t.hostDidConnect(this)}),this)}),this)},t.prototype.onDisconnect=function(){Object.defineProperty(this,"authenticated",{value:!1,enumerable:!0,configurable:!0}),Object.defineProperty(this,"session",{value:ir.absent(),enumerable:!0,configurable:!0}),this.context.hostDidDisconnect(this),this.downlinks.forEach((function(e,t){t.forEach((function(e,t){t.hostDidDisconnect(this)}),this)}),this)},t.prototype.onError=function(e){this.context.hostDidFail(e,this),this.downlinks.forEach((function(t,r){r.forEach((function(t,r){r.hostDidFail(e,this)}),this)}),this)},t.prototype.reconnect=function(){0===this.reconnectTimer&&(0===this.reconnectTimeout?this.reconnectTimeout=Math.floor(500+1e3*Math.random()):this.reconnectTimeout=Math.min(Math.floor(1.8*this.reconnectTimeout),this.maxReconnectTimeout),this.reconnectTimer=setTimeout(this.open.bind(this),this.reconnectTimeout))},t.prototype.clearReconnect=function(){0!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=0)},t.prototype.watchIdle=function(){0===this.idleTimer&&this.isConnected()&&this.isIdle()&&(this.idleTimer=setTimeout(this.checkIdle.bind(this),this.idleTimeout))},t.prototype.clearIdle=function(){0!==this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=0)},t.prototype.checkIdle=function(){this.isConnected()&&this.isIdle()&&this.close()},t.prototype.close=function(){this.context.closeHost(this)},t.prototype.closeUp=function(){this.downlinks.forEach((function(e,t){t.forEach((function(e,t){t.closeUp(this)}),this)}),this)},t.UnlinkDelay=0,t.MaxReconnectTimeout=3e4,t.IdleTimeout=1e3,t.SendBufferSize=1024,t}(tf),nf=function(e){function t(t,r,n){void 0===n&&(n={});var i=e.call(this,t,r,n)||this;return Object.defineProperty(i,"socket",{value:null,enumerable:!0,configurable:!0}),i}return C(t,e),Object.defineProperty(t.prototype,"WebSocket",{get:function(){return void 0!==this.options.WebSocket?this.options.WebSocket:"undefined"!=typeof WebSocket?WebSocket:"function"==typeof require?require("ws"):null},enumerable:!1,configurable:!0}),t.prototype.isConnected=function(){return null!==this.socket&&this.socket.readyState===this.socket.OPEN},t.prototype.open=function(){this.clearReconnect();var e=this.socket;if(null===e){var t=this.WebSocket;if(null===t)throw new Error("WebSocket undefined");var r=this.hostUri,n=r.schemeName;"warp"===n||"swim"===n?r=r.withSchemeName("ws"):"warps"!==n&&"swims"!==n||(r=r.withSchemeName("wss")),e=void 0!==this.options.protocols?new t(r.toString(),this.options.protocols):new t(r.toString()),Object.defineProperty(this,"socket",{value:e,enumerable:!0,configurable:!0}),e.onopen=this.onWebSocketOpen.bind(this),e.onmessage=this.onWebSocketMessage.bind(this),e.onclose=this.onWebSocketClose.bind(this),e.onerror=this.onWebSocketError.bind(this)}},t.prototype.close=function(){this.clearReconnect(),this.clearIdle(),null!==this.socket?(this.socket.close(),this.context.isOnline()||this.onWebSocketClose()):e.prototype.close.call(this)},t.prototype.push=function(e){if(this.isConnected()){this.clearIdle();var t=e.toRecon();this.socket.send(t),this.watchIdle()}else if(e instanceof Wp){if(!(this.sendBuffer.length<this.sendBufferSize))throw new Error("send buffer overflow");this.sendBuffer.push(e),this.open()}},t.prototype.onWebSocketOpen=function(){if(this.isConnected()){var e=this.credentials;if(e.isDefined()){var t=new Zp(e);this.push(t)}this.onConnect();for(var r=void 0;(r=this.sendBuffer.shift())&&this.isConnected();)this.push(r);this.watchIdle()}else this.close()},t.prototype.onWebSocketMessage=function(e){var t=e.data;if("string"==typeof t){var r=Np.parseRecon(t);null!==r?this.onEnvelope(r):this.onUnknownEnvelope(t)}},t.prototype.onWebSocketClose=function(){var e=this.socket;null!==e&&(e.onopen=null,e.onmessage=null,e.onclose=null,e.onerror=null,Object.defineProperty(this,"socket",{value:null,enumerable:!0,configurable:!0})),this.onDisconnect(),this.clearIdle(),this.isIdle()?this.close():this.context.isOnline()&&this.reconnect()},t.prototype.onWebSocketError=function(){null!==this.socket&&(this.socket.close(),this.context.isOnline()?this.onError():this.onWebSocketClose())},t}(rf),of=function(){function e(e,t,r,n,i,o,u){void 0===i&&(i=0),void 0===o&&(o=0),void 0===u&&(u=ir.absent()),Object.defineProperty(this,"context",{value:e,enumerable:!0}),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"nodeUri",{value:r,enumerable:!0}),Object.defineProperty(this,"laneUri",{value:n,enumerable:!0}),Object.defineProperty(this,"prio",{value:i,enumerable:!0}),Object.defineProperty(this,"rate",{value:o,enumerable:!0}),Object.defineProperty(this,"body",{value:u,enumerable:!0}),Object.defineProperty(this,"views",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(this,"host",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"status",{value:0,enumerable:!0,configurable:!0})}return e.prototype.keepLinked=function(){for(var e=this.views,t=0,r=e.length;t<r;t+=1)if(e[t].keepLinked())return!0;return!1},e.prototype.keepSynced=function(){for(var e=0,t=this.views.length;e<t;e+=1)if(this.views[e].keepSynced())return!0;return!1},Object.defineProperty(e.prototype,"unlinkDelay",{get:function(){var e=this.host;return null!==e?e.unlinkDelay:0},enumerable:!1,configurable:!0}),e.prototype.isConnected=function(){var e=this.host;return null!==e&&e.isConnected()},e.prototype.isAuthenticated=function(){var e=this.host;return null!==e&&e.isAuthenticated()},e.prototype.isLinked=function(){return 0!=(this.status&e.Linked)},e.prototype.isSynced=function(){return 0!=(this.status&e.Synced)},Object.defineProperty(e.prototype,"session",{get:function(){var e=this.host;return null!==e?e.session:ir.absent()},enumerable:!1,configurable:!0}),e.prototype.addDownlink=function(e){Object.defineProperty(this,"views",{value:x.inserted(e,this.views),enumerable:!0,configurable:!0})},e.prototype.removeDownlink=function(e){var t=this.views,r=x.removed(e,t);if(t!==r&&(Object.defineProperty(this,"views",{value:r,enumerable:!0,configurable:!0}),e.closeUp(),0===r.length)){var n=this.unlinkDelay;n<0?this.unlink():setTimeout(this.doUnlink.bind(this),n)}},e.prototype.onEventMessage=function(e,t){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].onEventMessage(e)},e.prototype.onCommandMessage=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].onCommandMessage(e)},e.prototype.onLinkRequest=function(t){Object.defineProperty(this,"status",{value:this.status|e.Linking,enumerable:!0,configurable:!0});for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].onLinkRequest(t)},e.prototype.onLinkedResponse=function(t,r){Object.defineProperty(this,"status",{value:this.status&~e.Linking|e.Linked,enumerable:!0,configurable:!0});for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].onLinkedResponse(t)},e.prototype.onSyncRequest=function(t){Object.defineProperty(this,"status",{value:this.status|e.Syncing,enumerable:!0,configurable:!0});for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].onSyncRequest(t)},e.prototype.onSyncedResponse=function(t,r){Object.defineProperty(this,"status",{value:this.status&~e.Syncing|e.Synced,enumerable:!0,configurable:!0});for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].onSyncedResponse(t)},e.prototype.onUnlinkRequest=function(t,r){Object.defineProperty(this,"status",{value:this.status&~(e.Linking|e.Syncing)|e.Unlinking,enumerable:!0,configurable:!0});for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].onUnlinkRequest(t)},e.prototype.onUnlinkedResponse=function(t,r){Object.defineProperty(this,"status",{value:this.status&~e.Unlinking,enumerable:!0,configurable:!0});var n=this.views;if(0===n.length||0!==this.status){for(var i=0,o=n.length;i<o;i+=1)n[i].onUnlinkedResponse(t);this.close()}else this.keepSynced()?this.sync():this.link()},e.prototype.hostDidConnect=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].hostDidConnect();this.keepSynced()?this.sync():this.link()},e.prototype.hostDidDisconnect=function(e){Object.defineProperty(this,"status",{value:0,enumerable:!0,configurable:!0});for(var t=!1,r=this.views,n=0,i=r.length;n<i;n+=1){var o=r[n];o.hostDidDisconnect(),t=t||o.keepLinked()}t||this.close()},e.prototype.hostDidFail=function(e,t){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].hostDidFail(e)},e.prototype.command=function(e){e=ir.fromAny(e),this.onCommandMessage(e),this.host.command(this.nodeUri,this.laneUri,e)},e.prototype.sync=function(){var e=this.host.unresolve(this.nodeUri),t=new Yp(e,this.laneUri,this.prio,this.rate,this.body);this.onSyncRequest(t),this.host.push(t)},e.prototype.link=function(){var e=this.host.unresolve(this.nodeUri),t=new Hp(e,this.laneUri,this.prio,this.rate,this.body);this.onLinkRequest(t),this.host.push(t)},e.prototype.unlink=function(){Object.defineProperty(this,"status",{value:e.Unlinking,enumerable:!0,configurable:!0}),this.context.unlinkDownlink(this)},e.prototype.doUnlink=function(){0===this.views.length&&this.unlink()},e.prototype.close=function(){this.context.closeDownlink(this)},e.prototype.openUp=function(e){Object.defineProperty(this,"host",{value:e,enumerable:!0,configurable:!0});for(var t=0,r=this.views.length;t<r;t+=1)this.views[t].openUp(e)},e.prototype.closeUp=function(){var e=this.views;Object.defineProperty(this,"views",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1)e[t].closeUp()},e.Linking=1,e.Linked=2,e.Syncing=4,e.Synced=8,e.Unlinking=16,e}();e.DownlinkFlags=void 0,(zp=e.DownlinkFlags||(e.DownlinkFlags={}))[zp.KeepLinked=1]="KeepLinked",zp[zp.KeepSynced=2]="KeepSynced",zp[zp.KeepLinkedSynced=3]="KeepLinkedSynced";var uf=function(){function e(e,t,r,n,i,o,u,s,a,p,f){var c,l,h,d,y,v,b,m,g,w,O,P,j;void 0===n&&(n=yu.empty()),void 0===i&&(i=yu.empty()),void 0===o&&(o=yu.empty()),void 0===u&&(u=0),void 0===s&&(s=0),void 0===a&&(a=ir.absent()),void 0===p&&(p=0),void 0===f?f=x.empty:Array.isArray(f)||(f=[j=f]),void 0!==r&&(n=void 0!==r.hostUri?yu.fromAny(r.hostUri):n,i=void 0!==r.nodeUri?yu.fromAny(r.nodeUri):i,o=void 0!==r.laneUri?yu.fromAny(r.laneUri):o,u=void 0!==r.prio?r.prio:u,s=void 0!==r.rate?r.rate:s,a=void 0!==r.body?ir.fromAny(r.body):a,j=null!=j?j:{},f=x.inserted(j,f),j.onEvent=null!==(c=r.onEvent)&&void 0!==c?c:j.onEvent,j.onCommand=null!==(l=r.onCommand)&&void 0!==l?l:j.onCommand,j.willLink=null!==(h=r.willLink)&&void 0!==h?h:j.willLink,j.didLink=null!==(d=r.didLink)&&void 0!==d?d:j.didLink,j.willSync=null!==(y=r.willSync)&&void 0!==y?y:j.willSync,j.didSync=null!==(v=r.didSync)&&void 0!==v?v:j.didSync,j.willUnlink=null!==(b=r.willUnlink)&&void 0!==b?b:j.willUnlink,j.didUnlink=null!==(m=r.didUnlink)&&void 0!==m?m:j.didUnlink,j.didConnect=null!==(g=r.didConnect)&&void 0!==g?g:j.didConnect,j.didDisconnect=null!==(w=r.didDisconnect)&&void 0!==w?w:j.didDisconnect,j.didClose=null!==(O=r.didClose)&&void 0!==O?O:j.didClose,j.didFail=null!==(P=r.didFail)&&void 0!==P?P:j.didFail),Object.defineProperty(this,"context",{value:e,enumerable:!0}),Object.defineProperty(this,"owner",{value:t,enumerable:!0}),Object.defineProperty(this,"ownHostUri",{value:n,enumerable:!0}),Object.defineProperty(this,"ownNodeUri",{value:i,enumerable:!0}),Object.defineProperty(this,"ownLaneUri",{value:o,enumerable:!0}),Object.defineProperty(this,"ownPrio",{value:u,enumerable:!0}),Object.defineProperty(this,"ownRate",{value:s,enumerable:!0}),Object.defineProperty(this,"ownBody",{value:a,enumerable:!0}),Object.defineProperty(this,"flags",{value:p,enumerable:!0,configurable:!0}),Object.defineProperty(this,"model",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"observers",{value:f,enumerable:!0,configurable:!0})}return e.prototype.hostUri=function(e){return void 0===e?this.ownHostUri:(e=yu.fromAny(e),this.copy(this.context,this.owner,e,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers))},e.prototype.nodeUri=function(e){return void 0===e?this.ownNodeUri:(e=yu.fromAny(e),this.copy(this.context,this.owner,this.ownHostUri,e,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers))},e.prototype.laneUri=function(e){return void 0===e?this.ownLaneUri:(e=yu.fromAny(e),this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,e,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers))},e.prototype.prio=function(e){return void 0===e?this.ownPrio:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,e,this.ownRate,this.ownBody,this.flags,this.observers)},e.prototype.rate=function(e){return void 0===e?this.ownRate:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,e,this.ownBody,this.flags,this.observers)},e.prototype.body=function(e){return void 0===e?this.ownBody:(e=ir.fromAny(e),this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,e,this.flags,this.observers))},e.prototype.keepLinked=function(e){if(void 0===e)return 0!=(1&this.flags);var t=e?1|this.flags:-2&this.flags;return this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,t,this.observers)},e.prototype.keepSynced=function(e){if(void 0===e)return 0!=(2&this.flags);var t=e?2|this.flags:-3&this.flags;return this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,t,this.observers)},e.prototype.observe=function(e){return Object.defineProperty(this,"observers",{value:x.inserted(e,this.observers),enumerable:!0,configurable:!0}),this},e.prototype.unobserve=function(e){for(var t=this.observers,r=t.length,n=0;n<r;n+=1){var i=t[n],o=i===e;if(!o)for(var u in i)if(i[u]===e){o=!0;break}if(o){if(r>1){for(var s=new Array(r-1),a=0;a<n;a+=1)s[a]=t[a];for(a=n+1;a<r;a+=1)s[a-1]=t[a];Object.defineProperty(this,"observers",{value:s,enumerable:!0,configurable:!0})}else Object.defineProperty(this,"observers",{value:x.empty,enumerable:!0,configurable:!0});break}}return this},e.prototype.onEvent=function(e){return this.observe({onEvent:e})},e.prototype.onCommand=function(e){return this.observe({onCommand:e})},e.prototype.willLink=function(e){return this.observe({willLink:e})},e.prototype.didLink=function(e){return this.observe({didLink:e})},e.prototype.willSync=function(e){return this.observe({willSync:e})},e.prototype.didSync=function(e){return this.observe({didSync:e})},e.prototype.willUnlink=function(e){return this.observe({willUnlink:e})},e.prototype.didUnlink=function(e){return this.observe({didUnlink:e})},e.prototype.didConnect=function(e){return this.observe({didConnect:e})},e.prototype.didDisconnect=function(e){return this.observe({didDisconnect:e})},e.prototype.didClose=function(e){return this.observe({didClose:e})},e.prototype.didFail=function(e){return this.observe({didFail:e})},e.prototype.isConnected=function(){var e=this.model;return null!==e&&e.isConnected()},e.prototype.isAuthenticated=function(){var e=this.model;return null!==e&&e.isAuthenticated()},e.prototype.isLinked=function(){var e=this.model;return null!==e&&e.isLinked()},e.prototype.isSynced=function(){var e=this.model;return null!==e&&e.isSynced()},Object.defineProperty(e.prototype,"session",{get:function(){var e=this.model;return null!==e?e.session:ir.absent()},enumerable:!1,configurable:!0}),e.prototype.onEventMessage=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.onEvent&&i.onEvent(e.body,this)}},e.prototype.onCommandMessage=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.onCommand&&i.onCommand(e,this)}},e.prototype.onLinkRequest=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willLink&&i.willLink(this)}},e.prototype.onLinkedResponse=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didLink&&i.didLink(this)}},e.prototype.onSyncRequest=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willSync&&i.willSync(this)}},e.prototype.onSyncedResponse=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didSync&&i.didSync(this)}},e.prototype.onUnlinkRequest=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willUnlink&&i.willUnlink(this)}},e.prototype.onUnlinkedResponse=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didUnlink&&i.didUnlink(this)}},e.prototype.hostDidConnect=function(){for(var e=this.observers,t=0,r=e.length;t<r;t+=1){var n=e[t];void 0!==n.didConnect&&n.didConnect(this)}},e.prototype.hostDidDisconnect=function(){for(var e=this.observers,t=0,r=e.length;t<r;t+=1){var n=e[t];void 0!==n.didDisconnect&&n.didDisconnect(this)}},e.prototype.hostDidFail=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didFail&&i.didFail(e,this)}},e.prototype.command=function(e){this.model.command(e)},e.prototype.close=function(){var e=this.owner;null!==e&&e.removeDownlink(this);var t=this.model;null!==t&&t.removeDownlink(this)},e.prototype.openUp=function(e){},e.prototype.closeUp=function(){for(var e=this.observers,t=0,r=e.length;t<r;t+=1){var n=e[t];void 0!==n.didClose&&n.didClose(this)}},e.initForm=function(){return new sf},E([s],e,"initForm",null),e}(),sf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t.prototype.mold=function(e){if(void 0!==e){var t=or.create();return void 0!==e.hostUri&&t.slot("host",yu.fromAny(e.hostUri).toString()),void 0!==e.nodeUri&&t.slot("node",yu.fromAny(e.nodeUri).toString()),void 0!==e.laneUri&&t.slot("lane",yu.fromAny(e.laneUri).toString()),void 0!==e.prio&&t.slot("prio",e.prio),void 0!==e.rate&&t.slot("rate",e.rate),void 0!==e.body&&t.slot("body",e.body),void 0!==e.type&&t.slot("type",e.type),or.of(tr.of("link",t))}return Qt.extant()},t.prototype.cast=function(e){var t=e.toValue().get("link");if(t.isDefined()){var r={},n=t.get("host");n.isDefined()&&(r.hostUri=n.cast(yu.form()));var i=t.get("node");i.isDefined()&&(r.nodeUri=i.cast(yu.form()));var o=t.get("lane");o.isDefined()&&(r.laneUri=o.cast(yu.form()));var u=t.get("prio");u.isDefined()&&(r.prio=u.numberValue());var s=t.get("rate");s.isDefined()&&(r.rate=s.numberValue());var a=t.get("body");a.isDefined()&&(r.body=a);var p=t.get("type");return p.isDefined()&&(r.type=p.stringValue()),r}},t}(En);Object.defineProperty(sf.prototype,"tag",{get:function(){return"link"},enumerable:!0,configurable:!0});var af=function(e){function t(t,r,n,i,o,u,s){return e.call(this,t,r,n,i,o,u,s)||this}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"event"},enumerable:!1,configurable:!0}),t}(of),pf=function(e){function t(t,r,n,i,o,u,s,a,p,f,c){return void 0===f&&(f=1),e.call(this,t,r,n,i,o,u,s,a,p,f,c)||this}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"event"},enumerable:!1,configurable:!0}),t.prototype.copy=function(e,r,n,i,o,u,s,a,p,f){return new t(e,r,void 0,n,i,o,u,s,a,p,f)},t.prototype.observe=function(t){return e.prototype.observe.call(this,t)},t.prototype.open=function(){var e=this.ownLaneUri;if(e.isEmpty())throw new Error("no lane");var t=this.ownNodeUri;if(t.isEmpty())throw new Error("no node");var r=this.ownHostUri;r.isEmpty()&&(r=t.endpoint(),t=r.unresolve(t));var n=this.context.getDownlink(r,t,e);if(void 0!==n){if(!(n instanceof af))throw new Error("downlink type mismatch");n.addDownlink(this)}else(n=new af(this.context,r,t,e,this.ownPrio,this.ownRate,this.ownBody)).addDownlink(this),this.context.openDownlink(n);return Object.defineProperty(this,"model",{value:n,enumerable:!0,configurable:!0}),null!==this.owner&&this.owner.addDownlink(this),this},t}(uf),ff=function(e){function t(t,r,n,i,o,u,s,a){void 0===a&&(a=new St);var p=e.call(this,t,r,n,i,o,u,s)||this;return Object.defineProperty(p,"state",{value:a,enumerable:!0,configurable:!0}),p}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"list"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.state.length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return this.state.isEmpty()},t.prototype.get=function(e,t){return this.state.get(e,t)||ir.absent()},t.prototype.getEntry=function(e,t){return this.state.getEntry(e,t)},t.prototype.set=function(e,t,r){if(void 0!==r&&(e=this.state.lookup(r,e))<0)throw new RangeError(""+r);if(e<0||e>=this.state.length)throw new RangeError(""+e);t=this.listWillUpdate(e,t);var n=this.state.getEntry(e);this.state.set(e,t),this.listDidUpdate(e,t,n[1]);var i=or.create(2).slot("key",n[0]).slot("index",e);return this.command(tr.of("update",i).concat(t)),this},t.prototype.insert=function(e,t,r){if(e<0||e>this.state.length)throw new RangeError(""+e);t=this.listWillUpdate(e,t),this.state.insert(e,t,r);var n=this.state.getEntry(e);this.listDidUpdate(e,t,ir.absent());var i=or.create(2).slot("key",n[0]).slot("index",e);return this.command(tr.of("update",i).concat(t)),this},t.prototype.remove=function(e,t){if(void 0!==t&&(e=this.state.lookup(t,e))<0)throw new RangeError(""+t);if(e<0||e>this.state.length)throw new RangeError(""+e);this.listWillRemove(e);var r=this.state.getEntry(e);this.state.remove(e),this.listDidRemove(e,r[1]);var n=or.create(2).slot("key",r[0]).slot("index",e);return this.command(or.create(1).attr("remove",n)),this},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0;r<e.length;r+=1){var n=this.state.length+r,i=this.listWillUpdate(n,e[r]);this.state.insert(n,i);var o=this.state.getEntry(n);this.listDidUpdate(n,i,ir.absent());var u=or.create(2).slot("key",o[0]).slot("index",n);this.command(tr.of("update",u).concat(i))}return this.state.length},t.prototype.pop=function(){var e=this.state.length-1;if(e>=0){this.listWillRemove(e);var t=this.state.getEntry(e);this.state.remove(e),this.listDidRemove(e,t[1]);var r=or.create(2).slot("key",t[0]).slot("index",e);return this.command(or.create(1).attr("remove",r)),t[1]}return ir.absent()},t.prototype.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length-1;r>=0;r-=1){var n=this.listWillUpdate(0,e[r]);this.state.insert(0,n);var i=this.state.getEntry(0);this.listDidUpdate(0,n,ir.absent());var o=or.create(2).slot("key",i[0]).slot("index",0);this.command(tr.of("update",o).concat(n))}return this.state.length},t.prototype.shift=function(){if(this.state.length>0){this.listWillRemove(0);var e=this.state.getEntry(0);this.state.remove(0),this.listDidRemove(0,e[1]);var t=or.create(2).slot("key",e[0]).slot("index",0);return this.command(or.create(1).attr("remove",t)),e[1]}return ir.absent()},t.prototype.move=function(e,t,r){if(void 0!==r&&(e=this.state.lookup(r,e))<0)throw new RangeError(""+r);if(e<0||e>=this.state.length)throw new RangeError(""+e);if(t<0||t>=this.state.length)throw new RangeError(""+t);if(e!==t){var n=this.state.getEntry(e);this.listWillMove(e,t,n[1]),this.state.remove(e).insert(t,n[1],n[0]),this.listDidMove(e,t,n[1]);var i=or.create(2).slot("key",n[0]).slot("from",e).slot("to",t);this.command(or.create(1).attr("move",i))}return this},t.prototype.splice=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];e<0&&(e=this.state.length+e),e=Math.min(Math.max(0,e),this.state.length),void 0===t&&(t=this.state.length-e);for(var i=[],o=e,u=e+t;o<u;o+=1){this.listWillRemove(e);var s=this.state.getEntry(e);i.push(s[1]),this.state.remove(e),this.listDidRemove(e,s[1]);var a=or.create(2).slot("key",s[0]).slot("index",e);this.command(or.create(1).attr("remove",a))}for(o=0;o<r.length;o+=1){var p=e+o,f=this.listWillUpdate(p,r[o]);this.state.insert(p,f);var c=this.state.getEntry(p);this.listDidUpdate(p,f,ir.absent());a=or.create(2).slot("key",c[0]).slot("index",p);this.command(tr.of("update",a).concat(f))}return i},t.prototype.clear=function(){this.listWillClear(),this.state.clear(),this.listDidClear(),this.command(or.create(1).attr("clear"))},t.prototype.forEach=function(e,t){return this.state.forEach(e,t)},t.prototype.values=function(){return this.state.values()},t.prototype.keys=function(){return this.state.keys()},t.prototype.entries=function(){return this.state.entries()},t.prototype.snapshot=function(){return this.state.clone()},t.prototype.setState=function(e){Object.defineProperty(this,"state",{value:e,enumerable:!0,configurable:!0})},t.prototype.onEventMessage=function(t,r){e.prototype.onEventMessage.call(this,t,r);var n=t.body,i=n.tag;if("update"===i){var o=n.head().toValue();(u=this.state.lookup(o.get("key"),o.get("index").numberValue()))>=0?this.onUpdateEvent(u,n.body(),o.get("key")):this.onInsertEvent(o.get("index").numberValue(0),n.body(),o.get("key"))}else if("move"===i){o=n.head().toValue();(u=this.state.lookup(o.get("key"),o.get("from").numberValue()))>=0&&this.onMoveEvent(u,o.get("to").numberValue(0),o.get("key"))}else if("remove"===i){var u;o=n.head().toValue();(u=this.state.lookup(o.get("key"),o.get("index").numberValue()))>=0&&this.onRemoveEvent(u,o.get("key"))}else if("drop"===i){o=n.head();this.onDropEvent(o.numberValue(0))}else if("take"===i){o=n.head();this.onTakeEvent(o.numberValue(0))}else"clear"===i&&this.onClearEvent()},t.prototype.onInsertEvent=function(e,t,r){t=this.listWillUpdate(e,t),this.state.insert(e,t,r),this.listDidUpdate(e,t,ir.absent())},t.prototype.onUpdateEvent=function(e,t,r){t=this.listWillUpdate(e,t);var n=this.state.get(e)||ir.absent();this.state.set(e,t),this.listDidUpdate(e,t,n)},t.prototype.onMoveEvent=function(e,t,r){if(e!==(t=Math.min(Math.max(0,t),this.state.length))){var n=this.state.get(e)||ir.absent();this.listWillMove(e,t,n),this.state.remove(e).insert(t,n,r),this.listDidMove(e,t,n)}},t.prototype.onRemoveEvent=function(e,t){this.listWillRemove(e);var r=this.state.get(e)||ir.absent();this.state.remove(e),this.listDidRemove(e,r)},t.prototype.onDropEvent=function(e){this.listWillDrop(e),this.state.drop(e),this.listDidDrop(e)},t.prototype.onTakeEvent=function(e){this.listWillTake(e),this.state.take(e),this.listDidTake(e)},t.prototype.onClearEvent=function(){this.listWillClear(),this.state.clear(),this.listDidClear()},t.prototype.listWillUpdate=function(e,t){for(var r=this.views,n=0,i=r.length;n<i;n+=1)t=r[n].listWillUpdate(e,t);return t},t.prototype.listDidUpdate=function(e,t,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].listDidUpdate(e,t,r)},t.prototype.listWillMove=function(e,t,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].listWillMove(e,t,r)},t.prototype.listDidMove=function(e,t,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].listDidMove(e,t,r)},t.prototype.listWillRemove=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].listWillRemove(e)},t.prototype.listDidRemove=function(e,t){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].listDidRemove(e,t)},t.prototype.listWillDrop=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].listWillDrop(e)},t.prototype.listDidDrop=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].listDidDrop(e)},t.prototype.listWillTake=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].listWillTake(e)},t.prototype.listDidTake=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].listDidTake(e)},t.prototype.listWillClear=function(){for(var e=this.views,t=0,r=e.length;t<r;t+=1)e[t].listWillClear()},t.prototype.listDidClear=function(){for(var e=this.views,t=0,r=e.length;t<r;t+=1)e[t].listDidClear()},t}(of),cf=function(e){function t(t,r,n,i,o,u,s,a,p,f,c,l,h){var d,y,v,b,m,g,w,O,P,x,j,C;void 0===f&&(f=3),void 0===h&&(h=null);var E=e.call(this,t,r,n,i,o,u,s,a,p,f,c)||this;if(void 0!==n){var S=E.observers[E.observers.length-1];S.willUpdate=null!==(d=n.willUpdate)&&void 0!==d?d:S.willUpdate,S.didUpdate=null!==(y=n.didUpdate)&&void 0!==y?y:S.didUpdate,S.willMove=null!==(v=n.willMove)&&void 0!==v?v:S.willMove,S.didMove=null!==(b=n.didMove)&&void 0!==b?b:S.didMove,S.willRemove=null!==(m=n.willRemove)&&void 0!==m?m:S.willRemove,S.didRemove=null!==(g=n.didRemove)&&void 0!==g?g:S.didRemove,S.willDrop=null!==(w=n.willDrop)&&void 0!==w?w:S.willDrop,S.didDrop=null!==(O=n.didDrop)&&void 0!==O?O:S.didDrop,S.willTake=null!==(P=n.willTake)&&void 0!==P?P:S.willTake,S.didTake=null!==(x=n.didTake)&&void 0!==x?x:S.didTake,S.willClear=null!==(j=n.willClear)&&void 0!==j?j:S.willClear,S.didClear=null!==(C=n.didClear)&&void 0!==C?C:S.didClear,l=void 0!==n.valueForm?n.valueForm:l}return Object.defineProperty(E,"ownValueForm",{value:void 0!==l?l:En.forValue(),enumerable:!0}),Object.defineProperty(E,"state0",{value:h,enumerable:!0,configurable:!0}),E}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"list"},enumerable:!1,configurable:!0}),t.prototype.copy=function(e,r,n,i,o,u,s,a,p,f,c,l){return 10===arguments.length&&(c=this.ownValueForm,l=this.state0),new t(e,r,void 0,n,i,o,u,s,a,p,f,c,l)},t.prototype.valueForm=function(e){return void 0===e?this.ownValueForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,e,this.state0)},Object.defineProperty(t.prototype,"length",{get:function(){return this.model.length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return this.model.isEmpty()},t.prototype.get=function(e,t){return this.model.get(e,t).coerce(this.ownValueForm)},t.prototype.getEntry=function(e,t){var r=this.model.getEntry(e,t);if(void 0!==r)return[r[0].coerce(this.ownValueForm),r[1]]},t.prototype.set=function(e,t,r){var n=this.ownValueForm.mold(t);return this.model.set(e,n,r),this},t.prototype.insert=function(e,t,r){var n=this.ownValueForm.mold(t);return this.model.insert(e,n,r),this},t.prototype.remove=function(e,t){return this.model.remove(e,t),this},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=new Array(e.length),n=0;n<e.length;n+=1)r[n]=this.ownValueForm.mold(e[n]);return this.model.push.apply(this.model,r)},t.prototype.pop=function(){return this.model.pop().coerce(this.ownValueForm)},t.prototype.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=new Array(e.length),n=0;n<e.length;n+=1)r[n]=this.ownValueForm.mold(e[n]);return this.model.unshift.apply(this.model,r)},t.prototype.shift=function(){return this.model.shift().coerce(this.ownValueForm)},t.prototype.move=function(e,t,r){return this.model.move(e,t,r),this},t.prototype.splice=function(e,t){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var o=new Array(n.length),u=0;u<n.length;u+=1)o[u]=this.ownValueForm.mold(n[u]);var s=(r=this.model).splice.apply(r,S([e,t],o,!1)),a=new Array(s.length);for(u=0;u<s.length;u+=1)a[u]=s[u].coerce(this.ownValueForm);return a},t.prototype.clear=function(){this.model.clear()},t.prototype.forEach=function(e,t){return this.ownValueForm===En.forValue()?this.model.state.forEach(e,t):this.model.state.forEach((function(r,n,i){var o=r.coerce(this.ownValueForm);return e.call(t,o,n,i)}),this)},t.prototype.values=function(){var e=this.model.values();return this.ownValueForm===En.forValue()?e:new Rn(e,this.ownValueForm)},t.prototype.keys=function(){return this.model.keys()},t.prototype.entries=function(){var e=this.model.entries();return this.ownValueForm===En.forValue()?e:new Un(e,En.forValue(),this.ownValueForm)},t.prototype.snapshot=function(){return this.model.snapshot()},t.prototype.setState=function(e){this.model.setState(e)},t.prototype.observe=function(t){return e.prototype.observe.call(this,t)},t.prototype.willUpdate=function(e){return this.observe({willUpdate:e})},t.prototype.didUpdate=function(e){return this.observe({didUpdate:e})},t.prototype.willMove=function(e){return this.observe({willMove:e})},t.prototype.didMove=function(e){return this.observe({didMove:e})},t.prototype.willRemove=function(e){return this.observe({willRemove:e})},t.prototype.didRemove=function(e){return this.observe({didRemove:e})},t.prototype.willDrop=function(e){return this.observe({willDrop:e})},t.prototype.didDrop=function(e){return this.observe({didDrop:e})},t.prototype.willTake=function(e){return this.observe({willTake:e})},t.prototype.didTake=function(e){return this.observe({didTake:e})},t.prototype.willClear=function(e){return this.observe({willClear:e})},t.prototype.didClear=function(e){return this.observe({didClear:e})},t.prototype.listWillUpdate=function(e,t){for(var r,n=this.observers,i=0,o=n.length;i<o;i+=1){var u=n[i];if(void 0!==u.willUpdate){void 0===r&&(r=t.coerce(this.ownValueForm));var s=u.willUpdate(e,r,this);void 0!==s&&(r=s,t=this.ownValueForm.mold(r))}}return t},t.prototype.listDidUpdate=function(e,t,r){for(var n,i,o=this.observers,u=0,s=o.length;u<s;u+=1){var a=o[u];void 0!==a.didUpdate&&(void 0===n&&(n=t.coerce(this.ownValueForm)),void 0===i&&(i=r.coerce(this.ownValueForm)),a.didUpdate(e,n,i,this))}},t.prototype.listWillMove=function(e,t,r){for(var n,i=this.observers,o=0,u=i.length;o<u;o+=1){var s=i[o];void 0!==s.willMove&&(void 0===n&&(n=r.coerce(this.ownValueForm)),s.willMove(e,t,n,this))}},t.prototype.listDidMove=function(e,t,r){for(var n,i=this.observers,o=0,u=i.length;o<u;o+=1){var s=i[o];void 0!==s.didMove&&(void 0===n&&(n=r.coerce(this.ownValueForm)),s.didMove(e,t,n,this))}},t.prototype.listWillRemove=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willRemove&&i.willRemove(e,this)}},t.prototype.listDidRemove=function(e,t){for(var r,n=this.observers,i=0,o=n.length;i<o;i+=1){var u=n[i];void 0!==u.didRemove&&(void 0===r&&(r=t.coerce(this.ownValueForm)),u.didRemove(e,r,this))}},t.prototype.listWillDrop=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willDrop&&i.willDrop(e,this)}},t.prototype.listDidDrop=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didDrop&&i.didDrop(e,this)}},t.prototype.listWillTake=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willTake&&i.willTake(e,this)}},t.prototype.listDidTake=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didTake&&i.didTake(e,this)}},t.prototype.listWillClear=function(){for(var e=this.observers,t=0,r=e.length;t<r;t+=1){var n=e[t];void 0!==n.willClear&&n.willClear(this)}},t.prototype.listDidClear=function(){for(var e=this.observers,t=0,r=e.length;t<r;t+=1){var n=e[t];void 0!==n.didClear&&n.didClear(this)}},t.prototype.initialState=function(e){return void 0===e?this.state0:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownValueForm,e)},t.prototype.didAliasModel=function(){this.onLinkedResponse(),this.model.state.forEach((function(e,t){this.listDidUpdate(t,e,ir.absent())}),this),this.onSyncedResponse()},t.prototype.open=function(){var e,t=this.ownLaneUri;if(t.isEmpty())throw new Error("no lane");var r=this.ownNodeUri;if(r.isEmpty())throw new Error("no node");var n=this.ownHostUri;n.isEmpty()&&(n=r.endpoint(),r=n.unresolve(r));var i=this.context.getDownlink(n,r,t);if(void 0!==i){if(!(i instanceof ff))throw new Error("downlink type mismatch");i.addDownlink(this),Object.defineProperty(this,"model",{value:i,enumerable:!0,configurable:!0}),setTimeout(this.didAliasModel.bind(this))}else(i=new ff(this.context,n,r,t,this.ownPrio,this.ownRate,this.ownBody,null!==(e=this.state0)&&void 0!==e?e:void 0)).addDownlink(this),this.context.openDownlink(i),Object.defineProperty(this,"model",{value:i,enumerable:!0,configurable:!0});return null!==this.owner&&this.owner.addDownlink(this),this},t}(uf),lf=function(e){function t(t,r,n,i,o,u,s,a){void 0===a&&(a=new Ot);var p=e.call(this,t,r,n,i,o,u,s)||this;return Object.defineProperty(p,"state",{value:a,enumerable:!0,configurable:!0}),p}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"map"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.state.size},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return this.state.isEmpty()},t.prototype.has=function(e){return this.state.has(e)},t.prototype.get=function(e){var t;return null!==(t=this.state.get(e))&&void 0!==t?t:ir.absent()},t.prototype.getEntry=function(e){return this.state.getEntry(e)},t.prototype.set=function(e,t){var r;t=this.mapWillUpdate(e,t);var n=null!==(r=this.state.get(e))&&void 0!==r?r:ir.absent();this.state.set(e,t),this.mapDidUpdate(e,t,n);var i=or.create(1).slot("key",e);return this.command(tr.of("update",i).concat(t)),this},t.prototype.delete=function(e){var t;if(this.state.has(e)){this.mapWillRemove(e);var r=null!==(t=this.state.get(e))&&void 0!==t?t:ir.absent();this.state.delete(e),this.mapDidRemove(e,r);var n=or.create(1).slot("key",e);return this.command(or.create(1).attr("remove",n)),!0}return!1},t.prototype.drop=function(e){return this.mapWillDrop(e),this.state.drop(e),this.mapDidDrop(e),this.command(or.create(1).attr("drop",e)),this},t.prototype.take=function(e){return this.mapWillTake(e),this.state.take(e),this.mapDidTake(e),this.command(or.create(1).attr("take",e)),this},t.prototype.clear=function(){this.mapWillClear(),this.state.clear(),this.mapDidClear(),this.command(or.create(1).attr("clear"))},t.prototype.forEach=function(e,t){return this.state.forEach(e,t)},t.prototype.keys=function(){return this.state.keys()},t.prototype.values=function(){return this.state.values()},t.prototype.entries=function(){return this.state.entries()},t.prototype.snapshot=function(){return this.state.clone()},t.prototype.setState=function(e){Object.defineProperty(this,"state",{value:e,enumerable:!0,configurable:!0})},t.prototype.onEventMessage=function(t,r){e.prototype.onEventMessage.call(this,t,r);var n=t.body,i=n.tag;if("update"===i){var o=n.head().toValue();this.onUpdateEvent(o.get("key"),n.body())}else if("remove"===i){o=n.head().toValue();this.onRemoveEvent(o.get("key"))}else if("drop"===i){o=n.head().toValue();this.onDropEvent(o.numberValue(0))}else if("take"===i){o=n.head().toValue();this.onTakeEvent(o.numberValue(0))}else"clear"===i&&this.onClearEvent()},t.prototype.onUpdateEvent=function(e,t){var r;t=this.mapWillUpdate(e,t);var n=null!==(r=this.state.get(e))&&void 0!==r?r:ir.absent();this.state.set(e,t),this.mapDidUpdate(e,t,n)},t.prototype.onRemoveEvent=function(e){var t;this.mapWillRemove(e);var r=null!==(t=this.state.get(e))&&void 0!==t?t:ir.absent();this.state.delete(e),this.mapDidRemove(e,r)},t.prototype.onDropEvent=function(e){this.mapWillDrop(e),this.state.drop(e),this.mapDidDrop(e)},t.prototype.onTakeEvent=function(e){this.mapWillTake(e),this.state.take(e),this.mapDidTake(e)},t.prototype.onClearEvent=function(){this.mapWillClear(),this.state.clear(),this.mapDidClear()},t.prototype.mapWillUpdate=function(e,t){for(var r=this.views,n=0,i=r.length;n<i;n+=1)t=r[n].mapWillUpdate(e,t);return t},t.prototype.mapDidUpdate=function(e,t,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].mapDidUpdate(e,t,r)},t.prototype.mapWillRemove=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].mapWillRemove(e)},t.prototype.mapDidRemove=function(e,t){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].mapDidRemove(e,t)},t.prototype.mapWillDrop=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].mapWillDrop(e)},t.prototype.mapDidDrop=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].mapDidDrop(e)},t.prototype.mapWillTake=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].mapWillTake(e)},t.prototype.mapDidTake=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)t[r].mapDidTake(e)},t.prototype.mapWillClear=function(){for(var e=this.views,t=0,r=e.length;t<r;t+=1)e[t].mapWillClear()},t.prototype.mapDidClear=function(){for(var e=this.views,t=0,r=e.length;t<r;t+=1)e[t].mapDidClear()},t}(of),hf=function(e){function t(t,r,n,i,o,u,s,a,p,f,c,l,h,d){var y,v,b,m,g,w,O,P,j,C;void 0===f&&(f=3),void 0===d&&(d=null);var E=e.call(this,t,r,n,i,o,u,s,a,p,f,c)||this;if(void 0!==n){var S=E.observers[E.observers.length-1];S.willUpdate=null!==(y=n.willUpdate)&&void 0!==y?y:S.willUpdate,S.didUpdate=null!==(v=n.didUpdate)&&void 0!==v?v:S.didUpdate,S.willRemove=null!==(b=n.willRemove)&&void 0!==b?b:S.willRemove,S.didRemove=null!==(m=n.didRemove)&&void 0!==m?m:S.didRemove,S.willDrop=null!==(g=n.willDrop)&&void 0!==g?g:S.willDrop,S.didDrop=null!==(w=n.didDrop)&&void 0!==w?w:S.didDrop,S.willTake=null!==(O=n.willTake)&&void 0!==O?O:S.willTake,S.didTake=null!==(P=n.didTake)&&void 0!==P?P:S.didTake,S.willClear=null!==(j=n.willClear)&&void 0!==j?j:S.willClear,S.didClear=null!==(C=n.didClear)&&void 0!==C?C:S.didClear,l=void 0!==n.keyForm?n.keyForm:l,h=void 0!==n.valueForm?n.valueForm:h}return Object.defineProperty(E,"ownKeyForm",{value:void 0!==l?l:En.forValue(),enumerable:!0}),Object.defineProperty(E,"ownValueForm",{value:void 0!==h?h:En.forValue(),enumerable:!0}),Object.defineProperty(E,"state0",{value:d,enumerable:!0,configurable:!0}),Object.defineProperty(E,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(E,"effects",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(E,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(E,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(E,"version",{value:-1,enumerable:!0,configurable:!0}),E}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"map"},enumerable:!1,configurable:!0}),t.prototype.copy=function(e,r,n,i,o,u,s,a,p,f,c,l,h){return 10===arguments.length&&(h=this.state0,c=this.ownKeyForm,l=this.ownValueForm),new t(e,r,void 0,n,i,o,u,s,a,p,f,c,l,h)},t.prototype.keyForm=function(e){return void 0===e?this.ownKeyForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,e,this.ownValueForm,this.state0)},t.prototype.valueForm=function(e){return void 0===e?this.ownValueForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownKeyForm,e,this.state0)},Object.defineProperty(t.prototype,"size",{get:function(){return this.model.size},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return this.model.isEmpty()},t.prototype.has=function(e){var t=this.ownKeyForm.mold(e);return this.model.has(t)},t.prototype.get=function(e){if(void 0===e)return this;var t=this.ownKeyForm.mold(e);return this.model.get(t).coerce(this.ownValueForm)},t.prototype.getEntry=function(e){var t=this.model.getEntry(e);if(void 0!==t)return[t[0].coerce(this.ownKeyForm),t[1].coerce(this.ownValueForm)]},t.prototype.firstKey=function(){var e=this.model.state.firstKey();if(void 0!==e){var t=this.ownKeyForm.cast(e);if(void 0!==t)return t}return this.ownKeyForm.unit},t.prototype.firstValue=function(){var e=this.model.state.firstValue();if(void 0!==e){var t=this.ownValueForm.cast(e);if(void 0!==t)return t}return this.ownValueForm.unit},t.prototype.firstEntry=function(){var e=this.model.state.firstEntry();if(void 0!==e)return[this.ownKeyForm.cast(e[0]),this.ownValueForm.cast(e[1])]},t.prototype.lastKey=function(){var e=this.model.state.lastKey();if(void 0!==e){var t=this.ownKeyForm.cast(e);if(void 0!==t)return t}return this.ownKeyForm.unit},t.prototype.lastValue=function(){var e=this.model.state.lastValue();if(void 0!==e){var t=this.ownValueForm.cast(e);if(void 0!==t)return t}return this.ownValueForm.unit},t.prototype.lastEntry=function(){var e=this.model.state.lastEntry();if(void 0!==e)return[this.ownKeyForm.cast(e[0]),this.ownValueForm.cast(e[1])]},t.prototype.nextKey=function(e){var t=this.ownKeyForm.mold(e),r=this.model.state.nextKey(t);if(void 0!==r){var n=this.ownKeyForm.cast(r);if(void 0!==n)return n}return this.ownKeyForm.unit},t.prototype.nextValue=function(e){var t=this.ownKeyForm.mold(e),r=this.model.state.nextValue(t);if(void 0!==r){var n=this.ownValueForm.cast(r);if(void 0!==n)return n}return this.ownValueForm.unit},t.prototype.nextEntry=function(e){var t=this.ownKeyForm.mold(e),r=this.model.state.nextEntry(t);if(void 0!==r)return[this.ownKeyForm.cast(r[0]),this.ownValueForm.cast(r[1])]},t.prototype.previousKey=function(e){var t=this.ownKeyForm.mold(e),r=this.model.state.previousKey(t);if(void 0!==r){var n=this.ownKeyForm.cast(r);if(void 0!==n)return n}return this.ownKeyForm.unit},t.prototype.previousValue=function(e){var t=this.ownKeyForm.mold(e),r=this.model.state.previousValue(t);if(void 0!==r){var n=this.ownValueForm.cast(r);if(void 0!==n)return n}return this.ownValueForm.unit},t.prototype.previousEntry=function(e){var t=this.ownKeyForm.mold(e),r=this.model.state.previousEntry(t);if(void 0!==r)return[this.ownKeyForm.cast(r[0]),this.ownValueForm.cast(r[1])]},t.prototype.set=function(e,t){var r=this.ownKeyForm.mold(e),n=this.ownValueForm.mold(t);return this.model.set(r,n),this},t.prototype.delete=function(e){var t=this.ownKeyForm.mold(e);return this.model.delete(t)},t.prototype.drop=function(e){return this.model.drop(e),this},t.prototype.take=function(e){return this.model.take(e),this},t.prototype.clear=function(){this.model.clear()},t.prototype.forEach=function(e,t){return this.ownKeyForm===En.forValue()&&this.ownValueForm===En.forValue()?this.model.state.forEach(e,t):this.model.state.forEach((function(r,n){var i=r.coerce(this.ownKeyForm),o=n.coerce(this.ownValueForm);return e.call(t,i,o)}),this)},t.prototype.keys=function(){var e=this.model.keys();return this.ownKeyForm===En.forValue()?e:new Rn(e,this.ownKeyForm)},t.prototype.values=function(){var e=this.model.values();return this.ownValueForm===En.forValue()?e:new Rn(e,this.ownValueForm)},t.prototype.entries=function(){var e=this.model.entries();return this.ownKeyForm===En.forValue()&&this.ownValueForm===En.forValue()?e:new Un(e,this.ownKeyForm,this.ownValueForm)},t.prototype.snapshot=function(){return this.model.snapshot()},t.prototype.setState=function(e){this.model.setState(e)},t.prototype.observe=function(t){return e.prototype.observe.call(this,t)},t.prototype.willUpdate=function(e){return this.observe({willUpdate:e})},t.prototype.didUpdate=function(e){return this.observe({didUpdate:e})},t.prototype.willRemove=function(e){return this.observe({willRemove:e})},t.prototype.didRemove=function(e){return this.observe({didRemove:e})},t.prototype.willDrop=function(e){return this.observe({willDrop:e})},t.prototype.didDrop=function(e){return this.observe({didDrop:e})},t.prototype.willTake=function(e){return this.observe({willTake:e})},t.prototype.didTake=function(e){return this.observe({didTake:e})},t.prototype.willClear=function(e){return this.observe({willClear:e})},t.prototype.didClear=function(e){return this.observe({didClear:e})},t.prototype.mapWillUpdate=function(e,t){for(var r,n,i=this.observers,o=0,u=i.length;o<u;o+=1){var s=i[o];if(void 0!==s.willUpdate){void 0===r&&(r=e.coerce(this.ownKeyForm)),void 0===n&&(n=t.coerce(this.ownValueForm));var a=s.willUpdate(r,n,this);void 0!==a&&(n=a,t=this.ownValueForm.mold(n))}}return t},t.prototype.mapDidUpdate=function(e,t,r){for(var n,i,o=e.coerce(this.ownKeyForm),u=this.observers,s=0,a=u.length;s<a;s+=1){var p=u[s];void 0!==p.didUpdate&&(void 0===n&&(n=t.coerce(this.ownValueForm)),void 0===i&&(i=r.coerce(this.ownValueForm)),p.didUpdate(o,n,i,this))}this.decohereInputKey(o,0),this.recohereInput(0)},t.prototype.mapWillRemove=function(e){for(var t,r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.willRemove&&(void 0===t&&(t=e.coerce(this.ownKeyForm)),o.willRemove(t,this))}},t.prototype.mapDidRemove=function(e,t){for(var r,n=e.coerce(this.ownKeyForm),i=this.observers,o=0,u=i.length;o<u;o+=1){var s=i[o];void 0!==s.didRemove&&(void 0===r&&(r=t.coerce(this.ownValueForm)),s.didRemove(n,r,this))}this.decohereInputKey(n,1),this.recohereInput(0)},t.prototype.mapWillDrop=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willDrop&&i.willDrop(e,this)}},t.prototype.mapDidDrop=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didDrop&&i.didDrop(e,this)}},t.prototype.mapWillTake=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.willTake&&i.willTake(e,this)}},t.prototype.mapDidTake=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didTake&&i.didTake(e,this)}},t.prototype.mapWillClear=function(){for(var e=this.observers,t=0,r=e.length;t<r;t+=1){var n=e[t];void 0!==n.willClear&&n.willClear(this)}},t.prototype.mapDidClear=function(){for(var e=this.observers,t=0,r=e.length;t<r;t+=1){var n=e[t];void 0!==n.didClear&&n.didClear(this)}},t.prototype.initialState=function(e){return void 0===e?this.state0:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownKeyForm,this.ownValueForm,e)},t.prototype.didAliasModel=function(){this.onLinkedResponse(),this.model.state.forEach((function(e,t){this.mapDidUpdate(e,t,ir.absent())}),this),this.onSyncedResponse()},t.prototype.open=function(){var e,t=this.ownLaneUri;if(t.isEmpty())throw new Error("no lane");var r=this.ownNodeUri;if(r.isEmpty())throw new Error("no node");var n=this.ownHostUri;n.isEmpty()&&(n=r.endpoint(),r=n.unresolve(r));var i=this.context.getDownlink(n,r,t);if(void 0!==i){if(!(i instanceof lf))throw new Error("downlink type mismatch");i.addDownlink(this),Object.defineProperty(this,"model",{value:i,enumerable:!0,configurable:!0}),setTimeout(this.didAliasModel.bind(this))}else(i=new lf(this.context,n,r,t,this.ownPrio,this.ownRate,this.ownBody,null!==(e=this.state0)&&void 0!==e?e:void 0)).addDownlink(this),this.context.openDownlink(i),Object.defineProperty(this,"model",{value:i,enumerable:!0,configurable:!0});return null!==this.owner&&this.owner.addDownlink(this),this},t.prototype.keyIterator=function(){return this.keys()},t.prototype.bindInput=function(e){if(!Kn.is(e))throw new TypeError(""+e);var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},t.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},t.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},t.prototype.outlet=function(e){var t=this.outlets,r=t.get(e);return void 0===r&&(r=new Qn(this,e),Object.defineProperty(this,"outlets",{value:t.updated(e,r),enumerable:!0,configurable:!0})),r},t.prototype.outputIterator=function(){return k.array(this.outputs)},t.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},t.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},t.prototype.unbindOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.unbindOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){t[r].unbindInput()}},t.prototype.disconnectOutputs=function(){var e=this.outlets;e.isEmpty()&&(Object.defineProperty(this,"outlets",{value:new Ot,enumerable:!0,configurable:!0}),e.forEach((function(e,t){t.disconnectOutputs()}),this));var t=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var r=0,n=t.length;r<n;r+=1){var i=t[r];i.unbindInput(),i.disconnectOutputs()}},t.prototype.decohereOutputKey=function(e,t){this.decohereKey(e,t)},t.prototype.decohereInputKey=function(e,t){this.decohereKey(e,t)},t.prototype.decohereKey=function(e,t){var r=this.effects;if(r.get(e)!==t){this.willDecohereKey(e,t),Object.defineProperty(this,"effects",{value:r.updated(e,t),enumerable:!0,configurable:!0}),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohereKey(e,t);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var u=n[i];Ln.is(u)?u.decohereOutputKey(e,t):u.decohereOutput()}var s=this.outlets.get(e);void 0!==s&&s.decohereInput(),this.didDecohereKey(e,t)}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1){e[t].decohereOutput()}this.outlets.forEach((function(e,t){t.decohereInput()}),this),this.didDecohere()}},t.prototype.recohereOutputKey=function(e,t){this.recohereKey(e,t)},t.prototype.recohereInputKey=function(e,t){this.recohereKey(e,t)},t.prototype.recohereKey=function(e,t){if(this.version<0){var r=this.effects,n=r.get(e);if(void 0!==n){this.willRecohereKey(e,n,t),Object.defineProperty(this,"effects",{value:r.removed(e),enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInputKey(e,t),this.onRecohereKey(e,n,t);for(var i=this.outputs,o=0,u=i.length;o<u;o+=1){var s=i[o];Ln.is(s)&&s.recohereOutputKey(e,t)}var a=this.outlets.get(e);void 0!==a&&a.recohereInput(t),this.didRecohereKey(e,n,t)}}},t.prototype.recohereOutput=function(e){this.recohere(e)},t.prototype.recohereInput=function(e){this.recohere(e)},t.prototype.recohere=function(e){if(this.version<0){this.willRecohere(e),this.effects.forEach((function(t){this.recohereKey(t,e)}),this),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),this.onRecohere(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1){t[r].recohereOutput(e)}this.didRecohere(e)}},t.prototype.willDecohereKey=function(e,t){},t.prototype.onDecohereKey=function(e,t){},t.prototype.didDecohereKey=function(e,t){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohereKey=function(e,t,r){},t.prototype.onRecohereKey=function(e,t,r){if(0===t){var n=this.input;if(null!==n){var i=n.get(e);void 0!==i?this.set(e,i):this.delete(e)}}else 1===t&&this.delete(e)},t.prototype.didRecohereKey=function(e,t,r){},t.prototype.willRecohere=function(e){},t.prototype.onRecohere=function(e){},t.prototype.didRecohere=function(e){},t}(uf);Bn.define(hf.prototype);var df=function(e){function t(t,r,n,i,o,u,s,a){void 0===a&&(a=ir.absent());var p=e.call(this,t,r,n,i,o,u,s)||this;return Object.defineProperty(p,"state",{value:a,enumerable:!0,configurable:!0}),p}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"value"},enumerable:!1,configurable:!0}),t.prototype.get=function(){return this.state},t.prototype.set=function(e){e=this.valueWillSet(e);var t=this.state;this.setState(e),this.valueDidSet(e,t),this.command(e)},t.prototype.setState=function(e){Object.defineProperty(this,"state",{value:e,enumerable:!0,configurable:!0})},t.prototype.onEventMessage=function(t,r){e.prototype.onEventMessage.call(this,t,r),this.onSetEvent(t.body)},t.prototype.onSetEvent=function(e){e=this.valueWillSet(e);var t=this.state;this.setState(e),this.valueDidSet(e,t)},t.prototype.valueWillSet=function(e){for(var t=this.views,r=0,n=t.length;r<n;r+=1)e=t[r].valueWillSet(e);return e},t.prototype.valueDidSet=function(e,t){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].valueDidSet(e,t)},t}(of),yf=function(e){function t(t,r,n,i,o,u,s,a,p,f,c,l,h){var d,y;void 0===f&&(f=3),void 0===h&&(h=ir.absent());var v=e.call(this,t,r,n,i,o,u,s,a,p,f,c)||this;if(void 0!==n){var b=v.observers[v.observers.length-1];b.willSet=null!==(d=n.willSet)&&void 0!==d?d:b.willSet,b.didSet=null!==(y=n.didSet)&&void 0!==y?y:b.didSet,l=void 0!==n.valueForm?n.valueForm:l}return Object.defineProperty(v,"ownValueForm",{value:void 0!==l?l:En.forValue(),enumerable:!0}),Object.defineProperty(v,"state0",{value:h,enumerable:!0,configurable:!0}),Object.defineProperty(v,"input",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(v,"outputs",{value:x.empty,enumerable:!0,configurable:!0}),Object.defineProperty(v,"version",{value:-1,enumerable:!0,configurable:!0}),v}return C(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"value"},enumerable:!1,configurable:!0}),t.prototype.copy=function(e,r,n,i,o,u,s,a,p,f,c,l){return 10===arguments.length&&(l=this.state0,c=this.ownValueForm),new t(e,r,void 0,n,i,o,u,s,a,p,f,c,l)},t.prototype.valueForm=function(e){return void 0===e?this.ownValueForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,e,this.state0)},t.prototype.get=function(){return this.model.get().coerce(this.ownValueForm)},t.prototype.set=function(e){var t=this.ownValueForm.mold(e);this.model.set(t)},t.prototype.setState=function(e){this.model.setState(e)},t.prototype.observe=function(t){return e.prototype.observe.call(this,t)},t.prototype.willSet=function(e){return this.observe({willSet:e})},t.prototype.didSet=function(e){return this.observe({didSet:e})},t.prototype.valueWillSet=function(e){for(var t,r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];if(void 0!==o.willSet){void 0===t&&(t=e.coerce(this.ownValueForm));var u=o.willSet(t,this);void 0!==u&&(t=u,e=this.ownValueForm.mold(t))}}return e},t.prototype.valueDidSet=function(e,t){for(var r,n,i=this.observers,o=0,u=i.length;o<u;o+=1){var s=i[o];void 0!==s.didSet&&(void 0===r&&(r=e.coerce(this.ownValueForm)),void 0===n&&(n=t.coerce(this.ownValueForm)),s.didSet(r,n,this))}this.decohere(),this.recohere(0)},t.prototype.initialState=function(e){return void 0===e?this.state0:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownValueForm,e)},t.prototype.didAliasModel=function(){this.onLinkedResponse(),this.valueDidSet(this.model.get(),ir.absent()),this.onSyncedResponse()},t.prototype.open=function(){var e=this.ownLaneUri;if(e.isEmpty())throw new Error("no lane");var t=this.ownNodeUri;if(t.isEmpty())throw new Error("no node");var r=this.ownHostUri;r.isEmpty()&&(r=t.endpoint(),t=r.unresolve(t));var n=this.context.getDownlink(r,t,e);if(void 0!==n){if(!(n instanceof df))throw new Error("downlink type mismatch");n.addDownlink(this),Object.defineProperty(this,"model",{value:n,enumerable:!0,configurable:!0}),setTimeout(this.didAliasModel.bind(this))}else(n=new df(this.context,r,t,e,this.ownPrio,this.ownRate,this.ownBody,this.state0)).addDownlink(this),this.context.openDownlink(n),Object.defineProperty(this,"model",{value:n,enumerable:!0,configurable:!0});return null!==this.owner&&this.owner.addDownlink(this),this},t.prototype.bindInput=function(e){var t=this.input;t!==e&&(null!==t&&t.unbindOutput(this),Object.defineProperty(this,"input",{value:e,enumerable:!0,configurable:!0}),null!==e&&e.bindOutput(this))},t.prototype.unbindInput=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}))},t.prototype.disconnectInputs=function(){var e=this.input;null!==e&&(e.unbindOutput(this),Object.defineProperty(this,"input",{value:null,enumerable:!0,configurable:!0}),e.disconnectInputs())},t.prototype.outputIterator=function(){return k.array(this.outputs)},t.prototype.bindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.inserted(e,this.outputs),enumerable:!0,configurable:!0})},t.prototype.unbindOutput=function(e){Object.defineProperty(this,"outputs",{value:x.removed(e,this.outputs),enumerable:!0,configurable:!0})},t.prototype.unbindOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){e[t].unbindInput()}},t.prototype.disconnectOutputs=function(){var e=this.outputs;Object.defineProperty(this,"outputs",{value:x.empty,enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1){var n=e[t];n.unbindInput(),n.disconnectOutputs()}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),Object.defineProperty(this,"version",{value:-1,enumerable:!0,configurable:!0}),this.onDecohere();for(var e=this.outputs,t=0,r=e.length;t<r;t+=1)e[t].decohereOutput();this.didDecohere()}},t.prototype.recohereOutput=function(e){this.recohere(e)},t.prototype.recohereInput=function(e){this.recohere(e)},t.prototype.recohere=function(e){if(this.version<0){this.willRecohere(e),Object.defineProperty(this,"version",{value:e,enumerable:!0,configurable:!0}),null!==this.input&&this.input.recohereInput(e),this.onRecohere(e);for(var t=this.outputs,r=0,n=t.length;r<n;r+=1)t[r].recohereOutput(e);this.didRecohere(e)}},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohere=function(e){},t.prototype.onRecohere=function(e){var t=this.input;if(null!==t){var r=t.get();void 0!==r&&this.set(r)}},t.prototype.didRecohere=function(e){},t}(uf);Fn.define(yf.prototype);var vf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return C(t,e),t}(Ii),bf=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"downlink",{value:t,enumerable:!0}),r}return C(t,e),t.prototype.isEmpty=function(){return this.downlink.isEmpty()},t.prototype.isArray=function(){return!0},t.prototype.isObject=function(){return this.downlink.isEmpty()},Object.defineProperty(t.prototype,"length",{get:function(){return this.downlink.length},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return!1},t.prototype.get=function(e){return void 0===e?this:ir.absent()},t.prototype.getAttr=function(e){return ir.absent()},t.prototype.getSlot=function(e){return ir.absent()},t.prototype.getItem=function(e){e instanceof yr&&(e=e.value);var t=this.downlink.length;return e<0&&(e=t+e),(e=Math.min(Math.max(0,e),t-1))>=0?this.downlink.get(e):Qt.absent()},t.prototype.set=function(e,t){throw new Error("unsupported")},t.prototype.setAttr=function(e,t){throw new Error("unsupported")},t.prototype.setSlot=function(e,t){throw new Error("unsupported")},t.prototype.setItem=function(e,t){e instanceof yr&&(e=e.value);var r=this.downlink.length;return e<0&&(e=r+e),(e=Math.min(Math.max(0,e),r-1))>=0&&this.downlink.set(e,ir.fromAny(t)),this},t.prototype.push=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.downlink).push.apply(e,t)},t.prototype.splice=function(e,t){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return(r=this.downlink).splice.apply(r,S([e,t],n,!1))},t.prototype.delete=function(e){return Qt.absent()},t.prototype.clear=function(){this.downlink.clear()},t.prototype.forEach=function(e,t){return this.downlink.forEach(e,t)},t.prototype.keyIterator=function(){return k.empty()},t}(vf),mf=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"downlink",{value:t,enumerable:!0}),t.observe(r),r}return C(t,e),t.prototype.isEmpty=function(){return this.downlink.isEmpty()},t.prototype.isArray=function(){return this.downlink.isEmpty()},t.prototype.isObject=function(){return!0},Object.defineProperty(t.prototype,"length",{get:function(){return this.downlink.size},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return this.downlink.has(e)},t.prototype.get=function(e){return void 0===e?this:this.downlink.get(e)},t.prototype.getAttr=function(e){return ir.absent()},t.prototype.getSlot=function(e){return this.get(e)},t.prototype.getItem=function(e){e instanceof yr&&(e=e.value);var t=this.downlink.size;if(e<0&&(e=t+e),(e=Math.min(Math.max(0,e),t-1))>=0){var r=this.downlink.getEntry(e);return $t.of(r[0],r[1])}return Qt.absent()},t.prototype.set=function(e,t){return this.downlink.set(e,t),this},t.prototype.setAttr=function(e,t){throw new Error("unsupported")},t.prototype.setSlot=function(e,t){return this.set(e,t)},t.prototype.setItem=function(e,t){throw new Error("unsupported")},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw new Error("unsupported")},t.prototype.splice=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];throw new Error("unsupported")},t.prototype.delete=function(e){e=ir.fromAny(e);var t=this.downlink.get(e);return this.downlink.delete(e)?$t.of(e,t):Qt.absent()},t.prototype.clear=function(){this.downlink.clear()},t.prototype.forEach=function(e,t){var r=0;return this.downlink.forEach((function(n,i){var o=e.call(t,$t.of(n,i),r);return r+=1,o}))},t.prototype.keyIterator=function(){return this.downlink.keys()},t.prototype.didUpdate=function(e,t,r){this.decohereInputKey(e,0),this.recohereInput(0)},t.prototype.didRemove=function(e,t){this.decohereInputKey(e,1),this.recohereInput(0)},t.prototype.didDrop=function(e){},t.prototype.didTake=function(e){},t.prototype.didClear=function(){},t}(vf),gf=function(e){function t(t){var r=e.call(this)||this;return Object.defineProperty(r,"downlink",{value:t,enumerable:!0}),t.observe(r),r}return C(t,e),t.prototype.isEmpty=function(){var e=this.downlink.get();return e instanceof or?e.isEmpty():!e.isDefined()},t.prototype.isArray=function(){var e=this.downlink.get();return!(e instanceof or)||e.isArray()},t.prototype.isObject=function(){var e=this.downlink.get();return e instanceof or?e.isObject():!e.isDefined()},Object.defineProperty(t.prototype,"length",{get:function(){var e=this.downlink.get();return e instanceof or?e.length:e.isDefined()?1:0},enumerable:!1,configurable:!0}),t.prototype.has=function(e){var t=this.downlink.get();return t instanceof or&&t.has(e)},t.prototype.get=function(e){if(void 0===e)return this;var t=this.downlink.get();return t instanceof or?t.get(e):ir.absent()},t.prototype.getAttr=function(e){var t=this.downlink.get();return t instanceof or?t.getAttr(e):ir.absent()},t.prototype.getSlot=function(e){var t=this.downlink.get();return t instanceof or?t.getSlot(e):ir.absent()},t.prototype.getField=function(e){var t=this.downlink.get();return t instanceof or?t.getField(e):void 0},t.prototype.getItem=function(e){var t=this.downlink.get();return t instanceof or?t.getItem(e):t},t.prototype.set=function(e,t){var r=this.downlink.get();if(!(r instanceof or))throw new Error("unsupported");return r.set(e,t),this},t.prototype.setAttr=function(e,t){var r=this.downlink.get();if(!(r instanceof or))throw new Error("unsupported");return r.setAttr(e,t),this},t.prototype.setSlot=function(e,t){var r=this.downlink.get();if(!(r instanceof or))throw new Error("unsupported");return r.setSlot(e,t),this},t.prototype.setItem=function(e,t){var r=this.downlink.get();return r instanceof or?r.setItem(e,t):this.downlink.set(Qt.fromAny(t).toValue()),this},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.downlink.get();if(r instanceof or)return r.push.apply(r,e);throw new Error("unsupported")},t.prototype.splice=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=this.downlink.get();if(i instanceof or)return i.splice.apply(i,S([e,t],r,!1));throw new Error("unsupported")},t.prototype.delete=function(e){var t=this.downlink.get();return t instanceof or?t.delete(e):ir.absent()},t.prototype.clear=function(){var e=this.downlink.get();if(!(e instanceof or))throw new Error("unsupported");e.clear()},t.prototype.forEach=function(e,t){return this.downlink.get().forEach(e,t)},t.prototype.keyIterator=function(){if(this.downlink.get()instanceof or)throw new Error;return k.empty()},t.prototype.didSet=function(e,t){this.decohereInput(),this.recohereInput(0)},t}(vf),wf=function(e){function t(t){void 0===t&&(t=null);var r=e.call(this)||this;return r.warp=t,r}return C(t,e),t.prototype.reify=function(e){return e instanceof Jt?this.reifyField(e):this.reifyValue(e)},t.prototype.reifyField=function(e){var t=e.value,r=this.reifyValue(t);return t!==r?e.updatedValue(r):e},t.prototype.reifyValue=function(e){return e instanceof Ri?this.reifyModel(e):e},t.prototype.reifyModel=function(e){if("link"===e.tag){var t=new Of(this.warp,e);return t.compile(),t}return e},t}(Ni),Of=function(e){function t(t,r){void 0===t&&(t=null);var n=e.call(this,r)||this;return n.hostUri=n.inoutlet(),n.nodeUri=n.inoutlet(),n.laneUri=n.inoutlet(),n.prio=n.inoutlet(),n.rate=n.inoutlet(),n.bodyValue=n.inoutlet(),n.type=n.inoutlet(),n.state=n.outlet(),n.warp=t,n.downlink=null,n.downlinkRecord=null,n.inputHostUri=void 0,n.inputNodeUri=void 0,n.inputLaneUri=void 0,n.inputPrio=void 0,n.inputRate=void 0,n.inputBody=void 0,n.inputType=void 0,n}return C(t,e),t.prototype.getOutput=function(e){if((e=this.outlet(e))===this.state){if(this.downlink instanceof yf)return this.downlink.get();if(null!==this.downlinkRecord)return this.downlinkRecord}},t.prototype.onRecohere=function(e){var t,r=this.castInput(this.hostUri,En.forString()),n=this.castInput(this.nodeUri,En.forString()),i=this.castInput(this.laneUri,En.forString()),o=this.castInput(this.prio,En.forNumber(),0),u=this.castInput(this.rate,En.forNumber(),0),s=this.getInput(this.bodyValue),a=this.castInput(this.type,En.forString(),void 0);if(r!==this.inputHostUri||n!==this.inputNodeUri||i!==this.inputLaneUri||o!==this.inputPrio||u!==this.inputRate||(void 0===s?void 0!==this.inputBody:!s.equals(this.inputBody))||a!==this.inputType){null!==this.downlink&&(this.downlink.close(),this.downlink=null,this.downlinkRecord=null),this.inputHostUri=r,this.inputNodeUri=n,this.inputLaneUri=i,this.inputPrio=o,this.inputRate=u,this.inputBody=s,this.inputType=a;var p=null!==(t=this.warp)&&void 0!==t?t:Sf;if("map"===a){var f=p.downlinkMap();void 0!==r&&(f=f.hostUri(r)),void 0!==n&&(f=f.nodeUri(n)),void 0!==i&&(f=f.laneUri(i)),0!==o&&(f=f.prio(o)),0!==u&&(f=f.rate(u)),void 0!==s&&(f=f.body(s)),f=f.open(),this.state=f,this.downlink=f,this.downlinkRecord=new mf(f)}else if("value"===a){f=p.downlinkValue();void 0!==r&&(f=f.hostUri(r)),void 0!==n&&(f=f.nodeUri(n)),void 0!==i&&(f=f.laneUri(i)),void 0!==o&&(f=f.prio(o)),void 0!==u&&(f=f.rate(u)),void 0!==s&&(f=f.body(s)),f=f.open(),this.state=f,this.downlink=f}}},t.reifier=function(e){return void 0===e?(void 0===t._reifier&&(t._reifier=new wf),t._reifier):new wf(e)},E([Ai],t.prototype,"hostUri",void 0),E([Ai],t.prototype,"nodeUri",void 0),E([Ai],t.prototype,"laneUri",void 0),E([Ai],t.prototype,"prio",void 0),E([Ai],t.prototype,"rate",void 0),E([Ai("body")],t.prototype,"bodyValue",void 0),E([Ai],t.prototype,"type",void 0),E([Mi],t.prototype,"state",void 0),t}(Vi),Pf=function(){function e(e){Object.defineProperty(this,"context",{value:e,enumerable:!0}),Object.defineProperty(this,"host",{value:null,enumerable:!0,configurable:!0}),Object.defineProperty(this,"downlinks",{value:[],enumerable:!0,configurable:!0}),Object.defineProperty(this,"observers",{value:x.empty,enumerable:!0,configurable:!0})}return e.prototype.isConnected=function(){var e=this.host;return null!==e&&e.isConnected()},e.prototype.isAuthenticated=function(){var e=this.host;return null!==e&&e.isAuthenticated()},Object.defineProperty(e.prototype,"session",{get:function(){var e=this.host;return null!==e?e.session:ir.absent()},enumerable:!1,configurable:!0}),e.prototype.authenticate=function(e){this.context.authenticate(this.hostUri,e)},e.prototype.addDownlink=function(e){var t=this.downlinks;0===t.length&&this.open(),t.push(e)},e.prototype.removeDownlink=function(e){var t=this.downlinks,r=t.indexOf(e);r>=0&&(t.splice(r,1),0===t.length&&this.close())},e.prototype.open=function(){this.context.openRef(this)},e.prototype.close=function(){this.context.closeRef(this)},e.prototype.closeUp=function(){var e=this.downlinks;Object.defineProperty(this,"downlinks",{value:[],enumerable:!0,configurable:!0});for(var t=0,r=e.length;t<r;t+=1)e[t].close()},e.prototype.observe=function(e){return Object.defineProperty(this,"observers",{value:x.inserted(e,this.observers),enumerable:!0,configurable:!0}),this},e.prototype.unobserve=function(e){for(var t=this.observers,r=t.length,n=0;n<r;n+=1){var i=t[n],o=i===e;if(!o)for(var u in i)if(i[u]===e){o=!0;break}if(o){if(r>1){for(var s=new Array(r-1),a=0;a<n;a+=1)s[a]=t[a];for(a=n+1;a<r;a+=1)s[a-1]=t[a];Object.defineProperty(this,"observers",{value:s,enumerable:!0,configurable:!0})}else Object.defineProperty(this,"observers",{value:x.empty,enumerable:!0,configurable:!0});break}}return this},e.prototype.didConnect=function(e){return this.observe({didConnect:e})},e.prototype.didAuthenticate=function(e){return this.observe({didAuthenticate:e})},e.prototype.didDeauthenticate=function(e){return this.observe({didDeauthenticate:e})},e.prototype.didDisconnect=function(e){return this.observe({didDisconnect:e})},e.prototype.didFail=function(e){return this.observe({didFail:e})},e.prototype.hostDidConnect=function(e){Object.defineProperty(this,"host",{value:e,enumerable:!0,configurable:!0});for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didConnect&&i.didConnect(e,this)}},e.prototype.hostDidAuthenticate=function(e,t){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didAuthenticate&&o.didAuthenticate(e,t,this)}},e.prototype.hostDidDeauthenticate=function(e,t){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didDeauthenticate&&o.didDeauthenticate(e,t,this)}},e.prototype.hostDidDisconnect=function(e){Object.defineProperty(this,"host",{value:null,enumerable:!0,configurable:!0});for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didDisconnect&&i.didDisconnect(e,this)}},e.prototype.hostDidFail=function(e,t){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didFail&&o.didFail(e,t,this)}},e}(),xf=function(e){function t(t,r,n,i){var o=e.call(this,t)||this;return Object.defineProperty(o,"hostUri",{value:r,enumerable:!0}),Object.defineProperty(o,"nodeUri",{value:n,enumerable:!0}),Object.defineProperty(o,"laneUri",{value:i,enumerable:!0}),o}return C(t,e),t.prototype.hostRef=function(e){return e=yu.fromAny(e),new Cf(this.context,e)},t.prototype.nodeRef=function(e){return e=yu.fromAny(e),new jf(this.context,this.hostUri,e)},t.prototype.laneRef=function(e){return e=yu.fromAny(e),new t(this.context,this.hostUri,this.nodeUri,e)},t.prototype.downlink=function(e){return new pf(this.context,this,e,this.hostUri,this.nodeUri,this.laneUri)},t.prototype.downlinkList=function(e){return new cf(this.context,this,e,this.hostUri,this.nodeUri,this.laneUri)},t.prototype.downlinkMap=function(e){return new hf(this.context,this,e,this.hostUri,this.nodeUri,this.laneUri)},t.prototype.downlinkValue=function(e){return new yf(this.context,this,e,this.hostUri,this.nodeUri,this.laneUri)},t.prototype.command=function(e){this.context.command(this.hostUri,this.nodeUri,this.laneUri,e)},t}(Pf),jf=function(e){function t(t,r,n){var i=e.call(this,t)||this;return Object.defineProperty(i,"hostUri",{value:r,enumerable:!0}),Object.defineProperty(i,"nodeUri",{value:n,enumerable:!0}),i}return C(t,e),t.prototype.hostRef=function(e){return e=yu.fromAny(e),new Cf(this.context,e)},t.prototype.nodeRef=function(e){return e=yu.fromAny(e),new t(this.context,this.hostUri,e)},t.prototype.laneRef=function(e){return e=yu.fromAny(e),new xf(this.context,this.hostUri,this.nodeUri,e)},t.prototype.downlink=function(e){return new pf(this.context,this,e,this.hostUri,this.nodeUri)},t.prototype.downlinkList=function(e){return new cf(this.context,this,e,this.hostUri,this.nodeUri)},t.prototype.downlinkMap=function(e){return new hf(this.context,this,e,this.hostUri,this.nodeUri)},t.prototype.downlinkValue=function(e){return new yf(this.context,this,e,this.hostUri,this.nodeUri)},t.prototype.command=function(e,t){this.context.command(this.hostUri,this.nodeUri,e,t)},t}(Pf),Cf=function(e){function t(t,r){var n=e.call(this,t)||this;return Object.defineProperty(n,"hostUri",{value:r,enumerable:!0}),n}return C(t,e),t.prototype.hostRef=function(e){return e=yu.fromAny(e),new t(this.context,e)},t.prototype.nodeRef=function(e){return e=yu.fromAny(e),new jf(this.context,this.hostUri,e)},t.prototype.laneRef=function(e,t){return e=yu.fromAny(e),t=yu.fromAny(t),new xf(this.context,this.hostUri,e,t)},t.prototype.downlink=function(e){return new pf(this.context,this,e,this.hostUri)},t.prototype.downlinkList=function(e){return new cf(this.context,this,e,this.hostUri)},t.prototype.downlinkMap=function(e){return new hf(this.context,this,e,this.hostUri)},t.prototype.downlinkValue=function(e){return new yf(this.context,this,e,this.hostUri)},t.prototype.command=function(e,t,r){this.context.command(this.hostUri,e,t,r)},t}(Pf),Ef=function(){function e(e){void 0===e&&(e={}),void 0===e.keepOnline&&(e.keepOnline=!0),Object.defineProperty(this,"options",{value:e,enumerable:!0,configurable:!0}),Object.defineProperty(this,"hosts",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"downlinks",{value:new Ot,enumerable:!0,configurable:!0}),Object.defineProperty(this,"downlinkCount",{value:0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"refs",{value:[],enumerable:!0,configurable:!0}),Object.defineProperty(this,"online",{value:!0,enumerable:!0,configurable:!0}),Object.defineProperty(this,"observers",{value:x.empty,enumerable:!0,configurable:!0}),this.onOnline=this.onOnline.bind(this),this.onOffline=this.onOffline.bind(this),this.watchOnline(!!e.keepOnline)}return e.prototype.isOnline=function(e){return void 0===e?this.online:(this.online!==e&&(Object.defineProperty(this,"online",{value:e,enumerable:!0,configurable:!0}),e&&this.hosts.forEach((function(e,t){t.open()}),this)),this)},e.prototype.keepOnline=function(e){return void 0===e?!!this.options.keepOnline:(this.options.keepOnline!==e&&(this.options.keepOnline=e,this.watchOnline(e)),this)},e.prototype.watchOnline=function(e){"object"==typeof window&&(e?(window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)):(window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline)))},e.prototype.onOnline=function(e){this.isOnline(!0)},e.prototype.onOffline=function(e){this.isOnline(!1)},e.prototype.getHost=function(e){return e=yu.fromAny(e),this.hosts.get(e)},e.prototype.openHost=function(e){e=yu.fromAny(e);var t=this.hosts.get(e);return void 0===t&&(t=new nf(this,e,this.options),this.hosts.set(e,t)),t},e.prototype.closeHost=function(e){void 0!==this.hosts.get(e.hostUri)&&(this.hosts.delete(e.hostUri),e.closeUp())},e.prototype.getDownlink=function(e,t,r){var n=this.downlinks.get(e);if(void 0!==n){var i=n.get(t);if(void 0!==i)return i.get(r)}},e.prototype.openDownlink=function(e){var t=e.hostUri,r=e.nodeUri,n=e.laneUri,i=this.downlinks.get(t);void 0===i&&(i=new Ot,this.downlinks.set(t,i));var o=i.get(r);if(void 0===o&&(o=new Ot,i.set(r,o)),o.has(n))throw new Error("duplicate downlink");o.set(n,e),Object.defineProperty(this,"downlinkCount",{value:this.downlinkCount+1,enumerable:!0,configurable:!0}),this.openHost(t).openDownlink(e)},e.prototype.unlinkDownlink=function(e){var t=e.hostUri,r=this.getHost(t);void 0!==r&&r.unlinkDownlink(e)},e.prototype.closeDownlink=function(e){var t=e.hostUri,r=e.nodeUri,n=e.laneUri,i=this.downlinks.get(t);if(void 0!==i){var o=i.get(r);if(void 0!==o&&o.get(n)){Object.defineProperty(this,"downlinkCount",{value:this.downlinkCount-1,enumerable:!0,configurable:!0}),o.delete(n),o.isEmpty()&&(i.delete(r),i.isEmpty()&&this.downlinks.delete(t));var u=this.getHost(t);void 0!==u&&u.closeDownlink(e)}}},e.prototype.downlink=function(e){return new pf(this,null,e)},e.prototype.downlinkList=function(e){return new cf(this,null,e)},e.prototype.downlinkMap=function(e){return new hf(this,null,e)},e.prototype.downlinkValue=function(e){return new yf(this,null,e)},e.prototype.openRef=function(e){this.refs.push(e)},e.prototype.closeRef=function(e){var t=this.refs,r=t.indexOf(e);r>=0&&(t.splice(r,1),e.closeUp())},e.prototype.hostRef=function(e){return e=yu.fromAny(e),new Cf(this,e)},e.prototype.nodeRef=function(e,t){return e=yu.fromAny(e),void 0===t?(e=(t=e).endpoint(),t=e.unresolve(t)):t=yu.fromAny(t),new jf(this,e,t)},e.prototype.laneRef=function(e,t,r){return e=yu.fromAny(e),t=yu.fromAny(t),void 0===r?(r=t,e=(t=e).endpoint(),t=e.unresolve(t)):r=yu.fromAny(r),new xf(this,e,t,r)},e.prototype.authenticate=function(e,t){e=yu.fromAny(e),t=ir.fromAny(t),this.openHost(e).authenticate(t)},e.prototype.command=function(e,t,r,n){e=yu.fromAny(e),t=yu.fromAny(t),3===arguments.length?(n=r,r=t,e=(t=e).endpoint(),t=e.unresolve(t)):r=yu.fromAny(r),n=ir.fromAny(n);var i=this.openHost(e);i.command(t,r,n)},e.prototype.close=function(){var e=this.refs;Object.defineProperty(this,"refs",{value:[],enumerable:!0,configurable:!0});for(var t=0;t<e.length;t+=1)e[t].closeUp();var r=this.downlinks.clone();this.downlinks.clear(),Object.defineProperty(this,"downlinkCount",{value:0,enumerable:!0,configurable:!0}),r.forEach((function(e,t){t.forEach((function(t,r){r.forEach((function(t,r){r.closeUp();var n=this.getHost(e);void 0!==n&&n.closeDownlink(r)}),this)}),this)}),this);var n=this.hosts.clone();this.hosts.clear(),n.forEach((function(e,t){t.closeUp()}),this)},e.prototype.observe=function(e){return Object.defineProperty(this,"observers",{value:x.inserted(e,this.observers),enumerable:!0,configurable:!0}),this},e.prototype.unobserve=function(e){for(var t=this.observers,r=t.length,n=0;n<r;n+=1){var i=t[n],o=i===e;if(!o)for(var u in i)if(i[u]===e){o=!0;break}if(o){if(r>1){for(var s=new Array(r-1),a=0;a<n;a+=1)s[a]=t[a];for(a=n+1;a<r;a+=1)s[a-1]=t[a];Object.defineProperty(this,"observers",{value:s,enumerable:!0,configurable:!0})}else Object.defineProperty(this,"observers",{value:x.empty,enumerable:!0,configurable:!0});break}}return this},e.prototype.didConnect=function(e){return this.observe({didConnect:e})},e.prototype.didAuthenticate=function(e){return this.observe({didAuthenticate:e})},e.prototype.didDeauthenticate=function(e){return this.observe({didDeauthenticate:e})},e.prototype.didDisconnect=function(e){return this.observe({didDisconnect:e})},e.prototype.didFail=function(e){return this.observe({didFail:e})},e.prototype.hostDidConnect=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didConnect&&i.didConnect(e,this)}var o=this.refs;for(r=0,n=o.length;r<n;r+=1){var u=o[r];u.hostUri.equals(e.hostUri)&&u.hostDidConnect(e)}},e.prototype.hostDidAuthenticate=function(e,t){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didAuthenticate&&o.didAuthenticate(e,t,this)}var u=this.refs;for(n=0,i=u.length;n<i;n+=1){var s=u[n];s.hostUri.equals(t.hostUri)&&s.hostDidAuthenticate(e,t)}},e.prototype.hostDidDeauthenticate=function(e,t){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didDeauthenticate&&o.didDeauthenticate(e,t,this)}var u=this.refs;for(n=0,i=u.length;n<i;n+=1){var s=u[n];s.hostUri.equals(t.hostUri)&&s.hostDidDeauthenticate(e,t)}},e.prototype.hostDidDisconnect=function(e){for(var t=this.observers,r=0,n=t.length;r<n;r+=1){var i=t[r];void 0!==i.didDisconnect&&i.didDisconnect(e,this)}var o=this.refs;for(r=0,n=o.length;r<n;r+=1){var u=o[r];u.hostUri.equals(e.hostUri)&&u.hostDidDisconnect(e)}},e.prototype.hostDidFail=function(e,t){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didFail&&o.didFail(e,t,this)}var u=this.refs;for(n=0,i=u.length;n<i;n+=1){var s=u[n];s.hostUri.equals(t.hostUri)&&s.hostDidFail(e,t)}},e}(),Sf=new Ef,kf=Sf.isOnline.bind(Sf),Mf=Sf.keepOnline.bind(Sf),Af=Sf.downlink.bind(Sf),Df=Sf.downlinkList.bind(Sf),If=Sf.downlinkMap.bind(Sf),Tf=Sf.downlinkValue.bind(Sf),Vf=Sf.hostRef.bind(Sf),qf=Sf.nodeRef.bind(Sf),Rf=Sf.laneRef.bind(Sf),Uf=Sf.authenticate.bind(Sf),Nf=Sf.command.bind(Sf);e.Absent=gr,e.AbstractInlet=Yn,e.AbstractInoutlet=_n,e.AbstractMapInlet=Zn,e.AbstractMapInletMapOutlet=ti,e.AbstractMapInletOutlet=ei,e.AbstractMapInoutlet=$n,e.AbstractMapOutlet=Jn,e.AbstractOutlet=Gn,e.AbstractRecordOutlet=Ii,e.AbstractRecordStreamlet=Vi,e.AbstractStreamlet=ki,e.AffineTransform=ia,e.AffineTransformInterpolator=oa,e.AffineTransformParser=ua,e.AndOperator=Ir,e.AndOutlet=Wi,e.Angle=us,e.AngleForm=ls,e.AngleInterpolator=cs,e.AngleParser=hs,e.AnyForm=Tn,e.ArrayInterpolator=it,e.Arrays=x,e.AssertException=I,e.Attr=tr,e.AttrInterpolator=rr,e.AuthRequest=Zp,e.AuthedResponse=Jp,e.BTree=Ot,e.BTreeContext=wt,e.BTreeLeaf=xt,e.BTreeNode=jt,e.BTreeNodeCursor=Ct,e.BTreePage=Pt,e.Base10=ie,e.Base10IntegerWriter=Fe,e.Base10NumberParser=Ne,e.Base16=Ve,e.Base16IntegerWriter=Be,e.Base16Parser=Le,e.Base16Writer=Ke,e.Base64=We,e.Base64Parser=Ye,e.Base64Writer=Ge,e.BaseRef=Pf,e.Binary=Ae,e.BinaryOperator=Pr,e.BinaryOperatorInterpolator=xr,e.BinaryOutlet=Fi,e.BitwiseAndOperator=qr,e.BitwiseAndOutlet=Yi,e.BitwiseNotOperator=Gr,e.BitwiseNotOutlet=uo,e.BitwiseOrOperator=Tr,e.BitwiseOrOutlet=Hi,e.BitwiseXorOperator=Vr,e.BitwiseXorOutlet=Xi,e.Bool=br,e.BooleanForm=In,e.Booleans=v,e.BridgeFunc=hn,e.ByteOrder=p,e.ByteOutput=Se,e.ByteOutputBuffer=Me,e.ByteOutputUint8Array=ke,e.ChildrenSelector=sn,e.CommandMessage=Wp,e.Compare=i,e.ConditionalOperator=Er,e.ConditionalOperatorInterpolator=Sr,e.ConditionalOutlet=Ki,e.Constraint=Xt,e.ConstraintBinding=Wt,e.ConstraintConstant=Bt,e.ConstraintDummy=Rt,e.ConstraintError=Ut,e.ConstraintExpression=zt,e.ConstraintGroup=Yt,e.ConstraintInvalid=Nt,e.ConstraintKey=It,e.ConstraintMap=Tt,e.ConstraintProduct=Kt,e.ConstraintRow=Gt,e.ConstraintSlack=qt,e.ConstraintSolver=_t,e.ConstraintStrength=Ht,e.ConstraintSum=Ft,e.ConstraintSymbol=Vt,e.ConstraintTerm=Lt,e.Constructors=w,e.ContinuousScale=dt,e.Cursor=k,e.CursorArray=D,e.CursorEmpty=M,e.CursorUnary=A,e.Data=cr,e.DataOutput=lr,e.Dataflow=fo,e.DateTime=Na,e.DateTimeForm=Fa,e.DateTimeFormat=Wa,e.DateTimeInterpolator=za,e.DateTimeLocale=Ka,e.DateTimeParser=La,e.DateTimeSpecifiers=Ba,e.DayInterval=Ep,e.DayOfMonthFormat=_a,e.DayOfMonthParser=pp,e.DeauthRequest=$p,e.DeauthedResponse=ef,e.DegAngle=ss,e.DescendantsSelector=an,e.Diagnostic=oe,e.DivideOperator=Hr,e.DivideOutlet=no,e.Domain=Qe,e.Downlink=uf,e.DownlinkModel=of,e.DownlinkRecord=vf,e.DownlinkReifier=wf,e.DownlinkStreamlet=Of,e.Easing=st,e.EmLength=$u,e.Envelope=Np,e.EqOperator=Nr,e.EqOutlet=Qi,e.Equals=t,e.Equivalent=n,e.EventDownlink=pf,e.EventDownlinkModel=af,e.EventMessage=Bp,e.Expression=wr,e.Extant=mr,e.Field=Jt,e.FieldInterpolator=er,e.FilterFieldsCombinator=ci,e.FilterFieldsOperator=fi,e.FilterSelector=pn,e.FilterTimeInterval=Op,e.Form=En,e.FormException=Cn,e.Format=ne,e.FromAny=o,e.Func=cn,e.Functions=g,e.GeOperator=Fr,e.GeOutlet=Ji,e.GeoBox=Oa,e.GeoBoxInterpolator=xa,e.GeoCurve=da,e.GeoGroup=ja,e.GeoJson=Ca,e.GeoJsonFeature=Va,e.GeoJsonFeatureCollection=qa,e.GeoJsonGeometry=Ea,e.GeoJsonGeometryCollection=Ta,e.GeoJsonLineString=Ma,e.GeoJsonMultiLineString=Aa,e.GeoJsonMultiPoint=ka,e.GeoJsonMultiPolygon=Ia,e.GeoJsonPoint=Sa,e.GeoJsonPolygon=Da,e.GeoPath=ga,e.GeoPathBuilder=wa,e.GeoPoint=la,e.GeoPointInterpolator=ha,e.GeoProjection=fa,e.GeoSegment=ya,e.GeoSegmentInterpolator=va,e.GeoShape=ca,e.GeoSpline=ba,e.GeoSplineBuilder=ma,e.GeoTile=Pa,e.GetAttrSelector=rn,e.GetItemSelector=nn,e.GetOutlet=zi,e.GetSelector=tn,e.GradAngle=ps,e.GtOperator=Lr,e.GtOutlet=$i,e.HashCode=r,e.HashGenCacheMap=R,e.HashGenCacheSet=N,e.Host=tf,e.HostAddressed=Fp,e.HostRef=Cf,e.Hour12Format=$a,e.Hour12Parser=hp,e.Hour24Format=Ja,e.Hour24Parser=lp,e.HourInterval=Sp,e.Identity=l,e.IdentityInterpolator=tt,e.IdentitySelector=en,e.IdentityTransform=Hs,e.In=function(e,t){if(1===arguments.length)return"string"==typeof e&&(e={name:e}),ki.decorateInlet.bind(void 0,e);ki.decorateInlet({},e,t)},e.Inlet=Nn,e.InletDescriptor=Ci,e.Inout=Ai,e.Input=Y,e.InputBuffer=ae,e.InputBufferDone=fe,e.InputBufferEmpty=pe,e.InputBufferError=ce,e.InputDone=se,e.InputEmpty=ue,e.InputError=G,e.InputException=H,e.InputSettings=X,e.Interpolate=Je,e.Interpolator=$e,e.InterpolatorInterpolator=ot,e.InterpolatorMap=et,e.Interpreter=Ar,e.InterpreterException=kr,e.InterpreterSettings=Mr,e.InvokeOperator=Zr,e.InvokeOperatorInterpolator=Jr,e.InvokeOutlet=po,e.Item=Qt,e.ItemForm=Vn,e.ItemInterpolator=Zt,e.KeyOutlet=Qn,e.KeysCursor=bt,e.KeysSelector=on,e.LambdaFunc=ln,e.LaneAddressed=Lp,e.LaneRef=xf,e.Lazy=s,e.LeOperator=Ur,e.LeOutlet=_i,e.Length=Zu,e.LengthException=Qu,e.LengthForm=is,e.LengthInterpolator=ns,e.LengthParser=os,e.LinearDomain=pt,e.LinearDomainInterpolator=ft,e.LinearRange=ct,e.LinearRangeInterpolator=lt,e.LinearScale=yt,e.LinearScaleInterpolator=vt,e.LinkAddressed=Kp,e.LinkRequest=Hp,e.LinkedResponse=Xp,e.ListDownlink=cf,e.ListDownlinkModel=ff,e.ListDownlinkRecord=bf,e.LiteralSelector=fn,e.LtOperator=Rr,e.LtOutlet=Gi,e.MapDownlink=hf,e.MapDownlinkModel=lf,e.MapDownlinkRecord=mf,e.MapFieldValuesCombinator=yi,e.MapFieldValuesOperator=di,e.MapInlet=Ln,e.MapInput=ui,e.MapOutlet=Kn,e.MapOutletCombinators=Bn,e.MapOutput=si,e.MapValueCombinator=hi,e.MapValueOperator=li,e.Mapping=_e,e.Mark=L,e.MathModule=dn,e.MemoizeMapCombinator=pi,e.MemoizeValueCombinator=ai,e.MillisecondFormat=np,e.MillisecondInterval=Ap,e.MillisecondParser=bp,e.MillisecondsInterval=Dp,e.MinusOperator=Br,e.MinusOutlet=to,e.MinuteFormat=tp,e.MinuteInterval=kp,e.MinuteParser=yp,e.ModuloOperator=Xr,e.ModuloOutlet=io,e.MonthFormat=Ya,e.MonthInterval=jp,e.MonthOfYearFormat=Xa,e.MonthOfYearParser=up,e.MonthParser=sp,e.Murmur3=c,e.NeOperator=zr,e.NeOutlet=Zi,e.NegativeOperator=_r,e.NegativeOutlet=so,e.NodeCursor=gt,e.NodeRef=jf,e.NotOperator=Yr,e.NotOutlet=oo,e.Num=yr,e.NumInterpolator=vr,e.NumberForm=Dn,e.NumberInterpolator=nt,e.Numbers=b,e.Objects=O,e.Operator=Or,e.OrOperator=Dr,e.OrOutlet=Bi,e.Out=Mi,e.Outlet=zn,e.OutletCombinators=Fn,e.OutletDescriptor=Ei,e.OutletInlet=ri,e.OutletMapInlet=ni,e.Output=Z,e.OutputBuffer=ye,e.OutputBufferDone=be,e.OutputBufferError=me,e.OutputBufferFull=ve,e.OutputDone=he,e.OutputError=de,e.OutputException=Q,e.OutputFull=le,e.OutputSettings=W,e.OutputStyle=B,e.Parser=we,e.ParserDone=Oe,e.ParserError=Pe,e.ParserException=ge,e.PatternFormat=ip,e.PatternParser=mp,e.PctLength=ts,e.PeriodFormat=ep,e.PeriodParser=dp,e.PlusOperator=Kr,e.PlusOutlet=eo,e.PositiveOperator=Qr,e.PositiveOutlet=ao,e.PxLength=Ju,e.R2BezierCurve=Os,e.R2Box=Ns,e.R2BoxInterpolator=zs,e.R2Circle=Us,e.R2CircleInterpolator=Fs,e.R2CubicCurve=Ss,e.R2CubicCurveParser=ks,e.R2Curve=gs,e.R2CurveParser=ws,e.R2EllipticCurve=Ms,e.R2EllipticCurveParser=As,e.R2Group=Ls,e.R2Path=Vs,e.R2PathBuilder=qs,e.R2PathParser=Rs,e.R2Point=bs,e.R2PointInterpolator=ms,e.R2QuadraticCurve=Cs,e.R2QuadraticCurveParser=Es,e.R2Segment=Ps,e.R2SegmentInterpolator=xs,e.R2SegmentParser=js,e.R2Shape=vs,e.R2Spline=Ds,e.R2SplineBuilder=Is,e.R2SplineParser=Ts,e.R2Vector=ds,e.R2VectorInterpolator=ys,e.RadAngle=as,e.Random=a,e.Range=Ze,e.Recon=co,e.ReconParser=Ko,e.ReconStructureParser=Bo,e.ReconStructureWriter=hu,e.ReconWriter=lu,e.Record=or,e.RecordCursor=ar,e.RecordFieldUpdater=qi,e.RecordInterpolator=sr,e.RecordMap=pr,e.RecordMapView=fr,e.RecordModel=Ri,e.RecordOutlet=Di,e.RecordScope=Ui,e.RecordStreamlet=Ti,e.ReduceFieldsCombinator=bi,e.ReduceFieldsOperator=vi,e.Reifier=Ni,e.RemLength=es,e.RemoteHost=rf,e.RotateTransform=Js,e.RotateTransformInterpolator=$s,e.RotateTransformParser=ea,e.STree=St,e.STreeContext=Et,e.STreeLeaf=Mt,e.STreeNode=At,e.STreeNodeCursor=Dt,e.STreePage=kt,e.Scale=ht,e.ScaleTransform=_s,e.ScaleTransformInterpolator=Qs,e.ScaleTransformParser=Zs,e.SecondFormat=rp,e.SecondInterval=Mp,e.SecondParser=vp,e.Selector=$r,e.Severity=q,e.ShortMonthFormat=Ga,e.ShortMonthParser=ap,e.ShortWeekdayFormat=Za,e.ShortWeekdayParser=cp,e.SkewTransform=ta,e.SkewTransformInterpolator=ra,e.SkewTransformParser=na,e.Slot=$t,e.SlotInterpolator=nr,e.Span=K,e.StepInterpolator=rt,e.Streamlet=Xn,e.StreamletException=Wn,e.StreamletInlet=Pi,e.StreamletInoutlet=ji,e.StreamletOutlet=xi,e.StreamletScope=Hn,e.StringForm=An,e.StringInput=_,e.StringOutput=J,e.StringWriter=te,e.Strings=m,e.SyncRequest=Yp,e.SyncedResponse=Gp,e.Tag=F,e.TagForm=Sn,e.Text=hr,e.TextOutput=dr,e.TimeDomain=Ip,e.TimeDomainInterpolator=Tp,e.TimeInterval=gp,e.TimeRange=Vp,e.TimeRangeInterpolator=qp,e.TimeScale=Rp,e.TimeScaleInterpolator=Up,e.TimeZone=Ra,e.TimeZoneForm=Ua,e.TimesOperator=Wr,e.TimesOutlet=ro,e.Timing=ut,e.ToAny=u,e.Transform=Ks,e.TransformForm=Bs,e.TransformList=sa,e.TransformListInterpolator=aa,e.TransformListParser=pa,e.TransformParser=Ws,e.TranslateTransform=Xs,e.TranslateTransformInterpolator=Ys,e.TranslateTransformParser=Gs,e.TurnAngle=fs,e.Tweening=at,e.UnaryOperator=jr,e.UnaryOperatorInterpolator=Cr,e.UnaryOutlet=Li,e.Unicode=re,e.UnitForm=kn,e.UnitTimeInterval=wp,e.UnitlessLength=rs,e.UnlinkRequest=_p,e.UnlinkedResponse=Qp,e.Uri=yu,e.UriAbsoluteParser=zu,e.UriAuthority=bu,e.UriAuthorityParser=Lu,e.UriCache=Uu,e.UriException=du,e.UriForm=Ru,e.UriFragment=qu,e.UriFragmentParser=_u,e.UriHost=gu,e.UriHostAddressParser=Wu,e.UriHostIPv4=Ou,e.UriHostIPv6=Pu,e.UriHostLiteralParser=Hu,e.UriHostName=wu,e.UriHostParser=Bu,e.UriHostUndefined=xu,e.UriParser=Nu,e.UriPath=Cu,e.UriPathBuilder=Mu,e.UriPathEmpty=ku,e.UriPathForm=Au,e.UriPathParser=Yu,e.UriPathSegment=Eu,e.UriPathSlash=Su,e.UriPort=ju,e.UriPortParser=Xu,e.UriQuery=Du,e.UriQueryBuilder=Vu,e.UriQueryParam=Iu,e.UriQueryParser=Gu,e.UriQueryUndefined=Tu,e.UriScheme=vu,e.UriSchemeParser=Fu,e.UriUser=mu,e.UriUserParser=Ku,e.Utf8=Ue,e.Utf8DecodedOutput=qe,e.Utf8EncodedOutput=Re,e.UtfErrorMode=De,e.UtfErrorModeFatal=Ie,e.UtfErrorModeReplacement=Te,e.Value=ir,e.ValueBuilder=ur,e.ValueCursor=Rn,e.ValueDownlink=yf,e.ValueDownlinkModel=df,e.ValueDownlinkRecord=gf,e.ValueEntryCursor=Un,e.ValueForm=qn,e.ValueInput=ii,e.ValueOutput=oi,e.Values=P,e.ValuesCursor=mt,e.ValuesSelector=un,e.WarpClient=Ef,e.WatchFieldsCombinator=Oi,e.WatchFieldsOperator=wi,e.WatchValueCombinator=gi,e.WatchValueOperator=mi,e.WebSocketHost=nf,e.WeekInterval=Cp,e.WeekdayFormat=Qa,e.WeekdayParser=fp,e.Writer=ee,e.WriterDone=je,e.WriterEnd=xe,e.WriterError=Ce,e.WriterException=$,e.WriterSequence=Ee,e.YearFormat=Ha,e.YearInterval=Pp,e.YearParser=op,e.YearsInterval=xp,e.assert=T,e.authenticate=Uf,e.client=Sf,e.command=Nf,e.downlink=Af,e.downlinkList=Df,e.downlinkMap=If,e.downlinkValue=Tf,e.hostRef=Vf,e.isOnline=kf,e.keepOnline=Mf,e.laneRef=Rf,e.nodeRef=qf,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=swim-runtime.min.js.map