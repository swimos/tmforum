// swim-runtime-4.0.0-dev.20210927.1; copyright 2015-2021 Swim Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).swim=t.swim||{})}(this,(function(t){"use strict";var e=function(t,e,r){var n=r.writable,i=r.enumerable,o=r.configurable;if(void 0!==r.get){var s=r.get;r.get=function(){var r=s.call(this);return Object.defineProperty(t,e,{value:r,writable:n,enumerable:i,configurable:o}),r}}else{if(void 0===r.value)throw new Error("invalid lazy property descriptor");var u=r.value;r.value=function(){var r=u.call(this);return Object.defineProperty(t,e,{value:function(){return r},writable:n,enumerable:i,configurable:o}),r}}},r=function(t,e){return t===e||null!=t&&"function"==typeof t.equals&&t.equals(e)};r.is=function(t){return null!=t&&"function"==typeof t.equals};var n=function(t){return void 0===t?0:null===t?1:t.hashCode()};n.is=function(t){return null!=t&&"function"==typeof t.hashCode};var i=function(t,e,r){return t===e||null!=t&&"function"==typeof t.equivalentTo&&t.equivalentTo(e,r)};i.is=function(t){return null!=t&&"function"==typeof t.equivalentTo},i.Epsilon=1e-8;var o=function(t,e){return void 0===t?void 0===e?0:1:null===t?void 0===e?-1:null===e?0:1:"function"==typeof t.compareTo?null==e?-1:t.compareTo(e):NaN};o.is=function(t){return null!=t&&"function"==typeof t.compareTo};var s={is:function(t){return null!=t&&"function"==typeof t.fromAny}},u={is:function(t){return null!=t&&"function"==typeof t.toAny}};void 0===String.prototype.codePointAt&&(String.prototype.codePointAt=function(t){var e=this.length;if((t=t?Number(t):0)!=t&&(t=0),t>=0&&t<e){var r=this.charCodeAt(t);if(r<=55295||r>=57344)return r;if(r<=56319&&t+1<e){var n=this.charCodeAt(t+1);if(n>=56320&&n<=57343)return 65536+((1023&r)<<10+n&1023)}}}),void 0===String.prototype.offsetByCodePoints&&(String.prototype.offsetByCodePoints=function(t,e){if(e>0)for(var r=this.length;e>0&&t<r;){if((i=this.charCodeAt(t))<=55295||i>=57344)t+=1;else if(i<=56319&&t+1<r){t+=(n=this.charCodeAt(t+1))>=56320&&n<=57343?2:1}else t+=1;e-=1}else if(e<0)for(;e<0&&t>0;){var n;if((n=this.charCodeAt(t-1))<=55295||n>=57344)t-=1;else if(n>=56320&&n<=57343&&t-1>0){var i;t-=(i=this.charCodeAt(t-2))>=55296&&i<=57343?2:1}else t-=1;e-=1}return t});var a={};"undefined"!=typeof window&&void 0!==window.crypto?a.fillBytes=function(t){window.crypto.getRandomValues(t)}:"undefined"!=typeof window&&void 0!==window.msCrypto?a.fillBytes=function(t){window.msCrypto.getRandomValues(t)}:a.fillBytes=function(t){if(t instanceof Int8Array)for(var e=0;e<t.length;e+=1)t[e]=128-Math.round(256*Math.random());else if(t instanceof Uint8Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(256*Math.random());else if(t instanceof Int16Array)for(e=0;e<t.length;e+=1)t[e]=32768-Math.round(65536*Math.random());else if(t instanceof Uint16Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(65536*Math.random());else if(t instanceof Int32Array)for(e=0;e<t.length;e+=1)t[e]=2147483648-Math.round(4294967296*Math.random());else{if(!(t instanceof Uint32Array))throw new TypeError(""+t);for(e=0;e<t.length;e+=1)t[e]=Math.round(4294967296*Math.random())}};var p={};Object.defineProperty(p,"BigEndian",{value:"BE",enumerable:!0}),Object.defineProperty(p,"LittleEndian",{value:"LE",enumerable:!0}),Object.defineProperty(p,"NativeOrder",{get:function(){var t,e=new ArrayBuffer(2);new Uint16Array(e)[0]=65279;var r=new Uint8Array(e);if(254===r[0]&&255===r[1])t=p.BigEndian;else{if(255!==r[0]||254!==r[1])throw new Error;t=p.LittleEndian}return Object.defineProperty(p,"NativeOrder",{value:t,enumerable:!0}),t},configurable:!0,enumerable:!0});var h,f={mix:function(t,e){return e=3432918353*(65535&e)+((3432918353*(e>>>16)&65535)<<16)&4294967295,t^=e=461845907*(65535&(e=f.rotl(e,15)))+((461845907*(e>>>16)&65535)<<16)&4294967295,t=27492+(65535&(t=5*(65535&(t=f.rotl(t,13)))+((5*(t>>>16)&65535)<<16)&4294967295))+((58964+(t>>>16)&65535)<<16)},mixUint8Array:function(t,e){if(p.NativeOrder===p.BigEndian)return f.mixUint8ArrayBE(t,e);if(p.NativeOrder===p.LittleEndian)return f.mixUInt8ArrayLE(t,e);throw new Error},mixUint8ArrayBE:function(t,e){for(var r=0,n=e.length;r+3<n;){var i=(255&e[r])<<24|(255&e[r+1])<<16|(255&e[r+2])<<8|255&e[r+3];t=f.mix(t,i),r+=4}if(r<n){i=(255&e[r])<<24;r+1<n&&(i|=(255&e[r+1])<<16,r+2<n&&(i|=(255&e[r+2])<<8)),i=3432918353*(65535&i)+((3432918353*(i>>>16)&65535)<<16)&4294967295,t^=i=461845907*(65535&(i=f.rotl(i,15)))+((461845907*(i>>>16)&65535)<<16)&4294967295}return t^n},mixUInt8ArrayLE:function(t,e){for(var r=0,n=e.length;r+3<n;){var i=255&e[r]|(255&e[r+1])<<8|(255&e[r+2])<<16|(255&e[r+3])<<24;t=f.mix(t,i),r+=4}if(r<n){i=255&e[r];r+1<n&&(i|=(255&e[r+1])<<8,r+2<n&&(i|=(255&e[r+2])<<16)),i=3432918353*(65535&i)+((3432918353*(i>>>16)&65535)<<16)&4294967295,t^=i=461845907*(65535&(i=f.rotl(i,15)))+((461845907*(i>>>16)&65535)<<16)&4294967295}return t^n},mixString:function(t,e){if(p.NativeOrder===p.BigEndian)return f.mixStringBE(t,e);if(p.NativeOrder===p.LittleEndian)return f.mixStringLE(t,e);throw new Error},mixStringBE:function(t,e){for(var r=0,n=32,i=0,o=e.length,s=0;i<o;){var u=e.codePointAt(i);void 0===u&&(u=e.charCodeAt(i)),u>=0&&u<=127?(r|=u<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),s+=1):u>=128&&u<=2047?(r|=(192|u>>>6)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=(128|63&u)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),s+=2):u>=2048&&u<=65535||u>=57344&&u<=65535?(r|=(224|u>>>12)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=(128|u>>>6&63)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=(128|63&u)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),s+=3):u>=65536&&u<=1114111?(r|=(240|u>>>18)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=(128|u>>>12&63)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=(128|u>>>6&63)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=(128|63&u)<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),s+=4):(r|=239<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=191<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),r|=189<<(n-=8),0===n&&(t=f.mix(t,r),r=0,n=32),s+=3),i=e.offsetByCodePoints(i,1)}return 32!==n&&(r=3432918353*(65535&r)+((3432918353*(r>>>16)&65535)<<16)&4294967295,t^=r=461845907*(65535&(r=f.rotl(r,15)))+((461845907*(r>>>16)&65535)<<16)&4294967295),t^s},mixStringLE:function(t,e){for(var r=0,n=0,i=0,o=e.length,s=0;i<o;){var u=e.codePointAt(i);void 0===u&&(u=e.charCodeAt(i)),u>=0&&u<=127?(r|=u<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),s+=1):u>=128&&u<=2047?(r|=(192|u>>>6)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=(128|63&u)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),s+=2):u>=2048&&u<=65535||u>=57344&&u<=65535?(r|=(224|u>>>12)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=(128|u>>>6&63)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=(128|63&u)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),s+=3):u>=65536&&u<=1114111?(r|=(240|u>>>18)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=(128|u>>>12&63)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=(128|u>>>6&63)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=(128|63&u)<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),s+=4):(r|=239<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=191<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),r|=189<<n,32===(n+=8)&&(t=f.mix(t,r),r=0,n=0),s+=3),i=e.offsetByCodePoints(i,1)}return 32!==n&&(r=3432918353*(65535&r)+((3432918353*(r>>>16)&65535)<<16)&4294967295,t^=r=461845907*(65535&(r=f.rotl(r,15)))+((461845907*(r>>>16)&65535)<<16)&4294967295),t^s},mash:function(t){return t=2246822507*(65535&(t^=t>>>16))+((2246822507*(t>>>16)&65535)<<16)&4294967295,t=3266489909*(65535&(t^=t>>>13))+((3266489909*(t>>>16)&65535)<<16)&4294967295,(t^=t>>>16)>>>0},rotl:function(t,e){return t<<e|t>>>32-e}},c={};c.compare=function(t,e){if("object"==typeof t&&null!==t){if("object"==typeof e&&null!==e){var r=c.hash(t),n=c.hash(e);return r<n?-1:r>n?1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},c.hash=(h=-1,function(t){if("object"==typeof t&&null!==t){var e=t._hashCode;return void 0===e&&(e=~~h,h-=1,Object.defineProperty(t,"_hashCode",{value:e,configurable:!0})),e}if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)});var l,d,y,v={compare:function(t,e){return"boolean"==typeof t?"boolean"==typeof e?t&&!e?-1:!t&&e?1:0:-1:null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash:function(t){if(!0===t)return 3;if(!1===t)return 2;if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)}},m={};m.equal=function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)},m.equivalent=function(t,e,r){return t===e||"number"==typeof t&&"number"==typeof e&&(isNaN(t)&&isNaN(e)||Math.abs(e-t)<(void 0!==r?r:i.Epsilon))},m.compare=function(t,e){return"number"==typeof t?"number"==typeof e?t<e?-1:t>e?1:isNaN(e)?isNaN(t)?0:-1:isNaN(t)?1:0:-1:null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},m.hash=(l=new ArrayBuffer(8),d=new Float64Array(l),y=new Int32Array(l),function(t){if("number"==typeof t)return t===~~t?~~t:(d[0]=t,y[0]^y[1]);if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)});var w={compare:function(t,e){return"string"==typeof t?"string"==typeof e?t<e?-1:t>e?1:0:-1:null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash:function(t){if("string"==typeof t)return f.mash(f.mixString(0,t));if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)}},g={compare:function(t,e){if("function"==typeof t){if("function"==typeof e){var r=g.hash(t),n=g.hash(e);return r<n?-1:r>n?1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN}};g.hash=function(){var t=-1;return function(e){if("function"==typeof e){var r=e._hashCode;return void 0===r&&(r=~~t,t-=1,Object.defineProperty(e,"_hashCode",{value:r,configurable:!0})),r}if(null===e)return 1;if(void 0===e)return 0;throw new TypeError(""+e)}}();var b={compare:function(t,e){if("function"==typeof t){if("function"==typeof e){var r=b.hash(t),n=b.hash(e);return r<n?-1:r>n?1:0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash:function(t){if("function"==typeof t){var e=t._hashCode;return void 0===e&&(e=f.mash(f.mixString(0,t.name)),Object.defineProperty(t,"_hashCode",{value:e,configurable:!0})),e}if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)}},x={equal:function(t,e){if(t===e)return!0;if("object"==typeof t&&null!==t&&"object"==typeof e&&null!==e){var r=Object.keys(t),n=Object.keys(e),i=r.length;if(i!==n.length)return!1;for(var o=0;o<i;o+=1){var s=r[o];if(s!==n[o]||!O.equal(t[s],e[s]))return!1}return!0}return!1},equivalent:function(t,e,r){if(t===e)return!0;if("object"==typeof t&&null!==t&&"object"==typeof e&&null!==e){var n=Object.keys(t),i=Object.keys(e),o=n.length;if(o!==i.length)return!1;for(var s=0;s<o;s+=1){var u=n[s];if(u!==i[s]||!O.equivalent(t[u],e[u],r))return!1}return!0}return!1},compare:function(t,e){if("object"==typeof t&&null!==t){if("object"==typeof e&&null!==e){if(t!==e){for(var r=Object.keys(t),n=Object.keys(e),i=r.length,o=n.length,s=Math.min(i,o),u=0,a=0;a<s&&0===u;a+=1){var p=r[a],h=n[a];0===(u=w.compare(p,h))&&(u=O.compare(t[p],e[h]))}return 0!==u?u:i>o?1:i<o?-1:0}return 0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},hash:function(t){if("object"==typeof t&&null!==t){for(var e=0,r=Object.keys(t),n=0,i=r.length;n<i;n+=1){var o=r[n];e=f.mix(f.mix(e,w.hash(o)),O.hash(t[o]))}return f.mash(e)}if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)}},O={equal:function(t,e){if(t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),t===e)return!0;if("number"==typeof t){if("number"==typeof e)return isNaN(t)&&isNaN(e)}else{if(r.is(t))return t.equals(e);if(Array.isArray(t)){if(Array.isArray(e))return C.equal(t,e)}else if("object"==typeof t&&null!==t&&"object"==typeof e&&null!==e)return x.equal(t,e)}return!1},hash:function(t){if(void 0===t)return 0;if(null===t)return 1;if(!1===t)return 2;if(!0===t)return 3;if("number"==typeof t)return m.hash(t);if("string"==typeof t)return w.hash(t);if(n.is(t))return t.hashCode();if("function"==typeof t)return g.hash(t);if(Array.isArray(t))return C.hash(t);if("object"==typeof t)return x.hash(t);throw new TypeError(""+t)},equivalent:function(t,e,r){if(void 0===r&&(r=i.Epsilon),t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),t===e)return!0;if("number"==typeof t){if("number"==typeof e)return isNaN(t)&&isNaN(e)||Math.abs(e-t)<r}else{if(i.is(t))return t.equivalentTo(e,r);if(Array.isArray(t)){if(Array.isArray(e))return C.equivalent(t,e,r)}else if("object"==typeof t&&null!==t&&"object"==typeof e&&null!==e)return x.equivalent(t,e,r)}return!1},compare:function(t,e){return t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),void 0===t?void 0===e?0:1:null===t?void 0===e?-1:null===e?0:1:"boolean"==typeof t?null==e?-1:"boolean"==typeof e?t&&!e?-1:!t&&e?1:0:1:"number"==typeof t?null==e||"boolean"==typeof e?-1:"number"==typeof e?t<e?-1:t>e?1:isNaN(e)?isNaN(t)?0:-1:isNaN(t)?1:0:1:"string"==typeof t?null==e||"boolean"==typeof e||"number"==typeof e?-1:"string"==typeof e?t<e?-1:t>e?1:0:1:o.is(t)?t.compareTo(e):"function"==typeof t?null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e?-1:"function"==typeof e?g.compare(t,e):1:Array.isArray(t)?null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"function"==typeof e?-1:Array.isArray(e)?C.compare(t,e):1:"object"==typeof t?null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"function"==typeof e||Array.isArray(e)?-1:"object"==typeof e?x.compare(t,e):1:NaN}},C={};Object.defineProperty(C,"empty",{value:Object.freeze([]),enumerable:!0,configurable:!0}),C.inserted=function(t,e){for(var r=null!=e?e.length:0,n=new Array(r+1),i=0;i<r;i+=1){var o=e[i];if(o===t)return e;n[i]=o}return n[r]=t,n},C.removed=function(t,e){var r=null!=e?e.length:0;if(0===r)return null!=e?e:C.empty;if(1===r)return e[0]!==t?e:C.empty;for(var n=new Array(r-1),i=0;i<r;){var o=e[i];if(o===t){for(i+=1;i<r;)n[i-1]=e[i],i+=1;return n}n[i]=o,i+=1}return e},C.equal=function(t,e){if(t===e)return!0;if("object"==typeof t&&null!==t&&"object"==typeof e&&null!==e){var r=t.length;if(r!==e.length)return!1;for(var n=0;n<r;n+=1)if(!O.equal(t[n],e[n]))return!1;return!0}return!1},C.equivalent=function(t,e,r){if(t===e)return!0;if("object"==typeof t&&null!==t&&"object"==typeof e&&null!==e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i+=1)if(!O.equivalent(t[i],e[i],r))return!1;return!0}return!1},C.compare=function(t,e){if("object"==typeof t&&null!==t){if("object"==typeof e&&null!==e){if(t!==e){for(var r=t.length,n=e.length,i=0,o=0,s=Math.min(r,n);o<s&&0===i;o+=1)i=O.compare(t[o],e[o]);return 0!==i?i:r>n?1:r<n?-1:0}return 0}return-1}return null===t?void 0===e?-1:null===e?0:1:void 0===t?void 0===e?0:1:NaN},C.hash=function(t){if("object"==typeof t&&null!==t){for(var e=0,r=0,n=t.length;r<n;r+=1)e=f.mix(e,O.hash(t[r]));return f.mash(e)}if(null===t)return 1;if(void 0===t)return 0;throw new TypeError(""+t)};var E=function(t,e){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},E(t,e)};function P(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function S(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(s=(o<3?i(s):o>3?i(e,r,s):i(e,r))||s);return o>3&&s&&Object.defineProperty(e,r,s),s}function k(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var M=function(){function t(){}return t.prototype.set=function(t){throw new Error("immutable")},t.prototype.delete=function(){throw new Error("immutable")},t.empty=function(){return new A},t.unary=function(t){return new D(t)},t.array=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=t.length),new I(t,e,r)},S([e],t,"empty",null),t}(),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){throw new Error("empty")},e.prototype.step=function(){throw new Error("empty")},e.prototype.skip=function(t){},e.prototype.hasNext=function(){return!1},e.prototype.nextIndex=function(){return 0},e.prototype.next=function(){return{done:!0}},e.prototype.hasPrevious=function(){return!1},e.prototype.previousIndex=function(){return-1},e.prototype.previous=function(){return{done:!0}},e}(M),D=function(t){function e(e){var r=t.call(this)||this;return r.value=e,r.index=0,r}return P(e,t),e.prototype.isEmpty=function(){return 0!==this.index},e.prototype.head=function(){if(0===this.index)return this.value;throw new Error("empty")},e.prototype.step=function(){if(0!==this.index)throw new Error("empty");this.index=1},e.prototype.skip=function(t){this.index=Math.min(Math.max(0,this.index+t),1)},e.prototype.hasNext=function(){return 0===this.index},e.prototype.nextIndex=function(){return this.index},e.prototype.next=function(){return 0===this.index?(this.index=1,{value:this.value,done:!0}):{done:!0}},e.prototype.hasPrevious=function(){return 1===this.index},e.prototype.previousIndex=function(){return this.index-1},e.prototype.previous=function(){return 1===this.index?(this.index=0,{value:this.value,done:!0}):{done:!0}},e}(M),I=function(t){function e(e,r,n){var i=t.call(this)||this;return i.array=e,i.index=r,i.limit=n,i}return P(e,t),e.prototype.isEmpty=function(){return this.index>=this.limit},e.prototype.head=function(){if(this.index<this.limit)return this.array[this.index];throw new Error("empty")},e.prototype.step=function(){if(!(this.index<this.limit))throw new Error("empty");this.index+=1},e.prototype.skip=function(t){this.index=Math.min(this.index+t,this.limit)},e.prototype.hasNext=function(){return this.index<this.limit},e.prototype.nextIndex=function(){return this.index},e.prototype.next=function(){var t=this.index;return t<this.limit?(this.index+=1,{value:this.array[t],done:this.index===this.limit}):(this.index=this.limit,{done:!0})},e.prototype.hasPrevious=function(){return this.index>0},e.prototype.previousIndex=function(){return this.index-1},e.prototype.previous=function(){var t=this.index-1;return t>=0?(this.index=t,{value:this.array[t],done:0===t}):(this.index=0,{done:!0})},e}(M),T=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),V=function(t,e){if(!t)throw new T(e)};V.ok=function(t,e){if(!t)throw new T(e)},V.notOk=function(t,e){if(t)throw new T(e)},V.equal=function(t,e,r){if(!O.equal(t,e))throw new T(r)},V.notEqual=function(t,e,r){if(O.equal(t,e))throw new T(r)},V.identical=function(t,e,r){if(t!==e)throw new T(r)},V.notIdentical=function(t,e,r){if(t===e)throw new T(r)},V.instanceOf=function(t,e,r){if(!(t instanceof e))throw new T(r)},V.notInstanceOf=function(t,e,r){if(t instanceof e)throw new T(r)},V.compareLessThan=function(t,e,r){if(!(O.compare(t,e)<0))throw new T(r)},V.compareNotLessThan=function(t,e,r){if(O.compare(t,e)<0)throw new T(r)},V.compareLessThanOrEqual=function(t,e,r){if(!(O.compare(t,e)<=0))throw new T(r)},V.compareNotLessThanOrEqual=function(t,e,r){if(O.compare(t,e)<=0)throw new T(r)},V.compareEqual=function(t,e,r){if(0!==O.compare(t,e))throw new T(r)},V.compareNotEqual=function(t,e,r){if(0===O.compare(t,e))throw new T(r)},V.compareGreaterThanOrEqual=function(t,e,r){if(!(O.compare(t,e)>=0))throw new T(r)},V.compareNotGreaterThanOrEqual=function(t,e,r){if(O.compare(t,e)>=0)throw new T(r)},V.compareGreaterThan=function(t,e,r){if(!(O.compare(t,e)>0))throw new T(r)},V.compareNotGreaterThan=function(t,e,r){if(O.compare(t,e)>0)throw new T(r)};var j,q=function(){function t(t,e){this.level=t,this.label=e}return t.prototype.isTrace=function(){return this.level===t.TRACE_LEVEL},t.prototype.isDebug=function(){return this.level===t.DEBUG_LEVEL},t.prototype.isInfo=function(){return this.level===t.INFO_LEVEL},t.prototype.isNote=function(){return this.level===t.NOTE_LEVEL},t.prototype.isWarning=function(){return this.level===t.WARNING_LEVEL},t.prototype.isError=function(){return this.level===t.ERROR_LEVEL},t.prototype.isAlert=function(){return this.level===t.ALERT_LEVEL},t.prototype.isFatal=function(){return this.level===t.FATAL_LEVEL},t.prototype.compareTo=function(e){return this===e?0:e instanceof t?this.level<e.level?-1:this.level>e.level?1:this.label.localeCompare(e.label):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.level===e.level&&this.label===e.label)},t.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(t),m.hash(this.level)),w.hash(this.label)))},t.prototype.toString=function(){return this.label},t.create=function(e,r){switch(e){case t.TRACE_LEVEL:return t.trace(r);case t.DEBUG_LEVEL:return t.debug(r);case t.INFO_LEVEL:return t.info(r);case t.NOTE_LEVEL:return t.note(r);case t.WARNING_LEVEL:return t.warning(r);case t.ERROR_LEVEL:return t.error(r);case t.ALERT_LEVEL:return t.alert(r);case t.FATAL_LEVEL:return t.fatal(r);default:throw new Error(""+e)}},t.trace=function(e){return void 0===e&&(e="trace"),"trace"===e?(void 0===t._trace&&(t._trace=new t(t.TRACE_LEVEL,e)),t._trace):new t(t.TRACE_LEVEL,e)},t.debug=function(e){return void 0===e&&(e="debug"),"debug"===e?(void 0===t._debug&&(t._debug=new t(t.DEBUG_LEVEL,e)),t._debug):new t(t.DEBUG_LEVEL,e)},t.info=function(e){return void 0===e&&(e="info"),"info"===e?(void 0===t._info&&(t._info=new t(t.INFO_LEVEL,e)),t._info):new t(t.INFO_LEVEL,e)},t.note=function(e){return void 0===e&&(e="note"),"note"===e?(void 0===t._note&&(t._note=new t(t.NOTE_LEVEL,e)),t._note):new t(t.NOTE_LEVEL,e)},t.warning=function(e){return void 0===e&&(e="warning"),"warning"===e?(void 0===t._warning&&(t._warning=new t(t.WARNING_LEVEL,e)),t._warning):new t(t.WARNING_LEVEL,e)},t.error=function(e){return void 0===e&&(e="error"),"error"===e?(void 0===t._error&&(t._error=new t(t.ERROR_LEVEL,e)),t._error):new t(t.ERROR_LEVEL,e)},t.alert=function(e){return void 0===e&&(e="alert"),"alert"===e?(void 0===t._alert&&(t._alert=new t(t.ALERT_LEVEL,e)),t._alert):new t(t.ALERT_LEVEL,e)},t.fatal=function(e){return void 0===e&&(e="fatal"),"fatal"===e?(void 0===t._fatal&&(t._fatal=new t(t.FATAL_LEVEL,e)),t._fatal):new t(t.FATAL_LEVEL,e)},t.TRACE_LEVEL=0,t.DEBUG_LEVEL=1,t.INFO_LEVEL=2,t.NOTE_LEVEL=3,t.WARNING_LEVEL=4,t.ERROR_LEVEL=5,t.ALERT_LEVEL=6,t.FATAL_LEVEL=7,t}(),R=function(){function t(t){this.buckets=new Array(t),this.gen4Hits=0,this.gen3Hits=0,this.gen2Hits=0,this.gen1Hits=0,this.misses=0}return t.prototype.get=function(t){if(0!==this.buckets.length){var e=Math.abs(O.hash(t))%this.buckets.length,r=this.buckets[e];if(void 0!==r){var n=r.gen4Key;if(void 0!==n&&O.equal(t,n)){var i=r.gen4Val;if(void 0!==i)return this.gen4Hits+=1,r.gen4Weight++,i;r.gen4Key=void 0}var o=r.gen3Key;if(void 0!==o&&O.equal(t,o)){var s=r.gen3Val;if(void 0!==s)return this.gen3Hits+=1,r.gen3Weight++>r.gen4Weight&&(this.buckets[e]=new U(r.gen3Key,r.gen3Val,r.gen3Weight,r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight)),s;r.gen3Key=void 0}var u=r.gen2Key;if(void 0!==u&&O.equal(t,u)){var a=r.gen2Val;if(void 0!==a)return this.gen2Hits+=1,r.gen2Weight++>r.gen3Weight&&(this.buckets[e]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight)),a;r.gen2Key=void 0}var p=r.gen1Key;if(void 0!==p&&O.equal(t,p)){var h=r.gen1Val;if(void 0!==h)return this.gen1Hits+=1,r.gen1Weight++>r.gen2Weight&&(this.buckets[e]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight,r.gen2Key,r.gen2Val,r.gen2Weight)),h;r.gen1Key=void 0}this.misses+=1}}},t.prototype.put=function(t,e){if(0===this.buckets.length)return e;var r=Math.abs(O.hash(t))%this.buckets.length,n=this.buckets[r]||new U,i=n.gen4Key;if(void 0!==i&&O.equal(t,i)){var o=n.gen4Val;if(void 0!==o)return this.gen4Hits+=1,n.gen4Weight++,o;n.gen4Key=void 0,i=void 0}var s=n.gen3Key;if(void 0!==s&&O.equal(t,s)){var u=n.gen3Val;if(void 0!==u)return this.gen3Hits+=1,n.gen3Weight++>n.gen4Weight&&(this.buckets[r]=new U(n.gen3Key,n.gen3Val,n.gen3Weight,n.gen4Key,n.gen4Val,n.gen4Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen1Key,n.gen1Val,n.gen1Weight)),u;n.gen3Key=void 0,s=void 0}var a=n.gen2Key;if(void 0!==a&&O.equal(t,a)){var p=n.gen2Val;if(void 0!==p)return this.gen2Hits+=1,n.gen2Weight++>n.gen3Weight&&(this.buckets[r]=new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen1Key,n.gen1Val,n.gen1Weight)),p;n.gen2Key=void 0,a=void 0}var h=n.gen1Key;if(void 0!==h&&O.equal(t,h)){var f=n.gen1Val;if(void 0!==f)return this.gen1Hits+=1,n.gen1Weight++>n.gen2Weight&&(this.buckets[r]=new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen1Key,n.gen1Val,n.gen1Weight,n.gen2Key,n.gen2Val,n.gen2Weight)),f;n.gen1Key=void 0,h=void 0}return this.misses+=1,this.buckets[r]=void 0===i?new U(n.gen3Key,n.gen3Val,n.gen3Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen1Key,n.gen1Val,n.gen1Weight,t,e,1):void 0===s?new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen2Key,n.gen2Val,n.gen2Weight,n.gen1Key,n.gen1Val,n.gen1Weight,t,e,1):void 0===a?new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen1Key,n.gen1Val,n.gen1Weight,t,e,1):void 0===h?new U(n.gen4Key,n.gen4Val,n.gen4Weight,n.gen3Key,n.gen3Val,n.gen3Weight,n.gen2Key,n.gen2Val,n.gen2Weight,t,e,1):new U(n.gen4Key,n.gen4Val,n.gen4Weight-1,n.gen3Key,n.gen3Val,n.gen3Weight-1,n.gen1Key,n.gen1Val,n.gen1Weight,t,e,1),e},t.prototype.remove=function(t){if(0!==this.buckets.length){var e=Math.abs(O.hash(t))%this.buckets.length,r=this.buckets[e];if(void 0!==r){var n=r.gen4Key;if(void 0!==n&&O.equal(t,n)){var i=r.gen4Val;return this.buckets[e]=new U(r.gen3Key,r.gen3Val,r.gen3Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight,void 0,void 0,0),i}var o=r.gen3Key;if(void 0!==o&&O.equal(t,o)){var s=r.gen3Val;return this.buckets[e]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight,void 0,void 0,0),s}var u=r.gen2Key;if(void 0!==u&&O.equal(t,u)){var a=r.gen2Val;return this.buckets[e]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight,void 0,void 0,0),a}var p=r.gen1Key;if(void 0!==p&&O.equal(t,p)){var h=r.gen1Val;return this.buckets[e]=new U(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen2Key,r.gen2Val,r.gen2Weight,void 0,void 0,0),h}}}},t.prototype.clear=function(){for(var t=0;t<this.buckets.length;t+=1)this.buckets[t]=void 0},t.prototype.hits=function(){return this.gen4Hits+this.gen3Hits+this.gen2Hits+this.gen1Hits},t.prototype.hitRatio=function(){var t=this.hits();return t/(t+this.misses)},t}(),U=function(t,e,r,n,i,o,s,u,a,p,h,f){void 0===r&&(r=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===f&&(f=0),this.gen4Key=t,this.gen4Val=e,this.gen4Weight=r,this.gen3Key=n,this.gen3Val=i,this.gen3Weight=o,this.gen2Key=s,this.gen2Val=u,this.gen2Weight=a,this.gen1Key=p,this.gen1Val=h,this.gen1Weight=f},N=function(){function t(t){this.buckets=new Array(t),this.gen4Hits=0,this.gen3Hits=0,this.gen2Hits=0,this.gen1Hits=0,this.misses=0}return t.prototype.put=function(t){if(0===this.buckets.length)return t;var e=Math.abs(O.hash(t))%this.buckets.length,r=this.buckets[e]||new z,n=r.gen4Val;if(void 0!==n&&O.equal(t,n))return this.gen4Hits+=1,r.gen4Weight++,n;var i=r.gen3Val;if(void 0!==i&&O.equal(t,i))return this.gen3Hits+=1,r.gen3Weight++>r.gen4Weight&&(this.buckets[e]=new z(r.gen3Val,r.gen3Weight,r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight)),i;var o=r.gen2Val;if(void 0!==o&&O.equal(t,o))return this.gen2Hits+=1,r.gen2Weight++>r.gen3Weight&&(this.buckets[e]=new z(r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight)),o;var s=r.gen1Val;return void 0!==s&&O.equal(t,s)?(this.gen1Hits+=1,r.gen1Weight++>r.gen2Weight&&(this.buckets[e]=new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight,r.gen2Val,r.gen2Weight)),s):(this.misses+=1,this.buckets[e]=void 0===n?new z(r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,t,1):void 0===i?new z(r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,t,1):void 0===o?new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight,t,1):void 0===s?new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,t,1):new z(r.gen4Val,r.gen4Weight-1,r.gen3Val,r.gen3Weight-1,r.gen1Val,r.gen1Weight,t,1),t)},t.prototype.remove=function(t){if(0===this.buckets.length)return!1;var e=Math.abs(O.hash(t))%this.buckets.length,r=this.buckets[e];if(void 0===r)return!1;var n=r.gen4Val;if(void 0!==n&&O.equal(t,n))return this.buckets[e]=new z(r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,void 0,0),!0;var i=r.gen3Val;if(void 0!==i&&O.equal(t,i))return this.buckets[e]=new z(r.gen4Val,r.gen4Weight,r.gen2Val,r.gen2Weight,r.gen1Val,r.gen1Weight,void 0,0),!0;var o=r.gen2Val;if(void 0!==o&&O.equal(t,o))return this.buckets[e]=new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen1Val,r.gen1Weight,void 0,0),!0;var s=r.gen1Val;return!(void 0===s||!O.equal(t,s))&&(this.buckets[e]=new z(r.gen4Val,r.gen4Weight,r.gen3Val,r.gen3Weight,r.gen2Val,r.gen2Weight,void 0,0),!0)},t.prototype.clear=function(){for(var t=0;t<this.buckets.length;t+=1)this.buckets[t]=void 0},Object.defineProperty(t.prototype,"hits",{get:function(){return this.gen4Hits+this.gen3Hits+this.gen2Hits+this.gen1Hits},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hitRatio",{get:function(){var t=this.hits;return t/(t+this.misses)},enumerable:!1,configurable:!0}),t}(),z=function(t,e,r,n,i,o,s,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===u&&(u=0),this.gen4Val=t,this.gen4Weight=e,this.gen3Val=r,this.gen3Weight=n,this.gen2Val=i,this.gen2Weight=o,this.gen1Val=s,this.gen1Weight=u},F=function(){},L=function(t){function r(e,r,n,i){var o=t.call(this)||this;return o.offset=e,o.line=r,o.column=n,o.note=i,o}return P(r,t),r.prototype.withNote=function(t){return this.note!==t?r.at(this.offset,this.line,this.column,t):this},r.prototype.min=function(t){return this.offset<=t.offset?this:t},r.prototype.max=function(t){return this.offset>=t.offset?this:t},Object.defineProperty(r.prototype,"start",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"end",{get:function(){return this},enumerable:!1,configurable:!0}),r.prototype.union=function(t){if(t instanceof r)return this.offset===t.offset&&this.line===t.line&&this.column===t.column?this:K.from(this,t);if(t instanceof K){var e=this.min(t.start),n=this.max(t.end);return e===t.start&&n===t.end?t:K.from(e,n)}throw new Error(t.toString())},r.prototype.shift=function(t){var e=this.offset+(this.offset-t.offset),n=this.line+(this.line-t.line),i=this.column;return 1===n&&(i+=this.column-t.column),e===this.offset&&n===this.line&&i===this.column?this:r.at(e,n,i,this.note)},r.prototype.equals=function(t){return this===t||t instanceof r&&(this.offset===t.offset&&this.line===t.line&&this.column===t.column&&this.note===t.note)},r.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(b.hash(r),m.hash(this.offset)),m.hash(this.line)),m.hash(this.column)),w.hash(this.note)))},r.prototype.display=function(t){return t=(t=nt.displayNumber(t,this.line)).write(58),t=nt.displayNumber(t,this.column),void 0!==this.note&&(t=t.write(58).write(32).write(this.note)),t},r.prototype.debug=function(t){return t=t.write("Mark").write(".").write("at").write("("),t=(t=nt.debugNumber(t,this.offset)).write(", "),t=(t=nt.debugNumber(t,this.line)).write(", "),t=nt.debugNumber(t,this.column),void 0!==this.note&&(t=t.write(", "),t=nt.debugString(t,this.note)),t=t.write(")")},r.prototype.toString=function(){return nt.display(this)},Object.defineProperty(r,"zero",{get:function(){return new r(0,1,1,void 0)},enumerable:!1,configurable:!0}),r.at=function(t,e,n,i){return new r(t,e,n,i)},S([e],r,"zero",null),r}(F),K=function(t){function e(e,r){var n=t.call(this)||this;return n.start=e,n.end=r,n}return P(e,t),e.prototype.union=function(t){if(t instanceof L){var r=this.start.min(t),n=this.end.max(t);return r===this.start&&n===this.end?this:e.from(r,n)}if(t instanceof e){r=this.start.min(t.start),n=this.end.max(t.end);return r===this.start&&n===this.end?this:e.from(r,n)}throw new Error(t.toString())},e.prototype.shift=function(t){var r=this.start.shift(t),n=this.end.shift(t);return r===this.start&&n===this.end?this:e.from(r,n)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.start.equals(t.start)&&this.end.equals(t.end))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.start.hashCode()),this.end.hashCode()))},e.prototype.display=function(t){return void 0!==this.start.note&&(t=t.write(this.start.note).write(58).write(32)),t=(t=nt.displayNumber(t,this.start.line)).write(58),t=(t=nt.displayNumber(t,this.start.column)).write(45),t=(t=nt.displayNumber(t,this.end.line)).write(58),t=nt.displayNumber(t,this.end.column),void 0!==this.end.note&&(t=t.write(58).write(32).write(this.end.note)),t},e.prototype.debug=function(t){return t=t.write("Span").write(".").write("from").write("("),t=(t=this.start.debug(t)).write(", "),t=(t=this.end.debug(t)).write(")")},e.prototype.toString=function(){return nt.display(this)},e.from=function(t,r){if(t.offset>r.offset){var n=t;t=r,r=n}return new e(t,r)},e}(F),B={reset:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(109)),t},bold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(109)),t},faint:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(50).write(109)),t},black:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(48).write(109)),t},red:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(49).write(109)),t},green:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(50).write(109)),t},yellow:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(51).write(109)),t},blue:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(52).write(109)),t},magenta:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(53).write(109)),t},cyan:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(54).write(109)),t},gray:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(48).write(59).write(51).write(55).write(109)),t},blackBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(48).write(109)),t},redBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(49).write(109)),t},greenBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(50).write(109)),t},yellowBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(51).write(109)),t},blueBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(52).write(109)),t},magentaBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(53).write(109)),t},cyanBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(54).write(109)),t},grayBold:function(t){return t.settings.isStyled()&&(t=t.write(27).write(91).write(49).write(59).write(51).write(55).write(109)),t}},W=function(){function t(t,e,r,n){Object.defineProperty(this,"lineSeparator",{value:t,enumerable:!0}),Object.defineProperty(this,"pretty",{value:e,enumerable:!0}),Object.defineProperty(this,"styled",{value:r,enumerable:!0}),Object.defineProperty(this,"precision",{value:n,enumerable:!0})}return t.prototype.withLineSeparator=function(t){return this.copy(t,this.pretty,this.styled,this.precision)},t.prototype.isPretty=function(){return this.pretty},t.prototype.asPretty=function(t){return this.copy(this.lineSeparator,t,this.styled,this.precision)},t.prototype.isStyled=function(){return this.styled},t.prototype.asStyled=function(t){return this.copy(this.lineSeparator,this.pretty,t,this.precision)},t.prototype.withPrecision=function(t){return this.copy(this.lineSeparator,this.pretty,this.styled,t)},t.prototype.copy=function(e,r,n,i){return t.create(e,r,n,i)},t.prototype.canEqual=function(e){return e instanceof t},t.prototype.equals=function(e){return this===e||e instanceof t&&(e.canEqual(this)&&this.lineSeparator===e.lineSeparator&&this.pretty===e.pretty&&this.styled===e.styled&&this.precision===e.precision)},t.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(b.hash(t),w.hash(this.lineSeparator)),v.hash(this.pretty)),v.hash(this.styled)),m.hash(this.precision)))},t.prototype.debug=function(t){return t=t.write("OutputSettings").write(46),t=(t=this.pretty||this.styled?this.pretty&&!this.styled?t.write("pretty"):!this.pretty&&this.styled?t.write("styled"):t.write("prettyStyled"):t.write("standard")).write(40).write(41),this.lineSeparator!==nt.lineSeparator&&(t=t.write(46).write("lineSeparator").write(40).display(this.lineSeparator).write(41)),-1!==this.precision&&(t=t.write(46).write("precision").write(40).display(this.precision).write(41)),t},t.prototype.toString=function(){return nt.debug(this)},t.standard=function(){return new t(nt.lineSeparator,!1,!1,-1)},t.pretty=function(){return new t(nt.lineSeparator,!0,!1,-1)},t.styled=function(){return new t(nt.lineSeparator,!1,!0,-1)},t.prettyStyled=function(){return new t(nt.lineSeparator,!0,!0,-1)},t.create=function(e,r,n,i){return"string"!=typeof e&&(e=nt.lineSeparator),"boolean"!=typeof r&&(r=!1),"boolean"!=typeof n&&(n=!1),"number"!=typeof i&&(i=-1),e===nt.lineSeparator&&-1===i?r||n?r&&!n?t.pretty():!r&&n?t.styled():t.prettyStyled():t.standard():new t(e,r,n,i)},t.fromInit=function(e){return t.create(e.lineSeparator,e.isPretty,e.isStyled,e.precision)},t.fromAny=function(e){return e instanceof t?e:"object"==typeof e&&null!==e?t.fromInit(e):t.standard()},S([e],t,"standard",null),S([e],t,"pretty",null),S([e],t,"styled",null),S([e],t,"prettyStyled",null),t}(),H=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),X=function(){function t(t){Object.defineProperty(this,"stripped",{value:t,enumerable:!0})}return t.prototype.isStripped=function(){return this.stripped},t.prototype.asStripped=function(t){return this.copy(t)},t.prototype.copy=function(e){return t.create(e)},t.prototype.canEqual=function(e){return e instanceof t},t.prototype.equals=function(e){return this===e||e instanceof t&&(e.canEqual(this)&&this.stripped===e.stripped)},t.prototype.hashCode=function(){return f.mash(f.mix(b.hash(t),v.hash(this.stripped)))},t.prototype.debug=function(t){return t=t.write("InputSettings").write(46),t=(t=this.stripped?t.write("stripped"):t.write("standard")).write(40).write(41)},t.prototype.toString=function(){return nt.debug(this)},t.standard=function(){return new t(!1)},t.stripped=function(){return new t(!0)},t.create=function(e){return e?t.stripped():t.standard()},t.fromAny=function(e){return e instanceof t?e:"object"==typeof e&&null!==e?t.create(e.isStripped):t.standard()},S([e],t,"standard",null),S([e],t,"stripped",null),t}(),Y=function(){function t(){}return t.prototype.trap=function(){throw new H},t.empty=function(){return new st(void 0,L.zero,X.standard())},t.done=function(){return new ut(void 0,L.zero,X.standard())},t.error=function(t){return new G(t,void 0,L.zero,X.standard())},S([e],t,"empty",null),S([e],t,"done",null),t}(),G=function(t){function e(e,r,n,i){var o=t.call(this)||this;return Object.defineProperty(o,"error",{value:e,enumerable:!0}),Object.defineProperty(o,"id",{value:r,enumerable:!0}),Object.defineProperty(o,"mark",{value:n,enumerable:!0}),Object.defineProperty(o,"settings",{value:i,enumerable:!0}),o}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},e.prototype.head=function(){throw new H},e.prototype.step=function(){return new e(new H("error step"),this.id,this.mark,this.settings)},e.prototype.trap=function(){return this.error},e.prototype.seek=function(t){return new e(new H("error seek"),this.id,this.mark,this.settings)},e.prototype.withId=function(t){return new e(this.error,t,this.mark,this.settings)},e.prototype.withMark=function(t){return new e(this.error,this.id,t,this.settings)},Object.defineProperty(e.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return t=X.fromAny(t),new e(this.error,this.id,this.mark,t)},e.prototype.clone=function(){return this},e}(Y),_=function(t){function e(e,r,n,i,o,s,u,a){var p=t.call(this)||this;return p.string=e,p.index=u,p.part=a,p.id=r,p.offset=n,p.line=i,p.column=o,p.settings=s,p}return P(e,t),e.prototype.isCont=function(){return this.index<this.string.length},e.prototype.isEmpty=function(){return this.part&&this.index>=this.string.length},e.prototype.isDone=function(){return!this.part&&this.index>=this.string.length},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return this.part},e.prototype.asPart=function(t){return this.part=t,this},e.prototype.head=function(){var t=this.string,e=this.index;if(e<t.length){var r=t.codePointAt(e);return void 0!==r?r:t.charCodeAt(e)}throw new H},e.prototype.step=function(){var t=this.string,e=this.index;if(e<t.length){var r=t.codePointAt(e);return this.index=t.offsetByCodePoints(e,1),this.offset+=this.index-e,10===r?(this.line+=1,this.column=1):this.column+=1,this}var n=new H("invalid step");return new G(n,this.id,this.mark,this.settings)},e.prototype.seek=function(t){if(void 0!==t){var e=this.index+(t.offset-this.offset);if(0<=e&&e<=this.string.length)return this.index=e,this.offset=t.offset,this.line=t.line,this.column=t.column,this;var r=new H("invalid seek to "+t);return new G(r,this.id,this.mark,this.settings)}return this.index=0,this.offset=0,this.line=1,this.column=1,this},e.prototype.withId=function(t){return this.id=t,this},Object.defineProperty(e.prototype,"mark",{get:function(){return L.at(this.offset,this.line,this.column)},enumerable:!1,configurable:!0}),e.prototype.withMark=function(t){return this.offset=t.offset,this.line=t.line,this.column=t.column,this},e.prototype.withSettings=function(t){return t=X.fromAny(t),this.settings=t,this},e.prototype.clone=function(){return new e(this.string,this.id,this.offset,this.line,this.column,this.settings,this.index,this.part)},e.create=function(t){return new e(t,void 0,0,1,1,X.standard(),0,!1)},e}(Y),Q=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),Z=function(){function t(){}return t.prototype.writeln=function(t){return"string"==typeof t&&this.write(t),this.write(this.settings.lineSeparator)},t.prototype.display=function(t){return nt.displayAny(this,t)},t.prototype.debug=function(t){return nt.debugAny(this,t)},t.prototype.flush=function(){return this},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length,n=0;n<r;n+=1)this.write(t[n])},t.prototype.trap=function(){throw new Q},t.prototype.clone=function(){throw new Error},t.full=function(){return new ct(W.standard())},t.done=function(){return new lt(W.standard())},t.error=function(t){return new dt(t,W.standard())},S([e],t,"full",null),S([e],t,"done",null),t}(),J=function(t){function e(e,r){var n=t.call(this)||this;return n.string=e,n.settings=r,n}return P(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},e.prototype.write=function(t){if("number"==typeof t)if(t>=0&&t<=55295||t>=57344&&t<=65535)t=String.fromCharCode(t);else if(t>=65536&&t<=1114111){var e=t-65536;t=String.fromCharCode(55296|e>>>10,56320|1023&e)}else t="ï¿½";return this.string+=t,this},e.prototype.writeln=function(t){return void 0!==t&&(this.string=this.string.concat(t)),this.string=this.string.concat(this.settings.lineSeparator),this},e.prototype.withSettings=function(t){return t=W.fromAny(t),this.settings=t,this},e.prototype.bind=function(){return this.string},e.prototype.clone=function(){return new e(this.string,this.settings)},e.prototype.toString=function(){return this.string},e}(Z),$=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),tt=function(){function t(){}return t.prototype.isCont=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.feed=function(t){throw new $},t.prototype.fork=function(t){return this},t.prototype.bind=function(){throw new $},t.prototype.trap=function(){throw new $},t.prototype.asDone=function(){throw new $},t.prototype.asError=function(){throw new $},t.prototype.andThen=function(t){return new St(this,t)},t.end=function(){return new Ct},t.done=function(t){return new Et(t)},t.error=function(t){return new Pt(t)},S([e],t,"end",null),t}(),et=function(t){function e(e,r,n){void 0===n&&(n=0);var i=t.call(this)||this;return i.value=e,i.input=r,i.index=n,i}return P(e,t),e.prototype.feed=function(t){return new e(t,""+t)},e.prototype.pull=function(t){return e.write(t,this.value,this.input,this.index)},e.write=function(t,r,n,i){void 0===i&&(i=0);for(var o=n.length;i<o&&t.isCont();){var s=n.codePointAt(i);void 0===s&&(s=n.charCodeAt(i)),t=t.write(s),i=n.offsetByCodePoints(i,1)}return i===o?tt.done(r):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i)},e}(tt),rt={stringInput:function(t){return _.create(t)},stringOutput:function(t,e){return void 0===e&&"string"!=typeof t?(e=t,t=""):"string"!=typeof t&&(t=""),e=W.fromAny(e),new J(t,e)},stringWriter:function(t){return void 0===t?new et(void 0,""):new et(t,""+t)},writeString:function(t,e){return et.write(t,void 0,""+e)},isAlpha:function(t){return t>=65&&t<=90||t>=97&&t<=122},isDigit:function(t){return t>=48&&t<=57},isSpace:function(t){return 32===t||9===t},isNewline:function(t){return 10===t||13===t},isWhitespace:function(t){return rt.isSpace(t)||rt.isNewline(t)}},nt={};Object.defineProperty(nt,"lineSeparator",{get:function(){var t;if("undefined"!=typeof global&&"function"==typeof global.require){var e=global.require("os");"object"==typeof e&&null!==e&&(t=e.EOL)}return void 0===t&&(t="\n"),Object.defineProperty(nt,"lineSeparator",{value:t,enumerable:!0,configurable:!0}),t},enumerable:!0,configurable:!0}),nt.display=function(t,e){if(void 0===t)return"undefined";if(null===t)return"null";if("number"==typeof t)return""+t;if("string"==typeof t)return t;if("function"==typeof t.display){var r=rt.stringOutput(e);return(r=t.display(r)).bind()}return""+t},nt.debug=function(t,e){if(void 0===t)return"undefined";if(null===t)return"null";if("number"==typeof t)return""+t;if("string"==typeof t){var r=rt.stringOutput(e);return(r=nt.debugString(r,t)).bind()}if("function"==typeof t.debug){r=rt.stringOutput(e);return(r=t.debug(r)).bind()}return""+t},nt.displayAny=function(t,e){return t=void 0===e?t.write("undefined"):null===e?t.write("null"):"number"==typeof e?nt.displayNumber(t,e):"string"==typeof e?t.write(e):"function"==typeof e.display?e.display(t):t.write(""+e)},nt.debugAny=function(t,e){return t=void 0===e?t.write("undefined"):null===e?t.write("null"):"number"==typeof e?nt.debugNumber(t,e):"string"==typeof e?nt.debugString(t,e):"function"==typeof e.debug?e.debug(t):t.write(""+e)},nt.displayNumber=function(t,e){if(isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<2147483648)if(e<0&&(t=t.write(45)),e>-10&&e<10)t=t.write(48+Math.abs(e));else{for(var r=new Array(19),n=e,i=18;0!==n;)r[i]=Math.abs(n%10|0),n=n/10|0,i-=1;for(i+=1;i<19;)t=t.write(48+r[i]),i+=1}else t=t.write(nt.decimal(e,t.settings.precision));return t},nt.debugNumber=function(t,e){return nt.displayNumber(t,e)},nt.debugChar=function(t,e){switch(t=t.write(39),e){case 8:t.write(92).write(98);break;case 9:t.write(92).write(116);break;case 10:t.write(92).write(110);break;case 12:t.write(92).write(102);break;case 13:t.write(92).write(114);break;case 34:t.write(92).write(34);break;case 39:t.write(92).write(39);break;case 92:t.write(92).write(92);break;default:t=e>=0&&e<=31||e>=127&&e<=159?t.write(92).write(117).write(nt.encodeHex(e>>>12&15)).write(nt.encodeHex(e>>>8&15)).write(nt.encodeHex(e>>>4&15)).write(nt.encodeHex(15&e)):t.write(e)}return t=t.write(39)},nt.debugString=function(t,e){t=t.write(34);for(var r=rt.stringInput(e);r.isCont();){var n=r.head();switch(n){case 8:t.write(92).write(98);break;case 9:t.write(92).write(116);break;case 10:t.write(92).write(110);break;case 12:t.write(92).write(102);break;case 13:t.write(92).write(114);break;case 34:t.write(92).write(34);break;case 92:t.write(92).write(92);break;default:t=n>=0&&n<=31||n>=127&&n<=159?t.write(92).write(117).write(nt.encodeHex(n>>>12&15)).write(nt.encodeHex(n>>>8&15)).write(nt.encodeHex(n>>>4&15)).write(nt.encodeHex(15&n)):t.write(n)}r=r.step()}return t=t.write(34)},nt.encodeHex=function(t){return t<10?48+t:t-10+65},nt.prefix=(j=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E"," Z","Y"],function(t,e){if(void 0===e&&(e=1),isFinite(t)){var r=Math.abs(t).toExponential(),n=r.indexOf("e"),i=n>=0?+r.slice(n+1):NaN,o=3*Math.min(Math.max(-8,Math.floor(i/3)),8),s=Math.pow(10,-o)*t,u=nt.trimTrailingZeros(Math.abs(s).toFixed(e));return s<0&&0!=+u&&(u="-"+u),u+=j[8+o/3]}return""+t}),nt.decimal=function(t,e){if(void 0===e&&(e=-1),e>=0){var r=nt.trimTrailingZeros(Math.abs(t).toFixed(e));return t<0&&0!=+r&&(r="-"+r),r}return""+t},nt.trimTrailingZeros=function(t){for(var e,r=-1,n=1,i=t.length;n<i;n+=1){var o=t.charCodeAt(n);if(46===o)r=n,e=n;else if(48===o)0===r&&(r=n),e=n;else if(o>=49&&o<=57)r>0&&(r=0);else if(r>0)break}return r>0&&(t=t.slice(0,r)+t.slice(e+1)),t},nt.duration=function(t,e){if(void 0===e&&(e=" "),isFinite(t)){var r=1e3,n=6e4,i=36e5,o=24*i,s=7*o,u=void 0;t>s&&(u=Math.floor(t/s),t%=s);var a=void 0;t>o&&(a=Math.floor(t/o),t%=o);var p=void 0;t>i&&(p=Math.floor(t/i),t%=i);var h=void 0;t>n&&(h=Math.floor(t/n),t%=n);var f=void 0;t>r&&(f=Math.floor(t/r),t%=r);var c="";return void 0!==u&&(c+=u+"w"),void 0!==a&&(c+=(0!==c.length?e:"")+a+"d"),void 0!==p&&(c+=(0!==c.length?e:"")+p+"h"),void 0!==h&&(c+=(0!==c.length?e:"")+h+"m"),void 0===f&&0!==t||(c+=(0!==c.length?e:"")+(void 0!==f?f:0)+"s"),0!==t&&0===c.length&&(c+=t+"ms"),c}return""+t};var it={isDigit:function(t){return t>=48&&t<=57},decodeDigit:function(t){if(t>=48&&t<=57)return t-48;var e=rt.stringOutput();throw e=e.write("Invalid base-10 digit: "),e=nt.debugChar(e,t),new Error(e.bind())},encodeDigit:function(t){if(t>=0&&t<=9)return 48+t;throw new Error(""+t)},countDigits:function(t){var e=0;do{e+=1,t=t/10|0}while(0!==t);return e},integerParser:function(){return new Nt(void 0,void 0,0)},parseInteger:function(t){return Nt.parse(t,void 0,void 0,0)},decimalParser:function(){return new Nt(void 0,void 0,1)},parseDecimal:function(t){return Nt.parse(t,void 0,void 0,1)},numberParser:function(){return new Nt},parseNumber:function(t){return Nt.parse(t)},integerWriter:function(t){return new Ft(void 0,void 0===t?0:t)},writeInteger:function(t,e){return Ft.write(t,void 0,e)}},ot=function(){function t(t,e,r,n,i,o){this.input=t,this.tag=e,this.severity=r,this.message=n,this.note=i,this.cause=o}return t.prototype.lineDigits=function(){var t=it.countDigits(this.tag.end.line);return null!==this.cause&&(t=Math.max(t,this.cause.lineDigits())),t},t.prototype.display=function(e){var r=this.input.clone(),n=this.tag.start,i=this.tag.end,o=this.severity,s=this.message,u=this.note,a=this.cause,p=this.lineDigits();return e=t.display(e,r,n,i,o,s,u,a,2,p)},t.display=function(e,r,n,i,o,s,u,a,p,h){for(;;){void 0!==s&&(e=(e=t.displayMessage(e,o,s)).writeln()),e=(e=t.displayAnchor(e,r,n,h)).writeln();var f=t.displayContext(e,r,n,i,o,u,a,p,h),c=f[0];if(e=f[1],null===c)break;e=e.writeln(),r=c.input.clone(),n=c.tag.start,i=c.tag.end,o=c.severity,s=c.message,u=c.note,a=c.cause}return e},t.displayMessage=function(e,r,n){return e=(e=t.formatSeverity(e,r)).write(r.label),e=B.reset(e),e=(e=B.bold(e)).write(58),void 0!==n&&(e=e.write(32).write(n)),e=B.reset(e)},t.displayAnchor=function(e,r,n,i){e=(e=t.displayLineLeadArrow(e,i)).write(32);var o=r.id;return void 0!==o&&(e=nt.displayAny(e,o)),e=e.write(58),e=(e=nt.displayNumber(e,n.line)).write(58),e=(e=nt.displayNumber(e,n.column)).writeln(),e=t.displayLineLead(e,i)},t.displayContext=function(e,r,n,i,o,s,u,a,p){var h,f=u,c=null!==u&&void 0===u.message&&O.equal(r.id,u.input.id)?n.offset<=u.tag.start.offset?-1:1:0;1===c&&(f=(h=t.displayContext(e,u.input.clone(),u.tag.start,u.tag.end,u.severity,u.note,u.cause,a,p))[0],e=(e=h[1]).writeln(),e=(e=t.displayLineLeadEllipsis(e,p)).writeln());(e=t.displayLines(e,r,n,i,o,a,p),void 0!==s&&(e=t.displayNote(e,s,p)),-1===c)&&(e=e.writeln(),e=(e=t.displayLineLeadEllipsis(e,p)).writeln(),f=(h=t.displayContext(e,u.input.clone(),u.tag.start,u.tag.end,u.severity,u.note,u.cause,a,p))[0],e=h[1]);return[f,e]},t.displayLines=function(e,r,n,i,o,s,u){for(var a=n.line,p=i.line,h=r.line;h<a;)t.consumeLineText(r,h),h+=1;if(p-a>2*s+2){for(;h<=a+s;)e=t.displayLine(e,r,n,i,o,h,u),h+=1;for(e=(e=t.displayLineLeadEllipsis(e,u)).write(32),e=(e=t.formatSeverity(e,o)).write(124),e=(e=B.reset(e)).writeln();h<p-s;)t.consumeLineText(r,h),h+=1}for(;h<=p;)e=t.displayLine(e,r,n,i,o,h,u),h+=1;return e},t.displayNote=function(e,r,n){return e=e.writeln(),e=(e=t.displayLineLead(e,n)).writeln(),e=t.displayLineComment(e,"note",r,n)},t.displayLine=function(e,r,n,i,o,s,u){return e=n.line===s&&i.line===s?t.displaySingleLine(e,r,n,i,o,s,u):n.line===s?t.displayStartLine(e,r,n,o,s,u):i.line===s?t.displayEndLine(e,r,i,o,s,u):t.displayMidLine(e,r,o,s,u)},t.displaySingleLine=function(e,r,n,i,o,s,u){e=(e=t.displayLineLeadNumber(e,s,u)).write(32);for(var a=1;a<r.column;a+=1)e=e.write(32);e=t.displayLineText(e,r,s),e=(e=t.displayLineLead(e,u)).write(32);for(var p=1;p<n.column;)e=e.write(32),p+=1;for(e=t.formatSeverity(e,o);p<=i.column;)e=e.write(94),p+=1;return void 0!==i.note&&(e=e.write(32).write(i.note)),e=B.reset(e)},t.displayStartLine=function(e,r,n,i,o,s){e=(e=t.displayLineLeadNumber(e,o,s)).write(32).write(32).write(32);for(var u=1;u<r.column;u+=1)e=e.write(32);e=t.displayLineText(e,r,o),e=(e=t.displayLineLead(e,s)).write(32).write(32),e=(e=t.formatSeverity(e,i)).write(95);for(var a=1;a<n.column;)e=e.write(95),a+=1;return e=e.write(94),void 0!==n.note&&(e=e.write(32).write(n.note)),e=(e=B.reset(e)).writeln()},t.displayEndLine=function(e,r,n,i,o,s){e=(e=t.displayLineLeadNumber(e,o,s)).write(32),e=(e=t.formatSeverity(e,i)).write(124),e=(e=B.reset(e)).write(32),e=t.displayLineText(e,r,o),e=(e=t.displayLineLead(e,s)).write(32),e=(e=t.formatSeverity(e,i)).write(124).write(95);for(var u=1;u<n.column;)e=e.write(95),u+=1;return e=e.write(94),void 0!==n.note&&(e=e.write(32).write(n.note)),e=B.reset(e)},t.displayMidLine=function(e,r,n,i,o){return e=(e=t.displayLineLeadNumber(e,i,o)).write(32),e=(e=t.formatSeverity(e,n)).write(124),e=(e=B.reset(e)).write(32),e=t.displayLineText(e,r,i)},t.displayLineComment=function(e,r,n,i){return e=(e=t.displayLineLeadComment(e,i)).write(32),e=(e=B.bold(e)).write(r).write(58),e=B.reset(e),void 0!==n&&(e=e.write(32).write(n)),e},t.displayLineLead=function(t,e){t=B.blueBold(t);for(var r=1+e,n=0;n<r;n+=1)t=t.write(32);return t=t.write(124),t=B.reset(t)},t.displayLineLeadComment=function(t,e){t=B.blueBold(t);for(var r=1+e,n=0;n<r;n+=1)t=t.write(32);return t=t.write(61),t=B.reset(t)},t.displayLineLeadArrow=function(t,e){for(var r=0;r<e;r+=1)t=t.write(32);return t=(t=B.blueBold(t)).write(45).write(45).write(62),t=B.reset(t)},t.displayLineLeadEllipsis=function(t,e){t=B.blueBold(t);for(var r=0;r<e;r+=1)t=t.write(46);return t=(t=B.reset(t)).write(32).write(32)},t.displayLineLeadNumber=function(t,e,r){for(var n=r-it.countDigits(e),i=0;i<n;i+=1)t=t.write(32);return t=B.blueBold(t),t=(t=nt.displayNumber(t,e)).write(32).write(124),t=B.reset(t)},t.displayLineText=function(t,e,r){for(;e.isCont()&&e.line===r;)t=t.write(e.head()),e=e.step();return e.line===r&&(t=t.writeln()),t},t.consumeLineText=function(t,e){for(;t.isCont()&&t.line===e;)t=t.step()},t.formatSeverity=function(t,e){switch(e.level){case q.FATAL_LEVEL:case q.ALERT_LEVEL:case q.ERROR_LEVEL:t=B.redBold(t);break;case q.WARNING_LEVEL:t=B.yellowBold(t);break;case q.NOTE_LEVEL:t=B.greenBold(t);break;case q.INFO_LEVEL:t=B.cyanBold(t);break;case q.DEBUG_LEVEL:case q.TRACE_LEVEL:default:t=B.magentaBold(t)}return t},t.prototype.toString=function(t){return nt.display(this,t)},t.create=function(e,r,n,i,o,s){return 3===arguments.length?(s=null,o=void 0,i=void 0):4===arguments.length?null===i||i instanceof t?(s=i,i=void 0):s=null:5===arguments.length?null===o||o instanceof t?(s=o,o=void 0):s=null:void 0===s&&(s=null),new t(e.clone(),r,n,i,o,s)},t.message=function(e,r,n,i,o){2===arguments.length?(o=null,i=void 0,n=q.error()):3===arguments.length?null===n||n instanceof t?(o=n,n=q.error()):"string"==typeof n?(o=null,i=n,n=q.error()):o=null:4===arguments.length?"string"==typeof n?(o=i,i=n,n=q.error()):null===i||i instanceof t?(o=i,i=void 0):o=null:void 0===o&&(o=null);var s=r.mark,u=r.clone();return u.seek(),new t(u,s,n,e,i,o)},t.unexpected=function(e,r,n,i){var o;if(1===arguments.length?(i=null,r=q.error()):2===arguments.length?null===r||r instanceof t?(i=r,r=q.error()):"string"==typeof r?(i=null,n=r,r=q.error()):i=null:3===arguments.length?"string"==typeof r?(i=n,n=r,r=q.error()):null===n||n instanceof t?(i=n,n=void 0):i=null:void 0===i&&(i=null),e.isCont()){var s=rt.stringOutput().write("unexpected").write(32);o=(s=nt.debugChar(s,e.head())).bind()}else o="unexpected end of input";var u=e.mark,a=e.clone();return a.seek(),new t(a,u,r,o,n,i)},t.expected=function(e,r,n,i,o){2===arguments.length?(o=null,n=q.error()):3===arguments.length?null===n||n instanceof t?(o=n,n=q.error()):"string"==typeof n?(o=null,i=n,n=q.error()):o=null:4===arguments.length?"string"==typeof n?(o=i,i=n,n=q.error()):null===i||i instanceof t?(o=i,i=void 0):o=null:void 0===o&&(o=null);var s=rt.stringOutput().write("expected").write(32);s=(s="number"==typeof e?nt.debugChar(s,e):s.write(e)).write(44).write(32).write("but found").write(32);var u=(s=r.isCont()?nt.debugChar(s,r.head()):s.write("end of input")).bind(),a=r.mark,p=r.clone();return p.seek(),new t(p,a,n,u,i,o)},t}(),st=function(t){function e(e,r,n){var i=t.call(this)||this;return Object.defineProperty(i,"id",{value:e,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!0},e.prototype.asPart=function(t){return t?this:new ut(this.id,this.mark,this.settings)},e.prototype.head=function(){throw new H},e.prototype.step=function(){var t=new H("empty step");return new G(t,this.id,this.mark,this.settings)},e.prototype.seek=function(t){var e=new H("empty seek");return new G(e,this.id,this.mark,this.settings)},e.prototype.withId=function(t){return new e(t,this.mark,this.settings)},e.prototype.withMark=function(t){return new e(this.id,t,this.settings)},Object.defineProperty(e.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return t=X.fromAny(t),new e(this.id,this.mark,t)},e.prototype.clone=function(){return this},e}(Y),ut=function(t){function e(e,r,n){var i=t.call(this)||this;return Object.defineProperty(i,"id",{value:e,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return t?new st(this.id,this.mark,this.settings):this},e.prototype.head=function(){throw new H},e.prototype.step=function(){var t=new H("done step");return new G(t,this.id,this.mark,this.settings)},e.prototype.seek=function(t){var e=new H("empty seek");return new G(e,this.id,this.mark,this.settings)},e.prototype.withId=function(t){return new e(t,this.mark,this.settings)},e.prototype.withMark=function(t){return new e(this.id,t,this.settings)},Object.defineProperty(e.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return t=X.fromAny(t),new e(this.id,this.mark,t)},e.prototype.clone=function(){return this},e}(Y),at=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return P(r,t),r.empty=function(){return new pt(void 0,L.zero,X.standard())},r.done=function(){return new ht(void 0,L.zero,X.standard())},r.error=function(t){return new ft(t,void 0,L.zero,X.standard())},S([e],r,"empty",null),S([e],r,"done",null),r}(Y),pt=function(t){function e(e,r,n){var i=t.call(this)||this;return Object.defineProperty(i,"id",{value:e,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!0},e.prototype.asPart=function(t){return t?this:new ht(this.id,this.mark,this.settings)},Object.defineProperty(e.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withIndex=function(t){if(0===t)return this;var e=new H("invalid index");return new ft(e,this.id,this.mark,this.settings)},Object.defineProperty(e.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withLimit=function(t){if(0===t)return this;var e=new H("invalid limit");return new ft(e,this.id,this.mark,this.settings)},Object.defineProperty(e.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new H},e.prototype.set=function(t,e){throw new H},e.prototype.head=function(){throw new H},e.prototype.step=function(t){var e=new H("empty step");return new ft(e,this.id,this.mark,this.settings)},e.prototype.seek=function(t){var e=new H("empty seek");return new ft(e,this.id,this.mark,this.settings)},e.prototype.withId=function(t){return new e(t,this.mark,this.settings)},e.prototype.withMark=function(t){return new e(this.id,t,this.settings)},Object.defineProperty(e.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return t=X.fromAny(t),new e(this.id,this.mark,t)},e.prototype.clone=function(){return this},e}(at),ht=function(t){function e(e,r,n){var i=t.call(this)||this;return Object.defineProperty(i,"id",{value:e,enumerable:!0}),Object.defineProperty(i,"mark",{value:r,enumerable:!0}),Object.defineProperty(i,"settings",{value:n,enumerable:!0}),i}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return t?new pt(this.id,this.mark,this.settings):this},Object.defineProperty(e.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withIndex=function(t){if(0===t)return this;var e=new H("invalid index");return new ft(e,this.id,this.mark,this.settings)},Object.defineProperty(e.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withLimit=function(t){if(0===t)return this;var e=new H("invalid limit");return new ft(e,this.id,this.mark,this.settings)},Object.defineProperty(e.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new H},e.prototype.set=function(t,e){throw new H},e.prototype.head=function(){throw new H},e.prototype.step=function(t){var e=new H("done step");return new ft(e,this.id,this.mark,this.settings)},e.prototype.seek=function(t){var e=new H("done seek");return new ft(e,this.id,this.mark,this.settings)},e.prototype.withId=function(t){return new e(t,this.mark,this.settings)},e.prototype.withMark=function(t){return new e(this.id,t,this.settings)},Object.defineProperty(e.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return t=X.fromAny(t),new e(this.id,this.mark,t)},e.prototype.clone=function(){return this},e}(at),ft=function(t){function e(e,r,n,i){var o=t.call(this)||this;return Object.defineProperty(o,"error",{value:e,enumerable:!0}),Object.defineProperty(o,"id",{value:r,enumerable:!0}),Object.defineProperty(o,"mark",{value:n,enumerable:!0}),Object.defineProperty(o,"settings",{value:i,enumerable:!0}),o}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},Object.defineProperty(e.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withIndex=function(t){return 0===t?this:new e(new H("invalid index"),this.id,this.mark,this.settings)},Object.defineProperty(e.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withLimit=function(t){return 0===t?this:new e(new H("invalid limit"),this.id,this.mark,this.settings)},Object.defineProperty(e.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new H},e.prototype.set=function(t,e){throw new H},e.prototype.head=function(){throw new H},e.prototype.step=function(t){return new e(new H("error step"),this.id,this.mark,this.settings)},e.prototype.trap=function(){return this.error},e.prototype.seek=function(t){return new e(new H("error seek"),this.id,this.mark,this.settings)},e.prototype.withId=function(t){return new e(this.error,t,this.mark,this.settings)},e.prototype.withMark=function(t){return new e(this.error,this.id,t,this.settings)},Object.defineProperty(e.prototype,"offset",{get:function(){return this.mark.offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this.mark.line},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this.mark.column},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return t=X.fromAny(t),new e(this.error,this.id,this.mark,t)},e.prototype.clone=function(){return this},e}(at),ct=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"settings",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!0},e.prototype.asPart=function(t){return t?this:new lt(this.settings)},e.prototype.write=function(t){return new dt(new Q("full"),this.settings)},e.prototype.writeln=function(t){return new dt(new Q("full"),this.settings)},e.prototype.bind=function(){throw new Q},e.prototype.withSettings=function(t){return new e(t=W.fromAny(t))},e.prototype.clone=function(){return this},e}(Z),lt=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"settings",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return t?new ct(this.settings):this},e.prototype.write=function(t){return new dt(new Q("done"),this.settings)},e.prototype.writeln=function(t){return new dt(new Q("done"),this.settings)},e.prototype.bind=function(){throw new Q},e.prototype.withSettings=function(t){return new e(t=W.fromAny(t))},e.prototype.clone=function(){return this},e}(Z),dt=function(t){function e(e,r){var n=t.call(this)||this;return Object.defineProperty(n,"error",{value:e,enumerable:!0}),Object.defineProperty(n,"settings",{value:r,enumerable:!0}),n}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},e.prototype.write=function(t){return this},e.prototype.writeln=function(t){return this},e.prototype.bind=function(){throw new Q},e.prototype.trap=function(){return this.error},e.prototype.withSettings=function(t){return t=W.fromAny(t),new e(this.error,t)},e.prototype.clone=function(){return this},e}(Z),yt=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return P(r,t),r.prototype.writeln=function(t){return"string"==typeof t&&this.write(t),this.write(this.settings.lineSeparator)},r.prototype.flush=function(){return this},r.prototype.clone=function(){throw new Error},r.full=function(){return new vt(W.standard())},r.done=function(){return new mt(W.standard())},r.error=function(t){return new wt(t,W.standard())},S([e],r,"full",null),S([e],r,"done",null),r}(Z),vt=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"settings",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!0},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!0},e.prototype.asPart=function(t){return t?this:new mt(this.settings)},Object.defineProperty(e.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withIndex=function(t){return 0===t?this:new wt(new Q("invalid index"),this.settings)},Object.defineProperty(e.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withLimit=function(t){return 0===t?this:new wt(new Q("invalid limit"),this.settings)},Object.defineProperty(e.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new Q},e.prototype.set=function(t,e){throw new Q},e.prototype.write=function(t){return new wt(new Q("full"),this.settings)},e.prototype.writeln=function(t){return new wt(new Q("full"),this.settings)},e.prototype.step=function(t){return void 0===t&&(t=1),0===t?this:new wt(new Q("invalid step"),this.settings)},e.prototype.bind=function(){throw new Q},e.prototype.withSettings=function(t){return new e(t=W.fromAny(t))},e.prototype.clone=function(){return this},e}(yt),mt=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"settings",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return t?new vt(this.settings):this},Object.defineProperty(e.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withIndex=function(t){return 0===t?this:new wt(new Q("invalid index"),this.settings)},Object.defineProperty(e.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withLimit=function(t){return 0===t?this:new wt(new Q("invalid limit"),this.settings)},Object.defineProperty(e.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new Q},e.prototype.set=function(t,e){throw new Q},e.prototype.write=function(t){return new wt(new Q("done"),this.settings)},e.prototype.writeln=function(t){return new wt(new Q("done"),this.settings)},e.prototype.step=function(t){return void 0===t&&(t=1),0===t?this:new wt(new Q("invalid step"),this.settings)},e.prototype.bind=function(){throw new Q},e.prototype.withSettings=function(t){return new e(t=W.fromAny(t))},e.prototype.clone=function(){return this},e}(yt),wt=function(t){function e(e,r){var n=t.call(this)||this;return Object.defineProperty(n,"error",{value:e,enumerable:!0}),Object.defineProperty(n,"settings",{value:r,enumerable:!0}),n}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},Object.defineProperty(e.prototype,"index",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withIndex=function(t){return 0===t?this:new e(new Q("invalid index"),this.settings)},Object.defineProperty(e.prototype,"limit",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.withLimit=function(t){return 0===t?this:new e(new Q("invalid limit"),this.settings)},Object.defineProperty(e.prototype,"capacity",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remaining",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){throw new Q},e.prototype.set=function(t,e){throw new Q},e.prototype.write=function(t){return this},e.prototype.writeln=function(t){return this},e.prototype.step=function(t){return void 0===t&&(t=1),0===t?this:new e(new Q("invalid step"),this.settings)},e.prototype.bind=function(){throw new Q},e.prototype.trap=function(){return this.error},e.prototype.withSettings=function(t){return t=W.fromAny(t),new e(this.error,t)},e.prototype.clone=function(){return this},e}(yt),gt=function(t){function e(r){var n=t.call(this,r instanceof ot?r.message:r)||this;return Object.setPrototypeOf(n,e.prototype),n.diagnostic=r instanceof ot?r:null,n}return P(e,t),e.prototype.toString=function(){return null!==this.diagnostic?this.diagnostic.toString():t.prototype.toString.call(this)},e}(Error),bt=function(){function t(){}return t.prototype.isCont=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.fork=function(t){return this},t.prototype.bind=function(){throw new gt},t.prototype.trap=function(){throw new gt},t.prototype.asError=function(){throw new gt},t.done=function(t){return new xt(t)},t.error=function(t){return t instanceof Error?new Ot(t):new Ot(new gt(t))},t}(),xt=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"value",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){return this.value},e}(bt),Ot=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"error",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){throw this.error},e.prototype.trap=function(){return this.error},e.prototype.asError=function(){return this},e}(bt),Ct=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.pull=function(t){return this},e.prototype.bind=function(){throw new $},e.prototype.asDone=function(){return this},e.prototype.andThen=function(t){return t},e}(tt),Et=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"value",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.pull=function(t){return this},e.prototype.bind=function(){return this.value},e.prototype.asDone=function(){return this},e.prototype.andThen=function(t){return t},e}(tt),Pt=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"error",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isCont=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.pull=function(t){return this},e.prototype.bind=function(){throw this.error},e.prototype.trap=function(){return this.error},e.prototype.asError=function(){return this},e.prototype.andThen=function(t){return this},e}(tt),St=function(t){function e(e,r){var n=t.call(this)||this;return n.head=e,n.tail=r,n}return P(e,t),e.prototype.pull=function(t){var r=this.head;return r.isCont()&&(r=r.pull(t)),r.isError()?r.asError():r.isDone()?this.tail.pull(t):new e(r,this.tail)},e}(tt),kt=function(t){function e(e,r,n){var i=t.call(this)||this;return i.array=e,i.size=r,i.settings=n,i}return P(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},e.prototype.write=function(t){if("number"==typeof t){var r=this.size,n=this.array,i=void 0;return null===n||r+1>n.length?(i=new Uint8Array(e.expand(r+1)),null!==n&&i.set(n,0),this.array=i):i=n,i[r]=t,this.size=r+1,this}throw new TypeError(""+t)},e.prototype.writeln=function(t){throw new TypeError(""+t)},e.prototype.toUint8Array=function(){var t=this.size,e=this.array;if(null!==e&&t===e.length)return e;var r=new Uint8Array(t);return null!==e&&r.set(e.slice(0,t),0),this.array=r,r},e.prototype.cloneArray=function(){var t=this.array;return null!==t?t.slice(0,this.size):null},e.prototype.withSettings=function(t){return t=W.fromAny(t),this.settings=t,this},e.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},e}(Z),Mt=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return P(e,t),e.prototype.bind=function(){return this.toUint8Array()},e.prototype.clone=function(){return new e(this.cloneArray(),this.size,this.settings)},e}(kt),At=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.array=e,s.index=r,s.limit=n,s.part=i,s.settings=o,s}return P(e,t),e.prototype.isCont=function(){return this.index<this.limit},e.prototype.isFull=function(){return this.part&&this.index>=this.limit},e.prototype.isDone=function(){return!this.part&&this.index>=this.limit},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return this.part},e.prototype.asPart=function(t){return this.part=t,this},e.prototype.withIndex=function(t){return 0<=t&&t<=this.limit?(this.index=t,this):new wt(new Q("invalid index"),this.settings)},e.prototype.withLimit=function(t){return 0<=t&&t<=this.array.length?(this.limit=t,this):new wt(new Q("invalid limit"),this.settings)},Object.defineProperty(e.prototype,"capacity",{get:function(){return this.array.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remaining",{get:function(){return this.limit-this.index},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return 0<=t&&t<this.limit},e.prototype.get=function(t){if(0<=t&&t<this.limit)return this.array[t];throw new Q},e.prototype.set=function(t,e){if(!(0<=t&&t<this.limit))throw new Q;this.array[t]=e},e.prototype.write=function(t){if("number"==typeof t){var e=this.index;return e<this.limit?(this.array[e]=t,this.index+=1,this):new wt(new Q("full"),this.settings)}return new wt(new Q("binary output"),this.settings)},e.prototype.writeln=function(t){return new wt(new Q("binary output"),this.settings)},e.prototype.step=function(t){var e=this.index+t;return 0<=e&&e<=this.limit?(this.index=e,this):new wt(new Q("invalid step"),this.settings)},e.prototype.bind=function(){return new Uint8Array(this.array.buffer,0,this.index)},e.prototype.withSettings=function(t){return t=W.fromAny(t),this.settings=t,this},e.prototype.clone=function(){return new e(this.array,this.index,this.limit,this.part,this.settings)},e.create=function(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=t.length),new e(t,r,r+n,!1,W.standard())},e}(yt),Dt={output:function(t,e){var r;return void 0===e&&"number"!=typeof t?(e=t,t=void 0):"number"!=typeof t&&(t=void 0),r="number"==typeof t?new Uint8Array(t):null,e=W.fromAny(e),new Mt(r,0,e)},outputBuffer:function(t,e,r){return At.create(t,e,r)}},It=function(){function t(){}return t.prototype.isFatal=function(){return!1},t.prototype.isReplacement=function(){return!1},t.prototype.toString=function(){return nt.debug(this)},t.fatal=function(){return new Tt(!1)},t.fatalNonZero=function(){return new Tt(!0)},t.replacement=function(){return new Vt(65533,!1)},t.replacementNonZero=function(){return new Vt(65533,!0)},S([e],t,"fatal",null),S([e],t,"fatalNonZero",null),S([e],t,"replacement",null),S([e],t,"replacementNonZero",null),t}(),Tt=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"nonZero",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.isFatal=function(){return!0},Object.defineProperty(e.prototype,"replacementChar",{get:function(){return 65533},enumerable:!1,configurable:!0}),e.prototype.isNonZero=function(){return this.nonZero},e.prototype.asNonZero=function(t){return t?It.fatalNonZero():It.fatal()},e.prototype.equals=function(t){return this===t||t instanceof e&&this.nonZero===t.nonZero},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),v.hash(this.nonZero)))},e.prototype.debug=function(t){return t=t.write("UtfErrorMode").write(46).write(this.nonZero?"fatalNonZero":"fatal").write(40).write(41)},e}(It),Vt=function(t){function e(e,r){var n=t.call(this)||this;return Object.defineProperty(n,"replacementChar",{value:e,enumerable:!0}),Object.defineProperty(n,"nonZero",{value:r,enumerable:!0}),n}return P(e,t),e.prototype.isReplacement=function(){return!0},e.prototype.isNonZero=function(){return this.nonZero},e.prototype.asNonZero=function(t){return 65533===this.replacementChar?t?It.replacementNonZero():It.replacement():new e(this.replacementChar,t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.replacementChar===t.replacementChar&&this.nonZero===t.nonZero)},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),m.hash(this.replacementChar)),v.hash(this.nonZero)))},e.prototype.debug=function(t){return t=t.write("UtfErrorMode").write(46).write(this.nonZero?"replacementNonZero":"replacement").write(40).write(41)},e}(It),jt=function(){function t(t){Object.defineProperty(this,"alphabet",{value:t,enumerable:!0})}return t.prototype.encodeDigit=function(t){return this.alphabet.charCodeAt(t)},t.prototype.uint8ArrayWriter=function(t){return void 0===t?new Kt(this,void 0,null):new Kt(this,t,t)},t.prototype.writeUint8Array=function(t,e){return Kt.write(t,this,void 0,e)},t.prototype.writeInteger=function(t,e,r){return void 0===r&&(r=0),Bt.write(t,this,void 0,e,r)},t.prototype.writeIntegerLiteral=function(t,e,r){return void 0===r&&(r=0),Bt.writeLiteral(t,this,void 0,e,r)},Object.defineProperty(t,"lowercase",{get:function(){return new t("0123456789abcdef")},enumerable:!1,configurable:!0}),Object.defineProperty(t,"uppercase",{get:function(){return new t("0123456789ABCDEF")},enumerable:!1,configurable:!0}),t.isDigit=function(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102},t.decodeDigit=function(t){if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-65+10;if(t>=97&&t<=102)return t-97+10;var e=rt.stringOutput();throw e=e.write("Invalid base-16 digit: "),e=nt.debugChar(e,t),new Error(e.bind())},t.writeQuantum=function(e,r,n){var i=t.decodeDigit(r),o=t.decodeDigit(n);return e=e.write(i<<4|o)},t.parser=function(t){return new Lt(t)},t.parse=function(t,e){return Lt.parse(t,e)},t.parseUint8Array=function(t){return Lt.parse(t,Dt.output())},S([e],t,"lowercase",null),S([e],t,"uppercase",null),t}(),qt=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.output=e,u.errorMode=r,u.c1=n,u.c2=i,u.c3=o,u.have=s,u}return P(e,t),e.prototype.isCont=function(){return this.output.isCont()},e.prototype.isFull=function(){return this.output.isFull()},e.prototype.isDone=function(){return this.output.isDone()},e.prototype.isError=function(){return this.output.isError()},e.prototype.isPart=function(){return this.output.isPart()},e.prototype.asPart=function(t){return this.output=this.output.asPart(t),this},e.prototype.write=function(t){if("number"==typeof t){var r=this.c1,n=this.c2,i=this.c3,o=-1,s=this.have;if(t>=0)switch(s){case 0:r=255&t,s=1;break;case 1:n=255&t,s=2;break;case 2:i=255&t,s=3;break;case 3:o=255&t,s=4;break;default:throw new Error("unreachable")}if(0===r&&this.errorMode.isNonZero())return Z.error(new Q("unexpected NUL byte"));if(r>=0&&r<=127)this.output=this.output.write(r),this.have=0;else if(r>=194&&r<=244)if(r>=194&&r<=223&&n>=128&&n<=191)this.output=this.output.write((31&r)<<6|63&n),this.c1=-1,this.have=0;else if(224===r&&n>=160&&n<=191||r>=225&&r<=236&&n>=128&&n<=191||237===r&&n>=128&&n<=159||r>=238&&r<=239&&n>=128&&n<=191)if(i>=128&&i<=191)this.output=this.output.write((15&r)<<12|(63&n)<<6|63&i),this.c1=-1,this.c2=-1,this.have=0;else if(i>=0){if(this.errorMode.isFatal())return Z.error(new Q(e.invalid(r,n,i)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=i,this.c2=-1,this.have=1}else{if(t<0||this.output.isDone())return Z.error(new Q(e.invalid(r,n)));this.c2=n,this.have=2}else if(240===r&&n>=144&&n<=191||r>=241&&r<=243&&n>=128&&n<=191||244===r&&n>=128&&n<=143)if(i>=128&&i<=191)if(o>=128&&o<=191)this.have=4,this.output=this.output.write((7&r)<<18|(63&n)<<12|(63&i)<<6|63&o),this.c1=-1,this.c2=-1,this.c3=-1,this.have=0;else if(o>=0){if(this.errorMode.isFatal())return Z.error(new Q(e.invalid(r,n,i,o)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=o,this.c2=-1,this.c3=-1,this.have=1}else{if(t<0||this.output.isDone())return Z.error(new Q(e.invalid(r,n,i)));this.c3=i,this.have=3}else if(i>=0){if(this.errorMode.isFatal())return Z.error(new Q(e.invalid(r,n,i)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=i,this.c2=-1,this.have=1}else{if(t<0||this.output.isDone())return Z.error(new Q(e.invalid(r,n)));this.c2=n,this.have=2}else if(n>=0){if(this.errorMode.isFatal())return Z.error(new Q(e.invalid(r,n)));this.output=this.output.write(this.errorMode.replacementChar),this.c1=n,this.have=1}else{if(t<0||this.output.isDone())return Z.error(new Q(e.invalid(r)));this.c1=r,this.have=1}else if(r>=0){if(this.errorMode.isFatal())return Z.error(new Q(e.invalid(r)));this.output=this.output.write(this.errorMode.replacementChar),this.have=0}return this.output.isError()?this.output:this}if("string"==typeof t)return this.output=this.output.write(t),this;throw new TypeError(""+t)},e.invalid=function(t,e,r,n){var i=rt.stringOutput();i=i.write("invalid UTF-8 code unit sequence: ");var o=jt.uppercase;return o.writeIntegerLiteral(i,t,2),void 0!==e&&(i=i.write(" "),o.writeIntegerLiteral(i,e,2),void 0!==r&&(i=i.write(" "),o.writeIntegerLiteral(i,r,2),void 0!==n&&(i=i.write(" "),o.writeIntegerLiteral(i,n,2)))),i.bind()},Object.defineProperty(e.prototype,"settings",{get:function(){return this.output.settings},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return this.output=this.output.withSettings(t),this},e.prototype.bind=function(){return 0===this.have?this.output.bind():this.write(-1).bind()},e.prototype.trap=function(){return this.output.trap()},e.prototype.clone=function(){return new e(this.output.clone(),this.errorMode,this.c1,this.c2,this.c3,this.have)},e.create=function(t,r){return void 0===r&&(r=It.fatal()),new e(t,r,-1,-1,-1,0)},e}(Z),Rt=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.output=e,u.errorMode=r,u.c2=n,u.c3=i,u.c4=o,u.index=s,u}return P(e,t),e.prototype.isCont=function(){return this.output.isCont()},e.prototype.isFull=function(){return this.output.isFull()},e.prototype.isDone=function(){return this.output.isDone()},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return this.output.isPart()},e.prototype.asPart=function(t){return this.output=this.output.asPart(t),this},e.prototype.write=function(t){if("number"==typeof t){for(var e=0,r=this.c2,n=this.c3,i=this.c4,o=this.output,s=this.index;s<4;){if(!o.isCont())return Z.error(new Q("unable to flush buffered code units"));switch(s){case 1:o=o.write(r),this.c2=0;break;case 2:o=o.write(n),this.c3=0;break;case 3:o=o.write(i),this.c4=0;break;default:throw new Error("unreachable")}s+=1}if(t>=0&&t<=127)i=t,s=3;else if(t>=128&&t<=2047)n=192|t>>>6,i=128|63&t,s=2;else if(t>=2048&&t<=65535||t>=57344&&t<=65535)r=224|t>>>12,n=128|t>>>6&63,i=128|63&t,s=1;else{if(!(t>=65536&&t<=1114111))return this.errorMode.isFatal()?Z.error(new Q("invalid code point: "+t)):this.write(this.errorMode.replacementChar);e=240|t>>>18,r=128|t>>>12&63,n=128|t>>>6&63,i=128|63&t,s=0}do{switch(s){case 0:o=o.write(e);break;case 1:o=o.write(r),this.c2=0;break;case 2:o=o.write(n),this.c3=0;break;case 3:o=o.write(i),this.c4=0;break;default:throw new Error("unreachable")}this.output=o,s+=1}while(s<4&&o.isCont());return s<4&&(s<3&&(s<2&&(this.c2=r),this.c3=n),this.c4=i),this.output=o,this.index=s,this}if("string"==typeof t)return this.output=this.output.write(t),this;throw new TypeError(""+t)},e.prototype.flush=function(){for(var t=this.output,e=this.index;e<4;){if(!t.isCont())return Z.error(new Q("unable to flush buffered code units"));switch(e){case 1:t=t.write(this.c2),this.c2=0;break;case 2:t=t.write(this.c3),this.c3=0;break;case 3:t=t.write(this.c4),this.c4=0;break;default:throw new Error("unreachable")}e+=1}return this.output=t,this.index=e,this},Object.defineProperty(e.prototype,"settings",{get:function(){return this.output.settings},enumerable:!1,configurable:!0}),e.prototype.withSettings=function(t){return this.output=this.output.withSettings(t),this},e.prototype.bind=function(){return this.output.bind()},e.prototype.clone=function(){return new e(this.output.clone(),this.errorMode,this.c2,this.c3,this.c4,this.index)},e.create=function(t,r){return void 0===r&&(r=It.fatal()),new e(t,r,0,0,0,4)},e}(Z),Ut={sizeOf:function(t,e){if("number"==typeof t||void 0===t){if("number"==typeof t){if(0===t&&void 0!==e&&e.isNonZero())return 2;if(t>=0&&t<=127)return 1;if(t>=128&&t<=2047)return 2;if(t>=2048&&t<=65535||t>=57344&&t<=65535)return 3;if(t>=65536&&t<=1114111)return 4}return void 0===e?3:e.isReplacement()?Ut.sizeOf(e.replacementChar):0}if("string"==typeof t){for(var r=0,n=0,i=t.length;n<i;n=t.offsetByCodePoints(n,1))r+=Ut.sizeOf(t.charCodeAt(n),e);return r}throw new TypeError(""+t)},decodedOutput:function(t,e){return qt.create(t,e)},encodedOutput:function(t,e){return Rt.create(t,e)},decodedString:function(){return Ut.decodedOutput(rt.stringOutput())}},Nt=function(t){function e(e,r,n,i){void 0===e&&(e=1),void 0===r&&(r=0),void 0===n&&(n=2),void 0===i&&(i=1);var o=t.call(this)||this;return o.sign=e,o.value=r,o.mode=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.sign,this.value,this.mode,this.step)},e.parse=function(t,r,n,i,o){void 0===r&&(r=1),void 0===n&&(n=0),void 0===i&&(i=2),void 0===o&&(o=1);var s=0;if(1===o)if(t.isCont())45===(s=t.head())?(t=t.step(),r=-1):43===s&&(t=t.step(),r=1),o=2;else if(t.isDone())return bt.error(ot.expected("number",t));if(2===o)if(t.isCont())if(48===(s=t.head()))t=t.step(),o=4;else{if(!(s>=49&&s<=57)){if(i>0&&46===s){var u=rt.stringOutput();return r<0&&(u=u.write(45)),zt.parse(t,u,i)}return bt.error(ot.expected("number",t))}t=t.step(),n=r*(s-48),o=3}else if(t.isDone())return bt.error(ot.expected("number",t));if(3===o){for(;t.isCont()&&(s=t.head())>=48&&s<=57;){var a=10*n+r*(s-48);if(!(-9007199254740991<=a&&a<=9007199254740992))return bt.error(ot.message("integer overflow",t));n=a,t=t.step()}if(t.isCont())o=4;else if(t.isDone())return bt.done(n)}if(4===o){if(t.isCont()){if(s=t.head(),i>0&&46===s||i>1&&(69===s||101===s)){u=rt.stringOutput();return u=r<0&&0===n?u.write(45).write(48):u.write(""+n),zt.parse(t,u,i)}return bt.done(n)}if(t.isDone())return bt.done(n)}return new e(r,n,i,o)},e}(bt),zt=function(t){function e(e,r,n){void 0===r&&(r=2),void 0===n&&(n=1);var i=t.call(this)||this;return i.output=e,i.mode=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.mode,this.step)},e.parse=function(t,r,n,i){void 0===n&&(n=2),void 0===i&&(i=1);var o=0;if(1===i)if(t.isCont())if(46===(o=t.head()))t=t.step(),r=r.write(o),i=2;else{if(!(n>1)||69!==o&&101!==o)return bt.error(ot.expected("decimal or exponent",t));t=t.step(),r=r.write(o),i=5}else if(t.isDone())return bt.error(ot.expected("decimal or exponent",t));if(2===i)if(t.isCont()){if(!((o=t.head())>=48&&o<=57))return bt.error(ot.expected("digit",t));t=t.step(),r=r.write(o),i=3}else if(t.isDone())return bt.error(ot.expected("digit",t));if(3===i){for(;t.isCont()&&(o=t.head())>=48&&o<=57;)t=t.step(),r=r.write(o);if(t.isCont()){if(!(n>1))return bt.done(+r.bind());i=4}else if(t.isDone())return bt.done(+r.bind())}if(4===i){if(69!==(o=t.head())&&101!==o)return bt.done(+r.bind());t=t.step(),r=r.write(o),i=5}if(5===i)if(t.isCont())43!==(o=t.head())&&45!==o||(t=t.step(),r=r.write(o)),i=6;else if(t.isDone())return bt.error(ot.unexpected(t));if(6===i)if(t.isCont()){if(!((o=t.head())>=48&&o<=57))return bt.error(ot.expected("digit",t));t=t.step(),r=r.write(o),i=7}else if(t.isDone())return bt.error(ot.expected("digit",t));if(7===i){for(;t.isCont()&&(o=t.head())>=48&&o<=57;)t=t.step(),r=r.write(o);if(!t.isEmpty())return bt.done(+r.bind())}return new e(r,n,i)},e}(bt),Ft=function(t){function e(e,r,n,i){void 0===n&&(n=0),void 0===i&&(i=1);var o=t.call(this)||this;return o.value=e,o.input=r,o.index=n,o.step=i,o}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.value,this.input,this.index,this.step)},e.write=function(t,r,n,i,o){if(void 0===i&&(i=0),void 0===o&&(o=1),0===o)return tt.end();if(1===o&&(n<0?t.isCont()&&(t=t.write(45),o=2):o=2),2===o)if(n>-10&&n<10){if(t.isCont())return t=t.write(it.encodeDigit(Math.abs(0|n))),tt.done(r)}else{for(var s=new Array(19),u=n,a=18;0!==u;)s[a]=Math.abs(u%10|0),u=u/10|0,a-=1;for(a+=1+i;a<19&&t.isCont();)t=t.write(it.encodeDigit(s[a])),i+=1,a+=1;if(19===a)return tt.done(r)}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o)},e}(tt),Lt=function(t){function e(e,r,n){void 0===r&&(r=0),void 0===n&&(n=1);var i=t.call(this)||this;return i.output=e,i.p=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.output.clone(),this.p,this.step)},e.parse=function(t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=1);for(var o=0;!t.isEmpty();){if(1===i)if(t.isCont()&&(o=t.head(),jt.isDigit(o)))t=t.step(),n=o,i=2;else if(!t.isEmpty())return bt.done(r.bind());if(2===i)if(t.isCont()&&(o=t.head(),jt.isDigit(o)))t=t.step(),r=jt.writeQuantum(r,n,o),n=0,i=1;else if(!t.isEmpty())return bt.error(ot.expected("base16 digit",t))}return new e(r,n,i)},e}(bt),Kt=function(t){function e(e,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var s=t.call(this)||this;return s.base16=e,s.value=r,s.input=n,s.index=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){if(t instanceof Uint8Array)return new e(this.base16,void 0,t);throw new TypeError(""+t)},e.prototype.pull=function(t){if(null===this.input)throw new $;return e.write(t,this.base16,this.value,this.input,this.index,this.step)},e.write=function(t,r,n,i,o,s){for(void 0===o&&(o=0),void 0===s&&(s=1);o<i.length;){var u=i[o];1===s&&t.isCont()&&(t=t.write(r.encodeDigit(u>>>4)),s=2),2===s&&t.isCont()&&(t=t.write(r.encodeDigit(15&u)),o+=1,s=1)}return o===i.length?tt.done(n):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e}(tt),Bt=function(t){function e(e,r,n,i,o,s){void 0===o&&(o=0),void 0===s&&(s=3);var u=t.call(this)||this;return u.base16=e,u.value=r,u.input=n,u.width=i,u.index=o,u.step=s,u}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.base16,this.value,this.input,this.width,this.index,this.step)},e.write=function(t,r,n,i,o,s,u){if(void 0===s&&(s=0),void 0===u&&(u=3),u<=0)return tt.end();if(1===u&&t.isCont()&&(t=t.write(48),u=2),2===u&&t.isCont()&&(t=t.write(120),u=3),3===u)if(i>=0&&i<16&&o<=1){if(t.isCont())return t=t.write(r.encodeDigit(i)),tt.done(n)}else{for(var a=15,p=new Array(16),h=i;0!==h||a>=16-o;)p[a]=15&h,h>>>=4,a-=1;for(a+=1+s;a<16&&t.isCont();)t=t.write(r.encodeDigit(p[a])),s+=1,a+=1;if(16===a)return tt.done(n)}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s,u)},e.writeLiteral=function(t,r,n,i,o){return e.write(t,r,n,i,o,0,1)},e}(tt),Wt=function(){function t(){}return t.prototype.decodeDigit=function(t){if(t>=65&&t<=90)return t-65;if(t>=97&&t<=122)return t+-71;if(t>=48&&t<=57)return t+4;if(43===t||45===t)return 62;if(47===t||95===t)return 63;var e=rt.stringOutput();throw e=e.write("Invalid base-64 digit: "),e=nt.debugChar(e,t),new Error(e.bind())},t.prototype.encodeDigit=function(t){return this.alphabet.charCodeAt(t)},t.prototype.writeQuantum=function(t,e,r,n,i){var o=this.decodeDigit(e),s=this.decodeDigit(r);if(61!==n){var u=this.decodeDigit(n);if(61!==i){var a=this.decodeDigit(i);t=(t=(t=t.write(o<<2|s>>>4)).write(s<<4|u>>>2)).write(u<<6|a)}else t=(t=t.write(o<<2|s>>>4)).write(s<<4|u>>>2)}else{if(61!==i)return Z.error(new Error("Improperly padded base-64"));t=t.write(o<<2|s>>>4)}return t},t.prototype.parser=function(t){return new Yt(this,t)},t.prototype.parse=function(t,e){return Yt.parse(t,this,e)},t.prototype.parseUint8Array=function(t){return Yt.parse(t,this,Dt.output())},t.prototype.uint8ArrayWriter=function(t){return void 0===t?new Gt(this,void 0,null):new Gt(this,t,t)},t.prototype.writeUint8Array=function(t,e){return Gt.write(t,this,void 0,e)},Object.defineProperty(t,"standardPadded",{get:function(){return new Ht(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"standardUnpadded",{get:function(){return new Ht(!1)},enumerable:!1,configurable:!0}),t.standard=function(e){return void 0===e&&(e=!0),e?t.standardPadded:t.standardUnpadded},Object.defineProperty(t,"urlPadded",{get:function(){return new Xt(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"urlUnpadded",{get:function(){return new Xt(!1)},enumerable:!1,configurable:!0}),t.url=function(e){return void 0===e&&(e=!0),e?t.urlPadded:t.urlUnpadded},S([e],t,"standardPadded",null),S([e],t,"standardUnpadded",null),S([e],t,"urlPadded",null),S([e],t,"urlUnpadded",null),t}(),Ht=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"padded",{value:e,enumerable:!0}),r}return P(e,t),Object.defineProperty(e.prototype,"alphabet",{get:function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"},enumerable:!1,configurable:!0}),e.prototype.isPadded=function(){return this.padded},e.prototype.asPadded=function(t){return t===this.padded?this:Wt.standard(t)},e.prototype.isDigit=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||43===t||47===t},e}(Wt),Xt=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"padded",{value:e,enumerable:!0}),r}return P(e,t),Object.defineProperty(e.prototype,"alphabet",{get:function(){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},enumerable:!1,configurable:!0}),e.prototype.isPadded=function(){return this.padded},e.prototype.asPadded=function(t){return t===this.padded?this:Wt.url(t)},e.prototype.isDigit=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||45===t||95===t},e}(Wt),Yt=function(t){function e(e,r,n,i,o,s){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=1);var u=t.call(this)||this;return u.base64=e,u.output=r,u.p=n,u.q=i,u.r=o,u.step=s,u}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.base64,this.output.clone(),this.p,this.q,this.r,this.step)},e.parse=function(t,r,n,i,o,s,u){void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=1);for(var a=0;!t.isEmpty();){if(1===u)if(t.isCont()&&(a=t.head(),r.isDigit(a)))t=t.step(),i=a,u=2;else if(!t.isEmpty())return bt.done(n.bind());if(2===u)if(t.isCont()&&(a=t.head(),r.isDigit(a)))t=t.step(),o=a,u=3;else if(!t.isEmpty())return bt.error(ot.expected("base64 digit",t));if(3===u)if(t.isCont()&&(a=t.head(),r.isDigit(a)||61===a))t=t.step(),s=a,u=61!==a?4:5;else if(!t.isEmpty())return r.isPadded()?bt.error(ot.unexpected(t)):(n=r.writeQuantum(n,i,o,61,61),bt.done(n.bind()));if(4===u){if(t.isCont()&&(a=t.head(),r.isDigit(a)||61===a)){if(t=t.step(),n=r.writeQuantum(n,i,o,s,a),s=0,o=0,i=0,61===a)return bt.done(n.bind());u=1}else if(!t.isEmpty())return r.isPadded()?bt.error(ot.unexpected(t)):(n=r.writeQuantum(n,i,o,s,61),bt.done(n.bind()))}else if(5===u){if(t.isCont()&&61===(a=t.head()))return t=t.step(),n=r.writeQuantum(n,i,o,s,a),s=0,o=0,i=0,bt.done(n.bind());if(!t.isEmpty())return bt.error(ot.expected(61,t))}}return new e(r,n,i,o,s,u)},e}(bt),Gt=function(t){function e(e,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var s=t.call(this)||this;return s.base64=e,s.value=r,s.input=n,s.index=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){if(t instanceof Uint8Array)return new e(this.base64,null,t);throw new TypeError(""+t)},e.prototype.pull=function(t){if(null===this.input)throw new $;return e.write(t,this.base64,this.value,this.input,this.index,this.step)},e.write=function(t,r,n,i,o,s){for(void 0===o&&(o=0),void 0===s&&(s=1);o+2<i.length&&t.isCont();){var u=i[o],a=i[o+1],p=i[o+2];1===s&&t.isCont()&&(t=t.write(r.encodeDigit(u>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(r.encodeDigit(63&(u<<4|a>>>4))),s=3),3===s&&t.isCont()&&(t=t.write(r.encodeDigit(63&(a<<2|p>>>6))),s=4),4===s&&t.isCont()&&(t=t.write(r.encodeDigit(63&p)),o+=3,s=1)}if(o+1<i.length&&t.isCont()){u=i[o],a=i[o+1];1===s&&t.isCont()&&(t=t.write(r.encodeDigit(u>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(r.encodeDigit(63&(u<<4|a>>>4))),s=3),3===s&&t.isCont()&&(t=t.write(r.encodeDigit(a<<2&63)),s=4),4===s&&(r.isPadded()?t.isCont()&&(t=t.write(61),o+=2):o+=2)}else if(o<i.length&&t.isCont()){u=i[o];1===s&&t.isCont()&&(t=t.write(r.encodeDigit(u>>>2)),s=2),2===s&&t.isCont()&&(t=t.write(r.encodeDigit(u<<4&63)),s=3),3===s&&(r.isPadded()?t.isCont()&&(t=t.write(61),s=4):o+=1),4===s&&t.isCont()&&(t=t.write(61),o+=1)}return o===i.length?tt.done(n):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e}(tt),_t=function(t,e){var r=function(t){return r.range(r.domain(t))};return Object.setPrototypeOf(r,_t.prototype),r.domain=t,r.range=e,r};_t.prototype=Object.create(Object.prototype),_t.prototype.equivalentTo=function(t,e){return this===t||t instanceof _t&&(this.domain.equivalentTo(t.domain,e)&&this.range.equivalentTo(t.range,e))},_t.prototype.canEqual=function(t){return t instanceof _t},_t.prototype.equals=function(t){return this===t||t instanceof _t&&(t.canEqual(this)&&this.domain.equals(t.domain)&&this.range.equals(t.range))},_t.prototype.toString=function(){return"Mapping("+this.domain+", "+this.range+")"};var Qt=function(t,e){var r=function(t){return O.equal(t,r[1])?1:0};return Object.setPrototypeOf(r,Qt.prototype),r[0]=t,r[1]=e,r};Qt.prototype=Object.create(_t.prototype),Object.defineProperty(Qt.prototype,"domain",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(Qt.prototype,"range",{get:function(){return Zt.unit},enumerable:!0,configurable:!0}),Qt.prototype.contains=function(t){return O.compare(this[0],t)<=0&&O.compare(t,this[1])<=0},Qt.prototype.equivalentTo=function(t,e){return this===t||t instanceof Qt&&(O.equivalent(this[0],t[0],e)&&O.equivalent(this[1],t[1],e))},Qt.prototype.canEqual=function(t){return t instanceof Qt},Qt.prototype.equals=function(t){return this===t||t instanceof Qt&&(t.canEqual(this)&&O.equal(this[0],t[0])&&O.equal(this[1],t[1]))},Qt.prototype.toString=function(){return"Domain("+this[0]+", "+this[1]+")"},Object.defineProperty(Qt,"unit",{get:function(){var t=pe(0,1);return Object.defineProperty(Qt,"unit",{value:t,enumerable:!0,configurable:!0}),t},enumerable:!0,configurable:!0});var Zt=function(t,e){var r=function(t){return t<1?r[0]:r[1]};return Object.setPrototypeOf(r,Zt.prototype),r[0]=t,r[1]=e,r};Zt.prototype=Object.create(_t.prototype),Object.defineProperty(Zt.prototype,"domain",{get:function(){return Qt.unit},enumerable:!0,configurable:!0}),Object.defineProperty(Zt.prototype,"range",{get:function(){return this},enumerable:!0,configurable:!0}),Zt.prototype.equivalentTo=function(t,e){return this===t||t instanceof Zt&&(O.equivalent(this[0],t[0],e)&&O.equivalent(this[1],t[1],e))},Zt.prototype.canEqual=function(t){return t instanceof Zt},Zt.prototype.equals=function(t){return this===t||t instanceof Zt&&(t.canEqual(this)&&O.equal(this[0],t[0])&&O.equal(this[1],t[1]))},Zt.prototype.toString=function(){return"Range("+this[0]+", "+this[1]+")"},Object.defineProperty(Zt,"unit",{get:function(){var t=fe(0,1);return Object.defineProperty(Zt,"unit",{value:t,enumerable:!0,configurable:!0}),t},enumerable:!0,configurable:!0});var Jt=function(t,e){return null!=t&&"function"==typeof t.interpolateTo?t.interpolateTo(e):null};Jt.is=function(t){return null!=t&&"function"==typeof t.interpolateTo};var $t=function(t,e){var r;return t===e?r=ee(t):"number"==typeof t&&"number"==typeof e?r=ne(t,e):Array.isArray(t)&&Array.isArray(e)?r=ie(t,e):null===(r=Jt(t,e))&&(r=re(t,e)),r};($t.prototype=Object.create(Zt.prototype)).map=function(t){return te(this,t)},$t.prototype.interpolateTo=function(t){return t instanceof $t?oe(this,t):null},$t.prototype.canEqual=function(t){return t instanceof this.constructor},$t.prototype.equals=function(t){return this===t||t instanceof $t&&(t.canEqual(this)&&O.equal(this[0],t[0])&&O.equal(this[1],t[1]))},$t.prototype.toString=function(){return"Interpolator("+this[0]+", "+this[1]+")"};var te=function(t,e){var r=function(t){return r.transform(r.interpolator(t))};return Object.setPrototypeOf(r,te.prototype),r.interpolator=t,r.transform=e,r};te.prototype=Object.create($t.prototype),Object.defineProperty(te.prototype,0,{get:function(){return this.transform(this.interpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(te.prototype,1,{get:function(){return this.transform(this.interpolator[1])},enumerable:!0,configurable:!0}),te.prototype.equals=function(t){return this===t||t instanceof te&&(this.interpolator.equals(t.interpolator)&&this.transform===t.transform)};var ee=function(t){var e=function(t){return e.value};return Object.setPrototypeOf(e,ee.prototype),e.value=t,e};ee.prototype=Object.create($t.prototype),Object.defineProperty(ee.prototype,0,{get:function(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(ee.prototype,1,{get:function(){return this.value},enumerable:!0,configurable:!0}),ee.prototype.equals=function(t){return this===t||t instanceof ee&&this.value===t.value};var re=function(t,e){var r=function(t){return t<1?r[0]:r[1]};return Object.setPrototypeOf(r,re.prototype),r[0]=t,r[1]=e,r};re.prototype=Object.create($t.prototype);var ne=function(t,e){var r=function(t){var e=r[0];return e+t*(r[1]-e)};return Object.setPrototypeOf(r,ne.prototype),r[0]=t,r[1]=e,r};ne.prototype=Object.create($t.prototype);var ie=function(t,e){var r=function(t){for(var e=r.interpolators,n=e.length,i=new Array(n),o=0;o<n;o+=1)i[o]=e[o](t);return i};Object.setPrototypeOf(r,ie.prototype);for(var n=Math.min(t.length,e.length),i=new Array(n),o=0;o<n;o+=1)i[o]=$t(t[o],e[o]);return r.interpolators=i,r};ie.prototype=Object.create($t.prototype),Object.defineProperty(ie.prototype,0,{get:function(){for(var t=this.interpolators,e=t.length,r=new Array(e),n=0;n<e;n+=1)r[n]=t[n][0];return r},enumerable:!0,configurable:!0}),Object.defineProperty(ie.prototype,1,{get:function(){for(var t=this.interpolators,e=t.length,r=new Array(e),n=0;n<e;n+=1)r[n]=t[n][1];return r},enumerable:!0,configurable:!0}),ie.prototype.equals=function(t){if(this===t)return!0;if(t instanceof ie){var e=this.interpolators.length;if(e===t.interpolators.length){for(var r=0;r<e;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1};var oe=function(t,e){var r=function(t){return 0===t?r[0]:1===t?r[1]:$t(r[0](t),r[1](t))};return Object.setPrototypeOf(r,oe.prototype),r[0]=t,r[1]=e,r};oe.prototype=Object.create($t.prototype);var se=function(t,e,r){var n=function(t){var e=n[0],r=n[1];return n.easing(Math.min(Math.max(0,(t-e)/(r-e)),1))};return Object.setPrototypeOf(n,se.prototype),n.easing=t,n[0]=e,n[1]=r,n};se.prototype=Object.create(Qt.prototype),Object.defineProperty(se.prototype,"duration",{get:function(){return this[1]-this[0]},enumerable:!0,configurable:!0}),se.prototype.contains=function(t){return this[0]<=t&&t<=this[1]},se.prototype.withDomain=function(t,e){return se(this.easing,t,e)},se.prototype.withDuration=function(t){var e=this[0];return se(this.easing,e,e+t)},se.prototype.overRange=function(t,e){var r;return r=1===arguments.length?t:$t(t,e),ae(this,r)},se.prototype.equivalentTo=function(t,e){return this===t||t instanceof se&&(this.easing.equivalentTo(t.easing,e)&&O.equivalent(this[0],t[0],e)&&O.equivalent(this[1],t[1],e))},se.prototype.canEqual=function(t){return t instanceof se},se.prototype.equals=function(t){return this===t||t instanceof se&&(t.canEqual(this)&&this.easing.equals(t.easing)&&O.equal(this[0],t[0])&&O.equal(this[1],t[1]))},se.prototype.toString=function(){return"Timing("+this.easing+", "+this[0]+", "+this[1]+")"},se.fromInit=function(t){var e=t.easing;void 0===e?e=ue.linear:"string"==typeof e&&(e=ue(e));var r=t.t0;void 0===r&&(r=0);var n=t.t1;if(void 0===n){var i=t.dt;n=void 0!==i?r+i:r}return se(e,r,n)},se.fromAny=function(t){if(null==t)return!1;if(t instanceof se||"boolean"==typeof t)return t;if("object"==typeof t)return se.fromInit(t);throw new TypeError(""+t)};var ue=function(t){switch(t){case"linear":return ue.linear;case"quad-in":return ue.quadIn;case"quad-out":return ue.quadOut;case"quad-in-out":return ue.quadInOut;case"cubic-in":return ue.cubicIn;case"cubic-out":return ue.cubicOut;case"cubic-in-out":return ue.cubicInOut;case"quart-in":return ue.quartIn;case"quart-out":return ue.quartOut;case"quart-in-out":return ue.quartInOut;case"expo-in":return ue.expoIn;case"expo-out":return ue.expoOut;case"expo-in-out":return ue.expoInOut;case"circ-in":return ue.circIn;case"circ-out":return ue.circOut;case"circ-in-out":return ue.circInOut;case"back-in":return ue.backIn;case"back-out":return ue.backOut;case"back-in-out":return ue.backInOut;case"elastic-in":return ue.elasticIn;case"elastic-out":return ue.elasticOut;case"elastic-in-out":return ue.elasticInOut;case"bounce-in":return ue.bounceIn;case"bounce-out":return ue.bounceOut;case"bounce-in-out":return ue.bounceInOut;default:throw new Error("unknown easing: "+t)}};ue.prototype=Object.create(se.prototype),Object.defineProperty(ue.prototype,0,{value:0,enumerable:!0}),Object.defineProperty(ue.prototype,1,{value:1,enumerable:!0}),Object.defineProperty(ue.prototype,"easing",{get:function(){return this},enumerable:!0}),ue.prototype.equivalentTo=function(t,e){return this===t},ue.prototype.canEqual=function(t){return t instanceof ue},ue.prototype.equals=function(t){return this===t},ue.prototype.toString=function(){return'Easing("'+this.type+'")'},ue.fromAny=function(t){if(t instanceof ue)return t;if("string"==typeof t)return ue(t);throw new TypeError(""+t)},ue.linear=function(t){return t},Object.setPrototypeOf(ue.linear,ue.prototype),ue.linear.type="linear",ue.quadIn=function(t){return t*t},Object.setPrototypeOf(ue.quadIn,ue.prototype),ue.quadIn.type="quad-in",ue.quadOut=function(t){return t*(2-t)},Object.setPrototypeOf(ue.quadOut,ue.prototype),ue.quadOut.type="quad-out",ue.quadInOut=function(t){return(t*=2)<=1?t*=t:(t-=1,t*=2-t,t+=1),t/=2},Object.setPrototypeOf(ue.quadInOut,ue.prototype),ue.quadInOut.type="quad-in-out",ue.cubicIn=function(t){return t*t*t},Object.setPrototypeOf(ue.cubicIn,ue.prototype),ue.cubicIn.type="cubic-in",ue.cubicOut=function(t){return t-=1,t*=t*t,t+=1},Object.setPrototypeOf(ue.cubicOut,ue.prototype),ue.cubicOut.type="cubic-out",ue.cubicInOut=function(t){return(t*=2)<=1?t*=t*t:(t-=2,t*=t*t,t+=2),t/=2},Object.setPrototypeOf(ue.cubicInOut,ue.prototype),ue.cubicInOut.type="cubic-in-out",ue.quartIn=function(t){return t*t*t*t},Object.setPrototypeOf(ue.quartIn,ue.prototype),ue.quartIn.type="quart-in",ue.quartOut=function(t){return 1-(t-=1)*t*t*t},Object.setPrototypeOf(ue.quartOut,ue.prototype),ue.quartOut.type="quart-out",ue.quartInOut=function(t){var e=t-1;return t<.5?8*t*t*t*t:1-8*e*e*e*e},Object.setPrototypeOf(ue.quartInOut,ue.prototype),ue.quartInOut.type="quart-in-out",ue.expoIn=function(t){return 0===t?0:Math.pow(2,10*(t-1))},Object.setPrototypeOf(ue.expoIn,ue.prototype),ue.expoIn.type="expo-in",ue.expoOut=function(t){return 1===t?1:1-Math.pow(2,-10*t)},Object.setPrototypeOf(ue.expoOut,ue.prototype),ue.expoOut.type="expo-out",ue.expoInOut=function(t){return 1===t||0===t?t:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))},Object.setPrototypeOf(ue.expoInOut,ue.prototype),ue.expoInOut.type="expo-in-out",ue.circIn=function(t){return-1*(Math.sqrt(1-t/1*t)-1)},Object.setPrototypeOf(ue.circIn,ue.prototype),ue.circIn.type="circ-in",ue.circOut=function(t){return t-=1,Math.sqrt(1-t*t)},Object.setPrototypeOf(ue.circOut,ue.prototype),ue.circOut.type="circ-out",ue.circInOut=function(t){if((t*=2)<1)return-.5*(Math.sqrt(1-t*t)-1);var e=t-2;return.5*(Math.sqrt(1-e*e)+1)},Object.setPrototypeOf(ue.circInOut,ue.prototype),ue.circInOut.type="circ-in-out",ue.backIn=function(t){var e=1.70158;return t*t*((e+1)*t-e)},Object.setPrototypeOf(ue.backIn,ue.prototype),ue.backIn.type="back-in",ue.backOut=function(t){var e=1.70158,r=t/1-1;return r*r*((e+1)*e+e)+1},Object.setPrototypeOf(ue.backOut,ue.prototype),ue.backOut.type="back-out",ue.backInOut=function(t){var e=2.5949095;if((t*=2)<1)return.5*t*t*((e+1)*t-e);var r=t-2;return.5*(r*r*((e+1)*r+e)+2)},Object.setPrototypeOf(ue.backInOut,ue.prototype),ue.backInOut.type="back-in-out",ue.elasticIn=function(t){if(0===t||1===t)return t;var e=t/1-1,r=(1-.7)/2*Math.PI*Math.asin(1);return-Math.pow(2,10*e)*Math.sin(2*(e-r)*Math.PI/(1-.7))},Object.setPrototypeOf(ue.elasticIn,ue.prototype),ue.elasticIn.type="elastic-in",ue.elasticOut=function(t){if(0===t||1===t)return t;var e=(1-.7)/(2*Math.PI)*Math.asin(1);return t*=2,Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/(1-.7))+1},Object.setPrototypeOf(ue.elasticOut,ue.prototype),ue.elasticOut.type="elastic-out",ue.elasticInOut=function(t){if(0===t||1===t)return t;var e=.65,r=(1-e)/(2*Math.PI)*Math.asin(1),n=2*t,i=n-1;return n<1?Math.pow(2,10*i)*Math.sin(2*(i-r)*Math.PI/(1-e))*-.5:Math.pow(2,-10*i)*Math.sin(2*(i-r)*Math.PI/(1-e))*.5+1},Object.setPrototypeOf(ue.elasticInOut,ue.prototype),ue.elasticInOut.type="elastic-in-out",ue.bounceIn=function(t){var e=7.5625;return(t=1-t)<1/2.75?1-e*t*t:t<2/2.75?1-(e*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(e*(t-=2.25/2.75)*t+.9375):1-(e*(t-=2.625/2.75)*t+.984375)},Object.setPrototypeOf(ue.bounceIn,ue.prototype),ue.bounceIn.type="bounce-in",ue.bounceOut=function(t){var e=7.5625;return t<1/2.75?e*t*t:t<2/2.75?e*(t-=1.5/2.75)*t+.75:t<2.5/2.75?e*(t-=2.25/2.75)*t+.9375:e*(t-=2.625/2.75)*t+.984375},Object.setPrototypeOf(ue.bounceOut,ue.prototype),ue.bounceOut.type="bounce-out",ue.bounceInOut=function(t){var e=t<.5,r=7.5625;return(t=e?1-2*t:2*t-1)<1/2.75?t*=r*t:t=t<2/2.75?r*(t-=1.5/2.75)*t+.75:t<2.5/2.75?r*(t-=2.25/2.75)*t+.9375:r*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5},Object.setPrototypeOf(ue.bounceInOut,ue.prototype),ue.bounceInOut.type="bounce-in-out";var ae=function(t,e){var r=function(t){return r.range(r.domain(t))};return Object.setPrototypeOf(r,ae.prototype),r.domain=t,r.range=e,r};ae.prototype=Object.create(_t.prototype),ae.prototype.withDomain=function(t,e){return this.domain.withDomain(t,e).overRange(this.range)},ae.prototype.canEqual=function(t){return t instanceof ae},ae.prototype.equals=function(t){return this===t||t instanceof ae&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},ae.prototype.toString=function(){return"Tweening("+this.domain+", "+this.range+")"};var pe=function(t,e){var r=function(t){var e=r[0],n=r[1]-e;return 0!==n?(t-e)/n:0};return Object.setPrototypeOf(r,pe.prototype),r[0]=t,r[1]=e,r};pe.prototype=Object.create(Qt.prototype),Object.defineProperty(pe.prototype,"inverse",{get:function(){return fe(this[0],this[1])},enumerable:!0,configurable:!0}),pe.prototype.contains=function(t){return this[0]<=t&&t<=this[1]},pe.prototype.interpolateTo=function(t){return t instanceof pe?he(this,t):null},pe.prototype.canEqual=function(t){return t instanceof pe},pe.prototype.equals=function(t){return this===t||t instanceof pe&&(t.canEqual(this)&&this[0]===t[0]&&this[1]===t[1])},pe.prototype.toString=function(){return"LinearDomain("+this[0]+", "+this[1]+")"};var he=function(t,e){var r=function(t){var e=r[0],n=e[0],i=e[1],o=r[1],s=o[0],u=o[1];return pe(n+t*(s-n),i+t*(u-i))};return Object.setPrototypeOf(r,he.prototype),r[0]=t,r[1]=e,r};he.prototype=Object.create($t.prototype);var fe=function(t,e){var r=function(t){var e=r[0];return e+t*(r[1]-e)};return Object.setPrototypeOf(r,fe.prototype),r[0]=t,r[1]=e,r};fe.prototype=Object.create(Zt.prototype),Object.defineProperty(fe.prototype,"inverse",{get:function(){return pe(this[0],this[1])},enumerable:!0,configurable:!0}),fe.prototype.interpolateTo=function(t){return t instanceof fe?ce(this,t):null},fe.prototype.canEqual=function(t){return t instanceof fe},fe.prototype.equals=function(t){return this===t||t instanceof fe&&(t.canEqual(this)&&this[0]===t[0]&&this[1]===t[1])},fe.prototype.toString=function(){return"LinearRange("+this[0]+", "+this[1]+")"};var ce=function(t,e){var r=function(t){var e=r[0],n=e[0],i=e[1],o=r[1],s=o[0],u=o[1];return fe(n+t*(s-n),i+t*(u-i))};return Object.setPrototypeOf(r,ce.prototype),r[0]=t,r[1]=e,r};ce.prototype=Object.create($t.prototype);var le=function(){throw new Error};(le.prototype=Object.create(_t.prototype)).canEqual=function(t){return t instanceof le},le.prototype.equals=function(t){return this===t||t instanceof le&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},le.prototype.toString=function(){return"Scale("+this.domain+", "+this.range+")"};var de=function(){throw new Error};(de.prototype=Object.create(le.prototype)).canEqual=function(t){return t instanceof de},de.prototype.equals=function(t){return this===t||t instanceof de&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},de.prototype.toString=function(){return"ContinuousScale("+this.domain+", "+this.range+")"};var ye=function(t,e){var r=function(t){return r.range(r.domain(t))};return Object.setPrototypeOf(r,ye.prototype),r.domain=t,r.range=e,r};ye.prototype=Object.create(de.prototype),Object.defineProperty(ye.prototype,"inverse",{get:function(){return ye(this.range.inverse,this.domain.inverse)},enumerable:!0,configurable:!0}),ye.prototype.withDomain=function(t,e){var r;return r=1===arguments.length?t:pe(t,e),ye(r,this.range)},ye.prototype.overRange=function(t,e){var r;return r=1===arguments.length?t:fe(t,e),ye(this.domain,r)},ye.prototype.clampDomain=function(t,e,r,n,o){void 0===o&&(o=i.Epsilon);var s=this.domain[0],u=this.domain[1];void 0!==t&&void 0!==e&&Math.abs(u-s)>e-t?s<u?(s=t,u=e):(u=t,s=e):(void 0!==t&&(s<u&&s<t?(u+=t-s,s=t):u<s&&u<t&&(s+=t-u,u=t)),void 0!==e&&(s<u&&u>e?(s-=u-e,u=e):u<s&&s>e&&(u-=s-e,s=e)));var a=this(s),p=this(u),h=a<p?p-a:a-p,f=Math.abs(h/(u-s));if(void 0!==r&&f<1/r)s=((l=s+u)-(c=h*r))/2,u=(l+c)/2;else if(void 0!==n&&f>1/n){var c,l;s=((l=s+u)-(c=h*n))/2,u=(l+c)/2}return Math.abs(s-this.domain[0])<o&&Math.abs(u-this.domain[1])<o?this:ye(pe(s,u),this.range)},ye.prototype.solveDomain=function(t,e,r,n,o,s){void 0===s&&(s=i.Epsilon);var u,a=this.domain[1]-this.domain[0],p=this.range[0],h=this.range[1];void 0===r||void 0===n||Math.abs(r-t)<s||Math.abs(n-e)<s?u=(h-p)/(0!==a?a:s):(u=(n-e)/(r-t),void 0!==o&&o||u<0==(h-p)/a<0||(u=-u));var f=e-u*t,c=(p-f)/u,l=(h-f)/u;return Math.abs(c-this.domain[0])<s&&Math.abs(l-this.domain[1])<s?this:ye(pe(c,l),this.range)},ye.prototype.interpolateTo=function(t){return t instanceof ye?ve(this,t):null},ye.prototype.canEqual=function(t){return t instanceof ye},ye.prototype.equals=function(t){return this===t||t instanceof ye&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},ye.prototype.toString=function(){return"LinearScale("+this.domain+", "+this.range+")"};var ve=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.domain,o=i[0],s=i[1],u=n.domain,a=u[0],p=u[1],h=pe(o+t*(a-o),s+t*(p-s)),f=e.range,c=f[0],l=f[1],d=n.range,y=d[0],v=d[1],m=fe(c+t*(y-c),l+t*(v-l));return ye(h,m)};return Object.setPrototypeOf(r,ve.prototype),r[0]=t,r[1]=e,r};ve.prototype=Object.create($t.prototype);var me=function(t){function e(e){var r=t.call(this)||this;return r.cursor=e,r}return P(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){return this.cursor.head()[0]},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,r=t.done;return{value:e&&e[0],done:r}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.previous(),e=t.value,r=t.done;return{value:e&&e[0],done:r}},e.prototype.delete=function(){this.cursor.delete()},e}(M),we=function(t){function e(e){var r=t.call(this)||this;return r.cursor=e,r}return P(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){return this.cursor.head()[1]},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,r=t.done;return{value:e&&e[1],done:r}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.previous(),e=t.value,r=t.done;return{value:e&&e[1],done:r}},e.prototype.delete=function(){this.cursor.delete()},e}(M),ge=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.pages=e,o.index=r,o.childIndex=n,o.childCursor=i,o}return P(e,t),e.prototype.isEmpty=function(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return!1;this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,!0;this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},e.prototype.head=function(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return this.childCursor.head();this.childCursor=null}else{if(!(this.childIndex<this.pages.length))throw this.childIndex=this.pages.length,new Error("empty");this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},e.prototype.step=function(){for(;;)if(null!==this.childCursor){if(!this.childCursor.isEmpty())return void(this.index+=1);this.childCursor=null}else{if(!(this.childIndex<this.pages.length))throw this.childIndex=this.pages.length,new Error("empty");this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},e.prototype.skip=function(t){for(;t>0;)if(null!==this.childCursor)this.childCursor.hasNext()?(this.index+=1,t-=1,this.childCursor.next()):this.childCursor=null;else{if(!(this.childIndex<this.pages.length))break;var e=this.pages[this.childIndex],r=this.pageSize(e);if(this.childIndex+=1,r<t){this.childCursor=this.pageCursor(e),t>0&&(this.index+=t,this.childCursor.skip(t),t=0);break}this.index+=r,t-=r}},e.prototype.hasNext=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasNext())return!0;this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,!1;this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},e.prototype.nextIndex=function(){return this.index},e.prototype.next=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasNext())return this.index+=1,this.childCursor.next();this.childCursor=null}else{if(!(this.childIndex<this.pages.length))return this.childIndex=this.pages.length,{done:!0};this.childCursor=this.pageCursor(this.pages[this.childIndex]),this.childIndex+=1}},e.prototype.hasPrevious=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasPrevious())return!0;this.childCursor=null}else{if(!(this.childIndex>0))return this.childIndex=0,!1;this.childCursor=this.reversePageCursor(this.pages[this.childIndex-1]),this.childIndex-=1}},e.prototype.previousIndex=function(){return this.index-1},e.prototype.previous=function(){for(;;)if(null!==this.childCursor){if(this.childCursor.hasPrevious())return this.index-=1,this.childCursor.previous();this.childCursor=null}else{if(!(this.childIndex>0))return this.childIndex=0,{done:!0};this.childCursor=this.reversePageCursor(this.pages[this.childIndex-1]),this.childIndex-=1}},e.prototype.set=function(t){this.childCursor.set(t)},e.prototype.delete=function(){this.childCursor.delete()},e}(M),be=function(){function t(){this.pageSplitSize=32}return t.prototype.compare=function(t,e){return O.compare(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t}(),xe=function(t){function e(e){var r=t.call(this)||this;return void 0===e&&(e=Oe.empty()),r.root=e,r}return P(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.root.isEmpty()},e.prototype.has=function(t){return this.root.has(t,this)},e.prototype.get=function(t){return this.root.get(t,this)},e.prototype.getEntry=function(t){return this.root.getEntry(t)},e.prototype.firstKey=function(){var t=this.root.firstEntry();return void 0!==t?t[0]:void 0},e.prototype.firstValue=function(){var t=this.root.firstEntry();return void 0!==t?t[1]:void 0},e.prototype.firstEntry=function(){return this.root.firstEntry()},e.prototype.lastKey=function(){var t=this.root.lastEntry();return void 0!==t?t[0]:void 0},e.prototype.lastValue=function(){var t=this.root.lastEntry();return void 0!==t?t[1]:void 0},e.prototype.lastEntry=function(){return this.root.lastEntry()},e.prototype.nextKey=function(t){var e=this.root.nextEntry(t,this);return void 0!==e?e[0]:void 0},e.prototype.nextValue=function(t){var e=this.root.nextEntry(t,this);return void 0!==e?e[1]:void 0},e.prototype.nextEntry=function(t){return this.root.nextEntry(t,this)},e.prototype.previousKey=function(t){var e=this.root.previousEntry(t,this);return void 0!==e?e[0]:void 0},e.prototype.previousValue=function(t){var e=this.root.previousEntry(t,this);return void 0!==e?e[1]:void 0},e.prototype.previousEntry=function(t){return this.root.previousEntry(t,this)},e.prototype.set=function(t,e){var r=this.root,n=this.root.updated(t,e,this);return r!==n&&(n.size>r.size&&(n=n.balanced(this)),this.root=n),this},e.prototype.delete=function(t){var e=this.root,r=this.root.removed(t,this);return e!==r&&(this.root=r,!0)},e.prototype.drop=function(t){return t>0&&this.root.size>0&&(t<this.root.size?this.root=this.root.drop(t,this):this.root=Oe.empty()),this},e.prototype.take=function(t){return t<this.root.size&&this.root.size>0&&(this.root=t>0?this.root.take(t,this):Oe.empty()),this},e.prototype.clear=function(){this.root=Oe.empty()},e.prototype.updated=function(t,e){var r=this.root,n=r.updated(t,e,this);return r!==n?(n.size>r.size&&(n=n.balanced(this)),this.copy(n)):this},e.prototype.removed=function(t){var e=this.root,r=e.removed(t,this);return e!==r?this.copy(r):this},e.prototype.cleared=function(){return this.root.isEmpty()?this:this.copy(Oe.empty())},e.prototype.reduced=function(t,e,r){var n=this.root,i=n.reduced(t,e,r);return n!==i&&(this.root=i),i.fold},e.prototype.forEach=function(t,e){return this.root.forEach(t,e)},e.prototype.forEachKey=function(t,e){return this.root.forEachKey(t,e)},e.prototype.forEachValue=function(t,e){return this.root.forEachValue(t,e)},e.prototype.keys=function(){return this.root.keys()},e.prototype.values=function(){return this.root.values()},e.prototype.entries=function(){return this.root.entries()},e.prototype.reverseKeys=function(){return this.root.reverseKeys()},e.prototype.reverseValues=function(){return this.root.reverseValues()},e.prototype.reverseEntries=function(){return this.root.reverseEntries()},e.prototype.clone=function(){return this.copy(this.root)},e.prototype.copy=function(t){var r=new e(t);return r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},e}(be),Oe=function(){function t(){}return t.prototype.keys=function(){return new me(this.entries())},t.prototype.values=function(){return new we(this.entries())},t.prototype.reverseKeys=function(){return new me(this.reverseEntries())},t.prototype.reverseValues=function(){return new we(this.reverseEntries())},t.empty=function(){return new Ce([],void 0)},S([e],t,"empty",null),t}(),Ce=function(t){function e(e,r){var n=t.call(this)||this;return n.slots=e,n.fold=r,n}return P(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.slots.length},e.prototype.minKey=function(){return this.slots[0][0]},e.prototype.maxKey=function(){return this.slots[this.slots.length-1][0]},e.prototype.has=function(t,e){return this.lookup(t,e)>=0},e.prototype.get=function(t,e){var r=this.lookup(t,e);return r>=0?this.slots[r][1]:void 0},e.prototype.getEntry=function(t){return this.slots[t]},e.prototype.firstEntry=function(){var t=this.slots;return 0!==t.length?t[0]:void 0},e.prototype.lastEntry=function(){var t=this.slots;return 0!==t.length?t[t.length-1]:void 0},e.prototype.nextEntry=function(t,e){var r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this.slots[r]},e.prototype.previousEntry=function(t,e){var r=this.lookup(t,e);return r>=0?r-=1:r=-(r+2),this.slots[r]},e.prototype.updated=function(t,e,r){var n=this.lookup(t,r);return n>=0?this.updatedSlot(n,t,e):(n=-(n+1),this.insertedSlot(n,t,e))},e.prototype.updatedSlot=function(t,r,n){var i=this.slots;if(n!==i[t][1]){var o=i.slice(0);return o[t]=[r,n],new e(o,void 0)}return this},e.prototype.insertedSlot=function(t,r,n){for(var i=this.slots,o=i.length+1,s=new Array(o),u=0;u<t;u+=1)s[u]=i[u];s[t]=[r,n];for(u=t;u<o-1;u+=1)s[u+1]=i[u];return new e(s,void 0)},e.prototype.removed=function(t,e){var r=this.lookup(t,e);return r>=0?this.slots.length>1?this.removedSlot(r):Oe.empty():this},e.prototype.removedSlot=function(t){for(var r=this.slots,n=new Array(r.length-1),i=0;i<t;i+=1)n[i]=r[i];for(i=t;i<n.length;i+=1)n[i]=r[i+1];return new e(n,void 0)},e.prototype.drop=function(t,r){if(t>0){var n=this.slots;if(t<n.length){for(var i=n.length-t,o=new Array(i),s=0;s<i;s+=1)o[s]=n[s+t];return new e(o,void 0)}return Oe.empty()}return this},e.prototype.take=function(t,r){var n=this.slots;if(t<n.length){if(t>0){for(var i=new Array(t),o=0;o<t;o+=1)i[o]=n[o];return new e(i,void 0)}return Oe.empty()}return this},e.prototype.balanced=function(t){var e=this.slots.length;if(e>1&&t.pageShouldSplit(this)){var r=e>>>1;return this.split(r)}return this},e.prototype.split=function(t){var e=new Array(2),r=this.splitLeft(t),n=this.splitRight(t);e[0]=r,e[1]=n;var i=new Array(1);return i[0]=n.minKey(),new Ee(e,i,void 0,this.slots.length)},e.prototype.splitLeft=function(t){for(var r=this.slots,n=new Array(t),i=0;i<t;i+=1)n[i]=r[i];return new e(n,void 0)},e.prototype.splitRight=function(t){for(var r=this.slots,n=r.length-t,i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+t];return new e(i,void 0)},e.prototype.reduced=function(t,r,n){if(void 0===this.fold){for(var i=this.slots,o=t,s=0,u=i.length;s<u;s+=1)o=r(o,i[s][1]);return new e(i,o)}return this},e.prototype.forEach=function(t,e){for(var r=this.slots,n=0,i=r.length;n<i;n+=1){var o=r[n],s=t.call(e,o[0],o[1]);if(void 0!==s)return s}},e.prototype.forEachKey=function(t,e){for(var r=this.slots,n=0,i=r.length;n<i;n+=1){var o=r[n],s=t.call(e,o[0]);if(void 0!==s)return s}},e.prototype.forEachValue=function(t,e){for(var r=this.slots,n=0,i=r.length;n<i;n+=1){var o=r[n],s=t.call(e,o[1]);if(void 0!==s)return s}},e.prototype.entries=function(){return M.array(this.slots)},e.prototype.reverseEntries=function(){return M.array(this.slots,this.slots.length)},e.prototype.lookup=function(t,e){for(var r=0,n=this.slots.length-1;r<=n;){var i=r+n>>>1,o=e.compare(t,this.slots[i][0]);if(o>0)r=i+1;else{if(!(o<0))return i;n=i-1}}return-(r+1)},e}(Oe),Ee=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.pages=e,o.knots=r,o.fold=n,o.size=i,o}return P(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.pages.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.size},e.prototype.minKey=function(){return this.pages[0].minKey()},e.prototype.maxKey=function(){return this.pages[this.pages.length-1].maxKey()},e.prototype.has=function(t,e){var r=this.lookup(t,e);if(r>0)r+=1;else{if(!(r<0))return!0;r=-(r+1)}return this.pages[r].has(t,e)},e.prototype.get=function(t,e){var r=this.lookup(t,e);return r>=0?r+=1:r=-(r+1),this.pages[r].get(t,e)},e.prototype.getEntry=function(t){for(var e=this.pages,r=0,n=e.length;r<n;r+=1){var i=e[r];if(t<i.size)return i.getEntry(t);t-=i.size}},e.prototype.firstEntry=function(){var t=this.pages;return 0!==t.length?t[0].firstEntry():void 0},e.prototype.lastEntry=function(){var t=this.pages;return 0!==t.length?t[t.length-1].lastEntry():void 0},e.prototype.nextEntry=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var n=this.pages,i=n[r].nextEntry(t,e);return void 0===i&&r+1<n.length&&(i=n[r+1].nextEntry(t,e)),i},e.prototype.previousEntry=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var n=this.pages,i=n[r].previousEntry(t,e);return void 0===i&&r>0&&(i=n[r-1].previousEntry(t,e)),i},e.prototype.updated=function(t,e,r){var n=this.lookup(t,r);n>=0?n+=1:n=-(n+1);var i=this.pages[n],o=i.updated(t,e,r);return i!==o?i.size!==o.size&&r.pageShouldSplit(o)?this.updatedPageSplit(n,o,i):this.updatedPage(n,o,i):this},e.prototype.updatedPage=function(t,r,n){var i=this.pages.slice(0);i[t]=r;var o,s=this.knots;return s.length>0?(o=s.slice(0),t>0&&(o[t-1]=r.minKey())):o=[],new e(i,o,void 0,this.size-n.size+r.size)},e.prototype.updatedPageSplit=function(t,r,n){for(var i=this.pages,o=new Array(i.length+1),s=0;s<t;s+=1)o[s]=i[s];var u=r.splitLeft(r.arity>>>1),a=r.splitRight(r.arity>>>1);o[t]=u,o[t+1]=a;for(s=t+1;s<i.length;s+=1)o[s+1]=i[s];var p=this.knots,h=new Array(i.length);if(t>0){for(s=0;s<t-1;s+=1)h[s]=p[s];h[t-1]=u.minKey(),h[t]=a.minKey();for(s=t;s<p.length;s+=1)h[s+1]=p[s]}else{h[0]=a.minKey();for(s=0;s<p.length;s+=1)h[s+1]=p[s]}return new e(o,h,void 0,this.size-n.size+r.size)},e.prototype.updatedPageMerge=function(t,r,n){for(var i=this.pages,o=r.pages,s=new Array(i.length+o.length-1),u=0;u<t;u+=1)s[u]=i[u];for(u=0;u<o.length;u+=1)s[u+t]=o[u];for(u=t+1;u<i.length;u+=1)s[u+o.length-1]=i[u];var a=this.knots,p=r.knots,h=new Array(s.length-1);if(t>0){for(u=0;u<t-1;u+=1)h[u]=a[u];h[t-1]=o[0].minKey();for(u=0;u<p.length;u+=1)h[u+t]=p[u];for(u=t;u<a.length;u+=1)h[u+p.length]=a[u]}else{for(u=0;u<p.length;u+=1)h[u]=p[u];h[p.length]=i[1].minKey();for(u=1;u<a.length;u+=1)h[u+p.length]=a[u]}return new e(s,h,void 0,this.size-n.size+r.size)},e.prototype.removed=function(t,e){var r=this.lookup(t,e);r>=0?r+=1:r=-(r+1);var n=this.pages[r],i=n.removed(t,e);return n!==i?this.replacedPage(r,i,n,e):this},e.prototype.replacedPage=function(t,r,n,i){return r.isEmpty()?this.pages.length>2?this.removedPage(t,r,n):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:Oe.empty():r instanceof e&&i.pageShouldMerge(r)?this.updatedPageMerge(t,r,n):this.updatedPage(t,r,n)},e.prototype.removedPage=function(t,r,n){for(var i=this.pages,o=new Array(i.length-1),s=0;s<t;s+=1)o[s]=i[s];for(s=t+1;s<i.length;s+=1)o[s-1]=i[s];var u=this.knots,a=new Array(u.length-1);if(t>0){for(s=0;s<t-1;s+=1)a[s]=u[s];for(s=t;s<u.length;s+=1)a[s-1]=u[s]}else for(s=1;s<u.length;s+=1)a[s-1]=u[s];return new e(o,a,void 0,this.size-n.size)},e.prototype.drop=function(t,r){if(t>0){var n=this.size;if(t<n){for(var i=this.pages,o=0;o<i.length;){var s=i[o].size;if(!(s<=t))break;n-=s,t-=s,o+=1}var u=i.length-o;if(u>1){var a=void 0;if(o>0){for(var p=new Array(u),h=0;h<u;h+=1)p[h]=i[h+o];var f=new Array(u-1);for(h=0;h<f.length;h+=1)f[h]=this.knots[h+o];a=new e(p,f,void 0,n)}else a=this;if(t>0){var c=i[o],l=c.drop(t,r);return a.replacedPage(0,l,c,r)}return a}return i[o].drop(t,r)}return Oe.empty()}return this},e.prototype.take=function(t,r){if(t<this.size){if(t>0){for(var n=this.pages,i=0,o=0;i<n.length&&t>0;){var s=n[i].size;if(o+=s,i+=1,!(s<=t))break;t-=s}var u=0===t?i:i+1;if(u>1){var a=void 0;if(i<n.length){for(var p=new Array(u),h=0;h<u;h+=1)p[h]=n[h];var f=new Array(u-1);for(h=0;h<f.length;h+=1)f[h]=this.knots[h];a=new e(p,f,void 0,o)}else a=this;if(t>0){var c=n[i-1],l=c.take(t,r);return a.replacedPage(i-1,l,c,r)}return a}return t>0?n[0].take(t,r):n[0]}return Oe.empty()}return this},e.prototype.balanced=function(t){if(this.pages.length>1&&t.pageShouldSplit(this)){var e=this.knots.length>>>1;return this.split(e)}return this},e.prototype.split=function(t){var r=new Array(2),n=this.splitLeft(t),i=this.splitRight(t);r[0]=n,r[1]=i;var o=new Array(1);return o[0]=i.minKey(),new e(r,o,void 0,this.size)},e.prototype.splitLeft=function(t){for(var r=this.pages,n=new Array(t+1),i=0;i<t+1;i+=1)n[i]=r[i];var o=this.knots,s=new Array(t);for(i=0;i<t;i+=1)s[i]=o[i];var u=0;for(i=0;i<=t;i+=1)u+=n[i].size;return new e(n,s,void 0,u)},e.prototype.splitRight=function(t){for(var r=this.pages,n=r.length-(t+1),i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+(t+1)];var s=this.knots,u=new Array(n-1);for(o=0;o<u.length;o+=1)u[o]=s[o+(t+1)];var a=0;for(o=0;o<n;o+=1)a+=i[o].size;return new e(i,u,void 0,a)},e.prototype.reduced=function(t,r,n){if(void 0===this.fold){for(var i=this.pages,o=i.length,s=new Array(o),u=0;u<o;u+=1)s[u]=i[u].reduced(t,r,n);var a=s[0].fold;for(u=1;u<o;u+=1)a=n(a,s[u].fold);return new e(s,this.knots,a,this.size)}return this},e.prototype.forEach=function(t,e){for(var r=this.pages,n=0,i=r.length;n<i;n+=1){var o=r[n].forEach(t,e);if(void 0!==o)return o}},e.prototype.forEachKey=function(t,e){for(var r=this.pages,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachKey(t,e);if(void 0!==o)return o}},e.prototype.forEachValue=function(t,e){for(var r=this.pages,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachValue(t,e);if(void 0!==o)return o}},e.prototype.entries=function(){return new Pe(this.pages)},e.prototype.reverseEntries=function(){return new Pe(this.pages,this.size,this.pages.length)},e.prototype.lookup=function(t,e){for(var r=0,n=this.knots.length-1;r<=n;){var i=r+n>>>1,o=e.compare(t,this.knots[i]);if(o>0)r=i+1;else{if(!(o<0))return i;n=i-1}}return-(r+1)},e}(Oe),Pe=function(t){function e(e,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=null),t.call(this,e,r,n,i)||this}return P(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(ge),Se=function(){function t(){this.pageSplitSize=32}return t.prototype.identify=function(t){var e=new Uint8Array(6);return a.fillBytes(e),e},t.prototype.compare=function(t,e){return O.compare(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t}(),ke=function(t){function e(e){var r=t.call(this)||this;return void 0===e&&(e=Me.empty()),r.root=e,r}return P(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.root.isEmpty()},e.prototype.get=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.get(t)},e.prototype.getEntry=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.getEntry(t)},e.prototype.set=function(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);var n=this.root;if(t<0||t>=n.size)throw new RangeError(""+t);return this.root=n.updated(t,e,this),this},e.prototype.insert=function(t,e,r){var n=this.root;if(t<0||t>n.size)throw new RangeError(""+t);return this.root=n.inserted(t,e,r,this).balanced(this),this},e.prototype.remove=function(t,e){if(void 0!==e&&(t=this.lookup(e,t))<0)throw new RangeError(""+e);var r=this.root;if(t<0||t>r.size)throw new RangeError(""+t);return this.root=r.removed(t,this),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.root,n=0;n<t.length;n+=1)r=r.inserted(r.size,t[n],void 0,this).balanced(this);return this.root=r,r.size},e.prototype.pop=function(){var t=this.root,e=t.size-1;if(e>=0){var r=t.get(e);return this.root=t.removed(e,this),r}},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.root,n=t.length-1;n>=0;n-=1)r=r.inserted(0,t[n],void 0,this).balanced(this);return this.root=r,r.size},e.prototype.shift=function(){var t=this.root;if(t.size>0){var e=t.get(0);return this.root=t.removed(0,this),e}},e.prototype.move=function(t,e,r){if(void 0!==r&&(t=this.lookup(r,t))<0)throw new RangeError(""+r);var n=this.root;if(t<0||t>=n.size)throw new RangeError(""+t);if(e<0||e>=n.size)throw new RangeError(""+e);if(t!==e){var i=n.getEntry(t);this.root=n.removed(t,this).inserted(e,i[1],i[0],this).balanced(this)}return this},e.prototype.splice=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=this.root;t<0&&(t=i.size+t),t=Math.min(Math.max(0,t),i.size),void 0===e&&(e=i.size-t);for(var o=[],s=t,u=t+e;s<u;s+=1)o.push(i.get(t)),i=i.removed(t,this);for(s=0;s<r.length;s+=1)i=i.inserted(t+s,r[s],void 0,this).balanced(this);return this.root=i,o},e.prototype.drop=function(t){var e=this.root;return t>0&&e.size>0&&(t<e.size?this.root=e.drop(t,this):this.root=Me.empty()),this},e.prototype.take=function(t){var e=this.root;return t<e.size&&e.size>0&&(this.root=t>0?e.take(t,this):Me.empty()),this},e.prototype.clear=function(){this.root=Me.empty()},e.prototype.forEach=function(t,e){return this.root.forEach(t,e,0)},e.prototype.keys=function(){return this.root.keys()},e.prototype.values=function(){return this.root.values()},e.prototype.entries=function(){return this.root.entries()},e.prototype.reverseKeys=function(){return this.root.reverseKeys()},e.prototype.reverseValues=function(){return this.root.reverseValues()},e.prototype.reverseEntries=function(){return this.root.reverseEntries()},e.prototype.clone=function(){return this.copy(this.root)},e.prototype.copy=function(t){var r=new e(t);return r.identify!==this.identify&&(r.identify=this.identify),r.compare!==this.compare&&(r.compare=this.compare),r.pageSplitSize!==this.pageSplitSize&&(r.pageSplitSize=this.pageSplitSize),r},e.prototype.lookup=function(t,e){void 0===e&&(e=0);var r=this.root,n=e=Math.min(Math.max(0,e),r.size-1);do{var i=r.getEntry(n);if(void 0!==i&&0===this.compare(i[0],t))return n;n=(n+1)%r.size}while(isFinite(n)&&n!==e);return-1},e}(Se),Me=function(){function t(){}return t.prototype.keys=function(){return new me(this.entries())},t.prototype.values=function(){return new we(this.entries())},t.prototype.reverseKeys=function(){return new me(this.reverseEntries())},t.prototype.reverseValues=function(){return new we(this.reverseEntries())},t.empty=function(){return new Ae([])},S([e],t,"empty",null),t}(),Ae=function(t){function e(e){var r=t.call(this)||this;return r.slots=e,r}return P(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.slots.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.slots.length},e.prototype.get=function(t){var e=this.slots[t];return void 0!==e?e[1]:void 0},e.prototype.getEntry=function(t){return this.slots[t]},e.prototype.updated=function(t,e,r){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.updatedItem(t,e)},e.prototype.updatedItem=function(t,r){var n=this.slots,i=n[t];if(void 0!==i&&r!==i[1]){var o=n.slice(0);return o[t]=[i[0],r],new e(o)}return this},e.prototype.inserted=function(t,e,r,n){if(t<0||t>this.slots.length)throw new RangeError(""+t);return this.insertedItem(t,e,r,n)},e.prototype.insertedItem=function(t,r,n,i){void 0===n&&(n=i.identify(r));for(var o=this.slots,s=new Array(o.length+1),u=0;u<t;u+=1)s[u]=o[u];s[t]=[n,r];for(u=t;u<o.length;u+=1)s[u+1]=o[u];return new e(s)},e.prototype.removed=function(t,e){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.slots.length>1?this.removedSlot(t):Me.empty()},e.prototype.removedSlot=function(t){for(var r=this.slots,n=new Array(r.length-1),i=0;i<t;i+=1)n[i]=r[i];for(i=t;i<n.length;i+=1)n[i]=r[i+1];return new e(n)},e.prototype.drop=function(t,r){var n=this.slots;if(t>0&&n.length>0){if(t<n.length){for(var i=n.length-t,o=new Array(i),s=0;s<i;s+=1)o[s]=n[s+t];return new e(o)}return Me.empty()}return this},e.prototype.take=function(t,r){var n=this.slots;if(t<n.length&&n.length>0){if(t>0){for(var i=new Array(t),o=0;o<t;o+=1)i[o]=n[o];return new e(i)}return Me.empty()}return this},e.prototype.balanced=function(t){var e=this.slots.length;return e>1&&t.pageShouldSplit(this)?this.split(e>>>1):this},e.prototype.split=function(t){var e=new Array(2),r=this.splitLeft(t),n=this.splitRight(t);e[0]=r,e[1]=n;var i=new Array(1);return i[0]=t,new De(e,i,this.slots.length)},e.prototype.splitLeft=function(t){for(var r=this.slots,n=new Array(t),i=0;i<t;i+=1)n[i]=r[i];return new e(n)},e.prototype.splitRight=function(t){for(var r=this.slots,n=r.length-t,i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+t];return new e(i)},e.prototype.forEach=function(t,e,r){for(var n=0;n<this.slots.length;n+=1){var i=this.slots[n],o=t.call(e,i[1],r+n,i[0]);if(void 0!==o)return o}},e.prototype.entries=function(){return M.array(this.slots)},e.prototype.reverseEntries=function(){return M.array(this.slots,this.slots.length)},e}(Me),De=function(t){function e(e,r,n){var i=t.call(this)||this;return i.pages=e,i.knots=r,i.size=n,i}return P(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.pages.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.size},e.prototype.get=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var r=0===e?t:t-this.knots[e-1];return this.pages[e].get(r)},e.prototype.getEntry=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var r=0===e?t:t-this.knots[e-1];return this.pages[e].getEntry(r)},e.prototype.updated=function(t,e,r){var n=this.lookup(t);n>=0?n+=1:n=-(n+1);var i=0===n?t:t-this.knots[n-1],o=this.pages[n],s=o.updated(i,e,r);return o!==s?o.size!==s.size&&r.pageShouldSplit(s)?this.updatedPageSplit(n,s,o):this.updatedPage(n,s,o):this},e.prototype.updatedPage=function(t,r,n){var i=this.pages,o=i.slice(0);o[t]=r;var s,u,a=this.knots;if(i.length-1>0){s=a.slice(0),u=t>0?a[t-1]:0;for(var p=t;p<s.length;p+=1)u+=o[p].size,s[p]=u;u+=o[s.length].size}else s=[],u=0;return new e(o,s,u)},e.prototype.updatedPageSplit=function(t,r,n){for(var i=this.pages,o=new Array(i.length+1),s=0;s<t;s+=1)o[s]=i[s];var u=r.splitLeft(r.arity>>>1),a=r.splitRight(r.arity>>>1);o[t]=u,o[t+1]=a;for(s=t+1;s<i.length;s+=1)o[s+1]=i[s];return e.create(o)},e.prototype.updatedPageMerge=function(t,r,n){for(var i=this.pages,o=r.pages,s=new Array(i.length+o.length-1),u=0;u<t;u+=1)s[u]=i[u];for(u=0;u<o.length;u+=1)s[u+t]=o[u];for(u=t+1;u<i.length;u+=1)s[u+o.length-1]=i[u];return e.create(s)},e.prototype.inserted=function(t,e,r,n){var i=this.lookup(t);i>=0?i+=1:i=-(i+1);var o=0===i?t:t-this.knots[i-1],s=this.pages[i],u=s.inserted(o,e,r,n);return s!==u?n.pageShouldSplit(u)?this.updatedPageSplit(i,u,s):this.updatedPage(i,u,s):this},e.prototype.removed=function(t,e){var r=this.lookup(t);r>=0?r+=1:r=-(r+1);var n=0===r?t:t-this.knots[r-1],i=this.pages[r],o=i.removed(n,e);return i!==o?this.replacedPage(r,o,i,e):this},e.prototype.replacedPage=function(t,r,n,i){return r.isEmpty()?this.pages.length>2?this.removedPage(t,r,n):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:Me.empty():r instanceof e&&i.pageShouldMerge(r)?this.updatedPageMerge(t,r,n):this.updatedPage(t,r,n)},e.prototype.removedPage=function(t,r,n){for(var i=this.pages,o=new Array(i.length-1),s=0;s<t;s+=1)o[s]=i[s];for(s=t+1;s<i.length;s+=1)o[s-1]=i[s];var u,a=this.knots,p=new Array(a.length-1);if(t>0){for(s=0;s<t;s+=1)p[s]=a[s];u=a[t-1]}else u=0;for(s=t;s<p.length;s+=1)u+=o[s].size,p[s]=u;return new e(o,p,u+=o[p.length].size)},e.prototype.drop=function(t,r){if(t>0){if(t<this.size){var n=this.lookup(t);n>=0?n+=1:n=-(n+1),t=0===n?t:t-this.knots[n-1];var i=this.pages,o=i.length-n;if(o>1){var s=void 0;if(n>0){for(var u=new Array(o),a=0;a<o;a+=1)u[a]=i[a+n];s=e.create(u)}else s=this;if(t>0){var p=i[n],h=p.drop(t,r);return s.replacedPage(0,h,p,r)}return s}return i[n].drop(t,r)}return Me.empty()}return this},e.prototype.take=function(t,r){if(t<this.size){if(t>0){var n=this.lookup(t);n>=0?n+=1:n=-(n+1),t=0===n?t:t-this.knots[n-1];var i=this.pages,o=0===t?n:n+1;if(o>1){var s=void 0;if(n<i.length){for(var u=new Array(o),a=0;a<o;a+=1)u[a]=i[a];var p=new Array(o-1);for(a=0;a<p.length;a+=1)p[a]=this.knots[a];s=new e(u,p,p[o-2]+u[o-1].size)}else s=this;if(t>0){var h=i[n],f=h.take(t,r);return s.replacedPage(n,f,h,r)}return s}return t>0?i[0].take(t,r):i[0]}return Me.empty()}return this},e.prototype.balanced=function(t){if(this.pages.length>1&&t.pageShouldSplit(this)){var e=this.knots.length>>>1;return this.split(e)}return this},e.prototype.split=function(t){var r=new Array(2),n=this.splitLeft(t),i=this.splitRight(t);r[0]=n,r[1]=i;var o=new Array(1);return o[0]=n.size,new e(r,o,this.size)},e.prototype.splitLeft=function(t){for(var r=this.pages,n=new Array(t+1),i=0;i<t+1;i+=1)n[i]=r[i];var o=this.knots,s=new Array(t);for(i=0;i<t;i+=1)s[i]=o[i];var u=0;for(i=0;i<=t;i+=1)u+=n[i].size;return new e(n,s,u)},e.prototype.splitRight=function(t){for(var r=this.pages,n=r.length-(t+1),i=new Array(n),o=0;o<n;o+=1)i[o]=r[o+(t+1)];var s,u=new Array(n-1);if(n>0){s=i[0].size;for(o=1;o<n;o+=1)u[o-1]=s,s+=i[o].size}else s=0;return new e(i,u,s)},e.prototype.forEach=function(t,e,r){for(var n=0;n<this.pages.length;n+=1){var i=this.pages[n],o=i.forEach(t,e,r);if(void 0!==o)return o;r+=i.size}},e.prototype.entries=function(){return new Ie(this.pages)},e.prototype.reverseEntries=function(){return new Ie(this.pages,this.size,this.pages.length)},e.prototype.lookup=function(t){for(var e=0,r=this.knots.length-1;e<=r;){var n=e+r>>>1;if(t>this.knots[n])e=n+1;else{if(!(t<this.knots[n]))return n;r=n-1}}return-(e+1)},e.create=function(t){for(var r=new Array(t.length-1),n=0,i=0,o=r.length;i<o;i+=1)n+=t[i].size,r[i]=n;return new e(t,r,n+=t[r.length].size)},e}(Me),Ie=function(t){function e(e,r,n,i){return void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=null),t.call(this,e,r,n,i)||this}return P(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(ge),Te={idCount:0,nextId:function(){var t=Te.idCount+1;return Te.idCount=t,t}},Ve=function(){function t(t,e){this.index=void 0!==t?t:{},this.array=void 0!==e?e:[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.array.length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.array.length},t.prototype.has=function(t){return void 0!==this.index[t.id]},t.prototype.get=function(t){var e=this.index[t.id];return void 0!==e?this.array[e][1]:void 0},t.prototype.getField=function(t){var e=this.index[t.id];return void 0!==e?this.array[e]:void 0},t.prototype.getEntry=function(t){return this.array[t]},t.prototype.set=function(t,e){var r=this.index[t.id];if(void 0!==r){var n=this.array[r],i=n[1];return n[1]=e,i}return this.index[t.id]=this.array.length,void this.array.push([t,e])},t.prototype.delete=function(t){var e=this.index[t.id];if(void 0!==e){delete this.index[t.id];var r=this.array[e],n=this.array.pop();return r!==n&&(this.array[e]=n,this.index[n[0].id]=e),!0}return!1},t.prototype.remove=function(t){var e=this.index[t.id];if(void 0!==e){delete this.index[t.id];var r=this.array[e],n=this.array.pop();return r!==n&&(this.array[e]=n,this.index[n[0].id]=e),r[1]}},t.prototype.clear=function(){this.index={},this.array.length=0},t.prototype.forEach=function(t,e){for(var r=this.array,n=0,i=r.length;n<i;n+=1){var o=r[n],s=t.call(e,o[0],o[1]);if(void 0!==s)return s}},t.prototype.clone=function(){for(var e=this.array,r=e.length,n={},i=new Array(r),o=0;o<r;o+=1){var s=e[o],u=s[0],a=s[1];i[o]=[u,a],n[u.id]=o}return new t(n,i)},t}(),je={},qe=function(){function t(){this.id=Te.nextId()}return t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!1},t.prototype.isInvalid=function(){return!1},t.prototype.addConstraintCondition=function(t,e){},t.prototype.removeConstraintCondition=function(t,e){},t.prototype.updateConstraintSolution=function(t){},t}(),Re=function(){function t(){this.id=Te.nextId()}return t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!0},t.prototype.isInvalid=function(){return!1},t.prototype.addConstraintCondition=function(t,e){},t.prototype.removeConstraintCondition=function(t,e){},t.prototype.updateConstraintSolution=function(t){},t}(),Ue=function(){function t(){this.id=Te.nextId()}return t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!1},t.prototype.isInvalid=function(){return!1},t.prototype.addConstraintCondition=function(t,e){},t.prototype.removeConstraintCondition=function(t,e){},t.prototype.updateConstraintSolution=function(t){},t}(),Ne=function(){function t(){}return Object.defineProperty(t.prototype,"id",{get:function(){return-1},enumerable:!1,configurable:!0}),t.prototype.isExternal=function(){return!1},t.prototype.isDummy=function(){return!1},t.prototype.isInvalid=function(){return!0},t.prototype.addConstraintCondition=function(t,e){},t.prototype.removeConstraintCondition=function(t,e){},t.prototype.updateConstraintSolution=function(t){},t}();je.invalid=new Ne;var ze={fromAny:function(t){return"number"==typeof t?ze.constant(t):t},sum:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=new Ve,n=0,i=0,o=t.length;i<o;i+=1){var s=t[i];if("number"==typeof s)n+=s;else if(Le.is(s)){if(null!==(c=s.variable))void 0!==(h=r.getField(c))?h[1]+=s.coefficient:r.set(c,s.coefficient);else n+=s.constant}else{for(var u=s.terms,a=0,p=u.size;a<p;a+=1){var h,f=u.getEntry(a),c=f[0],l=f[1];void 0!==(h=r.getField(c))?h[1]+=l:r.set(c,l)}n+=s.constant}}return new Fe(r,n)},product:function(t,e){return new Ke(t,e)},constant:function(t){return 0===t?ze.zero:new Be(t)}},Fe=function(){function t(t,e){this.terms=t,this.constant=e}return t.prototype.isConstant=function(){return this.terms.isEmpty()},t.prototype.plus=function(t){return ze.sum(this,t)},t.prototype.negative=function(){for(var e=this.terms,r=new Ve,n=0,i=e.size;n<i;n+=1){var o=e.getEntry(n),s=o[0],u=o[1];r.set(s,-u)}return new t(r,-this.constant)},t.prototype.minus=function(t){return t="number"==typeof t?ze.constant(t):t.negative(),ze.sum(this,t)},t.prototype.times=function(e){for(var r=this.terms,n=new Ve,i=0,o=r.size;i<o;i+=1){var s=r.getEntry(i),u=s[0],a=s[1];n.set(u,a*e)}return new t(n,this.constant*e)},t.prototype.divide=function(e){for(var r=this.terms,n=new Ve,i=0,o=r.size;i<o;i+=1){var s=r.getEntry(i),u=s[0],a=s[1];n.set(u,a/e)}return new t(n,this.constant/e)},t.prototype.debug=function(t){t=t.write("ConstraintExpression").write(46).write("sum").write(40);for(var e=this.terms.size,r=0;r<e;r+=1){var n=this.terms.getEntry(r),i=n[0],o=n[1];r>0&&(t=t.write(", ")),t=1===o?t.debug(i):t.debug(ze.product(o,i))}return 0!==this.constant&&(e>0&&(t=t.write(", ")),t=t.debug(this.constant)),t=t.write(41)},t.prototype.toString=function(){return nt.debug(this)},t}(),Le={is:function(t){if(void 0!==typeof t&&null!==t){return"coefficient"in t&&"variable"in t}return!1}},Ke=function(){function t(t,e){this.coefficient=t,this.variable=e}return t.prototype.isConstant=function(){return!1},Object.defineProperty(t.prototype,"terms",{get:function(){var t=new Ve;return t.set(this.variable,this.coefficient),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"constant",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.plus=function(e){return(e=ze.fromAny(e))instanceof t&&this.variable===e.variable?ze.product(this.coefficient+e.coefficient,this.variable):this.variable===e?ze.product(this.coefficient+1,this.variable):ze.sum(this,e)},t.prototype.negative=function(){return ze.product(-this.coefficient,this.variable)},t.prototype.minus=function(e){return(e=ze.fromAny(e))instanceof t&&this.variable===e.variable?ze.product(this.coefficient-e.coefficient,this.variable):this.variable===e?ze.product(this.coefficient-1,this.variable):ze.sum(this,e.negative())},t.prototype.times=function(t){return ze.product(this.coefficient*t,this.variable)},t.prototype.divide=function(t){return ze.product(this.coefficient/t,this.variable)},t.prototype.debug=function(t){return t=t.write("ConstraintExpression").write(46).write("product").write(40).debug(this.coefficient).write(", ").debug(this.variable).write(41)},t.prototype.toString=function(){return nt.debug(this)},t}(),Be=function(){function t(t){this.constant=t}return t.prototype.isConstant=function(){return!0},Object.defineProperty(t.prototype,"coefficient",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"variable",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"terms",{get:function(){return new Ve},enumerable:!1,configurable:!0}),t.prototype.plus=function(e){return(e=ze.fromAny(e))instanceof t?ze.constant(this.constant+e.constant):ze.sum(this,e)},t.prototype.negative=function(){return ze.constant(-this.constant)},t.prototype.minus=function(e){return(e=ze.fromAny(e))instanceof t?ze.constant(this.constant-e.constant):ze.sum(this,e.negative())},t.prototype.times=function(t){return ze.constant(this.constant*t)},t.prototype.divide=function(t){return ze.constant(this.constant/t)},t.prototype.debug=function(t){return t=t.write("ConstraintExpression").write(46),t=0===this.constant?t.write("zero"):t.write("constant").write(40).debug(this.constant).write(41)},t.prototype.toString=function(){return nt.debug(this)},t}();ze.zero=new Be(0);var We=function(){function t(t,e,r,n){this.id=Te.nextId(),this.owner=t,this.name=e,this.state=r,this.strength=n,this.constraintFlags=0,this.conditionCount=0}return t.prototype.isExternal=function(){return!0},t.prototype.isDummy=function(){return!1},t.prototype.isInvalid=function(){return!1},t.prototype.isConstant=function(){return!1},t.prototype.setState=function(t){var e=this.state;e!==t&&(this.willSetState(t,e),this.state=t,this.onSetState(t,e),this.didSetState(t,e))},t.prototype.willSetState=function(t,e){},t.prototype.onSetState=function(t,e){this.isConstraining()&&this.owner.setConstraintVariable(this,t)},t.prototype.didSetState=function(t,e){},t.prototype.evaluateConstraintVariable=function(){},t.prototype.updateConstraintSolution=function(t){this.isConstrained()&&this.setState(t)},Object.defineProperty(t.prototype,"coefficient",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"variable",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"terms",{get:function(){var t=new Ve;return t.set(this,1),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"constant",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.plus=function(t){return this===(t=ze.fromAny(t))?ze.product(2,this):ze.sum(this,t)},t.prototype.negative=function(){return ze.product(-1,this)},t.prototype.minus=function(t){return this===(t=ze.fromAny(t))?ze.zero:ze.sum(this,t.negative())},t.prototype.times=function(t){return ze.product(t,this)},t.prototype.divide=function(t){return ze.product(1/t,this)},t.prototype.setConstraintFlags=function(t){this.constraintFlags=t},t.prototype.isConstrained=function(){return 0!=(this.constraintFlags&t.ConstrainedFlag)},t.prototype.constrain=function(e){void 0===e&&(e=!0);var r=this.constraintFlags;return e&&0==(r&t.ConstrainedFlag)?(this.setConstraintFlags(r|t.ConstrainedFlag),0!==this.conditionCount&&this.stopConstraining()):e||0==(r&t.ConstrainedFlag)||(this.setConstraintFlags(r&~t.ConstrainedFlag),0!==this.conditionCount&&(this.startConstraining(),this.updateConstraintVariable())),this},t.prototype.addConstraintCondition=function(t,e){this.conditionCount+=1,this.isConstrained()||1!==this.conditionCount||(this.startConstraining(),this.updateConstraintVariable())},t.prototype.removeConstraintCondition=function(t,e){this.conditionCount-=1,this.isConstrained()||0!==this.conditionCount||this.stopConstraining()},t.prototype.isConstraining=function(){return 0!=(this.constraintFlags&t.ConstrainingFlag)},t.prototype.startConstraining=function(){0==(this.constraintFlags&t.ConstrainingFlag)&&(this.willStartConstraining(),this.setConstraintFlags(this.constraintFlags|t.ConstrainingFlag),this.onStartConstraining(),this.didStartConstraining())},t.prototype.willStartConstraining=function(){},t.prototype.onStartConstraining=function(){this.owner.addConstraintVariable(this)},t.prototype.didStartConstraining=function(){},t.prototype.stopConstraining=function(){0!=(this.constraintFlags&t.ConstrainingFlag)&&(this.willStopConstraining(),this.setConstraintFlags(this.constraintFlags&~t.ConstrainingFlag),this.onStopConstraining(),this.didStopConstraining())},t.prototype.willStopConstraining=function(){},t.prototype.onStopConstraining=function(){this.owner.removeConstraintVariable(this)},t.prototype.didStopConstraining=function(){},t.prototype.updateConstraintVariable=function(){void 0!==this.state&&this.owner.setConstraintVariable(this,this.state)},t.prototype.debug=function(t){return t=t.debug(this.owner).write(46).write("constraintVariable").write(40).debug(this.name).write(", ").debug(this.state).write(41)},t.prototype.toString=function(){return nt.debug(this)},t.ConstrainedFlag=1,t.ConstrainingFlag=2,t}(),He={Required:1001001e3,Strong:1e6,Medium:1e3,Weak:1,Unbound:-1,clip:function(t){return Math.min(Math.max(0,t),He.Required)},fromAny:function(t){if("number"==typeof t)return He.clip(t);if("required"===t)return He.Required;if("strong"===t)return He.Strong;if("medium"===t)return He.Medium;if("weak"===t)return He.Weak;throw new TypeError(""+t)}},Xe=function(){function t(t,e,r,n){this.id=Te.nextId(),this.scope=t,this.expression=e,this.relation=r,this.strength=n}return t.prototype.isConstrained=function(){return this.scope.hasConstraint(this)},t.prototype.constrain=function(t){return void 0===t&&(t=!0),t?this.scope.addConstraint(this):this.scope.removeConstraint(this),this},t.prototype.debug=function(t){return t=t.debug(this.scope).write(46).write("constraint").write(40).debug(this.expression).write(", ").debug(this.relation).write(", ").debug(void 0).write(", "),t=(t=this.strength===He.Required?t.debug("required"):this.strength===He.Strong?t.debug("strong"):this.strength===He.Medium?t.debug("medium"):this.strength===He.Weak?t.debug("weak"):t.debug(this.strength)).write(41)},t.prototype.toString=function(){return nt.debug(this)},t}(),Ye=function(){function t(t){this.scope=t,this.constraints=[],this.constrained=!1}return t.prototype.constraint=function(t,e,r,n){t=ze.fromAny(t),void 0!==r&&(r=ze.fromAny(r));var i=void 0!==r?t.minus(r):t;n=void 0===n?He.Required:He.fromAny(n);var o=new Xe(this.scope,i,e,n);return this.addConstraint(o),o},t.prototype.hasConstraint=function(t){return this.constraints.indexOf(t)>=0},t.prototype.addConstraint=function(t){var e=this.constraints;e.indexOf(t)<0&&(e.push(t),t.constrain(this.constrained))},t.prototype.removeConstraint=function(t){var e=this.constraints;if(void 0!==e){var r=e.indexOf(t);r>=0&&(e.splice(r,1),t.constrain(!1))}},t.prototype.enableConstraints=function(){for(var t=this.constraints,e=0,r=t.length;e<r;e+=1)t[e].constrain(!0)},t.prototype.disableConstraints=function(){for(var t=this.constraints,e=0,r=t.length;e<r;e+=1)t[e].constrain(!1)},t.prototype.isConstrained=function(){return this.constrained},t.prototype.constrain=function(t){return void 0===t&&(t=!0),t&&!this.constrained?(this.constrained=!0,this.enableConstraints()):!t&&this.constrained&&(this.constrained=!1,this.disableConstraints()),this},t}(),Ge=function(){function t(t,e,r,n){this.solver=t,this.symbol=e,this.cells=r,this.constant=n}return t.prototype.setSymbol=function(t){this.symbol=t,this.invalidate()},t.prototype.setConstant=function(t){this.constant!==t&&(this.constant=t,this.invalidate())},t.prototype.isConstant=function(){return this.cells.isEmpty()},t.prototype.isDummy=function(){for(var t=0,e=this.cells.size;t<e;t+=1){if(!(this.cells.getEntry(t)[0]instanceof Re))return!1}return!0},t.prototype.clone=function(){return new t(this.solver,this.symbol,this.cells.clone(),this.constant)},t.prototype.add=function(t){var e=this.constant+t;return this.setConstant(e),e},t.prototype.insertSymbol=function(t,e){var r;void 0===e&&(e=1),e+=null!==(r=this.cells.get(t))&&void 0!==r?r:0,Math.abs(e)<i.Epsilon?this.cells.remove(t):this.cells.set(t,e)},t.prototype.insertRow=function(t,e){this.setConstant(this.constant+t.constant*e);for(var r=0,n=t.cells.size;r<n;r+=1){var i=t.cells.getEntry(r),o=i[0],s=i[1];this.insertSymbol(o,s*e)}},t.prototype.removeSymbol=function(t){this.cells.remove(t)},t.prototype.negate=function(){this.setConstant(-this.constant);for(var t=0,e=this.cells.size;t<e;t+=1){var r=this.cells.getEntry(t);r[1]=-r[1]}},t.prototype.solveFor=function(t){var e=this.cells.remove(t);if(void 0!==e){var r=-1/e;this.setConstant(this.constant*r);for(var n=0,i=this.cells.size;n<i;n+=1){this.cells.getEntry(n)[1]*=r}}},t.prototype.solveForEx=function(t,e){this.insertSymbol(t,-1),this.solveFor(e)},t.prototype.coefficientFor=function(t){var e=this.cells.get(t);return void 0!==e?e:0},t.prototype.substitute=function(t,e){var r=this.cells.remove(t);void 0!==r&&this.insertRow(e,r)},t.prototype.invalidate=function(){var t=this.symbol;null!==t&&this.solver.invalidate(t,this)},t}(),_e=function(){function t(){this.constraints=new Ve,this.constraintVariables=new Ve,this.rows=new Ve,this.infeasible=[],this.objective=new Ge(this,null,new Ve,0),this.artificial=null,this.invalidated=new Ve}return t.prototype.constraint=function(t,e,r,n){t=ze.fromAny(t),void 0!==r&&(r=ze.fromAny(r));var i=void 0!==r?t.minus(r):t;n=void 0===n?He.Required:He.fromAny(n);var o=new Xe(this,i,e,n);return this.addConstraint(o),o},t.prototype.hasConstraint=function(t){return this.constraints.has(t)},t.prototype.addConstraint=function(t){if(!this.constraints.has(t)){for(var e=t.expression.terms,r=0,n=e.size;r<n;r+=1){e.getEntry(r)[0].addConstraintCondition(t,this)}var i=this.createRow(t),o=i.row,s=i.tag;this.addConstraintRow(t,o,s)}},t.prototype.addConstraintRow=function(t,e,r){this.willAddConstraint(t);var n=this.chooseSubject(e,r);if(n.isInvalid()&&e.isDummy()){if(!(Math.abs(e.constant)<i.Epsilon))throw new Error("unsatisfiable constraint");n=r.marker}if(n.isInvalid()){if(!this.addWithArtificialVariable(e))throw new Error("unsatisfiable constraint")}else e.setSymbol(n),e.solveFor(n),this.substitute(n,e),this.rows.set(n,e);this.constraints.set(t,r),this.optimize(this.objective),this.didAddConstraint(t),this.updateSolution()},t.prototype.willAddConstraint=function(t){},t.prototype.didAddConstraint=function(t){},t.prototype.removeConstraint=function(t){if(void 0!==this.constraints.get(t)){this.removeConstraintRow(t);for(var e=t.expression.terms,r=0,n=e.size;r<n;r+=1){e.getEntry(r)[0].removeConstraintCondition(t,this)}}},t.prototype.removeConstraintRow=function(t){var e=this.constraints.get(t);if(void 0!==e){this.willRemoveConstraint(t),this.constraints.remove(t),this.removeConstraintEffects(t,e);var r=e.marker;if(void 0===this.rows.remove(r)){var n=this.getMarkerLeavingSymbol(r);if(n.isInvalid())throw new Error("failed to find leaving row");var i=this.rows.remove(n);i.solveForEx(n,r),this.substitute(r,i)}this.optimize(this.objective),this.didRemoveConstraint(t),this.updateSolution()}},t.prototype.willRemoveConstraint=function(t){},t.prototype.didRemoveConstraint=function(t){},t.prototype.constraintVariable=function(t,e,r){return void 0===e&&(e=0),r=void 0===r?He.Strong:He.fromAny(r),new We(this,t,e,r)},t.prototype.hasConstraintVariable=function(t){return this.constraintVariables.has(t)},t.prototype.addConstraintVariable=function(t){if(!this.constraintVariables.has(t)){var e=He.clip(t.strength);if(e===He.Required)throw new Error("invalid variable strength");this.willAddConstraintVariable(t);var r=new Xe(this,t,"eq",e),n=this.createRow(r),i=n.row,o=n.tag;this.constraintVariables.set(t,{constraint:r,tag:o,state:0}),this.addConstraintRow(r,i,o),this.didAddConstraintVariable(t)}},t.prototype.willAddConstraintVariable=function(t){},t.prototype.didAddConstraintVariable=function(t){},t.prototype.removeConstraintVariable=function(t){var e=this.constraintVariables.get(t);void 0!==e&&(this.willRemoveConstraintVariable(t),this.constraintVariables.remove(t),this.removeConstraintRow(e.constraint),this.didRemoveConstraintVariable(t))},t.prototype.willRemoveConstraintVariable=function(t){},t.prototype.didRemoveConstraintVariable=function(t){},t.prototype.setConstraintVariable=function(t,e){var r=this.constraintVariables.get(t);if(void 0===r)throw new Error("unbound variable");var n=r.state;if(n!==e){r.state=e;var i=e-n;this.willSetConstraintVariable(t,e,n);var o=r.tag.marker,s=this.rows.get(o);if(void 0!==s)return s.add(-i)<0&&this.infeasible.push(o),void this.dualOptimize();var u=r.tag.other;if(void 0!==(s=this.rows.get(u)))return s.add(i)<0&&this.infeasible.push(u),void this.dualOptimize();for(var a=0,p=this.rows.size;a<p;a+=1){var h=this.rows.getEntry(a),f=h[0],c=h[1],l=c.coefficientFor(o);0!==l&&c.add(i*l)<0&&!f.isExternal()&&this.infeasible.push(f)}this.dualOptimize(),this.didSetConstraintVariable(t,e,n),this.updateSolution()}},t.prototype.willSetConstraintVariable=function(t,e,r){},t.prototype.didSetConstraintVariable=function(t,e,r){},t.prototype.invalidate=function(t,e){void 0===e&&(e=null),t.isExternal()&&this.invalidated.set(t,e)},t.prototype.updateSolution=function(){var t=this.invalidated;if(!t.isEmpty()){this.invalidated=new Ve;for(var e=0,r=t.size;e<r;e+=1){var n=t.getEntry(e)[0],i=this.rows.get(n);void 0!==i&&n.updateConstraintSolution(i.constant)}}},t.prototype.createRow=function(t){for(var e=t.expression,r=new Ge(this,null,new Ve,e.constant),n=e.terms,o=0,s=n.size;o<s;o+=1){var u=n.getEntry(o),a=u[0],p=u[1];if(Math.abs(p)>=i.Epsilon){var h=this.rows.get(a);void 0!==h?r.insertRow(h,p):r.insertSymbol(a,p)}}var f=this.objective,c=t.relation,l=t.strength,d={marker:je.invalid,other:je.invalid};if("le"===c||"ge"===c){p="le"===c?1:-1;var y=new qe;if(d.marker=y,r.insertSymbol(y,p),l<He.Required){var v=new Ue;d.other=v,r.insertSymbol(v,-p),f.insertSymbol(v,l)}}else if(l<He.Required){var m=new Ue,w=new Ue;d.marker=m,d.other=w,r.insertSymbol(m,-1),r.insertSymbol(w,1),f.insertSymbol(m,l),f.insertSymbol(w,l)}else{var g=new Re;d.marker=g,r.insertSymbol(g)}return r.constant<0&&r.negate(),{row:r,tag:d}},t.prototype.chooseSubject=function(t,e){for(var r=0,n=t.cells.size;r<n;r+=1){var i=t.cells.getEntry(r)[0];if(i.isExternal())return i}return(e.marker instanceof qe||e.marker instanceof Ue)&&t.coefficientFor(e.marker)<0?e.marker:(e.other instanceof qe||e.other instanceof Ue)&&t.coefficientFor(e.other)<0?e.other:je.invalid},t.prototype.addWithArtificialVariable=function(t){var e=new qe;this.rows.set(e,t.clone()),this.artificial=t.clone(),this.optimize(this.artificial);var r=Math.abs(this.artificial.constant)<i.Epsilon;this.artificial=null;var n=this.rows.remove(e);if(void 0!==n){if(n.isConstant())return r;var o=this.anyPivotableSymbol(n);if(o.isInvalid())return!1;n.setSymbol(o),n.solveForEx(e,o),this.substitute(o,n),this.rows.set(o,n)}for(var s=0,u=this.rows.size;s<u;s+=1)this.rows.getEntry(s)[1].removeSymbol(e);return this.objective.removeSymbol(e),r},t.prototype.substitute=function(t,e){for(var r=0,n=this.rows.size;r<n;r+=1){var i=this.rows.getEntry(r),o=i[0],s=i[1];s.substitute(t,e),s.constant<0&&!o.isExternal()&&this.infeasible.push(o)}this.objective.substitute(t,e),null!==this.artificial&&this.artificial.substitute(t,e)},t.prototype.optimize=function(t){for(;;){var e=this.getEnteringSymbol(t);if(e.isInvalid())return;var r=this.getLeavingSymbol(e);if(r.isInvalid())throw new Error("objective is unbounded");var n=this.rows.remove(r);n.setSymbol(e),n.solveForEx(r,e),this.substitute(e,n),this.rows.set(e,n)}},t.prototype.dualOptimize=function(){for(var t;void 0!==(t=this.infeasible.pop());){var e=this.rows.get(t);if(void 0!==e&&e.constant<0){var r=this.getDualEnteringSymbol(e);if(r.isInvalid())throw new Error("dual optimize failed");this.rows.remove(t),e.setSymbol(r),e.solveForEx(t,r),this.substitute(r,e),this.rows.set(r,e)}}},t.prototype.getEnteringSymbol=function(t){for(var e=0,r=t.cells.size;e<r;e+=1){var n=t.cells.getEntry(e),i=n[0];if(n[1]<0&&!i.isDummy())return i}return je.invalid},t.prototype.getDualEnteringSymbol=function(t){for(var e=Number.MAX_VALUE,r=je.invalid,n=0,i=t.cells.size;n<i;n+=1){var o=t.cells.getEntry(n),s=o[0],u=o[1];if(u>0&&!s.isDummy()){var a=this.objective.coefficientFor(s)/u;a<e&&(e=a,r=s)}}return r},t.prototype.getLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,r=je.invalid,n=0,i=this.rows.size;n<i;n+=1){var o=this.rows.getEntry(n),s=o[0],u=o[1];if(!s.isExternal()){var a=u.coefficientFor(t);if(a<0){var p=-u.constant/a;p<e&&(e=p,r=s)}}}return r},t.prototype.getMarkerLeavingSymbol=function(t){for(var e=Number.MAX_VALUE,r=Number.MAX_VALUE,n=je.invalid,i=je.invalid,o=je.invalid,s=0,u=this.rows.size;s<u;s+=1){var a=this.rows.getEntry(s),p=a[0],h=a[1],f=h.coefficientFor(t);if(0!==f)if(p.isExternal())o=p;else if(f<0){(c=-h.constant/f)<e&&(e=c,n=p)}else{var c;(c=h.constant/f)<r&&(r=c,i=p)}}return n.isInvalid()?i.isInvalid()?o:i:n},t.prototype.removeConstraintEffects=function(t,e){e.marker instanceof Ue&&this.removeMarkerEffects(e.marker,t.strength),e.other instanceof Ue&&this.removeMarkerEffects(e.other,t.strength)},t.prototype.removeMarkerEffects=function(t,e){var r=this.rows.get(t);void 0!==r?this.objective.insertRow(r,-e):this.objective.insertSymbol(t,-e)},t.prototype.anyPivotableSymbol=function(t){for(var e=0,r=t.cells.size;e<r;e+=1){var n=t.cells.getEntry(e)[0];if(n instanceof qe||n instanceof Ue)return n}return je.invalid},t}(),Qe=function(){function t(){}return t.prototype.updated=function(t,e){var r=or.create(2);return r.push(this),r.set(t,e),r},t.prototype.updatedAttr=function(t,e){var r=or.create(2);return r.push(this),r.setAttr(t,e),r},t.prototype.updatedSlot=function(t,e){var r=or.create(2);return r.push(this),r.setSlot(t,e),r},t.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=or.create(1+arguments.length);return r.push(this),r.push.apply(r,t),r},t.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=or.create(arguments.length+1);return r.push.apply(r,t),r.push(this),r},t.prototype.concat=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=or.create();n.push(this);for(var i=0,o=e.length;i<o;i+=1)t.fromAny(e[i]).forEach((function(t){n.push(t)}));return n},t.prototype.lt=function(e){return e=t.fromAny(e),this.compareTo(e)<0?mr.from(!0):t.absent()},t.prototype.le=function(e){return e=t.fromAny(e),this.compareTo(e)<=0?mr.from(!0):t.absent()},t.prototype.eq=function(e){return e=t.fromAny(e),this.equals(e)?mr.from(!0):t.absent()},t.prototype.ne=function(e){return e=t.fromAny(e),this.equals(e)?t.absent():mr.from(!0)},t.prototype.ge=function(e){return e=t.fromAny(e),this.compareTo(e)>=0?mr.from(!0):t.absent()},t.prototype.gt=function(e){return e=t.fromAny(e),this.compareTo(e)>0?mr.from(!0):t.absent()},t.prototype.invoke=function(e){return t.absent()},t.prototype.filter=function(t){var e=$r.literal(this);return 0===arguments.length?e.filter():e.filter(t)},t.prototype.max=function(t){return this.compareTo(t)>=0?this:t},t.prototype.min=function(t){return this.compareTo(t)<=0?this:t},t.prototype.evaluate=function(t){return this},t.prototype.substitute=function(t){return this},t.prototype.cast=function(t,e){var r=t.cast(this);return void 0===r&&(r=e),r},t.prototype.coerce=function(t,e){var r=t.cast(this);return void 0===r&&(r=t.unit),void 0===r&&(r=e),r},Object.defineProperty(t.prototype,"precedence",{get:function(){return 11},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){return t.call(e,this,0)},t.prototype.iterator=function(){return M.unary(this)},t.prototype.interpolateTo=function(e){return e instanceof t?Ze(this,e):null},t.prototype.display=function(t){return this.debug(t)},t.prototype.toString=function(){return nt.debug(this)},t.empty=function(){return or.empty()},t.extant=function(){return wr.extant()},t.absent=function(){return gr.absent()},t.fromAny=function(e){return e instanceof t?e:ir.fromAny(e)},t.globalScope=function(){return or.create(1).slot("math",dn.scope).commit()},S([e],t,"globalScope",null),t}(),Ze=function(t,e){var r=function(t){return t<1?r[0]:r[1]};return Object.setPrototypeOf(r,Ze.prototype),r[0]=t.commit(),r[1]=e.commit(),r};Ze.prototype=Object.create($t.prototype);var Je=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isDistinct=function(){return!0},e.prototype.isDefinite=function(){return!0},e.prototype.toValue=function(){return this.value},Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.value},enumerable:!1,configurable:!0}),e.prototype.flattened=function(){return ir.absent()},e.prototype.unflattened=function(){return or.of(this)},e.prototype.header=function(t){return ir.absent()},e.prototype.headers=function(t){},e.prototype.head=function(){return Qe.absent()},e.prototype.tail=function(){return or.empty()},e.prototype.body=function(){return ir.absent()},Object.defineProperty(e.prototype,"length",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){return ir.absent()},e.prototype.getAttr=function(t){return ir.absent()},e.prototype.getSlot=function(t){return ir.absent()},e.prototype.getField=function(t){},e.prototype.getItem=function(t){return Qe.absent()},e.prototype.deleted=function(t){return this},e.prototype.conditional=function(t,e){return t=Qe.fromAny(t)},e.prototype.or=function(t){return this},e.prototype.and=function(t){return t=Qe.fromAny(t)},e.prototype.lambda=function(t){return ir.absent()},e.prototype.stringValue=function(t){return this.value.stringValue(t)},e.prototype.numberValue=function(t){return this.value.numberValue(t)},e.prototype.booleanValue=function(t){return this.value.booleanValue(t)},e.prototype.interpolateTo=function(r){return r instanceof e?tr(this,r):t.prototype.interpolateTo.call(this,r)},e.of=function(t,e){var r;return"string"==typeof t?r=t:t instanceof lr&&(r=t.value),void 0!==r&&64===r.charCodeAt(0)?(r=r.slice(1),1===arguments.length?er.of(r):er.of(r,e)):1===arguments.length?$e.of(t):$e.of(t,e)},e.fromAny=function(t){if(t instanceof e)return t;if("object"==typeof t&&null!==t){if(void 0!==t.$key)return e.of(t.$key,t.$value);for(var r in t)return e.of(r,t[r])}throw new TypeError(""+t)},e.ImmutableFlag=1,e}(Qe),$e=function(t){function e(e,r,n){var i=t.call(this)||this;return i.key=e.commit(),i.value=r,i.flags=void 0!==n?n:0,i}return P(e,t),e.prototype.isConstant=function(){return this.key.isConstant()&&this.value.isConstant()},e.prototype.setValue=function(t){if(0!=(this.flags&Je.ImmutableFlag))throw new Error("immutable");var e=this.value;return this.value=t,e},e.prototype.updatedValue=function(t){return new e(this.key,t)},e.prototype.bitwiseOr=function(t){return(t=Qe.fromAny(t))instanceof br?new Vr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.bitwiseOr(t.value):t instanceof ir?this.value.bitwiseOr(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.bitwiseXor=function(t){return(t=Qe.fromAny(t))instanceof br?new jr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.bitwiseXor(t.value):t instanceof ir?this.value.bitwiseXor(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.bitwiseAnd=function(t){return(t=Qe.fromAny(t))instanceof br?new qr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.bitwiseAnd(t.value):t instanceof ir?this.value.bitwiseAnd(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.plus=function(t){return(t=Qe.fromAny(t))instanceof br?new Kr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.plus(t.value):t instanceof ir?this.value.plus(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.minus=function(t){return(t=Qe.fromAny(t))instanceof br?new Br(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.minus(t.value):t instanceof ir?this.value.minus(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.times=function(t){return(t=Qe.fromAny(t))instanceof br?new Wr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.times(t.value):t instanceof ir?this.value.times(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.divide=function(t){return(t=Qe.fromAny(t))instanceof br?new Hr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.divide(t.value):t instanceof ir?this.value.divide(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.modulo=function(t){return(t=Qe.fromAny(t))instanceof br?new Xr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.modulo(t.value):t instanceof ir?this.value.modulo(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.not=function(){var t=this.value.not();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.bitwiseNot=function(){var t=this.value.bitwiseNot();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.negative=function(){var t=this.value.negative();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.positive=function(){var t=this.value.positive();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.inverse=function(){var t=this.value.inverse();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.evaluate=function(t){t=Dr.fromAny(t);var r=this.key.evaluate(t).toValue(),n=this.value.evaluate(t).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?new e(r,n):Qe.absent()},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.key.substitute(t).toValue(),n=this.value.substitute(t).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?new e(r,n):Qe.absent()},e.prototype.toAny=function(){var t={};return this.key instanceof lr?t[this.key.value]=this.value.toAny():(t.$key=this.key.toAny(),t.$value=this.value.toAny()),t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return 0==(this.flags&Je.ImmutableFlag)},e.prototype.alias=function(){this.flags|=Je.ImmutableFlag},e.prototype.branch=function(){return 0!=(this.flags&Je.ImmutableFlag)?new e(this.key,this.value,this.flags&~Je.ImmutableFlag):this},e.prototype.clone=function(){return new e(this.key.clone(),this.value.clone())},e.prototype.commit=function(){return this.flags|=Je.ImmutableFlag,this.value.commit(),this},e.prototype.interpolateTo=function(r){return r instanceof e?nr(this,r):t.prototype.interpolateTo.call(this,r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 2},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.key.compareTo(t.key);return 0===r&&(r=this.value.compareTo(t.value)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.key.equals(t.key)&&this.value.equivalentTo(t.value,r))},e.prototype.keyEquals=function(t){return"string"==typeof t&&this.key instanceof lr?this.key.value===t:t instanceof Je?this.key.equals(t.key):this.key.equals(t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.key.equals(t.key)&&this.value.equals(t.value))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.key.hashCode()),this.value.hashCode()))},e.prototype.debug=function(t){return t=t.write("Slot").write(46).write("of").write(40).display(this.key),this.value instanceof wr||(t=t.write(44).write(32).display(this.value)),t=t.write(41)},e.of=function(t,r){return new e(t=ir.fromAny(t),r=1===arguments.length?ir.extant():ir.fromAny(r))},e}(Je),tr=function(t,e){var r=function(t){var e=r.keyInterpolator(t),n=r.valueInterpolator(t);return $e.of(e,n)};return Object.setPrototypeOf(r,tr.prototype),r.keyInterpolator=t.key.interpolateTo(e.key),r.valueInterpolator=t.value.interpolateTo(e.value),r};tr.prototype=Object.create($t.prototype),Object.defineProperty(tr.prototype,0,{get:function(){return $e.of(this.keyInterpolator[0],this.valueInterpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(tr.prototype,1,{get:function(){return $e.of(this.keyInterpolator[1],this.valueInterpolator[1])},enumerable:!0,configurable:!0}),tr.prototype.equals=function(t){return this===t||t instanceof tr&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))};var er=function(t){function e(e,r,n){var i=t.call(this)||this;return i.key=e,i.value=r,i.flags=void 0!==n?n:0,i}return P(e,t),e.prototype.isConstant=function(){return this.key.isConstant()&&this.value.isConstant()},Object.defineProperty(e.prototype,"name",{get:function(){return this.key.value},enumerable:!1,configurable:!0}),e.prototype.setValue=function(t){if(0!=(this.flags&Je.ImmutableFlag))throw new Error("immutable");var e=this.value;return this.value=t,e},e.prototype.updatedValue=function(t){return new e(this.key,t)},e.prototype.bitwiseOr=function(t){return(t=Qe.fromAny(t))instanceof br?new Vr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.bitwiseOr(t.value):t instanceof ir?this.value.bitwiseOr(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.bitwiseXor=function(t){return(t=Qe.fromAny(t))instanceof br?new jr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.bitwiseXor(t.value):t instanceof ir?this.value.bitwiseXor(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.bitwiseAnd=function(t){return(t=Qe.fromAny(t))instanceof br?new qr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.bitwiseAnd(t.value):t instanceof ir?this.value.bitwiseAnd(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.plus=function(t){return(t=Qe.fromAny(t))instanceof br?new Kr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.plus(t.value):t instanceof ir?this.value.plus(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.minus=function(t){return(t=Qe.fromAny(t))instanceof br?new Br(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.minus(t.value):t instanceof ir?this.value.minus(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.times=function(t){return(t=Qe.fromAny(t))instanceof br?new Wr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.times(t.value):t instanceof ir?this.value.times(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.divide=function(t){return(t=Qe.fromAny(t))instanceof br?new Hr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.divide(t.value):t instanceof ir?this.value.divide(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.modulo=function(t){return(t=Qe.fromAny(t))instanceof br?new Xr(this,t):(r=t instanceof e&&this.key.equals(t.key)?this.value.modulo(t.value):t instanceof ir?this.value.modulo(t):ir.absent()).isDefined()?new e(this.key,r):Qe.absent();var r},e.prototype.not=function(){var t=this.value.not();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.bitwiseNot=function(){var t=this.value.bitwiseNot();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.negative=function(){var t=this.value.negative();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.positive=function(){var t=this.value.positive();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.inverse=function(){var t=this.value.inverse();return t.isDefined()?new e(this.key,t):Qe.absent()},e.prototype.evaluate=function(t){t=Dr.fromAny(t);var r=this.key.evaluate(t).toValue(),n=this.value.evaluate(t).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?r instanceof lr?new e(r,n):new $e(r,n):Qe.absent()},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.key.substitute(t).toValue(),n=this.value.substitute(t).toValue();return r===this.key&&n===this.value?this:r.isDefined()&&n.isDefined()?r instanceof lr?new e(r,n):new $e(r,n):Qe.absent()},e.prototype.toAny=function(){var t={};return t["@"+this.key.value]=this.value.toAny(),t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return 0==(this.flags&Je.ImmutableFlag)},e.prototype.alias=function(){this.flags|=Je.ImmutableFlag},e.prototype.branch=function(){return 0!=(this.flags&Je.ImmutableFlag)?new e(this.key,this.value,this.flags&~Je.ImmutableFlag):this},e.prototype.clone=function(){return new e(this.key.clone(),this.value.clone())},e.prototype.commit=function(){return this.flags|=Je.ImmutableFlag,this.value.commit(),this},e.prototype.interpolateTo=function(r){return r instanceof e?rr(this,r):t.prototype.interpolateTo.call(this,r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 1},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.key.compareTo(t.key);return 0===r&&(r=this.value.compareTo(t.value)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.key.equals(t.key)&&this.value.equivalentTo(t.value,r))},e.prototype.keyEquals=function(t){return"string"==typeof t?this.key.value===t:t instanceof Je?this.key.equals(t.key):this.key.equals(t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.key.equals(t.key)&&this.value.equals(t.value))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.key.hashCode()),this.value.hashCode()))},e.prototype.debug=function(t){return t=t.write("Attr").write(46).write("of").write(40).display(this.key),this.value instanceof wr||(t=t.write(44).write(32).display(this.value)),t=t.write(41)},e.of=function(t,r){return new e(t=lr.fromAny(t),r=1===arguments.length?ir.extant():ir.fromAny(r))},e}(Je),rr=function(t,e){var r=function(t){var e=r.keyInterpolator(t),n=r.valueInterpolator(t);return er.of(e,n)};return Object.setPrototypeOf(r,rr.prototype),r.keyInterpolator=t.key.interpolateTo(e.key),r.valueInterpolator=t.value.interpolateTo(e.value),r};rr.prototype=Object.create($t.prototype),Object.defineProperty(rr.prototype,0,{get:function(){return er.of(this.keyInterpolator[0],this.valueInterpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(rr.prototype,1,{get:function(){return er.of(this.keyInterpolator[1],this.valueInterpolator[1])},enumerable:!0,configurable:!0}),rr.prototype.equals=function(t){return this===t||t instanceof rr&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))};var nr=function(t,e){var r=function(t){var e=r.keyInterpolator(t),n=r.valueInterpolator(t);return $e.of(e,n)};return Object.setPrototypeOf(r,nr.prototype),r.keyInterpolator=t.key.interpolateTo(e.key),r.valueInterpolator=t.value.interpolateTo(e.value),r};nr.prototype=Object.create($t.prototype),Object.defineProperty(nr.prototype,0,{get:function(){return $e.of(this.keyInterpolator[0],this.valueInterpolator[0])},enumerable:!0,configurable:!0}),Object.defineProperty(nr.prototype,1,{get:function(){return $e.of(this.keyInterpolator[1],this.valueInterpolator[1])},enumerable:!0,configurable:!0}),nr.prototype.equals=function(t){return this===t||t instanceof nr&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))};var ir=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isDistinct=function(){return!0},e.prototype.isDefinite=function(){return!0},Object.defineProperty(e.prototype,"key",{get:function(){return e.absent()},enumerable:!1,configurable:!0}),e.prototype.toValue=function(){return this},Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.flattened=function(){return this},e.prototype.unflattened=function(){return or.of(this)},e.prototype.header=function(t){return e.absent()},e.prototype.headers=function(t){},e.prototype.head=function(){return Qe.absent()},e.prototype.tail=function(){return or.empty()},e.prototype.body=function(){return e.extant()},Object.defineProperty(e.prototype,"length",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){return e.absent()},e.prototype.getAttr=function(t){return e.absent()},e.prototype.getSlot=function(t){return e.absent()},e.prototype.getField=function(t){},e.prototype.getItem=function(t){return Qe.absent()},e.prototype.deleted=function(t){return this},e.prototype.conditional=function(t,e){return t=Qe.fromAny(t)},e.prototype.or=function(t){return this},e.prototype.and=function(t){return t=Qe.fromAny(t)},e.prototype.bitwiseOr=function(t){if((t=Qe.fromAny(t))instanceof br)return new Vr(this,t);if(t instanceof er){if((e=this.bitwiseOr(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.bitwiseOr(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.bitwiseXor=function(t){if((t=Qe.fromAny(t))instanceof br)return new jr(this,t);if(t instanceof er){if((e=this.bitwiseXor(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.bitwiseXor(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.bitwiseAnd=function(t){if((t=Qe.fromAny(t))instanceof br)return new qr(this,t);if(t instanceof er){if((e=this.bitwiseAnd(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.bitwiseAnd(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.lt=function(e){return(e=Qe.fromAny(e))instanceof br?new Rr(this,e):t.prototype.lt.call(this,e)},e.prototype.le=function(e){return(e=Qe.fromAny(e))instanceof br?new Ur(this,e):t.prototype.le.call(this,e)},e.prototype.eq=function(e){return(e=Qe.fromAny(e))instanceof br?new Nr(this,e):t.prototype.eq.call(this,e)},e.prototype.ne=function(e){return(e=Qe.fromAny(e))instanceof br?new zr(this,e):t.prototype.ne.call(this,e)},e.prototype.ge=function(e){return(e=Qe.fromAny(e))instanceof br?new Fr(this,e):t.prototype.ge.call(this,e)},e.prototype.gt=function(e){return(e=Qe.fromAny(e))instanceof br?new Lr(this,e):t.prototype.gt.call(this,e)},e.prototype.plus=function(t){if((t=Qe.fromAny(t))instanceof br)return new Kr(this,t);if(t instanceof er){if((e=this.plus(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.plus(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.minus=function(t){if((t=Qe.fromAny(t))instanceof br)return new Br(this,t);if(t instanceof er){if((e=this.minus(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.minus(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.times=function(t){if((t=Qe.fromAny(t))instanceof br)return new Wr(this,t);if(t instanceof er){if((e=this.times(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.times(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.divide=function(t){if((t=Qe.fromAny(t))instanceof br)return new Hr(this,t);if(t instanceof er){if((e=this.divide(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.divide(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.modulo=function(t){if((t=Qe.fromAny(t))instanceof br)return new Xr(this,t);if(t instanceof er){if((e=this.modulo(t.value)).isDefined())return new er(t.key,e)}else if(t instanceof $e){var e;if((e=this.modulo(t.value)).isDefined())return new $e(t.key,e)}return Qe.absent()},e.prototype.not=function(){return e.absent()},e.prototype.bitwiseNot=function(){return e.absent()},e.prototype.negative=function(){return e.absent()},e.prototype.positive=function(){return e.absent()},e.prototype.inverse=function(){return e.absent()},e.prototype.lambda=function(t){return new cn(this,t)},e.prototype.stringValue=function(t){return t},e.prototype.numberValue=function(t){return t},e.prototype.booleanValue=function(t){return t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return!1},e.prototype.alias=function(){},e.prototype.branch=function(){return this},e.prototype.clone=function(){return this},e.prototype.commit=function(){return this},e.prototype.interpolateTo=function(e){return t.prototype.interpolateTo.call(this,e)},e.prototype.keyEquals=function(t){return!1},e.builder=function(){return new sr},e.empty=function(){return or.empty()},e.extant=function(){return wr.extant()},e.absent=function(){return gr.absent()},e.fromAny=function(t){if(t instanceof e)return t;if(void 0===t)return gr.absent();if(null===t)return wr.extant();if("boolean"==typeof t)return mr.from(t);if("number"==typeof t)return yr.from(t);if("string"==typeof t)return lr.from(t);if(t instanceof Uint8Array)return fr.wrap(t);if(Array.isArray(t))return or.fromArray(t);if("object"==typeof t)return or.fromObject(t);throw new TypeError(""+t)},e}(Qe),or=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.isDefinite=function(){return!this.isEmpty()},e.prototype.isArray=function(){return 0===this.fieldCount},e.prototype.isObject=function(){return 0===this.valueCount},Object.defineProperty(e.prototype,"valueCount",{get:function(){var t=0;return this.forEach((function(e){e instanceof ir&&(t+=1)}),this),t},enumerable:!1,configurable:!0}),e.prototype.isConstant=function(){return void 0===this.forEach((function(t){return!!t.isConstant()&&void 0}),this)},Object.defineProperty(e.prototype,"tag",{get:function(){var t=this.head();if(t instanceof er)return t.key.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var t,r,n=!1;return this.forEach((function(i){i instanceof er?n=!0:void 0===t&&i instanceof ir?t=i:(void 0===r&&(r=e.create(),void 0!==t&&r.push(t)),r.push(i))}),this),void 0===t?ir.extant():void 0===r?t:n?r:this},enumerable:!1,configurable:!0}),e.prototype.flattened=function(){if(this.isEmpty())return ir.extant();var t=this.iterator(),e=t.head();return t.step(),t.isEmpty()&&e instanceof ir?e:this.branch()},e.prototype.unflattened=function(){return this},e.prototype.header=function(t){var e=this.head();return e instanceof er&&e.key.value===t?e.value:ir.absent()},e.prototype.headers=function(t){var r=this.head();if(r instanceof er&&r.key.value===t){var n=r.value;return n instanceof e?n:e.of(n)}},e.prototype.head=function(){return this.forEach((function(t){return t}),this)||Qe.absent()},e.prototype.tail=function(){var t=e.create();return this.forEach((function(e,r){r>0&&t.push(e)}),this),t},e.prototype.body=function(){var t=this.tail();return t.isEmpty()?ir.absent():t.flattened()},e.prototype.has=function(t){return t=ir.fromAny(t),this.forEach((function(e){return!!(e instanceof Je&&e.key.equals(t))||void 0}),this)||!1},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=Qe.fromAny(t),e<0&&(e=Math.max(0,this.length+e));var r=this.forEach((function(r,n){return n>=e&&t.equals(r)?n:void 0}),this);return void 0!==r?r:-1},e.prototype.lastIndexOf=function(t,e){t=Qe.fromAny(t);var r=this.length;for(void 0===e?e=r-1:e<0&&(e=r+e),e=Math.min(e,r-1);e>=0;){if(t.equals(this.getItem(e)))return e;e-=1}return-1},e.prototype.get=function(t){return t=ir.fromAny(t),this.forEach((function(e){return e instanceof Je&&e.key.equals(t)?e.value:void 0}),this)||ir.absent()},e.prototype.getAttr=function(t){return t=lr.fromAny(t),this.forEach((function(e){return e instanceof er&&e.key.equals(t)?e.value:void 0}),this)||ir.absent()},e.prototype.getSlot=function(t){return t=ir.fromAny(t),this.forEach((function(e){return e instanceof $e&&e.key.equals(t)?e.value:void 0}),this)||ir.absent()},e.prototype.getField=function(t){return t=ir.fromAny(t),this.forEach((function(e){return e instanceof Je&&e.key.equals(t)?e:void 0}),this)},e.prototype.set=function(t,e){t=ir.fromAny(t),e=ir.fromAny(e);for(var r=this.iterator();!r.isEmpty();){var n=r.head();if(n instanceof Je&&n.key.equals(t))return n.isMutable()?n.setValue(e):r.set(n.updatedValue(e)),this;r.step()}return this.push(new $e(t,e)),this},e.prototype.setAttr=function(t,e){t=lr.fromAny(t),e=ir.fromAny(e);for(var r=this.iterator();!r.isEmpty();){var n=r.head();if(n instanceof Je&&n.key.equals(t))return n instanceof er&&n.isMutable()?n.setValue(e):r.set(new er(t,e)),this;r.step()}return this.push(new er(t,e)),this},e.prototype.setSlot=function(t,e){t=ir.fromAny(t),e=ir.fromAny(e);for(var r=this.iterator();!r.isEmpty();){var n=r.head();if(n instanceof Je&&n.key.equals(t))return n instanceof $e&&n.isMutable()?n.setValue(e):r.set(new $e(t,e)),this;r.step()}return this.push(new $e(t,e)),this},e.prototype.updated=function(t,e){t=ir.fromAny(t),e=ir.fromAny(e);for(var r=this.isMutable()?this:this.branch(),n=r.iterator();!n.isEmpty();){var i=n.head();if(i.key.equals(t))return i instanceof Je&&i.isMutable()?i.setValue(e):n.set(new $e(t,e)),r;n.step()}return r.push(new $e(t,e)),r},e.prototype.updatedAttr=function(t,e){t=lr.fromAny(t),e=ir.fromAny(e);for(var r=this.isMutable()?this:this.branch(),n=r.iterator();!n.isEmpty();){var i=n.head();if(i.key.equals(t))return i instanceof er&&i.isMutable()?i.setValue(e):n.set(new er(t,e)),r;n.step()}return r.push(new er(t,e)),r},e.prototype.updatedSlot=function(t,e){t=ir.fromAny(t),e=ir.fromAny(e);for(var r=this.isMutable()?this:this.branch(),n=r.iterator();!n.isEmpty();){var i=n.head();if(i.key.equals(t))return i instanceof $e&&i.isMutable()?i.setValue(e):n.set(new $e(t,e)),r;n.step()}return r.push(new $e(t,e)),r},e.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.isMutable()?this:this.branch();return r.push.apply(r,t),r},e.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.isMutable()?this:this.branch();return r.splice.apply(r,k([0,0],t,!1)),r},e.prototype.deleted=function(t){var e=this.isMutable()?this:this.branch();return e.delete(t),e},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.isMutable()?this:this.branch(),n=0,i=t.length;n<i;n+=1)Qe.fromAny(t[n]).forEach((function(t){r.push(t)}));return r},e.prototype.slice=function(t,e){return this.subRecord(t,e).branch()},e.prototype.attr=function(t,e){var r;return r=1===arguments.length?er.of(t):er.of(t,e),this.push(r),this},e.prototype.slot=function(t,e){var r;return r=1===arguments.length?$e.of(t):$e.of(t,e),this.push(r),this},e.prototype.item=function(t){return this.push(t),this},e.prototype.items=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.push.apply(this,k([this],t,!1)),this},e.prototype.evaluate=function(t){t=Dr.fromAny(t);var r=e.create();t.pushScope(r);var n=!1;return this.forEach((function(e){var i=e.evaluate(t);i.isDefined()&&r.push(i),e!==i&&(n=!0)}),this),t.popScope(),n?r:this},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=e.create();t.pushScope(r);var n=!1;return this.forEach((function(e){var i=e.substitute(t);i.isDefined()&&r.push(i),e!==i&&(n=!0)}),this),t.popScope(),n?r:this},e.prototype.stringValue=function(t){var e="";return void 0===this.forEach((function(t){if(t instanceof ir){var r=t.stringValue();if(void 0!==r)return void(e+=r)}return null}),this)?e:void 0},e.prototype.toAny=function(){return!this.isEmpty()&&this.isArray()?this.toArray():this.toObject()},e.prototype.toArray=function(){var t=new Array(this.length);return this.forEach((function(e,r){e instanceof ir?t[r]=e.toAny():e instanceof Je&&(t[r]={$key:e.key.toAny(),$value:e.value.toAny()})}),this),t},e.prototype.toObject=function(){var t={};return this.forEach((function(e,r){e instanceof er?t["@"+e.key.value]=e.value.toAny():e instanceof $e?e.key instanceof lr?t[e.key.value]=e.value.toAny():t["$"+r]={$key:e.key.toAny(),$value:e.value.toAny()}:e instanceof ir&&(t["$"+r]=e.toAny())}),this),t},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return!0},e.prototype.alias=function(){},e.prototype.branch=function(){var t=e.create();return this.forEach((function(e){t.push(e)}),this),t},e.prototype.clone=function(){var t=e.create();return this.forEach((function(e){t.push(e.clone())}),this),t},e.prototype.commit=function(){return this},e.prototype.bind=function(){return this},e.prototype.subRecord=function(t,r){var n=this.length;void 0===t?t=0:t<0&&(t=n+t),t=Math.min(Math.max(0,t),n),void 0===r?r=n:r<0&&(r=n+r);var i=e.create();return this.forEach((function(e,n){return n<t?void 0:n<r?void i.push(e):null}),this),i},e.prototype.iterator=function(){return new ar(this)},e.prototype.interpolateTo=function(r){return r instanceof e?ur(this,r):t.prototype.interpolateTo.call(this,r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 3},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.iterator(),n=t.iterator(),i=0;do{if(r.isEmpty()||n.isEmpty())break;i=r.head().compareTo(n.head()),r.step(),n.step()}while(0===i);return 0!==i?i:r.isEmpty()&&!n.isEmpty()?-1:!r.isEmpty()&&n.isEmpty()?1:0}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){if(this===t)return!0;if(t instanceof e){for(var n=this.iterator(),i=t.iterator();!n.isEmpty()&&!i.isEmpty();){if(!n.head().equivalentTo(i.head(),r))return!1;n.step(),i.step()}return n.isEmpty()&&i.isEmpty()}return!1},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){for(var r=this.iterator(),n=t.iterator();!r.isEmpty()&&!n.isEmpty();){if(!r.head().equals(n.head()))return!1;r.step(),n.step()}return r.isEmpty()&&n.isEmpty()}return!1},e.prototype.hashCode=function(){var t=b.hash(e);return this.forEach((function(e){t=f.mix(t,e.hashCode())}),this),t},e.prototype.debug=function(t){return t=t.write("Record").write(46),this.isEmpty()?t=t.write("empty").write(40).write(41):(t=t.write("of").write(40),this.forEach((function(e,r){0!==r&&(t=t.write(44).write(32)),t=t.display(e)}),this),t=t.write(41)),t},e.empty=function(){return pr.empty()},e.create=function(t){return pr.create(t)},e.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return pr.of.apply(pr,t)},e.fromAny=function(t){if(t instanceof e)return t;if(Array.isArray(t))return e.fromArray(t);if("object"==typeof t&&null!==t)return e.fromObject(t);throw new TypeError(""+t)},e.fromArray=function(t){for(var r=t.length||0,n=e.create(r),i=0;i<r;i+=1)n.push(Qe.fromAny(t[i]));return n},e.fromObject=function(t){var r=e.create();for(var n in t){var i=t[n];36===n.charCodeAt(0)?i&&"object"==typeof i&&Object.prototype.hasOwnProperty.call(i,"$key")?r.push(Je.of(i.$key,i.$value)):r.push(ir.fromAny(i)):r.push(Je.of(n,i))}return r},e.expand=function(t){return t=Math.max(8,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},e.AliasedFlag=1,e.ImmutableFlag=2,e}(ir);Object.defineProperty(or.prototype,"fieldCount",{get:function(){var t=0;return this.forEach((function(e){e instanceof Je&&(t+=1)}),this),t},enumerable:!0,configurable:!0});var sr=function(){function t(){this.record=null,this.value=null}return t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=t.length;r<n;r+=1){var i=t[r];if(i instanceof Je)return this.pushField(i);if(i instanceof ir)return this.pushValue(i);throw new TypeError(""+i)}},t.prototype.pushField=function(t){null===this.record&&(this.record=or.create(),null!==this.value&&(this.record.push(this.value),this.value=null)),this.record.push(t)},t.prototype.pushValue=function(t){null!==this.record?this.record.push(t):null===this.value?this.value=t:(this.record=or.create(),this.record.push(this.value),this.value=null,this.record.push(t))},t.prototype.bind=function(){return null!==this.record?this.record:null!==this.value?this.value:ir.absent()},t}(),ur=function(t,e){var r=function(t){for(var e=r.interpolators,n=e.length,i=or.create(n),o=0;o<n;o+=1)i.push(e[o](t));return i};Object.setPrototypeOf(r,ur.prototype);for(var n=Math.min(t.length,e.length),i=new Array(n),o=0;o<n;o+=1)i[o]=t.getItem(o).interpolateTo(e.getItem(o));return r.interpolators=i,r};ur.prototype=Object.create($t.prototype),Object.defineProperty(ur.prototype,0,{get:function(){for(var t=this.interpolators,e=t.length,r=or.create(e),n=0;n<e;n+=1)r.push(t[n][0]);return r},enumerable:!0,configurable:!0}),Object.defineProperty(ur.prototype,1,{get:function(){for(var t=this.interpolators,e=t.length,r=or.create(e),n=0;n<e;n+=1)r.push(t[n][1]);return r},enumerable:!0,configurable:!0}),ur.prototype.equals=function(t){if(this===t)return!0;if(t instanceof ur){var e=this.interpolators.length;if(e===t.interpolators.length){for(var r=0;r<e;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1};var ar=function(t){function e(e,r,n,i){var o=t.call(this)||this;return void 0===r&&(r=0),void 0===n&&(n=e.length),void 0===i&&(i=r),o.record=e,o.lower=r,o.upper=n,o.index=i,o.direction=0,o}return P(e,t),e.prototype.isEmpty=function(){return this.index>=this.upper},e.prototype.head=function(){if(this.direction=0,this.index<this.upper)return this.record.getItem(this.index);throw new Error("empty")},e.prototype.step=function(){this.direction=0;var t=this.index;if(!(t<this.upper))throw new Error("empty");this.index=t+1},e.prototype.skip=function(t){this.index=Math.min(Math.max(this.lower,this.index+t,this.upper))},e.prototype.hasNext=function(){return this.index<this.upper},e.prototype.nextIndex=function(){return this.index-this.lower},e.prototype.next=function(){this.direction=1;var t=this.index;return t<this.upper?(this.index=t+1,{value:this.record.getItem(t),done:this.index===this.upper}):(this.index=this.upper,{done:!0})},e.prototype.hasPrevious=function(){return this.index>this.lower},e.prototype.previousIndex=function(){return this.index-this.lower-1},e.prototype.previous=function(){this.direction=-1;var t=this.index-1;return t>=this.lower?(this.index=t,{value:this.record.getItem(t),done:t===this.lower}):(this.index=0,{done:!0})},e.prototype.set=function(t){this.direction>0?this.record.setItem(this.index-1,t):this.record.setItem(this.index,t)},e.prototype.delete=function(){var t=this.index;this.direction>0&&(t-=1,this.index=t),this.record.splice(t,1),this.direction=0},e}(M),pr=function(t){function r(e,r,n,i,o){var s=t.call(this)||this;return s.array=e,s.table=r,Object.defineProperty(s,"length",{value:n,writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(s,"fieldCount",{value:i,writable:!0,enumerable:!0,configurable:!0}),s.flags=o,s}return P(r,t),r.prototype.isEmpty=function(){return 0===this.length},Object.defineProperty(r.prototype,"valueCount",{get:function(){return this.length-this.fieldCount},enumerable:!1,configurable:!0}),r.prototype.isConstant=function(){for(var t=this.array,e=0,r=this.length;e<r;e+=1)if(!t[e].isConstant())return!1;return!0},Object.defineProperty(r.prototype,"tag",{get:function(){if(this.fieldCount>0){var t=this.array[0];if(t instanceof er)return t.key.value}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"target",{get:function(){for(var t,e,r=!1,n=this.array,i=0,o=this.length;i<o;i+=1){var s=n[i];s instanceof er?r=!0:void 0===t&&s instanceof ir?t=s:(void 0===e&&(e=or.create(),void 0!==t&&e.push(t)),e.push(s))}return void 0===t?ir.extant():void 0===e?t:r?e:this},enumerable:!1,configurable:!0}),r.prototype.head=function(){return this.length>0?this.array[0]:Qe.absent()},r.prototype.tail=function(){var t=this.length;return t>0?new hr(this,1,t):or.empty()},r.prototype.body=function(){var t=this.length;if(t>2)return new hr(this,1,t).branch();if(2===t){var e=this.array[1];return e instanceof ir?e:or.of(e)}return ir.absent()},r.prototype.has=function(t){if(0!==this.fieldCount){t=ir.fromAny(t);var e=this.hashTable(),r=e.length,n=Math.abs(t.hashCode()%r),i=n;do{var o=e[i];if(void 0===o)break;if(o.key.equals(t))return!0;i=(i+1)%r}while(i!==n)}return!1},r.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=Qe.fromAny(t);var r=this.array,n=this.length;for(e<0&&(e=Math.max(0,n+e));e<n;){if(t.equals(r[e]))return e;e+=1}return-1},r.prototype.lastIndexOf=function(t,e){t=Qe.fromAny(t);var r=this.array,n=this.length;for(void 0===e?e=n-1:e<0&&(e=n+e),e=Math.min(e,n-1);e>=0;){if(t.equals(r[e]))return e;e-=1}return-1},r.prototype.get=function(t){if(this.fieldCount>0){t=ir.fromAny(t);var e=this.hashTable(),r=e.length,n=Math.abs(t.hashCode()%r),i=n;do{var o=e[i];if(void 0===o)break;if(o.key.equals(t))return o.value;i=(i+1)%r}while(i!==n)}return ir.absent()},r.prototype.getAttr=function(t){if(this.fieldCount>0){t=lr.fromAny(t);var e=this.hashTable(),r=e.length,n=Math.abs(t.hashCode()%r),i=n;do{var o=e[i];if(void 0===o)break;if(o instanceof er&&o.key.equals(t))return o.value;i=(i+1)%r}while(i!==n)}return ir.absent()},r.prototype.getSlot=function(t){if(this.fieldCount>0){t=ir.fromAny(t);var e=this.hashTable(),r=e.length,n=Math.abs(t.hashCode()%r),i=n;do{var o=e[i];if(void 0===o)break;if(o instanceof $e&&o.key.equals(t))return o.value;i=(i+1)%r}while(i!==n)}return ir.absent()},r.prototype.getField=function(t){if(this.fieldCount>0){t=ir.fromAny(t);var e=this.hashTable(),r=e.length,n=Math.abs(t.hashCode()%r),i=n;do{var o=e[i];if(void 0===o)break;if(o.key.equals(t))return o;i=(i+1)%r}while(i!==n)}},r.prototype.getItem=function(t){t instanceof yr&&(t=t.value);var e=this.length;return t<0&&(t=e+t),t>=0&&t<e?this.array[t]:Qe.absent()},r.prototype.set=function(t,e){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return t=ir.fromAny(t),e=ir.fromAny(e),0!=(this.flags&or.AliasedFlag)?this.fieldCount>0?this.setAliased(t,e):this.pushAliased(new $e(t,e)):this.fieldCount>0?null!==this.table?this.setMutable(t,e):this.updateMutable(t,e):this.pushMutable(new $e(t,e)),this},r.prototype.setAliased=function(t,e){for(var r=this.length,n=this.array,i=new Array(or.expand(r+1)),o=0;o<r;o+=1){var s=n[o];if(s instanceof Je&&s.key.equals(t)){for(i[o]=s.updatedValue(e),o+=1;o<r;)i[o]=n[o],o+=1;return this.array=i,this.table=null,void(this.flags&=~or.AliasedFlag)}i[o]=s}i[r]=new $e(t,e),this.array=i,this.table=null,this.length=r+1,this.fieldCount+=1,this.flags&=~or.AliasedFlag},r.prototype.setMutable=function(t,e){var n=this.table,i=n.length,o=Math.abs(t.hashCode()%i),s=o;do{var u=n[s];if(void 0===u)break;if(u.key.equals(t))return u.isMutable()?void u.setValue(e):void this.updateMutable(t,e);s=(s+1)%i}while(s!==o);var a=new $e(t,e);this.pushMutable(a),r.put(n,a)},r.prototype.updateMutable=function(t,e){for(var n=this.array,i=0,o=this.length;i<o;i+=1){var s=n[i];if(s instanceof Je&&s.key.equals(t))return n[i]=s.updatedValue(e),void(this.table=null)}var u=new $e(t,e);this.pushMutable(u),r.put(this.table,u)},r.prototype.setAttr=function(t,e){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return t=lr.fromAny(t),e=ir.fromAny(e),0!=(this.flags&or.AliasedFlag)?this.fieldCount>0?this.setAttrAliased(t,e):this.pushAliased(new er(t,e)):this.fieldCount>0?null!==this.table?this.setAttrMutable(t,e):this.updateAttrMutable(t,e):this.pushMutable(new er(t,e)),this},r.prototype.setAttrAliased=function(t,e){for(var r=this.length,n=this.array,i=new Array(or.expand(r+1)),o=0;o<r;o+=1){var s=n[o];if(s instanceof Je&&s.key.equals(t)){for(i[o]=new er(t,e),o+=1;o<r;)i[o]=n[o],o+=1;return this.array=i,this.table=null,void(this.flags&=~or.AliasedFlag)}i[o]=s}i[r]=new er(t,e),this.array=i,this.table=null,this.length=r+1,this.fieldCount+=1,this.flags&=~or.AliasedFlag},r.prototype.setAttrMutable=function(t,e){var n=this.table,i=n.length,o=Math.abs(t.hashCode()%i),s=o;do{var u=n[s];if(void 0===u)break;if(u.key.equals(t))return void(u instanceof er&&u.isMutable()?u.setValue(e):this.updateAttrMutable(t,e));s=(s+1)%i}while(s!==o);var a=new er(t,e);this.push(a),r.put(n,a)},r.prototype.updateAttrMutable=function(t,e){for(var n=this.array,i=0,o=this.length;i<o;i+=1){var s=n[i];if(s instanceof Je&&s.key.equals(t))return n[i]=new er(t,e),void(this.table=null)}var u=new er(t,e);this.push(u),r.put(this.table,u)},r.prototype.setSlot=function(t,e){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return t=ir.fromAny(t),e=ir.fromAny(e),0!=(this.flags&or.AliasedFlag)?this.fieldCount>0?this.setSlotAliased(t,e):this.pushAliased(new $e(t,e)):this.fieldCount>0?null!==this.table?this.setSlotMutable(t,e):this.updateSlotMutable(t,e):this.pushMutable(new $e(t,e)),this},r.prototype.setSlotAliased=function(t,e){for(var r=this.length,n=this.array,i=new Array(or.expand(r+1)),o=0;o<r;o+=1){var s=n[o];if(s instanceof Je&&s.key.equals(t)){for(i[o]=new $e(t,e),o+=1;o<r;)i[o]=n[o],o+=1;return this.array=i,this.table=null,void(this.flags&=~or.AliasedFlag)}i[o]=s}i[r]=new $e(t,e),this.array=i,this.table=null,this.length=r+1,this.fieldCount+=1,this.flags&=~or.AliasedFlag},r.prototype.setSlotMutable=function(t,e){var n=this.table,i=n.length,o=Math.abs(t.hashCode()%i),s=o;do{var u=n[s];if(void 0===u)break;if(u.key.equals(t))return void(u instanceof $e&&u.isMutable()?u.setValue(e):this.updateSlotMutable(t,e));s=(s+1)%i}while(s!==o);var a=new $e(t,e);this.push(a),r.put(n,a)},r.prototype.updateSlotMutable=function(t,e){for(var n=this.array,i=0,o=this.length;i<o;i+=1){var s=n[i];if(s instanceof Je&&s.key.equals(t))return n[i]=new $e(t,e),void(this.table=null)}var u=new $e(t,e);this.push(u),r.put(this.table,u)},r.prototype.setItem=function(t,e){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");e=Qe.fromAny(e);var r=this.length;if(t<0&&(t=r+t),t<0||t>r)throw new RangeError(""+t);return 0!=(this.flags&or.AliasedFlag)?this.setItemAliased(t,e):this.setItemMutable(t,e),this},r.prototype.setItemAliased=function(t,e){for(var r=this.length,n=this.array,i=new Array(or.expand(r)),o=0;o<r;o+=1)i[o]=n[o];var s=n[t];i[t]=e,this.array=i,this.table=null,e instanceof Je?s instanceof Je||(this.fieldCount+=1):s instanceof Je&&(this.fieldCount-=1),this.flags&=~or.AliasedFlag},r.prototype.setItemMutable=function(t,e){var r=this.array,n=r[t];r[t]=e,e instanceof Je?(this.table=null,n instanceof Je||(this.fieldCount+=1)):n instanceof Je&&(this.table=null,this.fieldCount-=1)},r.prototype.updated=function(t,e){t=ir.fromAny(t),e=ir.fromAny(e);var r=0==(this.flags&or.ImmutableFlag)?this:this.branch();return 0!=(r.flags&or.AliasedFlag)?r.fieldCount>0?r.setAliased(t,e):r.pushAliased(new $e(t,e)):r.fieldCount>0?null!==r.table?r.setMutable(t,e):r.updateMutable(t,e):r.pushMutable(new $e(t,e)),r},r.prototype.updatedAttr=function(t,e){t=lr.fromAny(t),e=ir.fromAny(e);var r=0==(this.flags&or.ImmutableFlag)?this:this.branch();return 0!=(r.flags&or.AliasedFlag)?r.fieldCount>0?r.setAttrAliased(t,e):r.pushAliased(new er(t,e)):r.fieldCount>0?null!==r.table?r.setAttrMutable(t,e):r.updateAttrMutable(t,e):r.pushMutable(new er(t,e)),r},r.prototype.updatedSlot=function(t,e){t=ir.fromAny(t),e=ir.fromAny(e);var r=0==(this.flags&or.ImmutableFlag)?this:this.branch();return 0!=(r.flags&or.AliasedFlag)?r.fieldCount>0?r.setSlotAliased(t,e):r.pushAliased(new $e(t,e)):r.fieldCount>0?null!==r.table?r.setSlotMutable(t,e):r.updateSlotMutable(t,e):r.pushMutable(new $e(t,e)),r},r.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return 0!=(this.flags&or.AliasedFlag)?this.pushAliased.apply(this,t):this.pushMutable.apply(this,t),this.length},r.prototype.pushAliased=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t.length,n=this.length,i=this.fieldCount,o=this.array,s=new Array(or.expand(n+r));if(null!==o)for(var u=0;u<n;u+=1)s[u]=o[u];for(u=0;u<r;u+=1){var a=Qe.fromAny(t[u]);s[n]=a,n+=1,a instanceof Je&&(i+=1)}this.array=s,this.table=null,this.length=n,this.fieldCount=i,this.flags&=~or.AliasedFlag},r.prototype.pushMutable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r,n=t.length,i=this.length,o=this.fieldCount,s=this.array;if(null===s||i+n>s.length){if(r=new Array(or.expand(i+n)),null!==s)for(var u=0;u<i;u+=1)r[u]=s[u]}else r=s;for(u=0;u<n;u+=1){var a=Qe.fromAny(t[u]);r[i]=a,i+=1,a instanceof Je&&(o+=1,this.table=null)}this.array=r,this.length=i,this.fieldCount=o},r.prototype.splice=function(t,e){void 0===e&&(e=0);for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");var i=this.length;return t<0&&(t=i+t),t=Math.min(Math.max(0,t),i),e=Math.min(Math.max(0,e),i-t),0!=(this.flags&or.AliasedFlag)?this.spliceAliased.apply(this,k([t,e],r,!1)):this.spliceMutable.apply(this,k([t,e],r,!1))},r.prototype.spliceAliased=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];for(var i=r.length,o=this.length,s=this.fieldCount,u=this.array,a=new Array(or.expand(o-e+i)),p=0;p<t;p+=1)a[p]=u[p];var h=[];for(p=t;p<t+e;p+=1){var f=u[p];h.push(f),o-=1,f instanceof Je&&(s-=1)}for(p=t;p<o;p+=1)a[p+i]=u[p+e];for(p=0;p<i;p+=1){var c=Qe.fromAny(r[p]);a[p+t]=c,o+=1,c instanceof Je&&(s+=1)}return this.array=a,this.table=null,this.length=o,this.fieldCount=s,this.flags&=~or.AliasedFlag,h},r.prototype.spliceMutable=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i,o=r.length,s=this.length,u=this.fieldCount,a=this.array;if(null===a||s-e+o>a.length){if(i=new Array(or.expand(s-e+o)),null!==a)for(var p=0;p<t;p+=1)i[p]=a[p]}else i=a;var h=[];for(p=t;p<t+e;p+=1){var f=a[p];h.push(f),s-=1,f instanceof Je&&(u-=1)}if(o>e)for(p=s-1;p>=t;p-=1)i[p+o]=a[p+e];else for(p=t;p<s;p+=1)i[p+o]=a[p+e];for(p=0;p<o;p+=1){var c=Qe.fromAny(r[p]);i[p+t]=c,s+=1,c instanceof Je&&(u+=1)}return this.array=i,this.length=s,this.fieldCount=u,h},r.prototype.delete=function(t){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");return t=ir.fromAny(t),0!=(this.flags&or.AliasedFlag)?this.deleteAliased(t):this.deleteMutable(t)},r.prototype.deleteAliased=function(t){for(var e=this.length,r=this.array,n=new Array(or.expand(e)),i=0;i<e;i+=1){var o=r[i];if(o instanceof Je&&o.key.equals(t)){for(var s=i+1;s<e;s+=1,i+=1)n[i]=r[s];return this.array=n,this.table=null,this.length=e-1,this.fieldCount-=1,this.flags&=~or.AliasedFlag,o}n[i]=o}return Qe.absent()},r.prototype.deleteMutable=function(t){for(var e=this.length,r=this.array,n=0;n<e;n+=1){var i=r[n];if(i instanceof Je&&i.key.equals(t)){for(var o=n+1;o<e;o+=1,n+=1)r[n]=r[o];return r[e-1]=void 0,this.table=null,this.length=e-1,this.fieldCount-=1,i}}return Qe.absent()},r.prototype.clear=function(){if(0!=(this.flags&or.ImmutableFlag))throw new Error("immutable");this.array=null,this.table=null,this.length=0,this.fieldCount=0,this.flags=0},r.prototype.isAliased=function(){return 0!=(this.flags&or.AliasedFlag)},r.prototype.isMutable=function(){return 0==(this.flags&or.ImmutableFlag)},r.prototype.alias=function(){this.flags|=or.AliasedFlag},r.prototype.branch=function(){if(0==(this.flags&(or.AliasedFlag|or.ImmutableFlag)))for(var t=this.array,e=0,n=this.length;e<n;e+=1)t[e].alias();return this.flags|=or.AliasedFlag,new r(this.array,this.table,this.length,this.fieldCount,or.AliasedFlag)},r.prototype.clone=function(){for(var t=this.length,e=this.array,n=new Array(t),i=0;i<t;i+=1)n[i]=e[i].clone();return new r(n,null,t,this.fieldCount,0)},r.prototype.commit=function(){if(0==(this.flags&or.ImmutableFlag)){this.flags|=or.ImmutableFlag;for(var t=this.array,e=0,r=this.length;e<r;e+=1)t[e].commit()}return this},r.prototype.hashTable=function(){var t=this.fieldCount,e=this.table;if(0!==t&&null===e){e=new Array(or.expand(Math.max(t,10*t/7)));for(var n=this.array,i=0,o=this.length;i<o;i+=1){var s=n[i];s instanceof Je&&r.put(e,s)}this.table=e}return e},r.put=function(t,e){if(null!==t){var r=t.length,n=Math.abs(e.key.hashCode()%r),i=n;do{var o=t[i];if(void 0===o)return void(t[i]=e);if(e.key.equals(o.key))return void(t[i]=e);i=(i+1)%r}while(i!==n);throw new Error}},r.prototype.evaluate=function(t){t=Dr.fromAny(t);var e=this.array,r=this.length,n=or.create(r);t.pushScope(n);for(var i=!1,o=0;o<r;o+=1){var s=e[o],u=s.evaluate(t);u.isDefined()&&n.push(u),s!==u&&(i=!0)}return t.popScope(),i?n:this},r.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.array,r=this.length,n=or.create(r);t.pushScope(n);for(var i=!1,o=0;o<r;o+=1){var s=e[o],u=s.substitute(t);u.isDefined()&&n.push(u),s!==u&&(i=!0)}return t.popScope(),i?n:this},r.prototype.subRecord=function(t,e){var r=this.length;if(void 0===t?t=0:t<0&&(t=r+t),void 0===e?e=r:e<0&&(e=r+e),t<0||e>r||t>e)throw new RangeError(t+", "+e);return new hr(this,t,e)},r.prototype.forEach=function(t,e){for(var r=this.array,n=0,i=this.length;n<i;n+=1){var o=t.call(e,r[n],n);if(void 0!==o)return o}},r.empty=function(){return new r(null,null,0,0,or.AliasedFlag|or.ImmutableFlag)},r.create=function(t){return void 0===t?new r(null,null,0,0,or.AliasedFlag):new r(new Array(t),null,0,0,0)},r.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(0===n)return new r(null,null,0,0,or.AliasedFlag);for(var i=new Array(n),o=0,s=0,u=0;u<n;u+=1){var a=Qe.fromAny(t[u]);i[u]=a,o+=1,a instanceof Je&&(s+=1)}return new r(i,null,o,s,0)},S([e],r,"empty",null),r}(or),hr=function(t){function e(e,r,n){var i=t.call(this)||this;return i.record=e,i.lower=r,i.upper=n,i}return P(e,t),e.prototype.isEmpty=function(){return this.lower===this.upper},e.prototype.isArray=function(){for(var t=this.record.array,e=this.lower,r=this.upper;e<r;e+=1)if(t[e]instanceof Je)return!1;return!0},e.prototype.isObject=function(){for(var t=this.record.array,e=this.lower,r=this.upper;e<r;e+=1)if(t[e]instanceof ir)return!1;return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this.upper-this.lower},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){for(var t=0,e=this.record.array,r=this.lower,n=this.upper;r<n;r+=1)e[r]instanceof ir&&(t+=1);return t},enumerable:!1,configurable:!0}),e.prototype.isConstant=function(){for(var t=this.record.array,e=this.lower,r=this.upper;e<r;e+=1)if(!t[e].isConstant())return!1;return!0},Object.defineProperty(e.prototype,"tag",{get:function(){if(this.length>0){var t=this.record.array[this.lower];if(t instanceof er)return t.key.value}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){for(var t,e,r=!1,n=this.record.array,i=this.lower,o=this.upper;i<o;i+=1){var s=n[i];s instanceof er?r=!0:void 0===t&&s instanceof ir?t=s:(void 0===e&&(e=or.create(),void 0!==t&&e.push(t)),e.push(s))}return void 0===t?ir.extant():void 0===e?t:r?e:this},enumerable:!1,configurable:!0}),e.prototype.head=function(){return this.length>0?this.record.array[this.lower]:Qe.absent()},e.prototype.tail=function(){return this.length>0?new e(this.record,this.lower+1,this.upper):or.empty()},e.prototype.body=function(){var t=this.length;if(t>2)return new e(this.record,this.lower+1,this.upper).branch();if(2===t){var r=this.record.array[this.lower+1];return r instanceof ir?r:or.of(r)}return ir.absent()},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=Qe.fromAny(t);var r=this.record.array,n=this.length;for(e<0&&(e=Math.max(0,n+e)),e=this.lower+e;e<this.upper;){if(t.equals(r[e]))return e-this.lower;e+=1}return-1},e.prototype.lastIndexOf=function(t,e){t=Qe.fromAny(t);var r=this.record.array,n=this.length;for(void 0===e?e=n-1:e<0&&(e=n+e),e=this.lower+Math.min(e,n-1);e>=this.lower;){if(t.equals(r[e]))return e-this.lower;e-=1}return-1},e.prototype.getItem=function(t){t instanceof yr&&(t=t.value);var e=this.length;return t<0&&(t=e+t),t>=0&&t<e?this.record.array[this.lower+t]:Qe.absent()},e.prototype.setItem=function(t,e){if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");e=Qe.fromAny(e);var r=this.length;if(t<0&&(t=r+t),t<0||t>r)throw new RangeError(""+t);return 0!=(this.record.flags&or.AliasedFlag)?this.setItemAliased(t,e):this.setItemMutable(t,e),this},e.prototype.setItemAliased=function(t,e){for(var r=this.record,n=r.length,i=r.array,o=new Array(or.expand(n)),s=0;s<n;s+=1)o[s]=i[s];var u=null!==i?i[this.lower+t]:null;o[this.lower+t]=e,r.array=o,r.table=null,e instanceof Je?u instanceof Je||(r.fieldCount+=1):u instanceof Je&&(r.fieldCount-=1),r.flags&=~or.AliasedFlag},e.prototype.setItemMutable=function(t,e){var r=this.record,n=r.array,i=n[this.lower+t];n[this.lower+t]=e,e instanceof Je?(r.table=null,i instanceof Je||(r.fieldCount+=1)):i instanceof Je&&(r.table=null,r.fieldCount-=1)},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");return 0!=(this.record.flags&or.AliasedFlag)?this.pushAliased.apply(this,t):this.pushMutable.apply(this,t),this.length},e.prototype.pushAliased=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.record,n=t.length,i=r.length,o=r.fieldCount,s=r.array,u=new Array(or.expand(i+n));if(null!==s){for(var a=0;a<this.upper;a+=1)u[a]=s[a];for(a=this.upper;a<i;a+=1)u[a+n]=s[a]}for(a=0;a<n;a+=1){var p=Qe.fromAny(t[a]);u[a+this.upper]=p,i+=1,p instanceof Je&&(o+=1)}r.array=u,r.table=null,r.length=i,r.fieldCount=o,r.flags&=~or.AliasedFlag,this.upper+=n},e.prototype.pushMutable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r,n=this.record,i=t.length,o=n.length,s=n.fieldCount,u=n.array;if(null===u||o+i>u.length){if(r=new Array(or.expand(o+i)),null!==u)for(var a=0;a<this.upper;a+=1)r[a]=u[a]}else r=u;for(a=o-1;a>=this.upper;a-=1)r[a+i]=u[a];for(a=0;a<i;a+=1){var p=Qe.fromAny(t[a]);r[a+this.upper]=p,o+=1,p instanceof Je&&(s+=1,n.table=null)}n.array=r,n.length=o,n.fieldCount=s,this.upper+=i},e.prototype.splice=function(t,e){var r,n;void 0===e&&(e=0);for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");var s,u=this.length;return t<0&&(t=u+t),t=Math.min(Math.max(0,t),u),e=Math.min(Math.max(0,e),u-t),s=0!=(this.record.flags&or.AliasedFlag)?(r=this.record).spliceAliased.apply(r,k([this.lower+t,e],i,!1)):(n=this.record).spliceMutable.apply(n,k([this.lower+t,e],i,!1)),this.upper+=i.length-s.length,s},e.prototype.delete=function(t){if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");return t=ir.fromAny(t),0!=(this.record.flags&or.AliasedFlag)?this.deleteAliased(t):this.deleteMutable(t)},e.prototype.deleteAliased=function(t){for(var e=this.record,r=e.length,n=e.array,i=new Array(or.expand(r)),o=this.lower;o<this.upper;o+=1){var s=n[o];if(s instanceof Je&&s.key.equals(t)){for(var u=o+1;u<r;u+=1,o+=1)i[o]=n[u];return e.array=i,e.table=null,e.length=r-1,e.fieldCount-=1,e.flags&=~or.AliasedFlag,this.upper-=1,s}i[o]=s}return Qe.absent()},e.prototype.deleteMutable=function(t){for(var e=this.record,r=e.length,n=e.array,i=this.lower;i<this.upper;i+=1){var o=n[i];if(o instanceof Je&&o.key.equals(t)){for(var s=i+1;s<r;s+=1,i+=1)n[i]=n[s];return n[r-1]=void 0,e.table=null,e.length=r-1,e.fieldCount-=1,this.upper-=1,o}}return Qe.absent()},e.prototype.clear=function(){if(0!=(this.record.flags&or.ImmutableFlag))throw new Error("immutable");0!=(this.record.flags&or.AliasedFlag)?this.clearAliased():this.clearMutable()},e.prototype.clearAliased=function(){for(var t=this.record,e=t.length,r=t.fieldCount,n=e-this.length,i=t.array,o=new Array(or.expand(n)),s=0;s<this.lower;)o[s]=i[s],s+=1;for(;s<this.upper;)i[s]instanceof Je&&(r-=1),s+=1;s=this.lower;for(var u=this.upper;u<e;)o[s]=i[u],s+=1,u+=1;t.array=o,t.table=null,t.length=n,t.fieldCount=r,t.flags&=~or.AliasedFlag,this.upper=this.lower},e.prototype.clearMutable=function(){for(var t=this.record,e=t.length,r=t.fieldCount,n=t.array,i=this.lower;i<this.upper;)n[i]instanceof Je&&(r-=1),i+=1;i=this.lower;for(var o=this.upper;o<e;){var s=n[o];s instanceof Je&&(t.table=null),n[i]=s,i+=1,o+=1}for(t.length=i,t.fieldCount=r;i<e;)n[i]=void 0,i+=1;this.upper=this.lower},e.prototype.isAliased=function(){return 0!=(this.record.flags&or.AliasedFlag)},e.prototype.isMutable=function(){return 0==(this.record.flags&or.ImmutableFlag)},e.prototype.alias=function(){this.record.flags|=or.AliasedFlag},e.prototype.branch=function(){for(var t=this.length,e=0,r=this.record.array,n=new Array(or.expand(t)),i=this.lower,o=0;o<t;){var s=r[i];n[o]=s,s instanceof Je&&(e+=1),i+=1,o+=1}return new pr(n,null,t,e,0)},e.prototype.clone=function(){for(var t=this.length,e=0,r=this.record.array,n=new Array(or.expand(t)),i=this.lower,o=0;o<t;){var s=r[i];n[o]=s.clone(),s instanceof Je&&(e+=1),i+=1,o+=1}return new pr(n,null,t,e,0)},e.prototype.commit=function(){return this.record.commit(),this},e.prototype.subRecord=function(t,r){var n=this.length;if(void 0===t?t=0:t<0&&(t=n+t),void 0===r?r=n:r<0&&(r=n+r),t<0||r>n||t>r)throw new RangeError(t+", "+r);return new e(this.record,this.lower+t,this.upper+r)},e.prototype.forEach=function(t,e){for(var r=this.record.array,n=this.lower,i=this.upper;n<i;n+=1){var o=t.call(e,r[n],n);if(void 0!==o)return o}},e}(or);Object.defineProperty(hr.prototype,"fieldCount",{get:function(){for(var t=this.record.array,e=0,r=this.lower,n=this.upper;r<n;r+=1)t[r]instanceof Je&&(e+=1);return e},enumerable:!0,configurable:!0});var fr=function(t){function r(e,r,n){var i=t.call(this)||this;return i.array=e,i.size=r,i.flags=n,i}return P(r,t),r.prototype.isConstant=function(){return!0},r.prototype.getByte=function(t){if(t<0||t>=this.size)throw new RangeError(""+t);return this.array[t]},r.prototype.setByte=function(t,e){var n=this.flags;if(0!=(n&r.ImmutableFlag))throw new Error("immutable");if(t<0||t>=this.size)throw new RangeError(""+t);return 0!=(n&r.AliasedFlag)?this.setByteAliased(t,e):this.setByteMutable(t,e)},r.prototype.setByteAliased=function(t,e){var n=this.size,i=this.array,o=new Uint8Array(r.expand(n));return o.set(i,0),o[t]=e,this.array=o,this.flags&=~r.AliasedFlag,this},r.prototype.setByteMutable=function(t,e){return this.array[t]=e,this},r.prototype.addByte=function(t){var e=this.flags;if(0!=(e&r.ImmutableFlag))throw new Error("immutable");return 0!=(e&r.AliasedFlag)?this.addByteAliased(t):this.addByteMutable(t)},r.prototype.addByteAliased=function(t){var e=this.size,n=this.array,i=new Uint8Array(r.expand(e+1));return null!==n&&i.set(n,0),i[e]=t,this.array=i,this.size=e+1,this.flags&=~r.AliasedFlag,this},r.prototype.addByteMutable=function(t){var e,n=this.size,i=this.array;return null===i||n+1>i.length?(e=new Uint8Array(r.expand(n+1)),null!==i&&e.set(i,0),this.array=e):e=i,e[n]=t,this.size=n+1,this},r.prototype.addData=function(t){var e=t.array;if(null!==e){var r=t.size;return e.length>r&&(e=e.slice(0,r)),this.addUint8Array(e)}return this},r.prototype.addUint8Array=function(t){var e=this.flags;if(0!=(e&r.ImmutableFlag))throw new Error("immutable");return 0!=(e&r.AliasedFlag)?this.addUint8ArrayAliased(t):this.addUint8ArrayMutable(t)},r.prototype.addUint8ArrayAliased=function(t){var e=t.length;if(0===e)return this;var n=this.size,i=this.array,o=new Uint8Array(r.expand(n+e));return null!==i&&o.set(i,0),o.set(t,n),this.array=o,this.size=n+e,this.flags&=~r.AliasedFlag,this},r.prototype.addUint8ArrayMutable=function(t){var e=t.length;if(0===e)return this;var n,i=this.size,o=this.array;return null===o||i+e>o.length?(n=new Uint8Array(r.expand(i+e)),null!==o&&n.set(o,0),this.array=n):n=o,n.set(t,i),this.size=i+e,this},r.prototype.clear=function(){if(0!=(this.flags&r.ImmutableFlag))throw new Error("immutable");this.array=null,this.size=0,this.flags=r.AliasedFlag},r.prototype.toUint8Array=function(){var t=this.array,e=this.flags;if(0!=(e&r.ImmutableFlag))return null!==t?t.slice(0):new Uint8Array(0);if(0!=(e&r.AliasedFlag)||this.size!==t.length){var n=null!==t?t.slice(0):new Uint8Array(0);return this.array=n,this.flags&=~r.AliasedFlag,n}return t},r.prototype.asUint8Array=function(){var t;return null!==this.array&&this.size>0?(t=this.array).length!==this.size&&(t=new Uint8Array(t.buffer,t.byteOffset,this.size)):t=void 0,t},r.prototype.toAny=function(){return this.toUint8Array()},r.prototype.isAliased=function(){return 0!=(this.flags&r.AliasedFlag)},r.prototype.isMutable=function(){return 0==(this.flags&r.ImmutableFlag)},r.prototype.branch=function(){return this.flags|=r.AliasedFlag,new r(this.array,this.size,r.AliasedFlag)},r.prototype.clone=function(){return this.branch()},r.prototype.commit=function(){return this.flags|=r.ImmutableFlag,this},r.prototype.writeBase16=function(t,e){void 0===e&&(e=jt.uppercase);var r=this.array,n=this.size;return null!==r&&0!==n?(r.length!==n&&(r=r.slice(0,n)),e.writeUint8Array(t,r)):tt.end()},r.prototype.toBase16=function(t){void 0===t&&(t=jt.uppercase);var e=rt.stringOutput();return this.writeBase16(e,t).bind(),e.bind()},r.prototype.writeBase64=function(t,e){void 0===e&&(e=Wt.standard());var r=this.array,n=this.size;return null!==r&&0!==n?(r.length!==n&&(r=r.slice(0,n)),e.writeUint8Array(t,r)):tt.end()},r.prototype.toBase64=function(t){void 0===t&&(t=Wt.standard());var e=rt.stringOutput();return this.writeBase64(e,t),e.bind()},r.prototype.interpolateTo=function(e){return t.prototype.interpolateTo.call(this,e)},Object.defineProperty(r.prototype,"typeOrder",{get:function(){return 4},enumerable:!1,configurable:!0}),r.prototype.compareTo=function(t){if(t instanceof r){var e=this.array,n=t.array,i=this.size,o=t.size,s=0,u=0;do{if(!(u<i&&u<o))break;s=e[u]-n[u],u+=1}while(0===s);return s>0?1:s<0?-1:i>o?1:i<o?-1:0}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},r.prototype.equivalentTo=function(t){return this.equals(t)},r.prototype.equals=function(t){if(this===t)return!0;if(t instanceof r){var e=this.array,n=t.array,i=this.size;if(i!==t.size)return!1;for(var o=0;o<i;o+=1)if(e[o]!==n[o])return!1;return!0}return!1},r.prototype.hashCode=function(){return f.mash(f.mixUint8Array(b.hash(r),null!==this.array?this.array:new Uint8Array(0)))},r.prototype.debug=function(t){if(t=t.write("Data").write(46),0===this.size)t=t.write("empty").write(40).write(41);else{t=t.write("base16").write(40).write(34);var e=this.writeBase16(t);if(!e.isDone())return Z.error(e.trap());t=t.write(34).write(41)}return t},r.empty=function(){return new r(null,0,r.AliasedFlag|r.ImmutableFlag)},r.create=function(t){return void 0===t?new r(null,0,r.AliasedFlag):new r(new Uint8Array(t),0,0)},r.wrap=function(t){return new r(t,t.length,r.AliasedFlag)},r.fromBase16=function(t){return"string"==typeof t&&(t=rt.stringInput(t)),jt.parse(t,r.output()).bind()},r.fromBase64=function(t,e){return void 0===e&&(e=Wt.standard()),"string"==typeof t&&(t=rt.stringInput(t)),e.parse(t,r.output()).bind()},r.fromAny=function(t){if(t instanceof r)return t;if(t instanceof Uint8Array)return r.wrap(t);throw new TypeError(""+t)},r.random=function(t){var e=new Uint8Array(t);return a.fillBytes(e),r.wrap(e)},r.output=function(t){return t instanceof r||(t=r.create(t)),new cr(t,W.standard())},r.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},r.AliasedFlag=1,r.ImmutableFlag=2,S([e],r,"empty",null),r}(ir),cr=function(t){function e(e,r){var n=t.call(this)||this;return n.data=e,n.settings=r,n}return P(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},e.prototype.write=function(t){if("number"==typeof t)return this.data.addByte(t),this;throw new TypeError(""+t)},e.prototype.writeln=function(t){throw new TypeError(""+t)},e.prototype.withSettings=function(t){return t=W.fromAny(t),this.settings=t,this},e.prototype.bind=function(){return this.data},e.prototype.clone=function(){return new e(this.data.branch(),this.settings)},e}(Z),lr=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r.hashValue=void 0,r}return P(r,t),r.prototype.isConstant=function(){return!0},Object.defineProperty(r.prototype,"size",{get:function(){return this.value.length},enumerable:!1,configurable:!0}),r.prototype.stringValue=function(t){return this.value},r.prototype.numberValue=function(t){try{return yr.parse(this.value).numberValue()}catch(e){return t}},r.prototype.booleanValue=function(t){return"true"===this.value||"false"!==this.value&&t},r.prototype.toAny=function(){return this.value},r.prototype.valueOf=function(){return this.value},r.prototype.plus=function(e){return(e=Qe.fromAny(e))instanceof r?r.from(this.value+e.value):t.prototype.plus.call(this,e)},r.prototype.branch=function(){return this},r.prototype.clone=function(){return this},r.prototype.commit=function(){return this},r.prototype.interpolateTo=function(e){return t.prototype.interpolateTo.call(this,e)},Object.defineProperty(r.prototype,"typeOrder",{get:function(){return 5},enumerable:!1,configurable:!0}),r.prototype.compareTo=function(t){return t instanceof r?this.value.localeCompare(t.value):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},r.prototype.equivalentTo=function(t){return this.equals(t)},r.prototype.equals=function(t){return this===t||t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){var t=this.hashValue;return void 0===t&&(t=w.hash(this.value),this.hashValue=t),t},r.prototype.debug=function(t){return t=t.write("Text").write(46),t=0===this.value.length?t.write("empty").write(40).write(41):t.write("from").write(40).debug(this.value).write(41)},r.prototype.display=function(t){return nt.debugAny(t,this.value)},r.prototype.toString=function(){return this.value},r.empty=function(){return new r("")},r.from=function(t){var e=t.length;if(0===e)return r.empty();var n=new r(t);return e<=64&&(n=r.cache.put(n)),n},r.fromAny=function(t){if(t instanceof r)return t;if("string"==typeof t)return r.from(t);throw new TypeError(""+t)},r.output=function(t){return void 0===t&&(t=W.standard()),new dr("",t)},Object.defineProperty(r,"cache",{get:function(){return new N(128)},enumerable:!1,configurable:!0}),S([e],r,"empty",null),S([e],r,"cache",null),r}(ir),dr=function(t){function e(e,r){var n=t.call(this)||this;return n.string=e,n.settings=r,n}return P(e,t),e.prototype.isCont=function(){return!0},e.prototype.isFull=function(){return!1},e.prototype.isDone=function(){return!1},e.prototype.isError=function(){return!1},e.prototype.isPart=function(){return!1},e.prototype.asPart=function(t){return this},e.prototype.write=function(t){if("number"==typeof t)if(t>=0&&t<=55295||t>=57344&&t<=65535)t=String.fromCharCode(t);else if(t>=65536&&t<=1114111){var e=t-65536;t=String.fromCharCode(55296|e>>>10,56320|1023&e)}else t="ï¿½";return this.string+=t,this},e.prototype.withSettings=function(t){return t=W.fromAny(t),this.settings=t,this},e.prototype.bind=function(){return lr.from(this.string)},e.prototype.clone=function(){return new e(this.string,this.settings)},e.prototype.toString=function(){return this.string},e}(Z),yr=function(t){function r(e,r){var n=t.call(this)||this;return n.value=e,n.flags=void 0!==r?r:0,n}return P(r,t),r.prototype.isConstant=function(){return!0},r.prototype.isNaN=function(){return isNaN(this.value)},r.prototype.isInfinite=function(){return!isNaN(this.value)&&!isFinite(this.value)},r.prototype.isUint32=function(){return 0!=(this.flags&r.Uint32Flag)},r.prototype.isUint64=function(){return 0!=(this.flags&r.Uint64Flag)},r.prototype.stringValue=function(t){return""+this.value},r.prototype.numberValue=function(t){return this.value},r.prototype.booleanValue=function(t){return!!this.value},r.prototype.toAny=function(){return this.value},r.prototype.valueOf=function(){return this.value},r.prototype.bitwiseOr=function(e){return(e=Qe.fromAny(e))instanceof r?r.from((this.value|e.value)>>>0):t.prototype.bitwiseOr.call(this,e)},r.prototype.bitwiseXor=function(e){return(e=Qe.fromAny(e))instanceof r?r.from((this.value^e.value)>>>0):t.prototype.bitwiseXor.call(this,e)},r.prototype.bitwiseAnd=function(e){return(e=Qe.fromAny(e))instanceof r?r.from((this.value&e.value)>>>0):t.prototype.bitwiseAnd.call(this,e)},r.prototype.plus=function(e){return(e=Qe.fromAny(e))instanceof r?r.from(this.value+e.value):t.prototype.plus.call(this,e)},r.prototype.minus=function(e){return(e=Qe.fromAny(e))instanceof r?r.from(this.value-e.value):t.prototype.minus.call(this,e)},r.prototype.times=function(e){return(e=Qe.fromAny(e))instanceof r?r.from(this.value*e.value):t.prototype.times.call(this,e)},r.prototype.divide=function(e){return(e=Qe.fromAny(e))instanceof r?r.from(this.value/e.value):t.prototype.divide.call(this,e)},r.prototype.modulo=function(e){return(e=Qe.fromAny(e))instanceof r?r.from(this.value%e.value):t.prototype.modulo.call(this,e)},r.prototype.bitwiseNot=function(){return r.from(~this.value>>>0)},r.prototype.negative=function(){return r.from(-this.value)},r.prototype.positive=function(){return this},r.prototype.inverse=function(){return r.from(1/this.value)},r.prototype.abs=function(){return r.from(Math.abs(this.value))},r.prototype.ceil=function(){return r.from(Math.ceil(this.value))},r.prototype.floor=function(){return r.from(Math.floor(this.value))},r.prototype.round=function(){return r.from(Math.round(this.value))},r.prototype.sqrt=function(){return r.from(Math.sqrt(this.value))},r.prototype.pow=function(t){return t=r.fromAny(t),r.from(Math.pow(this.value,t.value))},r.prototype.max=function(t){return this.compareTo(t)>=0?this:t},r.prototype.min=function(t){return this.compareTo(t)<=0?this:t},r.prototype.interpolateTo=function(e){return e instanceof r?vr(this,e):t.prototype.interpolateTo.call(this,e)},Object.defineProperty(r.prototype,"typeOrder",{get:function(){return 6},enumerable:!1,configurable:!0}),r.prototype.compareTo=function(t){if(t instanceof r){var e=this.value,n=t.value;return e<n?-1:e>n?1:isNaN(n)?isNaN(e)?0:-1:isNaN(e)?1:0}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},r.prototype.equivalentTo=function(t,e){if(this===t)return!0;if(t instanceof r){var n=this.value,o=t.value;return n===o||isNaN(n)&&isNaN(o)||Math.abs(o-n)<(void 0!==e?e:i.Epsilon)}return!1},r.prototype.equals=function(t){if(this===t)return!0;if(t instanceof r){var e=this.value,n=t.value;return e===n||isNaN(e)&&isNaN(n)}return!1},r.prototype.hashCode=function(){return m.hash(this.value)},r.prototype.debug=function(t){return t=t.write("Num").write(46).write("from").write(40).display(this).write(41)},r.prototype.display=function(t){return nt.displayNumber(t,this.value)},Object.defineProperty(r,"zero",{get:function(){return new r(0)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"negativeZero",{get:function(){return new r(-0)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"one",{get:function(){return new r(1)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"negativeOne",{get:function(){return new r(-1)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"nan",{get:function(){return new r(NaN)},enumerable:!1,configurable:!0}),r.uint32=function(t){return new r(t,r.Uint32Flag)},r.uint64=function(t){return new r(t,r.Uint64Flag)},r.from=function(t){return 0===t?1/t==-1/0?r.negativeZero:r.zero:1===t?r.one:-1===t?r.negativeOne:isNaN(t)?r.nan:r.cache.put(new r(t))},r.fromAny=function(t){if(t instanceof r)return t;if("number"==typeof t)return r.from(t);throw new TypeError(""+t)},r.parse=function(t){if("NaN"===t)return r.nan;var e=+t;if(isFinite(e))return r.from(e);throw new Error(t)},Object.defineProperty(r,"cache",{get:function(){return new N(128)},enumerable:!1,configurable:!0}),r.Uint32Flag=1,r.Uint64Flag=2,r.TypeMask=3,S([e],r,"zero",null),S([e],r,"negativeZero",null),S([e],r,"one",null),S([e],r,"negativeOne",null),S([e],r,"nan",null),S([e],r,"cache",null),r}(ir),vr=function(t,e){var r=function(t){var e=r[0].value,n=r[1].value;return yr.from(e+t*(n-e))};return Object.setPrototypeOf(r,vr.prototype),r[0]=t,r[1]=e,r};vr.prototype=Object.create($t.prototype);var mr=function(t){function r(e){var r=t.call(this)||this;return Object.defineProperty(r,"value",{value:e,enumerable:!0}),Object.defineProperty(r,"hashValue",{value:w.hash(e?"true":"false"),enumerable:!0}),r}return P(r,t),r.prototype.isDefinite=function(){return this.value},r.prototype.isConstant=function(){return!0},r.prototype.stringValue=function(t){return this.value?"true":"false"},r.prototype.booleanValue=function(t){return this.value},r.prototype.toAny=function(){return this.value},r.prototype.valueOf=function(){return this.value},r.prototype.conditional=function(t,e){return this.value?Qe.fromAny(t):Qe.fromAny(e)},r.prototype.or=function(t){return this.value?this:Qe.fromAny(t)},r.prototype.and=function(t){return this.value?Qe.fromAny(t):this},r.prototype.not=function(){return r.from(!this.value)},Object.defineProperty(r.prototype,"typeOrder",{get:function(){return 7},enumerable:!1,configurable:!0}),r.prototype.compareTo=function(t){return t instanceof r?this.value&&!t.value?-1:!this.value&&t.value?1:0:t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},r.prototype.equivalentTo=function(t){return this.equals(t)},r.prototype.equals=function(t){return this===t||t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return this.hashValue},r.prototype.debug=function(t){return t=t.write("Bool").write(46).write("from").write(40).write(this.value?"true":"false").write(41)},r.prototype.display=function(t){return t=t.write(this.value?"true":"false")},Object.defineProperty(r,"true",{get:function(){return new r(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(r,"false",{get:function(){return new r(!1)},enumerable:!1,configurable:!0}),r.from=function(t){return t?r.true:r.false},r.fromAny=function(t){if(t instanceof r)return t;if("boolean"==typeof t)return r.from(t);throw new TypeError(""+t)},S([e],r,"true",null),S([e],r,"false",null),r}(ir),wr=function(t){function r(){return t.call(this)||this}return P(r,t),r.prototype.isDefined=function(){return!0},r.prototype.isDistinct=function(){return!1},r.prototype.isDefinite=function(){return!1},r.prototype.isConstant=function(){return!0},r.prototype.unflattened=function(){return or.empty()},r.prototype.not=function(){return ir.absent()},r.prototype.stringValue=function(t){return""},r.prototype.booleanValue=function(t){return!0},r.prototype.toAny=function(){return null},r.prototype.interpolateTo=function(e){return t.prototype.interpolateTo.call(this,e)},Object.defineProperty(r.prototype,"typeOrder",{get:function(){return 98},enumerable:!1,configurable:!0}),r.prototype.compareTo=function(t){return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},r.prototype.equivalentTo=function(t){return this===t},r.prototype.equals=function(t){return this===t},r.prototype.hashCode=function(){return b.hash(r)},r.prototype.debug=function(t){return t=t.write("Value").write(46).write("extant").write(40).write(41)},r.prototype.display=function(t){return t=t.write("null")},r.extant=function(){return new r},r.fromAny=function(t){if(t instanceof r)return t;if(null===t)return r.extant();throw new TypeError(""+t)},S([e],r,"extant",null),r}(ir),gr=function(t){function r(){return t.call(this)||this}return P(r,t),r.prototype.isDefined=function(){return!1},r.prototype.isDistinct=function(){return!1},r.prototype.isDefinite=function(){return!1},r.prototype.isConstant=function(){return!0},r.prototype.unflattened=function(){return or.empty()},r.prototype.updated=function(t,e){return or.of($e.of(t,e))},r.prototype.updatedAttr=function(t,e){return or.of(er.of(t,e))},r.prototype.updatedSlot=function(t,e){return or.of($e.of(t,e))},r.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return or.of(t)},r.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return or.of(t)},r.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=or.create(),n=0,i=t.length;n<i;n+=1)Qe.fromAny(t[n]).forEach((function(t){r.push(t)}));return r},r.prototype.conditional=function(t,e){return Qe.fromAny(e)},r.prototype.or=function(t){return Qe.fromAny(t)},r.prototype.and=function(t){return this},r.prototype.not=function(){return ir.extant()},r.prototype.booleanValue=function(t){return!1},r.prototype.toAny=function(){},r.prototype.forEach=function(t,e){},r.prototype.iterator=function(){return M.empty()},r.prototype.interpolateTo=function(e){return t.prototype.interpolateTo.call(this,e)},Object.defineProperty(r.prototype,"typeOrder",{get:function(){return 99},enumerable:!1,configurable:!0}),r.prototype.compareTo=function(t){return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},r.prototype.equivalentTo=function(t){return this===t},r.prototype.equals=function(t){return this===t},r.prototype.hashCode=function(){return b.hash(r)},r.prototype.debug=function(t){return t=t.write("Value").write(46).write("absent").write(40).write(41)},r.prototype.display=function(t){return t=t.write("undefined")},r.absent=function(){return new r},r.fromAny=function(t){if(t instanceof r)return t;if(void 0===t)return r.absent();throw new TypeError(""+t)},S([e],r,"absent",null),r}(ir),br=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.conditional=function(t,e){return t=Qe.fromAny(t),e=Qe.fromAny(e),new Sr(this,t,e)},e.prototype.or=function(t){return t=Qe.fromAny(t),new Ir(this,t)},e.prototype.and=function(t){return t=Qe.fromAny(t),new Tr(this,t)},e.prototype.bitwiseOr=function(t){return t=Qe.fromAny(t),new Vr(this,t)},e.prototype.bitwiseXor=function(t){return t=Qe.fromAny(t),new jr(this,t)},e.prototype.bitwiseAnd=function(t){return t=Qe.fromAny(t),new qr(this,t)},e.prototype.lt=function(t){return t=Qe.fromAny(t),new Rr(this,t)},e.prototype.le=function(t){return t=Qe.fromAny(t),new Ur(this,t)},e.prototype.eq=function(t){return t=Qe.fromAny(t),new Nr(this,t)},e.prototype.ne=function(t){return t=Qe.fromAny(t),new zr(this,t)},e.prototype.ge=function(t){return t=Qe.fromAny(t),new Fr(this,t)},e.prototype.gt=function(t){return t=Qe.fromAny(t),new Lr(this,t)},e.prototype.plus=function(t){return t=Qe.fromAny(t),new Kr(this,t)},e.prototype.minus=function(t){return t=Qe.fromAny(t),new Br(this,t)},e.prototype.times=function(t){return t=Qe.fromAny(t),new Wr(this,t)},e.prototype.divide=function(t){return t=Qe.fromAny(t),new Hr(this,t)},e.prototype.modulo=function(t){return t=Qe.fromAny(t),new Xr(this,t)},e.prototype.not=function(){return new Yr(this)},e.prototype.bitwiseNot=function(){return new Gr(this)},e.prototype.negative=function(){return new _r(this)},e.prototype.positive=function(){return new Qr(this)},e.prototype.inverse=function(){return new Hr(yr.one,this)},e.prototype.toAny=function(){return this},e}(ir),xr=function(t){function e(){return t.call(this)||this}return P(e,t),e.binary=function(t,e,r){switch(e){case"||":return new Ir(t,r);case"&&":return new Tr(t,r);case"|":return new Vr(t,r);case"^":return new jr(t,r);case"&":return new qr(t,r);case"<":return new Rr(t,r);case"<=":return new Ur(t,r);case"==":return new Nr(t,r);case"!=":return new zr(t,r);case">=":return new Fr(t,r);case">":return new Lr(t,r);case"+":return new Kr(t,r);case"-":return new Br(t,r);case"*":return new Wr(t,r);case"/":return new Hr(t,r);case"%":return new Xr(t,r);default:throw new Error(e)}},e.unary=function(t,e){switch(t){case"!":return new Yr(e);case"~":return new Gr(e);case"-":return new _r(e);case"+":return new Qr(e);default:throw new Error(t)}},e}(br),Or=function(t){function e(e,r){var n=t.call(this)||this;return n.operand1=e,n.operand2=r,n}return P(e,t),e.prototype.isConstant=function(){return this.operand1.isConstant()&&this.operand2.isConstant()},e.prototype.interpolateTo=function(r){return r instanceof e&&this.operator===r.operator?Cr(this,r):t.prototype.interpolateTo.call(this,r)},e}(xr),Cr=function(t,e){var r=t.operator;if(r!==e.operator)throw new Error;var n=function(t){var e=n.operand1Interpolator(t),r=n.operand2Interpolator(t);return xr.binary(e,n.operator,r)};return Object.setPrototypeOf(n,Cr.prototype),n.operand1Interpolator=t.operand1.interpolateTo(e.operand1),n.operator=r,n.operand2Interpolator=t.operand2.interpolateTo(e.operand2),n};Cr.prototype=Object.create($t.prototype),Object.defineProperty(Cr.prototype,0,{get:function(){var t=this.operand1Interpolator[0],e=this.operand2Interpolator[0];return xr.binary(t,this.operator,e)},enumerable:!0,configurable:!0}),Object.defineProperty(Cr.prototype,1,{get:function(){var t=this.operand1Interpolator[1],e=this.operand2Interpolator[1];return xr.binary(t,this.operator,e)},enumerable:!0,configurable:!0}),Cr.prototype.equals=function(t){return this===t||t instanceof Cr&&(this.operator===t.operator&&this.operand1Interpolator.equals(t.operand1Interpolator)&&this.operand2Interpolator.equals(t.operand2Interpolator))};var Er=function(t){function e(e){var r=t.call(this)||this;return r.operand=e,r}return P(e,t),e.prototype.isConstant=function(){return this.operand.isConstant()},e.prototype.interpolateTo=function(r){return r instanceof e&&this.operator===r.operator?Pr(this,r):t.prototype.interpolateTo.call(this,r)},e}(xr),Pr=function(t,e){var r=t.operator;if(r!==e.operator)throw new Error;var n=function(t){var e=n.operandInterpolator(t);return xr.unary(n.operator,e)};return Object.setPrototypeOf(n,Pr.prototype),n.operator=r,n.operandInterpolator=t.operand.interpolateTo(e.operand),n};Pr.prototype=Object.create($t.prototype),Object.defineProperty(Pr.prototype,0,{get:function(){var t=this.operandInterpolator[0];return xr.unary(this.operator,t)},enumerable:!0,configurable:!0}),Object.defineProperty(Pr.prototype,1,{get:function(){var t=this.operandInterpolator[1];return xr.unary(this.operator,t)},enumerable:!0,configurable:!0}),Pr.prototype.equals=function(t){return this===t||t instanceof Pr&&(this.operator===t.operator&&this.operandInterpolator.equals(t.operandInterpolator))};var Sr=function(t){function e(e,r,n){var i=t.call(this)||this;return i.ifTerm=e.commit(),i.thenTerm=r.commit(),i.elseTerm=n.commit(),i}return P(e,t),e.prototype.isConstant=function(){return this.ifTerm.isConstant()&&this.thenTerm.isConstant()&&this.elseTerm.isConstant()},Object.defineProperty(e.prototype,"precedence",{get:function(){return 2},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){var e;((t=Dr.fromAny(t)).willOperate(this),this.ifTerm.evaluate(t).isDefinite())?e=this.thenTerm.evaluate(t):e=this.elseTerm.evaluate(t);return t.didOperate(this,e),e},e.prototype.substitute=function(t){return t=Dr.fromAny(t),new e(this.ifTerm.substitute(t),this.thenTerm.substitute(t),this.elseTerm.substitute(t))},e.prototype.interpolateTo=function(r){return r instanceof e?kr(this,r):t.prototype.interpolateTo.call(this,r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 20},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.ifTerm.compareTo(t.ifTerm);return 0===r&&0===(r=this.thenTerm.compareTo(t.thenTerm))&&(r=this.elseTerm.compareTo(t.elseTerm)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.ifTerm.equivalentTo(t.ifTerm,r)&&this.thenTerm.equivalentTo(t.thenTerm,r)&&this.elseTerm.equivalentTo(t.elseTerm,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.ifTerm.equals(t.ifTerm)&&this.thenTerm.equals(t.thenTerm)&&this.elseTerm.equals(t.elseTerm))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(b.hash(e),this.ifTerm.hashCode()),this.thenTerm.hashCode()),this.elseTerm.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.ifTerm).write(46).write("conditional").write(40).debug(this.thenTerm).write(44).write(32).debug(this.elseTerm).write(41)},e.prototype.clone=function(){return new e(this.ifTerm.clone(),this.thenTerm.clone(),this.elseTerm.clone())},e}(xr),kr=function(t,e){var r=function(t){var e=r.ifTermInterpolator(t),n=r.thenTermInterpolator(t),i=r.elseTermInterpolator(t);return new Sr(e,n,i)};return Object.setPrototypeOf(r,kr.prototype),r.ifTermInterpolator=t.ifTerm.interpolateTo(e.ifTerm),r.thenTermInterpolator=t.thenTerm.interpolateTo(e.thenTerm),r.elseTermInterpolator=t.elseTerm.interpolateTo(e.elseTerm),r};kr.prototype=Object.create($t.prototype),Object.defineProperty(kr.prototype,0,{get:function(){var t=this.ifTermInterpolator[0],e=this.thenTermInterpolator[0],r=this.elseTermInterpolator[0];return new Sr(t,e,r)},enumerable:!0,configurable:!0}),Object.defineProperty(kr.prototype,1,{get:function(){var t=this.ifTermInterpolator[1],e=this.thenTermInterpolator[1],r=this.elseTermInterpolator[1];return new Sr(t,e,r)},enumerable:!0,configurable:!0}),kr.prototype.equals=function(t){return this===t||t instanceof kr&&(this.ifTermInterpolator.equals(t.ifTermInterpolator)&&this.thenTermInterpolator.equals(t.thenTermInterpolator)&&this.elseTermInterpolator.equals(t.elseTermInterpolator))};var Mr=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),Ar=function(){function t(t){Object.defineProperty(this,"maxScopeDepth",{value:t,enumerable:!0})}return t.prototype.withMaxScopeDepth=function(t){return this.copy(t)},t.prototype.copy=function(e){return new t(e)},t.prototype.canEqual=function(e){return e instanceof t},t.prototype.equals=function(e){return this===e||e instanceof t&&(e.canEqual(this)&&this.maxScopeDepth===e.maxScopeDepth)},t.prototype.hashCode=function(){return f.mash(f.mix(b.hash(t),m.hash(this.maxScopeDepth)))},t.prototype.debug=function(t){return t=t.write("new").write(32).write("InterpreterSettings").write(40).debug(this.maxScopeDepth).write(41)},t.prototype.toString=function(){return nt.debug(this)},t.standard=function(){return new t(1024)},S([e],t,"standard",null),t}(),Dr=function(){function t(t,e,r){this.settings=void 0!==t?t:Ar.standard(),this.scopeStack=void 0!==e?e:null,this.scopeDepth=void 0!==r?r:0}return t.prototype.withSettings=function(t){return this.settings=t,this},t.prototype.peekScope=function(){var t=this.scopeDepth;if(t<=0)throw new Mr("scope stack empty");return this.scopeStack[t-1]},t.prototype.getScope=function(t){if(t<0||t>=this.scopeDepth)throw new RangeError(""+t);return this.scopeStack[t]},t.prototype.pushScope=function(e){var r=this.scopeDepth;if(r>=this.settings.maxScopeDepth)throw new Mr("scope stack overflow");var n,i=this.scopeStack;if(null===i||r+1>i.length){if(n=new Array(t.expand(r+1)),null!==i)for(var o=0;o<r;o+=1)n[o]=i[o];this.scopeStack=n}else n=i;n[r]=e,this.scopeDepth+=1},t.prototype.popScope=function(){var t=this.scopeDepth;if(t<=0)throw new Mr("scope stack empty");var e=this.scopeStack,r=e[t-1];return e[t-1]=void 0,this.scopeDepth-=1,r},t.prototype.swapScope=function(t){var e=this.scopeDepth;if(e<=0)throw new Mr("scope stack empty");var r=this.scopeStack,n=r[e-1];return r[e-1]=t,n},t.prototype.willOperate=function(t){},t.prototype.didOperate=function(t,e){},t.prototype.willSelect=function(t){},t.prototype.didSelect=function(t,e){},t.prototype.willTransform=function(t){},t.prototype.didTransform=function(t,e){},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=e.length,i=new Array(t.expand(n)),o=0;o<n;o+=1){var s=Qe.fromAny(e[o]);i[o]=s}return new t(Ar.standard(),i,n)},t.fromAny=function(e,r){if(void 0===r&&(r=Qe.globalScope()),!(e instanceof t)){var n=e;e=new t,void 0!==r&&e.pushScope(r),void 0!==n&&e.pushScope(Qe.fromAny(n))}return e},t.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},t}(),Ir=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"||"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 3},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){var e;(t=Dr.fromAny(t)).willOperate(this);var r=this.operand1.evaluate(t);r.isDefinite()?e=r:e=this.operand2.evaluate(t);return t.didOperate(this,e),e},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.or(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 21},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("or").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Tr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"&&"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 4},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){var e;(t=Dr.fromAny(t)).willOperate(this);var r=this.operand1.evaluate(t);r.isDefinite()?e=this.operand2.evaluate(t):e=r;return t.didOperate(this,e),e},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.and(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 22},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("and").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Vr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"|"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 5},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.bitwiseOr(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.bitwiseOr(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 23},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("bitwiseOr").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),jr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"^"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 6},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.bitwiseXor(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.bitwiseXor(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 24},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("bitwiseXor").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),qr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"&"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 7},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.bitwiseAnd(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.bitwiseAnd(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 25},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("bitwiseAnd").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Rr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"<"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.lt(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.lt(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 26},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t.debug(this.operand1).write(46).write("lt").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Ur=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"<="},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.le(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.le(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 27},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t.debug(this.operand1).write(46).write("le").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Nr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"=="},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.eq(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.eq(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 28},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("eq").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),zr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"!="},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.ne(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.ne(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 29},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("ne").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Fr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return">="},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.ge(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.ge(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 30},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("ge").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Lr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return">"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.gt(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.gt(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 31},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("gt").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Kr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"+"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 8},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.plus(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.plus(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 32},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("plus").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Br=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"-"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 8},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.minus(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.minus(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 33},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("minus").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Wr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"*"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 9},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.times(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.times(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 34},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("times").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Hr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"/"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 9},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.divide(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.divide(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 35},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("divide").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Xr=function(t){function e(e,r){return t.call(this,e,r)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"%"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 9},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){(t=Dr.fromAny(t)).willOperate(this);var e=this.operand1.evaluate(t),r=this.operand2.evaluate(t),n=e.modulo(r);return t.didOperate(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var e=this.operand1.substitute(t),r=this.operand2.substitute(t);return e.modulo(r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 36},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.operand1.compareTo(t.operand1);return 0===r&&(r=this.operand2.compareTo(t.operand2)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.operand1.equivalentTo(t.operand1,r)&&this.operand2.equivalentTo(t.operand2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.operand1.equals(t.operand1)&&this.operand2.equals(t.operand2))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.operand1.hashCode()),this.operand2.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand1).write(46).write("modulo").write(40).debug(this.operand2).write(41)},e.prototype.clone=function(){return new e(this.operand1.clone(),this.operand2.clone())},e}(Or),Yr=function(t){function e(e){return t.call(this,e)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"!"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){return t=Dr.fromAny(t),this.operand.evaluate(t).not()},e.prototype.substitute=function(t){return t=Dr.fromAny(t),this.operand.substitute(t).not()},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 37},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return m.compare(this.typeOrder,t.typeOrder)},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.operand.equivalentTo(t.operand,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.operand.equals(t.operand)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.operand.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand).write(46).write("not").write(40).write(41)},e.prototype.clone=function(){return new e(this.operand.clone())},e}(Er),Gr=function(t){function e(e){return t.call(this,e)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"~"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){return t=Dr.fromAny(t),this.operand.evaluate(t).bitwiseNot()},e.prototype.substitute=function(t){return t=Dr.fromAny(t),this.operand.substitute(t).bitwiseNot()},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 38},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?this.operand.compareTo(t.operand):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.operand.equivalentTo(t.operand,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.operand.equals(t.operand)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.operand.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand).write(46).write("bitwiseNot").write(40).write(41)},e.prototype.clone=function(){return new e(this.operand.clone())},e}(Er),_r=function(t){function e(e){return t.call(this,e)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"-"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){return t=Dr.fromAny(t),this.operand.evaluate(t).negative()},e.prototype.substitute=function(t){return t=Dr.fromAny(t),this.operand.substitute(t).negative()},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 39},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?this.operand.compareTo(t.operand):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.operand.equivalentTo(t.operand,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.operand.equals(t.operand)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.operand.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand).write(46).write("negative").write(40).write(41)},e.prototype.clone=function(){return new e(this.operand.clone())},e}(Er),Qr=function(t){function e(e){return t.call(this,e)||this}return P(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"+"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 10},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){return t=Dr.fromAny(t),this.operand.evaluate(t).positive()},e.prototype.substitute=function(t){return t=Dr.fromAny(t),this.operand.substitute(t).positive()},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 40},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?this.operand.compareTo(t.operand):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.operand.equivalentTo(t.operand,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.operand.equals(t.operand)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.operand.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.operand).write(46).write("positive").write(40).write(41)},e.prototype.clone=function(){return new e(this.operand.clone())},e}(Er),Zr=function(t){function e(e,r){var n=t.call(this)||this;return n.func=e,n.args=r.commit(),n.state=void 0,n}return P(e,t),e.prototype.setState=function(t){this.state=t},e.prototype.isConstant=function(){return this.func.isConstant()&&this.args.isConstant()},Object.defineProperty(e.prototype,"precedence",{get:function(){return 11},enumerable:!1,configurable:!0}),e.prototype.evaluate=function(t){t=Dr.fromAny(t);var e=this.func.evaluate(t);return e instanceof fn?e.invoke(this.args,t,this):Qe.absent()},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.func.evaluate(t);if(r instanceof fn){var n=r.expand(this.args,t,this);if(void 0!==n)return n}var i=this.args.substitute(t).toValue();return new e(this.func,i)},e.prototype.interpolateTo=function(r){return r instanceof e?Jr(this,r):t.prototype.interpolateTo.call(this,r)},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 41},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.func.compareTo(t.func);return 0===r&&(r=this.args.compareTo(t.args)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.func.equals(t.func)&&this.args.equivalentTo(t.args,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.func.equals(t.func)&&this.args.equals(t.args))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.func.hashCode()),this.args.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.func).write(46).write("invoke").write(40).debug(this.args).write(41)},e.prototype.clone=function(){return new e(this.func.clone(),this.args.clone())},e}(xr),Jr=function(t,e){var r=function(t){var e=r.funcInterpolator(t),n=r.argsInterpolator(t);return new Zr(e,n)};return Object.setPrototypeOf(r,Jr.prototype),r.funcInterpolator=t.func.interpolateTo(e.func),r.argsInterpolator=t.args.interpolateTo(e.args),r};Jr.prototype=Object.create($t.prototype),Object.defineProperty(Jr.prototype,0,{get:function(){var t=this.funcInterpolator[0],e=this.argsInterpolator[0];return new Zr(t,e)},enumerable:!0,configurable:!0}),Object.defineProperty(Jr.prototype,1,{get:function(){var t=this.funcInterpolator[1],e=this.argsInterpolator[1];return new Zr(t,e)},enumerable:!0,configurable:!0}),Jr.prototype.equals=function(t){return this===t||t instanceof Jr&&(this.funcInterpolator.equals(t.funcInterpolator)&&this.argsInterpolator.equals(t.argsInterpolator))};var $r=function(t){function r(){return t.call(this)||this}return P(r,t),r.prototype.isConstant=function(){return!1},r.prototype.evaluate=function(t){t=Dr.fromAny(t);var e=or.create();return this.forSelected(t,(function(t){var r=t.peekScope();void 0!==r&&e.push(r)}),this),e.isEmpty()?Qe.absent():e.flattened()},r.prototype.get=function(t){return t=ir.fromAny(t),this.andThen(new en(t,r.identity()))},r.prototype.getAttr=function(t){return t=lr.fromAny(t),this.andThen(new rn(t,r.identity()))},r.prototype.getItem=function(t){return t=yr.fromAny(t),this.andThen(new nn(t,r.identity()))},r.prototype.keys=function(){return this.andThen(r.keys())},r.prototype.values=function(){return this.andThen(r.values())},r.prototype.children=function(){return this.andThen(r.children())},r.prototype.descendants=function(){return this.andThen(r.descendants())},r.prototype.filter=function(t){return 0===arguments.length?new pn(this,r.identity()):(t=Qe.fromAny(t),this.andThen(t.filter()))},r.prototype.invoke=function(t){return new Zr(this,t)},Object.defineProperty(r.prototype,"precedence",{get:function(){return 11},enumerable:!1,configurable:!0}),r.prototype.debug=function(t){return t=t.write("Selector").write(46).write("identity").write(40).write(41),t=this.debugThen(t)},r.identity=function(){return new tn},r.get=function(t){return t=ir.fromAny(t),new en(t,r.identity())},r.getAttr=function(t){return t=lr.fromAny(t),new rn(t,r.identity())},r.getItem=function(t){return t=yr.fromAny(t),new nn(t,r.identity())},r.keys=function(){return new on(r.identity())},r.values=function(){return new sn(r.identity())},r.children=function(){return new un(r.identity())},r.descendants=function(){return new an(r.identity())},r.literal=function(t){return(t=Qe.fromAny(t))instanceof r||(t=new hn(t,r.identity())),t},S([e],r,"identity",null),S([e],r,"keys",null),S([e],r,"values",null),S([e],r,"children",null),S([e],r,"descendants",null),r}(br),tn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),Object.defineProperty(e.prototype,"then",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.forSelected=function(t,e,r){var n;if(t.willSelect(this),0!==t.scopeDepth){var i=t.popScope(),o=i.evaluate(t);t.pushScope(o),n=e.call(r,t),t.swapScope(i)}return t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){return e.call(r,t)},e.prototype.substitute=function(t){return(t=Dr.fromAny(t)).peekScope().substitute(t)},e.prototype.get=function(t){return t=ir.fromAny(t),new en(t,this)},e.prototype.getAttr=function(t){return t=lr.fromAny(t),new rn(t,this)},e.prototype.getItem=function(t){return t=yr.fromAny(t),new nn(t,this)},e.prototype.andThen=function(t){return t},e.prototype.keys=function(){return $r.keys()},e.prototype.values=function(){return $r.values()},e.prototype.children=function(){return $r.children()},e.prototype.descendants=function(){return $r.descendants()},e.prototype.filter=function(t){return 0===arguments.length?new pn(this,this):(t=Qe.fromAny(t)).filter()},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 10},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t){return this===t},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return b.hash(e)},e.prototype.debugThen=function(t){return t},e.prototype.clone=function(){return this},e}($r),en=function(t){function e(e,r){var n=t.call(this)||this;return n.item=e.commit(),n.then=r,n}return P(e,t),e.prototype.forSelected=function(t,r,n){t.willSelect(this);var i=this.item.evaluate(t).toValue(),o=e.forSelected(i,this.then,t,r,n);return t.didSelect(this,o),o},e.forSelected=function(t,r,n,i,o){var s;if(0!==n.scopeDepth){var u=n.popScope().toValue(),a=void 0;u instanceof or&&void 0!==(a=u.getField(t))&&(n.pushScope(a.toValue()),s=r.forSelected(n,i,o),n.popScope()),void 0===a&&void 0===s&&e.forSelected(t,r,n,i,o),n.pushScope(u)}return s},e.prototype.mapSelected=function(t,e,r){var n;t.willTransform(this);var i=this.item.evaluate(t).toValue();if(0!==t.scopeDepth){var o=t.popScope().toValue();if(o instanceof or){var s=o.getField(i);if(void 0!==s){t.pushScope(s.toValue());var u=this.then.mapSelected(t,e,r);t.popScope(),u instanceof Je?i.equals(u.key)?o.set(i,u.toValue()):(o.delete(i),o.push(u)):u.isDefined()?o.set(i,u.toValue()):o.delete(i)}}t.pushScope(o),n=o}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.item.evaluate(t).toValue(),n=e.substitute(r,this.then,t);if(void 0!==n)return n;var i=this.then.substitute(t);return i instanceof $r||(i=this.then),new e(this.item,i)},e.substitute=function(t,r,n){var i;if(0!==n.scopeDepth){var o=n.popScope().toValue(),s=void 0;o instanceof or&&void 0!==(s=o.getField(t))&&(i=s.toValue().substitute(n)),void 0===s&&void 0===i&&e.substitute(t,r,n),n.pushScope(o)}return i},e.prototype.andThen=function(t){return new e(this.item,this.then.andThen(t))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 12},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.item.compareTo(t.item);return 0===r&&(r=this.then.compareTo(t.then)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.item.equals(t.item)&&this.then.equivalentTo(t.then,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.item.equals(t.item)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.item.hashCode()),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("get").write(40).debug(this.item).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.item.clone(),this.then.clone())},e}($r),rn=function(t){function e(e,r){var n=t.call(this)||this;return n.item=e,n.then=r,n}return P(e,t),e.prototype.forSelected=function(t,r,n){t.willSelect(this);var i=this.item,o=e.forSelected(i,this.then,t,r);return t.didSelect(this,o),o},e.forSelected=function(t,r,n,i,o){var s;if(0!==n.scopeDepth){var u=n.popScope().toValue(),a=void 0;u instanceof or&&(a=u.getField(t))instanceof er&&(n.pushScope(a.toValue()),s=r.forSelected(n,i,o),n.popScope()),void 0===a&&void 0===s&&e.forSelected(t,r,n,i,o),n.pushScope(u)}return s},e.prototype.mapSelected=function(t,e,r){var n;t.willTransform(this);var i=this.item;if(0!==t.scopeDepth){var o=t.popScope().toValue();if(o instanceof or){var s=o.getField(i);if(s instanceof er){t.pushScope(s.toValue());var u=this.then.mapSelected(t,e,r);t.popScope(),u instanceof Je?i.equals(u.key)?o.setAttr(i,u.toValue()):(o.delete(i),o.push(u)):u.isDefined()?o.setAttr(i,u.toValue()):o.delete(i)}}t.pushScope(o),n=o}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.item,n=e.substitute(r,this.then,t);if(void 0!==n)return n;var i=this.then.substitute(t);return i instanceof $r||(i=this.then),new e(this.item,i)},e.substitute=function(t,r,n){var i;if(0!==n.scopeDepth){var o=n.popScope().toValue(),s=void 0;o instanceof or&&(s=o.getField(t))instanceof er&&(i=s.toValue().substitute(n)),void 0===s&&void 0===i&&e.substitute(t,r,n),n.pushScope(o)}return i},e.prototype.andThen=function(t){return new e(this.item,this.then.andThen(t))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 13},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.item.compareTo(t.item);return 0===r&&(r=this.then.compareTo(t.then)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.item.equals(t.item)&&this.then.equivalentTo(t.then,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.item.equals(t.item)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.item.hashCode()),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("getAttr").write(40).debug(this.item).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.item.clone(),this.then.clone())},e}($r),nn=function(t){function e(e,r){var n=t.call(this)||this;return n.item=e,n.then=r,n}return P(e,t),e.prototype.forSelected=function(t,e,r){var n;t.willSelect(this);var i=this.item.numberValue();if(0!==t.scopeDepth){var o=t.popScope().toValue();if(o instanceof or&&i<o.length){var s=o.getItem(i);t.pushScope(s),n=this.then.forSelected(t,e,r),t.popScope()}t.pushScope(o)}return t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){var n;if(t.willTransform(this),0!==t.scopeDepth){var i=t.popScope().toValue(),o=this.item.numberValue();if(i instanceof or&&o<i.length){var s=i.getItem(o);t.pushScope(s);var u=this.then.mapSelected(t,e,r);t.popScope(),u.isDefined()?i.setItem(o,u):i.splice(o,1)}t.pushScope(i),n=i}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.item.numberValue();if(0!==t.scopeDepth){var n=t.popScope().toValue(),i=void 0;if(n instanceof or&&r<n.length)i=n.getItem(r).substitute(t);if(t.pushScope(n),void 0!==i)return i}var o=this.then.substitute(t);return o instanceof $r||(o=this.then),new e(this.item,o)},e.prototype.andThen=function(t){return new e(this.item,this.then.andThen(t))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 14},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.item.compareTo(t.item);return 0===r&&(r=this.then.compareTo(t.then)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.item.equals(t.item)&&this.then.equivalentTo(t.then,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.item.equals(t.item)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.item.hashCode()),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("getItem").write(40).debug(this.item).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.item,this.then.clone())},e}($r),on=function(t){function e(e){var r=t.call(this)||this;return r.then=e,r}return P(e,t),e.prototype.forSelected=function(t,e,r){var n;if(t.willSelect(this),0!==t.scopeDepth){var i=t.popScope();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var s=o.next().value;s instanceof Je&&(t.pushScope(s.key),n=this.then.forSelected(t,e,r),t.popScope())}else i instanceof Je&&(t.pushScope(i.key),n=this.then.forSelected(t,e,r),t.popScope());t.pushScope(i)}return t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){var n;if(t.willTransform(this),0!==t.scopeDepth){var i=t.popScope();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var s=o.next().value;if(s instanceof Je){var u=s.key;t.pushScope(u);var a=this.then.mapSelected(t,e,r).toValue();t.popScope(),a.isDefined()?u!==a&&(i instanceof er&&a instanceof lr?o.set(er.of(a,i.toValue())):o.set($e.of(a,i.toValue()))):o.delete()}}else if(i instanceof Je){u=i.key;t.pushScope(u);a=this.then.mapSelected(t,e,r).toValue();t.popScope(),a.isDefined()?u!==a&&(i=i instanceof er&&a instanceof lr?er.of(a,i.toValue()):$e.of(a,i.toValue())):i=Qe.absent()}t.pushScope(i),n=i}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.then.substitute(t);return r instanceof $r||(r=this.then),new e(r)},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 15},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?this.then.compareTo(t.then):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.then.equivalentTo(t.then,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.then.equals(t.then)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("keys").write(40).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.then.clone())},e}($r),sn=function(t){function e(e){var r=t.call(this)||this;return r.then=e,r}return P(e,t),e.prototype.forSelected=function(t,e,r){var n;if(t.willSelect(this),0!==t.scopeDepth){var i=t.popScope();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var s=o.next().value;t.pushScope(s.toValue()),n=this.then.forSelected(t,e,r),t.popScope()}else t.pushScope(i.toValue()),n=this.then.forSelected(t,e,r),t.popScope();t.pushScope(i)}return t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){var n;if(t.willTransform(this),0!==t.scopeDepth){var i=t.popScope();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var s=o.next().value;if(s instanceof Je){var u=s.toValue();t.pushScope(u);var a=this.then.mapSelected(t,e,r);t.popScope(),a.isDefined()?a instanceof Je?o.set(a):a!==u&&o.set(s.updatedValue(a.toValue())):o.delete()}else{t.pushScope(s.toValue());a=this.then.mapSelected(t,e,r);t.popScope(),a.isDefined()?s!==a&&o.set(a):o.delete()}}else if(i instanceof Je){u=i.toValue();t.pushScope(u);a=this.then.mapSelected(t,e,r);t.popScope(),a.isDefined()?a instanceof Je?i=a:a!==u&&(i=i.updatedValue(a.toValue())):i=Qe.absent()}else t.pushScope(i),i=this.then.mapSelected(t,e,r),t.popScope();t.pushScope(i),n=i}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.then.substitute(t);return r instanceof $r||(r=this.then),new e(r)},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 16},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?this.then.compareTo(t.then):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.then.equivalentTo(t.then,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.then.equals(t.then)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("values").write(40).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.then.clone())},e}($r),un=function(t){function e(e){var r=t.call(this)||this;return r.then=e,r}return P(e,t),e.prototype.forSelected=function(t,e,r){var n;if(t.willSelect(this),0!==t.scopeDepth){var i=t.popScope().toValue();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var s=o.next().value;t.pushScope(s),n=this.then.forSelected(t,e,r),t.popScope()}t.pushScope(i)}return t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){var n;if(t.willTransform(this),0!==t.scopeDepth){var i=t.popScope().toValue();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var s=o.next().value;t.pushScope(s);var u=this.then.mapSelected(t,e);t.popScope(),u.isDefined()?u!==s&&o.set(u):o.delete()}t.pushScope(i),n=i}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.then.substitute(t);return r instanceof $r||(r=this.then),new e(r)},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 17},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?this.then.compareTo(t.then):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.then.equivalentTo(t.then,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.then.equals(t.then)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("children").write(40).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.then.clone())},e}($r),an=function(t){function e(e){var r=t.call(this)||this;return r.then=e,r}return P(e,t),e.prototype.forSelected=function(t,e,r){var n;if(t.willSelect(this),0!==t.scopeDepth){var i=t.popScope().toValue();if(i instanceof or)for(var o=i.iterator();void 0===n&&o.hasNext();){var s=o.next().value;t.pushScope(s),void 0===(n=this.then.forSelected(t,e,r))&&this.forSelected(t,e,r),t.popScope()}t.pushScope(i)}return t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){var n;if(t.willTransform(this),0!==t.scopeDepth){var i=t.popScope().toValue();if(i instanceof or)for(var o=i.iterator();o.hasNext();){var s=o.next().value;t.pushScope(s);var u=this.then.mapSelected(t,e,r);u.isDefined()&&(u=this.mapSelected(t,e,r)),t.popScope(),u.isDefined()?u!==s&&o.set(u):o.delete()}t.pushScope(i),n=i}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.then.substitute(t);return r instanceof $r||(r=this.then),new e(r)},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 18},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?this.then.compareTo(t.then):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&this.then.equivalentTo(t.then,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&this.then.equals(t.then)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("descendants").write(40).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.then.clone())},e}($r),pn=function(t){function e(e,r){var n=t.call(this)||this;return n.predicate=e,n.then=r,n}return P(e,t),e.prototype.forSelected=function(t,e,r){var n;return t.willSelect(this),0!==t.scopeDepth&&this.filterSelected(t)&&(n=this.then.forSelected(t,e,r)),t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){var n;return t.willTransform(this),n=0!==t.scopeDepth?this.filterSelected(t)?this.then.mapSelected(t,e,r):t.peekScope().toValue():Qe.absent(),t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.predicate.substitute(t);r instanceof $r||(r=this.predicate);var n=this.then.substitute(t);return n instanceof $r||(n=this.then),new e(r,n)},e.prototype.filterSelected=function(t){return void 0!==this.predicate.forSelected(t,this.selected,this)},e.prototype.selected=function(t){return null},e.prototype.andThen=function(t){return new e(this.predicate,this.then.andThen(t))},e.prototype.filter=function(t){return 0===arguments.length?this:(t=Qe.fromAny(t),this.andThen(t.filter()))},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 19},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.predicate.compareTo(t.predicate);return 0===r&&(r=this.then.compareTo(t.then)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.predicate.equivalentTo(t.predicate,r)&&this.then.equivalentTo(t.then,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.predicate.equals(t.predicate)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.predicate.hashCode()),this.then.hashCode()))},e.prototype.debugThen=function(t){return t=t.write(46).write("filter").write(40).debug(this.predicate).write(41),t=this.then.debugThen(t)},e.prototype.clone=function(){return new e(this.predicate.clone(),this.then.clone())},e}($r),hn=function(t){function e(e,r){var n=t.call(this)||this;return n.item=e.commit(),n.then=r,n}return P(e,t),e.prototype.forSelected=function(t,e,r){var n;if(t.willSelect(this),0!==t.scopeDepth){var i=this.item.evaluate(t);i.isDefined()&&(t.pushScope(i),n=this.then.forSelected(t,e,r),t.popScope())}return t.didSelect(this,n),n},e.prototype.mapSelected=function(t,e,r){var n;if(t.willTransform(this),0!==t.scopeDepth){var i=this.item.evaluate(t);i.isDefined()&&(t.pushScope(i),i=this.then.mapSelected(t,e,r),t.popScope()),n=i}else n=Qe.absent();return t.didTransform(this,n),n},e.prototype.substitute=function(t){t=Dr.fromAny(t);var r=this.item.substitute(t),n=this.then.substitute(t);return n instanceof $r||(n=this.then),new e(r,n)},e.prototype.andThen=function(t){return new e(this.item,this.then.andThen(t))},Object.defineProperty(e.prototype,"precedence",{get:function(){return this.item.precedence},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 11},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.item.compareTo(t.item);return 0===r&&(r=this.then.compareTo(t.then)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.item.equivalentTo(t.item,r)&&this.then.equivalentTo(t.then,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.item.equals(t.item)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.item.hashCode()),this.then.hashCode()))},e.prototype.debug=function(t){return t=t.write("Selector").write(46).write("literal").write(40).debug(this.item).write(41),t=this.then.debugThen(t)},e.prototype.debugThen=function(t){return t},e.prototype.clone=function(){return new e(this.item.clone(),this.then.clone())},e}($r),fn=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.isConstant=function(){return!1},e.prototype.expand=function(t,e,r){},e}(br),cn=function(t){function e(e,r){var n=t.call(this)||this;return n.bindings=e,n.template=r,n}return P(e,t),Object.defineProperty(e.prototype,"precedence",{get:function(){return 1},enumerable:!1,configurable:!0}),e.prototype.invoke=function(t,e,r){e=Dr.fromAny(e);for(var n=this.bindings,i=Math.max(1,n.length),o=or.create(i),s=0,u=0;s<i;){var a=n instanceof or?n.getItem(s):0===s?n:Qe.absent(),p=t instanceof or?t.getItem(u).toValue():0===u?t:ir.absent();a instanceof lr&&p.isDistinct()?(o.push($e.of(a,p)),u+=1):a instanceof $e&&(p.isDistinct()?o.push(a.updatedValue(p)):o.push(a),u+=1),s+=1}e.pushScope(o);var h=this.template.evaluate(e);return e.popScope(),h},Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 50},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){if(t instanceof e){var r=this.bindings.compareTo(t.bindings);return 0===r&&(r=this.template.compareTo(t.template)),r}return t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(this.bindings.equivalentTo(t.bindings,r)&&this.template.equivalentTo(t.template,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.bindings.equals(t.bindings)&&this.template.equals(t.template))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.bindings.hashCode()),this.template.hashCode()))},e.prototype.debug=function(t){return t=t.debug(this.bindings).write(46).write("lambda").write(40).debug(this.template).write(41)},e}(fn),ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),Object.defineProperty(e.prototype,"typeOrder",{get:function(){return 51},enumerable:!1,configurable:!0}),e.prototype.compareTo=function(t){return t instanceof e?b.compare(this.constructor,t.constructor):t instanceof Qe?m.compare(this.typeOrder,t.typeOrder):NaN},e.prototype.equivalentTo=function(t){return this===t},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return b.hash(this.constructor)},e.prototype.debug=function(t){return t=t.write(this.constructor.name)},e}(fn),dn={};Object.defineProperty(dn,"max",{get:function(){var t=new yn;return Object.defineProperty(dn,"max",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"min",{get:function(){var t=new vn;return Object.defineProperty(dn,"min",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"abs",{get:function(){var t=new mn;return Object.defineProperty(dn,"abs",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"ceil",{get:function(){var t=new wn;return Object.defineProperty(dn,"ceil",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"floor",{get:function(){var t=new gn;return Object.defineProperty(dn,"floor",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"round",{get:function(){var t=new bn;return Object.defineProperty(dn,"round",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"sqrt",{get:function(){var t=new xn;return Object.defineProperty(dn,"sqrt",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"pow",{get:function(){var t=new On;return Object.defineProperty(dn,"pow",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"rate",{get:function(){var t=new Cn;return Object.defineProperty(dn,"rate",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"random",{get:function(){var t=new En;return Object.defineProperty(dn,"random",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0}),Object.defineProperty(dn,"scope",{get:function(){var t=or.create(10).slot("max",dn.max).slot("min",dn.min).slot("abs",dn.abs).slot("ceil",dn.ceil).slot("floor",dn.floor).slot("round",dn.round).slot("pow",dn.pow).slot("sqrt",dn.sqrt).slot("rate",dn.rate).slot("random",dn.random).commit();return Object.defineProperty(dn,"scope",{value:t,configurable:!0,enumerable:!0}),t},configurable:!0,enumerable:!0});var yn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){var n,i;if(e=Dr.fromAny(e),t.length>=2?(n=t.getItem(0).evaluate(e),i=t.getItem(1).evaluate(e)):n=t.evaluate(e),void 0!==i)return n.max(i);if(void 0!==r){var o=void 0!==(i=r.state)?n.max(i):n;return r.setState(o),o}return Qe.absent()},e.prototype.expand=function(t,e,r){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,r)},e}(ln),vn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){var n,i;if(e=Dr.fromAny(e),t.length>=2?(n=t.getItem(0).evaluate(e),i=t.getItem(1).evaluate(e)):n=t.evaluate(e),void 0!==i)return n.min(i);if(void 0!==r){var o=void 0!==(i=r.state)?n.min(i):n;return r.setState(o),o}return Qe.absent()},e.prototype.expand=function(t,e,r){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,r)},e}(ln),mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof yr?t.abs():Qe.absent()},e}(ln),wn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof yr?t.ceil():Qe.absent()},e}(ln),gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof yr?t.floor():Qe.absent()},e}(ln),bn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof yr?t.round():Qe.absent()},e}(ln),xn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){return(t=t.evaluate(e).toValue())instanceof yr?t.sqrt():Qe.absent()},e}(ln),On=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){e=Dr.fromAny(e);var n=t.getItem(0).evaluate(e),i=t.getItem(1).evaluate(e);return n instanceof yr&&i instanceof yr?n.pow(i):Qe.absent()},e}(ln),Cn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){var n,i;if(e=Dr.fromAny(e),t.length>=2?(n=t.getItem(0).evaluate(e).numberValue(NaN),i=t.getItem(1).evaluate(e).numberValue(1e3)):(n=t.evaluate(e).numberValue(NaN),i=1e3),isFinite(n)&&void 0!==r){var o=r.state;if(void 0===o)o={v0:n,t0:Date.now(),dv:0,dt:0},r.setState(o);else{var s=Date.now(),u=s-o.t0;if(u>i&&s>o.t0||u>2*i){var a=n-o.v0;o.v0=n,o.t0=s,o.dv=a,o.dt=u}if(r.setState(o),0!==o.dt){var p=i*o.dv/o.dt;return yr.from(p)}}}return Qe.absent()},e.prototype.expand=function(t,e,r){return t=t.evaluate(e).toValue(),this.invoke(t,e,r)},e}(ln),En=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.invoke=function(t,e,r){var n=(t=t.evaluate(e).toValue()).length>=1?t.getItem(0).numberValue(0):0,i=t.length>=2?t.getItem(1).numberValue(n+1):n+1,o=n+Math.random()*(i-n);return yr.from(o)},e}(ln),Pn=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),Sn=function(){function t(){}return t.prototype.withTag=function(t){return void 0!==t&&t!==this.tag?new kn(this,t):this},t.prototype.withUnit=function(t){return t!==this.unit?new Mn(this,t):this},t.forString=function(){return new Dn("")},t.forNumber=function(){return new In(0)},t.forBoolean=function(){return new Tn(!1)},t.forAny=function(){return new Vn(void 0)},t.forItem=function(){return new jn(Qe.absent())},t.forValue=function(){return new qn(ir.absent())},S([e],t,"forString",null),S([e],t,"forNumber",null),S([e],t,"forBoolean",null),S([e],t,"forAny",null),S([e],t,"forItem",null),S([e],t,"forValue",null),t}();Object.defineProperty(Sn.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(Sn.prototype,"unit",{get:function(){},enumerable:!0,configurable:!0});var kn=function(t){function e(e,r){var n=t.call(this)||this;return n.form=e,n.tag=r,n}return P(e,t),e.prototype.withTag=function(t){return void 0!==t&&t!==this.tag?new e(this.form,t):void 0===t?this.form:this},e.prototype.withUnit=function(t){return t!==this.unit?new e(this.form.withUnit(t),this.tag):this},e.prototype.mold=function(t,e){return(e=this.form.mold(t,e)).header(this.tag).isDefined()||(e=e.prepended(er.of(this.tag))),e},e.prototype.cast=function(t,e){return t.header(this.tag).isDefined()?this.form.cast(t,e):t.keyEquals(this.tag)?this.form.cast(t.toValue(),e):void 0},e}(Sn);Object.defineProperty(kn.prototype,"unit",{get:function(){return this.form.unit},enumerable:!0,configurable:!0});var Mn=function(t){function e(e,r){var n=t.call(this)||this;return n.form=e,Object.defineProperty(n,"unit",{value:r,enumerable:!0}),n}return P(e,t),e.prototype.withTag=function(t){return t!==this.tag?new e(this.form.withTag(t),this.unit):this},e.prototype.withUnit=function(t){return t!==this.unit?new e(this.form,t):t===this.form.unit?this.form:this},e.prototype.mold=function(t,e){return 1===arguments.length?this.form.mold(t):this.form.mold(t,e)},e.prototype.cast=function(t,e){return 1===arguments.length?this.form.cast(t):this.form.cast(t,e)},e}(Sn);Object.defineProperty(Mn.prototype,"tag",{get:function(){return this.form.tag},enumerable:!0,configurable:!0});var An,Dn=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return void 0===e?lr.from(t):e.concat(lr.from(t))},e.prototype.cast=function(t,e){var r=t.target;try{return r.stringValue()}catch(t){return}},e}(Sn),In=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return void 0===e?yr.from(t):e.concat(yr.from(t))},e.prototype.cast=function(t,e){var r=t.target;try{return r.numberValue()}catch(t){return}},e}(Sn),Tn=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return void 0===e?mr.from(t):e.concat(mr.from(t))},e.prototype.cast=function(t,e){var r=t.target;try{return r.booleanValue()}catch(t){return}},e}(Sn),Vn=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return t=Qe.fromAny(t),void 0!==e&&(t=e.concat(t)),t},e.prototype.cast=function(t,e){return t.toAny()},e}(Sn),jn=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:void 0!==e?e.commit():void 0,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return t=Qe.fromAny(t),void 0!==e&&(t=e.concat(t)),t},e.prototype.cast=function(t,e){return t},e}(Sn),qn=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:void 0!==e?e.commit():void 0,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return t=ir.fromAny(t),void 0!==e&&(t=e.concat(t)),t},e.prototype.cast=function(t,e){return t.toValue()},e}(Sn),Rn=function(t){function e(e,r){var n=t.call(this)||this;return n.cursor=e,n.form=r,n}return P(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){return this.cursor.head().coerce(this.form)},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,r=t.done;return void 0!==e?{value:e.coerce(this.form),done:r}:{done:r}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.previous(),e=t.value,r=t.done;return void 0!==e?{value:e.coerce(this.form),done:r}:{done:r}},e.prototype.delete=function(){this.cursor.delete()},e}(M),Un=function(t){function e(e,r,n){var i=t.call(this)||this;return i.cursor=e,i.keyForm=r,i.valueForm=n,i}return P(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){var t=this.cursor.head();return[t[0].coerce(this.keyForm),t[1].coerce(this.valueForm)]},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,r=t.done;return void 0!==e?{value:[e[0].coerce(this.keyForm),e[1].coerce(this.valueForm)],done:r}:{done:r}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.previous(),e=t.value,r=t.done;return void 0!==e?{value:[e[0].coerce(this.keyForm),e[1].coerce(this.valueForm)],done:r}:{done:r}},e.prototype.delete=function(){this.cursor.delete()},e}(M),Nn={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"input"in e&&"function"==typeof e.bindInput&&"function"==typeof e.unbindInput}return!1}},zn={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"function"==typeof e.outputIterator&&"function"==typeof e.bindOutput&&"function"==typeof e.unbindOutput}return!1}},Fn={};Fn.define=function(t){Object.prototype.hasOwnProperty.call(t,"memoize")||(t.memoize=Fn.memoize),Object.prototype.hasOwnProperty.call(t,"map")||(t.map=Fn.map),Object.prototype.hasOwnProperty.call(t,"watch")||(t.watch=Fn.watch)},Fn.memoize=function(){var t=new ai;return t.bindInput(this),t},Fn.map=function(t){var e=new li(t);return e.bindInput(this),e},Fn.watch=function(t){return new gi(t).bindInput(this),this},t.KeyEffect=void 0,(An=t.KeyEffect||(t.KeyEffect={}))[An.Update=0]="Update",An[An.Remove=1]="Remove";var Ln={is:function(t){if("object"==typeof t&&null!==t){var e=t;return Nn.is(e)&&"function"==typeof e.decohereOutputKey&&"function"==typeof e.recohereOutputKey}return!1}},Kn={is:function(t){if("object"==typeof t&&null!==t){var e=t;return zn.is(e)&&"function"==typeof e.keyIterator&&"function"==typeof e.outlet}return!1}},Bn={define:function(t){Object.prototype.hasOwnProperty.call(t,"memoize")||(t.memoize=Bn.memoize),Object.prototype.hasOwnProperty.call(t,"filterr")||(t.filter=Bn.filter),Object.prototype.hasOwnProperty.call(t,"map")||(t.map=Bn.map),Object.prototype.hasOwnProperty.call(t,"reduce")||(t.reduce=Bn.reduce),Object.prototype.hasOwnProperty.call(t,"watch")||(t.watch=Bn.watch)},memoize:function(){var t=new pi;return t.bindInput(this),t},filter:function(t){var e=new fi(t);return e.bindInput(this),e},map:function(t){var e;return 1===t.length?((e=new li(t)).bindInput(this),e):((e=new yi(t)).bindInput(this),e)},reduce:function(t,e,r){var n=new mi(t,e,r);return n.bindInput(this),n},watch:function(t){return 1===t.length?(new gi(t).bindInput(this),this):(new xi(t).bindInput(this),this)}},Wn=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),Hn={is:function(t){if("object"==typeof t&&null!==t){return"streamletScope"in t&&"streamletContext"in t&&"function"==typeof t.outlet}return!1}},Xn={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"streamletScope"in e&&"function"==typeof e.setStreamletScope&&"streamletContext"in e&&"function"==typeof e.setStreamletContext}return!1}},Yn=function(){function t(){this.input=null,this.version=-1}return t.prototype.bindInput=function(t){var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},t.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},t.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},t.prototype.disconnectOutputs=function(){},t.prototype.decohereOutput=function(){this.version>=0&&(this.willDecohereOutput(),this.version=-1,this.onDecohereOutput(),this.didDecohereOutput())},t.prototype.recohereOutput=function(t){this.version<0&&(this.willRecohereOutput(t),this.version=t,null!==this.input&&this.input.recohereInput(t),this.onRecohereOutput(t),this.didRecohereOutput(t))},t.prototype.willDecohereOutput=function(){},t.prototype.onDecohereOutput=function(){},t.prototype.didDecohereOutput=function(){},t.prototype.willRecohereOutput=function(t){},t.prototype.onRecohereOutput=function(t){},t.prototype.didRecohereOutput=function(t){},t}(),Gn=function(){function t(){this.outputs=C.empty,this.version=-1}return t.prototype.outputIterator=function(){return M.array(this.outputs)},t.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},t.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},t.prototype.unbindOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}},t.prototype.disconnectOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){var n=t[e];n.unbindInput(),n.disconnectOutputs()}},t.prototype.disconnectInputs=function(){},t.prototype.decohereInput=function(){if(this.version>=0){this.willDecohereInput(),this.version=-1,this.onDecohereInput();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1)t[e].decohereOutput();this.didDecohereInput()}},t.prototype.recohereInput=function(t){if(this.version<0){this.willRecohereInput(t),this.version=t,this.onRecohereInput(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1)e[r].recohereOutput(t);this.didRecohereInput(t)}},t.prototype.willDecohereInput=function(){},t.prototype.onDecohereInput=function(){},t.prototype.didDecohereInput=function(){},t.prototype.willRecohereInput=function(t){},t.prototype.onRecohereInput=function(t){},t.prototype.didRecohereInput=function(t){},t}();Fn.define(Gn.prototype);var _n=function(){function t(){this.input=null,this.outputs=C.empty,this.version=-1}return t.prototype.bindInput=function(t){var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},t.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},t.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},t.prototype.outputIterator=function(){return M.array(this.outputs)},t.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},t.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},t.prototype.unbindOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}},t.prototype.disconnectOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){var n=t[e];n.unbindInput(),n.disconnectOutputs()}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),this.version=-1,this.onDecohere();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1)t[e].decohereOutput();this.didDecohere()}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this.version<0){this.willRecohere(t),this.version=t,null!==this.input&&this.input.recohereInput(t),this.onRecohere(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1)e[r].recohereOutput(t);this.didRecohere(t)}},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t}();Fn.define(_n.prototype);var Qn=function(t){function e(e,r){var n=t.call(this)||this;return n.input=e,n.key=r,n}return P(e,t),e.prototype.get=function(){return this.input.get(this.key)},e}(Gn),Zn=function(){function t(){this.input=null,this.effects=new xe,this.version=-1}return t.prototype.bindInput=function(t){if(!Kn.is(t))throw new TypeError(""+t);var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},t.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},t.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},t.prototype.disconnectOutputs=function(){},t.prototype.decohereOutputKey=function(t,e){var r=this.effects;r.get(t)!==e&&(this.willDecohereOutputKey(t,e),this.effects=r.updated(t,e),this.version=-1,this.onDecohereOutputKey(t,e),this.didDecohereOutputKey(t,e))},t.prototype.decohereOutput=function(){this.version>=0&&(this.willDecohereOutput(),this.version=-1,this.onDecohereOutput(),this.didDecohereOutput())},t.prototype.recohereOutputKey=function(t,e){if(this.version<0){var r=this.effects,n=r.get(t);void 0!==n&&(this.willRecohereOutputKey(t,n,e),this.effects=r.removed(t),null!==this.input&&this.input.recohereInputKey(t,e),this.onRecohereOutputKey(t,n,e),this.didRecohereOutputKey(t,n,e))}},t.prototype.recohereOutput=function(t){this.version<0&&(this.willRecohereOutput(t),this.effects.forEach((function(e){this.recohereOutputKey(e,t)}),this),this.version=t,this.onRecohereOutput(t),this.didRecohereOutput(t))},t.prototype.willDecohereOutputKey=function(t,e){},t.prototype.onDecohereOutputKey=function(t,e){},t.prototype.didDecohereOutputKey=function(t,e){},t.prototype.willDecohereOutput=function(){},t.prototype.onDecohereOutput=function(){},t.prototype.didDecohereOutput=function(){},t.prototype.willRecohereOutputKey=function(t,e,r){},t.prototype.onRecohereOutputKey=function(t,e,r){},t.prototype.didRecohereOutputKey=function(t,e,r){},t.prototype.willRecohereOutput=function(t){},t.prototype.onRecohereOutput=function(t){},t.prototype.didRecohereOutput=function(t){},t}(),Jn=function(){function t(){this.effects=new xe,this.outlets=new xe,this.outputs=C.empty,this.version=-1}return t.prototype.outlet=function(t){var e=this.outlets,r=e.get(t);return void 0===r&&(r=new Qn(this,t),this.outlets=e.updated(t,r)),r},t.prototype.outputIterator=function(){return M.array(this.outputs)},t.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},t.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},t.prototype.unbindOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){e[r].unbindInput()}},t.prototype.disconnectOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){var i=e[r];i.unbindInput(),i.disconnectOutputs()}},t.prototype.disconnectInputs=function(){},t.prototype.decohereInputKey=function(t,e){var r=this.effects;if(r.get(t)!==e){this.willDecohereInputKey(t,e),this.effects=r.updated(t,e),this.version=-1,this.onDecohereInputKey(t,e);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var s=n[i];Ln.is(s)?s.decohereOutputKey(t,e):s.decohereOutput()}var u=this.outlets.get(t);void 0!==u&&u.decohereInput(),this.didDecohereInputKey(t,e)}},t.prototype.decohereInput=function(){if(this.version>=0){this.willDecohereInput(),this.version=-1,this.onDecohereInput();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1){t[e].decohereOutput()}this.outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohereInput()}},t.prototype.recohereInputKey=function(t,e){if(this.version<0){var r=this.effects,n=r.get(t);if(void 0!==n){this.willRecohereInputKey(t,n,e),this.effects=r.removed(t),this.onRecohereInputKey(t,n,e);for(var i=this.outputs,o=0,s=i.length;o<s;o+=1){var u=i[o];Ln.is(u)&&u.recohereOutputKey(t,e)}var a=this.outlets.get(t);void 0!==a&&a.recohereInput(e),this.didRecohereInputKey(t,n,e)}}},t.prototype.recohereInput=function(t){if(this.version<0){this.willRecohereInput(t),this.effects.forEach((function(e){this.recohereInputKey(e,t)}),this),this.version=t,this.onRecohereInput(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1){e[r].recohereOutput(t)}this.didRecohereInput(t)}},t.prototype.willDecohereInputKey=function(t,e){},t.prototype.onDecohereInputKey=function(t,e){},t.prototype.didDecohereInputKey=function(t,e){},t.prototype.willDecohereInput=function(){},t.prototype.onDecohereInput=function(){},t.prototype.didDecohereInput=function(){},t.prototype.willRecohereInputKey=function(t,e,r){},t.prototype.onRecohereInputKey=function(t,e,r){},t.prototype.didRecohereInputKey=function(t,e,r){},t.prototype.willRecohereInput=function(t){},t.prototype.onRecohereInput=function(t){},t.prototype.didRecohereInput=function(t){},t}();Bn.define(Jn.prototype);var $n=function(){function t(){this.input=null,this.effects=new xe,this.outlets=new xe,this.outputs=C.empty,this.version=-1}return t.prototype.bindInput=function(t){if(!Kn.is(t))throw new TypeError(""+t);var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},t.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},t.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},t.prototype.outlet=function(t){var e=this.outlets,r=e.get(t);return void 0===r&&(r=new Qn(this,t),this.outlets=e.updated(t,r)),r},t.prototype.outputIterator=function(){return M.array(this.outputs)},t.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},t.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},t.prototype.unbindOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){e[r].unbindInput()}},t.prototype.disconnectOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){var i=e[r];i.unbindInput(),i.disconnectOutputs()}},t.prototype.decohereOutputKey=function(t,e){this.decohereKey(t,e)},t.prototype.decohereInputKey=function(t,e){this.decohereKey(t,e)},t.prototype.decohereKey=function(t,e){var r=this.effects;if(r.get(t)!==e){this.willDecohereKey(t,e),this.effects=r.updated(t,e),this.version=-1,this.onDecohereKey(t,e);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var s=n[i];Ln.is(s)?s.decohereOutputKey(t,e):s.decohereOutput()}var u=this.outlets.get(t);void 0!==u&&u.decohereInput(),this.didDecohereKey(t,e)}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),this.version=-1,this.onDecohere();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1){t[e].decohereOutput()}this.outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohere()}},t.prototype.recohereOutputKey=function(t,e){this.recohereKey(t,e)},t.prototype.recohereInputKey=function(t,e){this.recohereKey(t,e)},t.prototype.recohereKey=function(t,e){if(this.version<0){var r=this.effects,n=r.get(t);if(void 0!==n){this.willRecohereKey(t,n,e),this.effects=r.removed(t),null!==this.input&&this.input.recohereInputKey(t,e),this.onRecohereKey(t,n,e);for(var i=this.outputs,o=0,s=i.length;o<s;o+=1){var u=i[o];Ln.is(u)&&u.recohereOutputKey(t,e)}var a=this.outlets.get(t);void 0!==a&&a.recohereInput(e),this.didRecohereKey(t,n,e)}}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this.version<0){this.willRecohere(t),this.effects.forEach((function(e){this.recohereKey(e,t)}),this),this.version=t,this.onRecohere(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1){e[r].recohereOutput(t)}this.didRecohere(t)}},t.prototype.willDecohereKey=function(t,e){},t.prototype.onDecohereKey=function(t,e){},t.prototype.didDecohereKey=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohereKey=function(t,e,r){},t.prototype.onRecohereKey=function(t,e,r){},t.prototype.didRecohereKey=function(t,e,r){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t}();Bn.define($n.prototype);var ti=function(){function t(){this.input=null,this.effects=new xe,this.outputs=C.empty,this.version=-1}return t.prototype.bindInput=function(t){if(!Kn.is(t))throw new TypeError(""+t);var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},t.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},t.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},t.prototype.outputIterator=function(){return M.array(this.outputs)},t.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},t.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},t.prototype.unbindOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}},t.prototype.disconnectOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){var n=t[e];n.unbindInput(),n.disconnectOutputs()}},t.prototype.decohereOutputKey=function(t,e){var r=this.effects;if(r.get(t)!==e){this.willDecohereOutputKey(t,e),this.effects=r.updated(t,e),this.version=-1,this.onDecohereOutputKey(t,e);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){n[i].decohereOutput()}this.didDecohereOutputKey(t,e)}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),this.version=-1,this.onDecohere();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1){t[e].decohereOutput()}this.didDecohere()}},t.prototype.recohereOutputKey=function(t,e){if(this.version<0){var r=this.effects,n=r.get(t);void 0!==n&&(this.willRecohereOutputKey(t,n,e),this.effects=r.removed(t),null!==this.input&&this.input.recohereInputKey(t,e),this.onRecohereOutputKey(t,n,e),this.didRecohereOutputKey(t,n,e))}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this.version<0){this.willRecohere(t),this.effects.forEach((function(e){this.recohereOutputKey(e,t)}),this),this.version=t,this.onRecohere(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1){e[r].recohereOutput(t)}this.didRecohere(t)}},t.prototype.willDecohereOutputKey=function(t,e){},t.prototype.onDecohereOutputKey=function(t,e){},t.prototype.didDecohereOutputKey=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohereOutputKey=function(t,e,r){},t.prototype.onRecohereOutputKey=function(t,e,r){},t.prototype.didRecohereOutputKey=function(t,e,r){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t}();Fn.define(ti.prototype);var ei=function(){function t(){this.input=null,this.outputEffects=new xe,this.inputEffects=new xe,this.outlets=new xe,this.outputs=C.empty,this.version=-1}return t.prototype.bindInput=function(t){if(!Kn.is(t))throw new TypeError(""+t);var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},t.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},t.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},t.prototype.outlet=function(t){var e=this.outlets,r=e.get(t);return void 0===r&&(r=new Qn(this,t),this.outlets=e.updated(t,r)),r},t.prototype.outputIterator=function(){return M.array(this.outputs)},t.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},t.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},t.prototype.unbindOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){e[r].unbindInput()}},t.prototype.disconnectOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){var i=e[r];i.unbindInput(),i.disconnectOutputs()}},t.prototype.decohereOutputKey=function(t,e){var r=this.outputEffects;r.get(t)!==e&&(this.willDecohereOutputKey(t,e),this.outputEffects=r.updated(t,e),this.version=-1,this.onDecohereOutputKey(t,e),this.didDecohereOutputKey(t,e))},t.prototype.decohereInputKey=function(t,e){var r=this.inputEffects;if(r.get(t)!==e){this.willDecohereInputKey(t,e),this.inputEffects=r.updated(t,e),this.version=-1,this.onDecohereInputKey(t,e);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var s=n[i];Ln.is(s)?s.decohereOutputKey(t,e):s.decohereOutput()}var u=this.outlets.get(t);void 0!==u&&u.decohereInput(),this.didDecohereInputKey(t,e)}},t.prototype.decohereOutput=function(){this.decohere()},t.prototype.decohereInput=function(){this.decohere()},t.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),this.version=-1,this.onDecohere();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1){t[e].decohereOutput()}this.outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohere()}},t.prototype.recohereOutputKey=function(t,e){if(this.version<0){var r=this.outputEffects,n=r.get(t);void 0!==n&&(this.willRecohereOutputKey(t,n,e),this.outputEffects=r.removed(t),null!==this.input&&this.input.recohereInputKey(t,e),this.onRecohereOutputKey(t,n,e),this.didRecohereOutputKey(t,n,e))}},t.prototype.recohereInputKey=function(t,e){if(this.version<0){var r=this.inputEffects,n=r.get(t);if(void 0!==n){var i=this.willRecohereInputKey(t,n,e);n!==i&&this.decohereInputKey(t,i),this.inputEffects=r.removed(t),this.onRecohereInputKey(t,i,e);for(var o=this.outputs,s=0,u=o.length;s<u;s+=1){var a=o[s];Ln.is(a)&&a.recohereOutputKey(t,e)}var p=this.outlets.get(t);void 0!==p&&p.recohereInput(e),this.didRecohereInputKey(t,i,e)}}},t.prototype.recohereOutput=function(t){this.recohere(t)},t.prototype.recohereInput=function(t){this.recohere(t)},t.prototype.recohere=function(t){if(this.version<0){this.willRecohere(t),this.outputEffects.forEach((function(e){this.recohereOutputKey(e,t)}),this),this.inputEffects.forEach((function(e){this.recohereInputKey(e,t)}),this),this.version=t,this.onRecohere(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1){e[r].recohereOutput(t)}this.didRecohere(t)}},t.prototype.willDecohereOutputKey=function(t,e){},t.prototype.onDecohereOutputKey=function(t,e){},t.prototype.didDecohereOutputKey=function(t,e){},t.prototype.willDecohereInputKey=function(t,e){},t.prototype.onDecohereInputKey=function(t,e){},t.prototype.didDecohereInputKey=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.didDecohere=function(){},t.prototype.willRecohereOutputKey=function(t,e,r){},t.prototype.onRecohereOutputKey=function(t,e,r){},t.prototype.didRecohereOutputKey=function(t,e,r){},t.prototype.willRecohereInputKey=function(t,e,r){return e},t.prototype.onRecohereInputKey=function(t,e,r){},t.prototype.didRecohereInputKey=function(t,e,r){},t.prototype.willRecohere=function(t){},t.prototype.onRecohere=function(t){},t.prototype.didRecohere=function(t){},t}();Bn.define(ei.prototype);var ri=function(t){function e(e){var r=t.call(this)||this;return r.outlet=e,r}return P(e,t),e.prototype.onDecohereOutput=function(){this.outlet.decohereInput()},e.prototype.onRecohereOutput=function(t){this.outlet.recohereInput(t)},e}(Yn),ni=function(t){function e(e){var r=t.call(this)||this;return r.outlet=e,r}return P(e,t),e.prototype.onDecohereOutputKey=function(t,e){this.outlet.decohereInput()},e.prototype.onDecohereOutput=function(){this.outlet.decohereInput()},e.prototype.onRecohereOutputKey=function(t,e,r){this.outlet.recohereInput(r)},e.prototype.onRecohereOutput=function(t){this.outlet.recohereInput(t)},e}(Zn),ii=function(t){function e(e){var r=t.call(this)||this;return r.state=e,r}return P(e,t),e.prototype.get=function(){return this.state},e.prototype.set=function(t){var e=this.state;return e!==t&&(this.state=t,this.decohereInput()),e},e}(Gn),oi=function(t){function e(e){var r=t.call(this)||this;return r.state=e,r}return P(e,t),e.prototype.get=function(){return this.state},e.prototype.onRecohereOutput=function(t){var e=this.input;null!==e&&(this.state=e.get())},e}(Yn),si=function(t){function e(e){var r=t.call(this)||this;void 0===e&&(e=new xe),r.state=e;var n=r.effects;return e.forEach((function(t){n=n.updated(t,0)}),r),r.effects=n,r}return P(e,t),e.prototype.has=function(t){return this.state.has(t)},e.prototype.get=function(t){return void 0===t?this.state:this.state.get(t)},e.prototype.set=function(t,e){var r=this.state,n=r.get(t);return n!==e&&(this.state=r.updated(t,e),this.decohereInputKey(t,0)),n},e.prototype.delete=function(t){var e=this.state,r=e.removed(t);return e!==r&&(this.state=r,this.decohereInputKey(t,1)),this},e.prototype.keyIterator=function(){return this.state.keys()},e}(Jn),ui=function(t){function e(){var e=t.call(this)||this;return e.state=new xe,e}return P(e,t),e.prototype.get=function(){return this.state},e.prototype.onRecohereOutputKey=function(t,e,r){if(0===e){var n=this.input;if(null!==n){var i=n.get(t);this.state=void 0!==i?this.state.updated(t,i):this.state.removed(t)}}else 1===e&&(this.state=this.state.removed(t))},e}(Zn),ai=function(t){function e(){var e=t.call(this)||this;return e.state=void 0,e}return P(e,t),e.prototype.get=function(){return this.state},e.prototype.onRecohere=function(t){var e=this.input;null!==e&&(this.state=e.get())},e.prototype.memoize=function(){return this},e}(_n),pi=function(t){function e(){var e=t.call(this)||this;return e.state=void 0,e.cache=new xe,e}return P(e,t),e.prototype.has=function(t){return this.cache.has(t)},e.prototype.get=function(t){if(void 0===t){var e=this.state,r=this.input;return void 0===e&&null!==r&&(e=r.get(),this.state=e),e}return this.cache.get(t)},e.prototype.keyIterator=function(){return this.cache.keys()},e.prototype.onRecohereKey=function(t,e,r){if(0===e){var n=this.input;if(null!==n){var i=n.get(t);this.cache=void 0!==i?this.cache.updated(t,i):this.cache.removed(t)}}else 1===e&&(this.cache=this.cache.removed(t))},e.prototype.onRecohere=function(t){this.state=void 0},e.prototype.memoize=function(){return this},e}($n),hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.has=function(t){var e=this.input;if(null!==e){var r=e.get(t);return void 0!==r&&this.evaluate(t,r)}return!1},e.prototype.get=function(t){if(void 0===t){for(var e=new xe,r=this.keyIterator();;){var n=r.next();if(n.done)break;var i=n.value;void 0!==(o=this.input.get(i))&&this.evaluate(i,o)&&e.set(i,o)}return e}var o,s=this.input;if(null!==s&&void 0!==(o=s.get(t))&&this.evaluate(t,o))return o},e.prototype.keyIterator=function(){var t=this.input;return null!==t?t.keyIterator():M.empty()},e.prototype.onDecohereOutputKey=function(t,e){this.decohereInputKey(t,e)},e.prototype.onRecohereOutputKey=function(t,e,r){this.recohereInputKey(t,r)},e.prototype.willRecohereInputKey=function(t,e,r){if(0===e){var n=this.input;if(null!==n){var i=n.get(t);if(void 0===i||!this.evaluate(t,i))return 1}}return e},e}(ei),fi=function(t){function e(e){var r=t.call(this)||this;return r.func=e,r}return P(e,t),e.prototype.evaluate=function(t,e){return(0,this.func)(t,e)},e}(hi),ci=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.get=function(){var t=this.input;return null!==t?this.evaluate(t.get()):void 0},e}(_n),li=function(t){function e(e){var r=t.call(this)||this;return r.func=e,r}return P(e,t),e.prototype.evaluate=function(t){return void 0!==t?(0,this.func)(t):void 0},e}(ci),di=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.has=function(t){var e=this.input;return null!==e&&e.has(t)},e.prototype.get=function(t){if(void 0===t){for(var e=new xe,r=this.keyIterator();;){var n=r.next();if(n.done)break;var i=n.value,o=this.evaluate(i,this.input.get(i));void 0!==o&&e.set(i,o)}return e}var s=this.input;return null!==s?this.evaluate(t,s.get(t)):void 0},e.prototype.keyIterator=function(){var t=this.input;return null!==t?t.keyIterator():M.empty()},e}($n),yi=function(t){function e(e){var r=t.call(this)||this;return r.func=e,r}return P(e,t),e.prototype.evaluate=function(t,e){return void 0!==e?(0,this.func)(t,e):void 0},e}(di),vi=function(t){function e(){var e=t.call(this)||this;return e.state=new xe,e}return P(e,t),e.prototype.get=function(){return this.state.reduced(this.identity,this.accumulate.bind(this),this.combine.bind(this))},e.prototype.onRecohereOutputKey=function(t,e,r){if(0===e){var n=this.input;if(null!==n){var i=n.get(t);void 0!==i?this.state.set(t,i):this.state.delete(t)}}else 1===e&&this.state.delete(t)},e}(ti),mi=function(t){function e(e,r,n){var i=t.call(this)||this;return i.identity=e,i.accumulator=r,i.combiner=n,i}return P(e,t),e.prototype.get=function(){return this.state.reduced(this.identity,this.accumulator,this.combiner)},e.prototype.accumulate=function(t,e){return(0,this.accumulator)(t,e)},e.prototype.combine=function(t,e){return(0,this.combiner)(t,e)},e}(vi),wi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.onRecohereOutput=function(t){var e=this.input;null!==e&&this.evaluate(e.get())},e}(Yn),gi=function(t){function e(e){var r=t.call(this)||this;return r.func=e,r}return P(e,t),e.prototype.evaluate=function(t){if(void 0!==t)return(0,this.func)(t)},e}(wi),bi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.onRecohereOutputKey=function(t,e,r){if(0===e){var n=this.input;null!==n?this.evaluate(t,n.get(t)):this.evaluate(t,void 0)}else 1===e&&this.evaluate(t,void 0)},e}(Zn),xi=function(t){function e(e){var r=t.call(this)||this;return r.func=e,r}return P(e,t),e.prototype.evaluate=function(t,e){if(void 0!==e)return(0,this.func)(t,e)},e}(bi),Oi=function(t){function e(e){var r=t.call(this)||this;return r.streamlet=e,r}return P(e,t),e.prototype.willDecohereOutput=function(){var t=this.streamlet;void 0!==t.willDecohereInlet&&t.willDecohereInlet(this)},e.prototype.didDecohereOutput=function(){var t=this.streamlet;void 0!==t.didDecohereInlet?t.didDecohereInlet(this):t.decohere()},e.prototype.willRecohereOutput=function(t){var e=this.streamlet;void 0!==e.willRecohereInlet&&e.willRecohereInlet(this,t)},e.prototype.didRecohereOutput=function(t){var e=this.streamlet;void 0!==e.didRecohereInlet?e.didRecohereInlet(this,t):e.recohere(t)},e}(Yn),Ci=function(t){function e(e){var r=t.call(this)||this;return r.streamlet=e,r}return P(e,t),e.prototype.get=function(){var t=this.streamlet;return void 0!==t.getOutput?t.getOutput(this):void 0},e.prototype.willDecohereInput=function(){var t=this.streamlet;void 0!==t.willDecohereOutlet&&t.willDecohereOutlet(this)},e.prototype.didDecohereInput=function(){var t=this.streamlet;void 0!==t.didDecohereOutlet?t.didDecohereOutlet(this):t.decohere()},e.prototype.willRecohereInput=function(t){var e=this.streamlet;void 0!==e.willRecohereOutlet&&e.willRecohereOutlet(this,t)},e.prototype.didRecohereInput=function(t){var e=this.streamlet;void 0!==e.didRecohereOutlet&&e.didRecohereOutlet(this,t)},e}(Gn),Ei=function(t){function e(e){var r=t.call(this)||this;return r.streamlet=e,r}return P(e,t),e.prototype.get=function(){var t=this.streamlet;if(void 0!==t.getOutput){var e=t.getOutput(this);if(void 0!==e)return e}var r=this.input;return null!==r?r.get():void 0},e.prototype.willDecohere=function(){var t=this.streamlet;void 0!==t.willDecohereOutlet&&t.willDecohereOutlet(this)},e.prototype.didDecohere=function(){var t=this.streamlet;void 0!==t.didDecohereOutlet?t.didDecohereOutlet(this):t.decohere()},e.prototype.willRecohere=function(t){var e=this.streamlet;void 0!==e.willRecohereOutlet&&e.willRecohereOutlet(this,t)},e.prototype.didRecohere=function(t){var e=this.streamlet;void 0!==e.didRecohereOutlet&&e.didRecohereOutlet(this,t)},e}(_n),Pi=function(t,e,r){this.key=t,this.name=e,this.type=r},Si=function(t,e,r){this.key=t,this.name=e,this.type=r},ki=function(t,e,r){this.key=t,this.name=e,this.type=r},Mi=function(){function t(t){void 0===t&&(t=null),this.streamletScope=t,this.streamletContext=null,this.version=-1}return t.prototype.setStreamletScope=function(t){this.streamletScope=t},t.prototype.setStreamletContext=function(t){this.streamletContext=t},t.prototype.inlet=function(e){return void 0===e?new Oi(this):t.reflectInletKey(e,this,Object.getPrototypeOf(this))},t.prototype.bindInput=function(t,e){var r=this.inlet(t);if(null===r)throw new Error(""+t);r.bindInput(e)},t.prototype.unbindInput=function(t){var e=this.inlet(t);if(null===e)throw new Error(""+t);e.unbindInput()},t.prototype.outlet=function(e){return void 0===e?new Ci(this):"string"==typeof e?t.reflectOutletKey(e,this,Object.getPrototypeOf(this)):e},t.prototype.inoutlet=function(){return new Ei(this)},t.prototype.decohere=function(){this.version>=0&&(this.willDecohere(),this.version=-1,this.onDecohere(),this.onDecohereOutlets(),this.didDecohere())},t.prototype.recohere=function(t){this.version<0&&(this.willRecohere(t),this.version=t,this.onRecohereInlets(t),this.onRecohere(t),this.onRecohereOutlets(t),this.didRecohere(t))},t.prototype.getInput=function(t,e){var r;if("string"==typeof t&&(t=this.inlet(t)),null!==t){var n=t.input;null!==n&&(r=n.get())}return void 0===r&&(r=e),r},t.prototype.getOutput=function(t){},t.prototype.disconnectInputs=function(){t.disconnectInputs(this,Object.getPrototypeOf(this))},t.disconnectInputs=function(e,r){for(;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"inlets"))for(var n in r.inlets){var i=r.inlets[n];if(i instanceof Pi)t.reflectInletField(e,i).disconnectInputs();else if(i instanceof ki){t.reflectInoutletField(e,i).disconnectInputs()}}r=Object.getPrototypeOf(r)}},t.prototype.disconnectOutputs=function(){t.disconnectOutputs(this,Object.getPrototypeOf(this))},t.disconnectOutputs=function(e,r){for(;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"outlets"))for(var n in r.outlets){var i=r.outlets[n];if(i instanceof Si)t.reflectOutletField(e,i).disconnectOutputs();else if(i instanceof ki){t.reflectInoutletField(e,i).disconnectOutputs()}}r=Object.getPrototypeOf(r)}},t.prototype.willDecohereInlet=function(t){},t.prototype.didDecohereInlet=function(t){this.decohere()},t.prototype.willRecohereInlet=function(t,e){},t.prototype.didRecohereInlet=function(t,e){this.recohere(e)},t.prototype.willDecohereOutlet=function(t){},t.prototype.didDecohereOutlet=function(t){},t.prototype.willRecohereOutlet=function(t,e){},t.prototype.didRecohereOutlet=function(t,e){},t.prototype.willDecohere=function(){},t.prototype.onDecohere=function(){},t.prototype.onDecohereOutlets=function(){t.decohereOutlets(this,Object.getPrototypeOf(this))},t.decohereOutlets=function(e,r){for(;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"outlets"))for(var n in r.outlets){var i=r.outlets[n];if(i instanceof Si)t.reflectOutletField(e,i).decohereInput();else if(i instanceof ki){t.reflectInoutletField(e,i).decohereInput()}}r=Object.getPrototypeOf(r)}},t.prototype.didDecohere=function(){},t.prototype.willRecohere=function(t){},t.prototype.onRecohereInlets=function(e){t.recohereInlets(e,this,Object.getPrototypeOf(this))},t.recohereInlets=function(e,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"inlets"))for(var i in n.inlets){var o=n.inlets[i];if(o instanceof Pi)t.reflectInletField(r,o).recohereOutput(e);else if(o instanceof ki){t.reflectInoutletField(r,o).recohereOutput(e)}}n=Object.getPrototypeOf(n)}},t.prototype.onRecohere=function(t){},t.prototype.onRecohereOutlets=function(e){t.recohereOutlets(e,this,Object.getPrototypeOf(this))},t.recohereOutlets=function(e,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"outlets"))for(var i in n.outlets){var o=n.outlets[i];if(o instanceof Si)t.reflectOutletField(r,o).recohereInput(e);else if(o instanceof ki){t.reflectInoutletField(r,o).recohereInput(e)}}n=Object.getPrototypeOf(n)}},t.prototype.didRecohere=function(t){},t.reflectEachInlet=function(e,r,n,i){for(var o=0;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"inlets"))for(var s in r.inlets){var u=r.inlets[s],a=void 0;if(null!==(a=u instanceof Pi?t.reflectInletField(e,u):u instanceof ki?t.reflectInoutletField(e,u):null)){var p=n.call(i,a,u.name,o);if(void 0!==p)return p;o+=1}}r=Object.getPrototypeOf(r)}},t.reflectEachOutlet=function(e,r,n,i){for(var o=0;null!==r;){if(Object.prototype.hasOwnProperty.call(r,"outlets"))for(var s in r.outlets){var u=r.outlets[s],a=void 0;if(null!==(a=u instanceof Si?t.reflectOutletField(e,u):u instanceof ki?t.reflectInoutletField(e,u):null)){var p=n.call(i,a,u.name,o);if(void 0!==p)return p;o+=1}}r=Object.getPrototypeOf(r)}},t.reflectInletCount=function(t){for(var e=0;null!==t;){if(Object.prototype.hasOwnProperty.call(t,"inlets"))for(var r in t.inlets)e+=1;t=Object.getPrototypeOf(t)}return e},t.reflectOutletCount=function(t){for(var e=0;null!==t;){if(Object.prototype.hasOwnProperty.call(t,"outlets"))for(var r in t.outlets)e+=1;t=Object.getPrototypeOf(t)}return e},t.reflectInletIndex=function(e,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"inlets"))for(var i in n.inlets){if(0===e){var o=n.inlets[i];return o instanceof Pi?[o.name,t.reflectInletField(r,o)]:o instanceof ki?[o.name,t.reflectInoutletField(r,o)]:null}e-=1}n=Object.getPrototypeOf(n)}return null},t.reflectOutletIndex=function(e,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"outlets"))for(var i in n.outlets){if(0===e){var o=n.outlets[i];return o instanceof Si?[o.name,t.reflectOutletField(r,o)]:o instanceof ki?[o.name,t.reflectInoutletField(r,o)]:null}e-=1}n=Object.getPrototypeOf(n)}return null},t.reflectInletKey=function(e,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"inlets")){var i=n.inlets[e];if(void 0!==i)return i instanceof Pi?t.reflectInletField(r,i):i instanceof ki?t.reflectInoutletField(r,i):null}n=Object.getPrototypeOf(n)}return null},t.reflectOutletKey=function(e,r,n){for(;null!==n;){if(Object.prototype.hasOwnProperty.call(n,"outlets")){var i=n.outlets[e];if(void 0!==i)return i instanceof Si?t.reflectOutletField(r,i):i instanceof ki?t.reflectInoutletField(r,i):null}n=Object.getPrototypeOf(n)}return null},t.reflectInletField=function(e,r){if("value"===r.type)return t.reflectValueInletField(e,r.key);if("map"===r.type)return t.reflectMapInletField(e,r.key);throw new TypeError(r.type)},t.reflectValueInletField=function(e,r){var n=e[r];return void 0===n&&(n=e instanceof t?e.inlet():new Oi(e),e[r]=n),n},t.reflectMapInletField=function(t,e){return null},t.reflectOutletField=function(e,r){if("value"===r.type)return t.reflectValueOutletField(e,r.key);if("map"===r.type)return t.reflectMapOutletField(e,r.key);throw new TypeError(r.type)},t.reflectValueOutletField=function(e,r){var n=e[r];return void 0===n&&(n=e instanceof t?e.outlet():new Ci(e),e[r]=n),n},t.reflectMapOutletField=function(t,e){return null},t.reflectInoutletField=function(e,r){if("value"===r.type)return t.reflectValueInoutletField(e,r.key);if("map"===r.type)return t.reflectMapInoutletField(e,r.key);throw new TypeError(r.type)},t.reflectValueInoutletField=function(e,r){var n=e[r];return void 0===n&&(n=e instanceof t?e.inoutlet():new Ei(e),e[r]=n),n},t.reflectMapInoutletField=function(t,e){return null},t.init=function(t){Object.prototype.hasOwnProperty.call(t,"inlets")||(t.inlets={}),Object.prototype.hasOwnProperty.call(t,"outlets")||(t.outlets={}),Object.prototype.hasOwnProperty.call(t,"inoutlets")||(t.inoutlets={})},t.decorateInlet=function(e,r,n){t.init(r);var i=void 0!==e.name?e.name:n.toString(),o=void 0!==e.type?e.type:"value",s=new Pi(n.toString(),i,o);r.inlets[i]=s},t.decorateOutlet=function(e,r,n){t.init(r);var i=void 0!==e.name?e.name:n.toString(),o=void 0!==e.type?e.type:"value",s=new Si(n.toString(),i,o);r.outlets[i]=s},t.decorateInoutlet=function(e,r,n){t.init(r);var i=void 0!==e.name?e.name:n.toString(),o=void 0!==e.type?e.type:"value",s=new ki(n.toString(),i,o);r.inlets[i]=s,r.outlets[i]=s,r.inoutlets[i]=s},t}();function Ai(t,e){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),Mi.decorateOutlet.bind(void 0,t);Mi.decorateOutlet({},t,e)}function Di(t,e){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),Mi.decorateInoutlet.bind(void 0,t);Mi.decorateInoutlet({},t,e)}var Ii={is:function(t){if("object"==typeof t&&null!==t){var e=t;return Kn.is(e)&&Hn.is(e)}return!1}},Ti=function(t){function e(){var e=t.call(this)||this;return e.effects=new xe,e.outlets=new xe,e.outputs=C.empty,e.version=-1,e}return P(e,t),Object.defineProperty(e.prototype,"streamletContext",{get:function(){var t=this.streamletScope;return null!==t?t.streamletContext:null},enumerable:!1,configurable:!0}),e.prototype.hasOwn=function(t){return this.has(t)},e.prototype.get=function(e){return void 0===e?this:t.prototype.get.call(this,e)},e.prototype.outlet=function(t){if("string"==typeof t&&(t=lr.from(t)),!this.hasOwn(t)){var e=this.streamletScope;if(Ii.is(e)&&e.has(t))return e.outlet(t)}var r=this.outlets,n=r.get(t);return void 0===n&&(n=new Qn(this,t),this.outlets=r.updated(t,n),this.decohereInputKey(t,0)),n},e.prototype.outputIterator=function(){return M.array(this.outputs)},e.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},e.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},e.prototype.unbindOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){e[r].unbindInput()}},e.prototype.disconnectOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.disconnectOutputs()}),this));var r=this.outputs;this.outputs=C.empty;for(var n=0,i=r.length;n<i;n+=1){var o=r[n];o.unbindInput(),o.disconnectOutputs()}this.forEach((function(t){t instanceof Je&&(t=t.toValue()),(t instanceof e||t instanceof Vi||Ii.is(t))&&t.disconnectOutputs()}),this)},e.prototype.disconnectInputs=function(){},e.prototype.decohereInputKey=function(t,e){var r=this.effects;if(r.get(t)!==e){this.willDecohereInputKey(t,e),this.effects=r.updated(t,e),this.version=-1,this.onDecohereInputKey(t,e);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var s=n[i];Ln.is(s)?s.decohereOutputKey(t,e):s.decohereOutput()}var u=this.outlets.get(t);void 0!==u&&u.decohereInput(),this.didDecohereInputKey(t,e)}},e.prototype.decohereInput=function(){if(this.version>=0){this.willDecohereInput(),this.version=-1,this.onDecohereInput();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1){t[e].decohereOutput()}this.outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohereInput()}},e.prototype.recohereInputKey=function(t,e){if(this.version<0){var r=this.effects,n=r.get(t);if(void 0!==n){this.willRecohereInputKey(t,n,e),this.effects=r.removed(t),this.onRecohereInputKey(t,n,e);for(var i=this.outputs,o=0,s=i.length;o<s;o+=1){var u=i[o];Ln.is(u)&&u.recohereOutputKey(t,e)}var a=this.outlets.get(t);void 0!==a&&a.recohereInput(e),this.didRecohereInputKey(t,n,e)}}},e.prototype.recohereInput=function(t){if(this.version<0){this.willRecohereInput(t),this.effects.forEach((function(e){this.recohereInputKey(e,t)}),this),this.version=t,this.onRecohereInput(t);for(var r=this.outputs,n=0,i=r.length;n<i;n+=1){r[n].recohereOutput(t)}this.forEach((function(r){r instanceof Je&&(r=r.toValue()),r instanceof e?r.recohereInput(t):r instanceof Vi?r.recohere(t):Ii.is(r)&&r.recohereInput(t)}),this),this.didRecohereInput(t)}},e.prototype.willDecohereInputKey=function(t,e){},e.prototype.onDecohereInputKey=function(t,e){},e.prototype.didDecohereInputKey=function(t,e){},e.prototype.willDecohereInput=function(){},e.prototype.onDecohereInput=function(){},e.prototype.didDecohereInput=function(){},e.prototype.willRecohereInputKey=function(t,e,r){},e.prototype.onRecohereInputKey=function(t,e,r){},e.prototype.didRecohereInputKey=function(t,e,r){},e.prototype.willRecohereInput=function(t){},e.prototype.onRecohereInput=function(t){},e.prototype.didRecohereInput=function(t){},e.prototype.filter=function(e){if("function"!=typeof e)return t.prototype.filter.call(this,e);var r=new fi(e);return r.bindInput(this),r},e}(or);Object.defineProperty(Ti.prototype,"streamletScope",{get:function(){return null},enumerable:!0,configurable:!0}),Bn.define(Ti.prototype);var Vi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.isConstant=function(){return!1},e.prototype.compile=function(){Mi.reflectEachInlet(this,Object.getPrototypeOf(this),(function(t,e){null===t.input&&this.compileInlet(t,e)}),this)},e.prototype.compileInlet=function(t,e){var r=this.streamletScope;if(null!==r){var n=r.outlet(e);null!==n&&t.bindInput(n)}},e}(or),ji=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.streamletScope=e,r.streamletContext=null,r.version=-1,r}return P(e,t),e.prototype.setStreamletScope=function(t){this.streamletScope=t},e.prototype.setStreamletContext=function(t){this.streamletContext=t},e.prototype.isEmpty=function(){return 0!==this.length},Object.defineProperty(e.prototype,"length",{get:function(){return Mi.reflectOutletCount(Object.getPrototypeOf(this))},enumerable:!1,configurable:!0}),e.prototype.has=function(t){if(t instanceof lr)t=t.value;else if("string"!=typeof t)return!1;return null!==this.outlet(t)},e.prototype.get=function(t){if(t instanceof lr)t=t.value;else if("string"!=typeof t)return ir.absent();var e=this.outlet(t);if(null!==e){var r=e.get();if(void 0!==r)return r}return ir.absent()},e.prototype.getAttr=function(t){return ir.absent()},e.prototype.getSlot=function(t){return this.get(t)},e.prototype.getField=function(t){if("string"==typeof t)t=lr.from(t);else if(!(t instanceof lr))return;var e=this.get(t);if(e.isDefined())return $e.of(t,e)},e.prototype.getItem=function(t){t instanceof yr&&(t=t.value);var e=Mi.reflectOutletIndex(t,this,Object.getPrototypeOf(this));if(null!==e){var r=e[0],n=e[1].get();return void 0===n&&(n=ir.extant()),$e.of(r,n)}return Qe.absent()},e.prototype.set=function(t,e){throw new Error("unsupported")},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setSlot=function(t,e){throw new Error("unsupported")},e.prototype.setItem=function(t,e){throw new Error("unsupported")},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];throw new Error("unsupported")},e.prototype.delete=function(t){throw new Error("unsupported")},e.prototype.clear=function(){throw new Error("unsupported")},e.prototype.forEach=function(t,e){return Mi.reflectEachOutlet(this,Object.getPrototypeOf(this),(function(r,n,i){var o=r.get();if(void 0!==o){var s=t.call(e,o,i);if(void 0!==s)return s}}),this)},e.prototype.inlet=function(t){return void 0===t?new Oi(this):Mi.reflectInletKey(t,this,Object.getPrototypeOf(this))},e.prototype.bindInput=function(t,e){var r=this.inlet(t);if(null===r)throw new Error(t);r.bindInput(e)},e.prototype.unbindInput=function(t){var e=this.inlet(t);if(null===e)throw new Error(t);e.unbindInput()},e.prototype.outlet=function(t){return void 0===t?new Ci(this):"string"==typeof t?Mi.reflectOutletKey(t,this,Object.getPrototypeOf(this)):t},e.prototype.inoutlet=function(){return new Ei(this)},e.prototype.decohere=function(){this.version>=0&&(this.willDecohere(),this.version=-1,this.onDecohere(),this.onDecohereOutlets(),this.didDecohere())},e.prototype.recohere=function(t){this.version<0&&(this.willRecohere(t),this.version=t,this.onRecohereInlets(t),this.onRecohere(t),this.onRecohereOutlets(t),this.didRecohere(t))},e.prototype.getInput=function(t,e){var r;if("string"==typeof t&&(t=this.inlet(t)),null!==t){var n=t.input;null!==n&&(r=n.get())}return void 0===r&&(r=e),r},e.prototype.castInput=function(t,e,r){var n,i=this.getInput(t);return void 0!==i&&(n=e.cast(i)),void 0===n&&(n=r),n},e.prototype.coerceInput=function(t,e,r){var n,i=this.getInput(t);return void 0!==i&&(n=e.cast(i)),void 0===n&&(n=e.unit),void 0===n&&(n=r),n},e.prototype.getOutput=function(t){},e.prototype.disconnectInputs=function(){Mi.disconnectInputs(this,Object.getPrototypeOf(this))},e.prototype.disconnectOutputs=function(){Mi.disconnectOutputs(this,Object.getPrototypeOf(this))},e.prototype.willDecohereInlet=function(t){},e.prototype.didDecohereInlet=function(t){this.decohere()},e.prototype.willRecohereInlet=function(t,e){},e.prototype.didRecohereInlet=function(t,e){this.recohere(e)},e.prototype.willDecohereOutlet=function(t){},e.prototype.didDecohereOutlet=function(t){},e.prototype.willRecohereOutlet=function(t,e){},e.prototype.didRecohereOutlet=function(t,e){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.onDecohereOutlets=function(){Mi.decohereOutlets(this,Object.getPrototypeOf(this))},e.prototype.willRecohere=function(t){},e.prototype.onRecohereInlets=function(t){Mi.recohereInlets(t,this,Object.getPrototypeOf(this))},e.prototype.onRecohere=function(t){},e.prototype.onRecohereOutlets=function(t){Mi.recohereOutlets(t,this,Object.getPrototypeOf(this))},e.prototype.didRecohere=function(t){},e}(Vi),qi=function(t){function e(e,r){var n=t.call(this)||this;return n.record=e,n.key=r,n}return P(e,t),e.prototype.onDecohereOutput=function(){var t=this.record;Ii.is(t)&&t.decohereInputKey(this.key,0)},e.prototype.onRecohereOutput=function(t){var e=this.input;if(null!==e){var r=e.get();void 0!==r?this.record.set(this.key,r):this.record.delete(this.key)}},e}(Yn),Ri=function(t){function e(e){var r=t.call(this)||this;return void 0===e&&(e=or.create()),r.state=e,r.fieldUpdaters=new xe,r}return P(e,t),e.prototype.isEmpty=function(){return this.state.isEmpty()},e.prototype.isArray=function(){return this.state.isArray()},e.prototype.isObject=function(){return this.state.isObject()},Object.defineProperty(e.prototype,"length",{get:function(){return this.state.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){return this.state.valueCount},enumerable:!1,configurable:!0}),e.prototype.has=function(t){if(this.state.has(t))return!0;var e=this.streamletScope;return e instanceof or&&e.has(t)},e.prototype.hasOwn=function(t){return this.state.has(t)},e.prototype.indexOf=function(t,e){return this.state.indexOf(t,e)},e.prototype.lastIndexOf=function(t,e){return void 0===e&&(e=0),this.state.lastIndexOf(t,e)},e.prototype.get=function(t){if(void 0===t)return this;t=ir.fromAny(t);var e=this.state.get(t);if(!e.isDefined()){var r=this.streamletScope;r instanceof or&&(e=r.get(t))}return e},e.prototype.getAttr=function(t){t=lr.fromAny(t);var e=this.state.getAttr(t);if(!e.isDefined()){var r=this.streamletScope;r instanceof or&&(e=r.getAttr(t))}return e},e.prototype.getSlot=function(t){t=ir.fromAny(t);var e=this.state.getSlot(t);if(!e.isDefined()){var r=this.streamletScope;r instanceof or&&(e=r.getSlot(t))}return e},e.prototype.getField=function(t){t=ir.fromAny(t);var e=this.state.getField(t);if(void 0===e){var r=this.streamletScope;r instanceof or&&(e=r.getField(t))}return e},e.prototype.getItem=function(t){return this.state.getItem(t)},e.prototype.bindValue=function(t,e){var r=new qi(this,t),n=ho.compile(e,this);r.bindInput(n),this.fieldUpdaters=this.fieldUpdaters.updated(t,r)},e.prototype.set=function(t,e){if(t=ir.fromAny(t),this.state.has(t))this.state.set(t,e);else{var r=this.streamletScope;r instanceof or&&r.has(t)?r.set(t,e):this.state.set(t,e)}return this.decohereInputKey(t,0),this},e.prototype.setAttr=function(t,e){if(t=lr.fromAny(t),this.state.has(t))this.state.setAttr(t,e);else{var r=this.streamletScope;r instanceof or&&r.has(t)?r.setAttr(t,e):this.state.setAttr(t,e)}return this.decohereInputKey(t,0),this},e.prototype.setSlot=function(t,e){if(t=ir.fromAny(t),this.state.has(t))this.state.setSlot(t,e);else{var r=this.streamletScope;r instanceof or&&r.has(t)?r.setSlot(t,e):this.state.setSlot(t,e)}return this.decohereInputKey(t,0),this},e.prototype.setItem=function(t,e){var r=this.state.getItem(t);return e=Qe.fromAny(e),this.state.setItem(t,e),r instanceof Je&&e instanceof Je?r.key.equals(e.key)?this.decohereInputKey(r.key,0):(this.decohereInputKey(r.key,1),this.decohereInputKey(e.key,0)):r instanceof Je?this.decohereInputKey(r.key,1):e instanceof Je?this.decohereInputKey(e.key,0):this.decohereInput(),this},e.prototype.push=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=this.state.length,i=(t=this.state).push.apply(t,e);n<i;){var o=this.state.get(n);o instanceof Je&&this.decohereInputKey(o.key,0),n+=1}return i},e.prototype.splice=function(t,e){var r;void 0===e&&(e=0);for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=this.state.length;t<0&&(t=o+t),t=Math.max(0,t),e=Math.max(0,e);for(var s=(r=this.state).splice.apply(r,k([t,e],n,!1)),u=0;u<s.length;u+=1){var a=s[u];a instanceof Je&&this.decohereInputKey(a.key,1)}for(u=t;u<t+n.length;u+=1){var p=this.state.get(u);p instanceof Je&&this.decohereInputKey(p.key,0)}return s},e.prototype.delete=function(t){var e=this.state.delete(t);return e instanceof Je&&this.decohereInputKey(e.key,1),e},e.prototype.clear=function(){var t=this.state.branch();this.state.clear(),t.forEach((function(t){t instanceof Je&&this.decohereInputKey(t.key,1)}),this)},e.prototype.forEach=function(t,e){return this.state.forEach(t,e)},e.prototype.keyIterator=function(){throw new Error},e.prototype.disconnectInputs=function(){var t=this.fieldUpdaters;t.isEmpty()||(this.fieldUpdaters=new xe,t.forEach((function(t,e){e.disconnectInputs()}),this))},e.prototype.memoize=function(){return this},e.prototype.materialize=function(t){t.forEach((function(t){this.materializeItem(t)}),this)},e.prototype.materializeItem=function(t){t instanceof Je?this.materializeField(t):this.materializeValue(t)},e.prototype.materializeField=function(t){var e=t.value;if(e instanceof Vi)e.setStreamletScope(this),this.state.push(t);else if(e instanceof or){var r=new Ui(this);r.materialize(e),this.state.push(t.updatedValue(r))}else this.state.push(t)},e.prototype.materializeValue=function(t){if(t instanceof Vi)t.setStreamletScope(this),this.state.push(t);else if(t instanceof or){var e=new Ui(this);e.materialize(t),this.state.push(e)}else this.state.push(t)},e.prototype.compile=function(t){t.forEach((function(t,e){this.compileItem(t,e)}),this)},e.prototype.compileItem=function(t,e){t instanceof Je?this.compileField(t,e):this.compileValue(t,e)},e.prototype.compileField=function(t,e){var r=t.key,n=t.value;r.isConstant()&&(n.isConstant()?this.decohereInputKey(r,0):n instanceof Vi?(n.compile(),this.decohereInputKey(r,0)):n instanceof or?(this.state.getItem(e).toValue().compile(n),this.decohereInputKey(r,0)):(t.setValue(ir.extant()),this.bindValue(r,n)))},e.prototype.compileValue=function(t,e){t instanceof Vi?t.compile():t instanceof or?this.state.getItem(e).compile(t):t.isConstant()},e.prototype.reify=function(t){void 0===t&&(t=Ni.system()),this.forEach((function(e,r){var n=this.reifyItem(e,t);e!==n&&this.setItem(r,n)}),this)},e.prototype.reifyItem=function(t,r){null!==r&&(t=r.reify(t));var n=this.streamletScope;return n instanceof e?n.reifyItem(t,r):t},e.from=function(t){var r=new e;return r.materialize(t),r.compile(t),r},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.from(or.of.apply(or,t))},e.globalScope=function(){var t=new e;return t.materializeField($e.of("math",dn.scope.branch())),t},e}(Ti);Object.defineProperty(Ri.prototype,"fieldCount",{get:function(){return this.state.fieldCount},enumerable:!0,configurable:!0});var Ui=function(t){function e(e,r){var n=t.call(this,r)||this;return Object.defineProperty(n,"streamletScope",{value:e,writable:!0,enumerable:!0,configurable:!0}),n}return P(e,t),e.from=function(t){var r=new e(e.globalScope());return r.materialize(t),r.compile(t),r},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.from(or.of.apply(or,t))},e}(Ri),Ni=function(){function t(){}return t.system=function(){return null},t}(),zi=function(t){function e(){var e=t.call(this)||this;return e.keyInlet=new ri(e),e.mapInlet=new ni(e),e}return P(e,t),e.prototype.get=function(){var t=this.keyInlet.input;if(null!==t){var e=t.get();if(void 0!==e){var r=this.mapInlet.input;if(null!==r){var n=r.get(e);if(void 0!==n)return n}}}return ir.absent()},e}(Gn),Fi=function(t){function e(){var e=t.call(this)||this;return e.operand1Inlet=new ri(e),e.operand2Inlet=new ri(e),e}return P(e,t),e.prototype.get=function(){var t=this.operand1Inlet.input,e=this.operand2Inlet.input;if(null!==t&&null!==e){var r=t.get(),n=e.get();if(void 0!==r&&void 0!==n)return this.evaluate(r,n).toValue()}return ir.absent()},e}(Gn),Li=function(t){function e(){var e=t.call(this)||this;return e.operandInlet=new ri(e),e}return P(e,t),e.prototype.get=function(){var t=this.operandInlet.input;if(null!==t){var e=t.get();if(void 0!==e)return this.evaluate(e).toValue()}return ir.absent()},e}(Gn),Ki=function(t){function e(){var e=t.call(this)||this;return e.ifInlet=new ri(e),e.thenInlet=new ri(e),e.elseInlet=new ri(e),e}return P(e,t),e.prototype.get=function(){var t=this.ifInlet.input;if(null!==t){var e=t.get();if(void 0!==e)if(e.isDefinite()){var r=this.thenInlet.input;if(null!==r){var n=r.get();if(void 0!==n)return n}}else{var i=this.elseInlet.input;if(null!==i){var o=i.get();if(void 0!==o)return o}}}return ir.absent()},e}(Gn),Bi=function(t){function e(){var e=t.call(this)||this;return e.operand1Inlet=new ri(e),e.operand2Inlet=new ri(e),e}return P(e,t),e.prototype.get=function(){var t=this.operand1Inlet.input,e=null!==t?t.get():void 0;if(void 0!==e&&e.isDefinite())return e;var r=this.operand2Inlet.input,n=null!==r?r.get():void 0;return void 0!==n?n:ir.absent()},e}(Gn),Wi=function(t){function e(){var e=t.call(this)||this;return e.operand1Inlet=new ri(e),e.operand2Inlet=new ri(e),e}return P(e,t),e.prototype.get=function(){var t=this.operand1Inlet.input,e=null!==t?t.get():void 0;if(void 0!==e){if(e.isDefinite()){var r=this.operand2Inlet.input,n=null!==r?r.get():void 0;if(void 0!==n)return n}return e}return ir.absent()},e}(Gn),Hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseOr(e)},e}(Fi),Xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseXor(e)},e}(Fi),Yi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseAnd(e)},e}(Fi),Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.lt(e)},e}(Fi),_i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.le(e)},e}(Fi),Qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.eq(e)},e}(Fi),Zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.ne(e)},e}(Fi),Ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.ge(e)},e}(Fi),$i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.gt(e)},e}(Fi),to=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.plus(e)},e}(Fi),eo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.minus(e)},e}(Fi),ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.times(e)},e}(Fi),no=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.divide(e)},e}(Fi),io=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t,e){return t.modulo(e)},e}(Fi),oo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t){return t.not()},e}(Li),so=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t){return t.bitwiseNot()},e}(Li),uo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t){return t.negative()},e}(Li),ao=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.evaluate=function(t){return t.positive()},e}(Li),po=function(t){function e(e){var r=t.call(this)||this;return r.scope=e,r.funcInlet=new ri(r),r.argsInlet=new ri(r),r}return P(e,t),e.prototype.get=function(){var t=this.funcInlet.input,e=this.argsInlet.input;if(null!==t&&null!==e){var r=t.get();if(r instanceof fn){var n=e.get();if(void 0!==n){var i=new Dr;return i.pushScope(this.scope),r.invoke(n,i,void 0).toValue()}}}return ir.absent()},e}(Gn),ho={compile:function(t,e){if(e instanceof Qn){var r=e.get();zn.is(r)&&(e=r)}if(t.isConstant())return new ii(t);if(t instanceof $r)return ho.compileSelector(t,e);if(t instanceof xr)return ho.compileOperator(t,e);throw new TypeError(""+t)},compileSelector:function(t,e){if(t instanceof tn)return ho.compileIdentitySelector(e);if(t instanceof en)return ho.compileGetSelector(t,e);if(t instanceof rn)return ho.compileGetAttrSelector(t,e);if(t instanceof nn)return ho.compileGetItemSelector(t,e);if(t instanceof on)return ho.compileKeysSelector(e);if(t instanceof sn)return ho.compileValuesSelector(e);if(t instanceof un)return ho.compileChildrenSelector(e);if(t instanceof an)return ho.compileDescendantsSelector(e);if(t instanceof pn)return ho.compileFilterSelector(t,e);throw new TypeError(""+t)},compileIdentitySelector:function(t){return t},compileGetSelector:function(t,e){var r=t.item;if(!r.isConstant()){var n=new zi;i=ho.compile(r,e);return n.keyInlet.bindInput(i),n.mapInlet.bindInput(e),n}if(Ii.is(e)){if(null!==(i=e.outlet(r)))return ho.compile(t.then,i)}else if(Hn.is(e)){var i,o=r.stringValue(void 0);if(void 0!==o)if(null!==(i=e.outlet(o)))return ho.compile(t.then,i)}return null},compileGetAttrSelector:function(t,e){throw new Error},compileGetItemSelector:function(t,e){throw new Error},compileKeysSelector:function(t){throw new Error},compileValuesSelector:function(t){throw new Error},compileChildrenSelector:function(t){throw new Error},compileDescendantsSelector:function(t){throw new Error},compileFilterSelector:function(t,e){throw new Error},compileOperator:function(t,e){if(t instanceof Sr)return ho.compileConditionalOperator(t,e);if(t instanceof Or)return ho.compileBinaryOperator(t,e);if(t instanceof Er)return ho.compileUnaryOperator(t,e);if(t instanceof Zr)return ho.compileInvokeOperator(t,e);throw new TypeError(""+t)},compileConditionalOperator:function(t,e){var r=new Ki,n=t.ifTerm.toValue(),i=t.thenTerm.toValue(),o=t.elseTerm.toValue(),s=ho.compile(n,e),u=ho.compile(i,e),a=ho.compile(o,e);return r.ifInlet.bindInput(s),r.thenInlet.bindInput(u),r.elseInlet.bindInput(a),r},compileBinaryOperator:function(t,e){if(t instanceof Ir)return ho.compileOrOperator(t,e);if(t instanceof Tr)return ho.compileAndOperator(t,e);if(t instanceof Vr)return ho.compileBitwiseOrOperator(t,e);if(t instanceof jr)return ho.compileBitwiseXorOperator(t,e);if(t instanceof qr)return ho.compileBitwiseAndOperator(t,e);if(t instanceof Rr)return ho.compileLtOperator(t,e);if(t instanceof Ur)return ho.compileLeOperator(t,e);if(t instanceof Nr)return ho.compileEqOperator(t,e);if(t instanceof zr)return ho.compileNeOperator(t,e);if(t instanceof Fr)return ho.compileGeOperator(t,e);if(t instanceof Lr)return ho.compileGtOperator(t,e);if(t instanceof Kr)return ho.compilePlusOperator(t,e);if(t instanceof Br)return ho.compileMinusOperator(t,e);if(t instanceof Wr)return ho.compileTimesOperator(t,e);if(t instanceof Hr)return ho.compileDivideOperator(t,e);if(t instanceof Xr)return ho.compileModuloOperator(t,e);throw new TypeError(""+t)},compileBinaryOutlet:function(t,e,r){var n=t.operand1.toValue(),i=t.operand2.toValue(),o=ho.compile(n,r),s=ho.compile(i,r);return e.operand1Inlet.bindInput(o),e.operand2Inlet.bindInput(s),e},compileOrOperator:function(t,e){var r=new Bi,n=t.operand1.toValue(),i=t.operand2.toValue(),o=ho.compile(n,e),s=ho.compile(i,e);return r.operand1Inlet.bindInput(o),r.operand2Inlet.bindInput(s),r},compileAndOperator:function(t,e){var r=new Wi,n=t.operand1.toValue(),i=t.operand2.toValue(),o=ho.compile(n,e),s=ho.compile(i,e);return r.operand1Inlet.bindInput(o),r.operand2Inlet.bindInput(s),r},compileBitwiseOrOperator:function(t,e){return ho.compileBinaryOutlet(t,new Hi,e)},compileBitwiseXorOperator:function(t,e){return ho.compileBinaryOutlet(t,new Xi,e)},compileBitwiseAndOperator:function(t,e){return ho.compileBinaryOutlet(t,new Yi,e)},compileLtOperator:function(t,e){return ho.compileBinaryOutlet(t,new Gi,e)},compileLeOperator:function(t,e){return ho.compileBinaryOutlet(t,new _i,e)},compileEqOperator:function(t,e){return ho.compileBinaryOutlet(t,new Qi,e)},compileNeOperator:function(t,e){return ho.compileBinaryOutlet(t,new Zi,e)},compileGeOperator:function(t,e){return ho.compileBinaryOutlet(t,new Ji,e)},compileGtOperator:function(t,e){return ho.compileBinaryOutlet(t,new $i,e)},compilePlusOperator:function(t,e){return ho.compileBinaryOutlet(t,new to,e)},compileMinusOperator:function(t,e){return ho.compileBinaryOutlet(t,new eo,e)},compileTimesOperator:function(t,e){return ho.compileBinaryOutlet(t,new ro,e)},compileDivideOperator:function(t,e){return ho.compileBinaryOutlet(t,new no,e)},compileModuloOperator:function(t,e){return ho.compileBinaryOutlet(t,new io,e)},compileUnaryOperator:function(t,e){if(t instanceof Yr)return ho.compileNotOperator(t,e);if(t instanceof Gr)return ho.compileBitwiseNotOperator(t,e);if(t instanceof _r)return ho.compileNegativeOperator(t,e);if(t instanceof Qr)return ho.compilePositiveOperator(t,e);throw new TypeError(""+t)},compileUnaryOutlet:function(t,e,r){var n=t.operand.toValue(),i=ho.compile(n,r);return e.operandInlet.bindInput(i),e},compileNotOperator:function(t,e){return ho.compileUnaryOutlet(t,new oo,e)},compileBitwiseNotOperator:function(t,e){return ho.compileUnaryOutlet(t,new so,e)},compileNegativeOperator:function(t,e){return ho.compileUnaryOutlet(t,new uo,e)},compilePositiveOperator:function(t,e){return ho.compileUnaryOutlet(t,new ao,e)},compileInvokeOperator:function(t,e){var r=t.func,n=t.args,i=new po(e),o=ho.compile(r,e),s=ho.compile(n,e);return i.funcInlet.bindInput(o),i.argsInlet.bindInput(s),i}},fo={};Object.defineProperty(fo,"structureParser",{value:function(){var t=new Bo;return Object.defineProperty(fo,"structureParser",{value:function(){return t},enumerable:!0,configurable:!0}),t},enumerable:!0,configurable:!0}),Object.defineProperty(fo,"structureWriter",{value:function(){var t=new ls;return Object.defineProperty(fo,"structureWriter",{value:function(){return t},enumerable:!0,configurable:!0}),t},enumerable:!0,configurable:!0}),fo.parse=function(t){return fo.structureParser().parseBlockString(t)},fo.parser=function(){return fo.structureParser().blockParser()},fo.sizeOf=function(t){return fo.structureWriter().sizeOfItem(t)},fo.sizeOfBlock=function(t){return fo.structureWriter().sizeOfBlockItem(t)},fo.write=function(t,e){return fo.structureWriter().writeItem(t,e)},fo.writeBlock=function(t,e){return fo.structureWriter().writeBlockItem(t,e)},fo.toString=function(t){var e=rt.stringOutput(),r=fo.write(e,t);return r.isDone()||(e=Z.error(r.trap())),e.bind()},fo.toBlockString=function(t){var e=rt.stringOutput(),r=fo.writeBlock(e,t);return r.isDone()||(e=Z.error(r.trap())),e.bind()},fo.toData=function(t){var e=Ut.encodedOutput(fr.output()),r=fo.write(e,t);return r.isDone()||(e=Z.error(r.trap())),e.bind()},fo.toBlockData=function(t){var e=Ut.encodedOutput(fr.output()),r=fo.writeBlock(e,t);return r.isDone()||(e=Z.error(r.trap())),e.bind()},fo.isSpace=function(t){return 32===t||9===t},fo.isNewline=function(t){return 10===t||13===t},fo.isWhitespace=function(t){return fo.isSpace(t)||fo.isNewline(t)},fo.isIdentStartChar=function(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},fo.isIdentChar=function(t){return 45===t||t>=48&&t<=57||t>=65&&t<=90||95===t||t>=97&&t<=122||183===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},Qe.prototype.toRecon=function(){return fo.toString(this)},Qe.prototype.toReconBlock=function(){return fo.toBlockString(this)},ir.parseRecon=function(t){return fo.parse(t)};var co=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.keyParser=n,s.valueParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.keyParser,this.valueParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;t:for(;;){if(1===s){for(;t.isCont()&&(u=t.head(),fo.isWhitespace(u));)t=t.step();if(t.isCont())if(33===u||34===u||36===u||37===u||39===u||40===u||43===u||45===u||u>=48&&u<=57||64===u||91===u||96===u||123===u||126===u||fo.isIdentStartChar(u))n=n||r.valueBuilder(),s=2;else{if(35!==u)return void 0!==n?bt.done(n.bind()):bt.done(r.absent());t=t.step(),s=7}else if(t.isDone())return void 0!==n?bt.done(n.bind()):bt.done(r.absent())}if(2===s){for(void 0===i&&(i=r.parseBlockExpression(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=3;else if(i.isError())return i}if(3===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont())58===u?(t=t.step(),s=4):(n.push(r.item(i.bind())),i=void 0,s=6);else if(t.isDone())return n.push(r.item(i.bind())),bt.done(n.bind())}if(4===s){for(;t.isCont()&&fo.isSpace(t.head());)t=t.step();if(t.isCont())s=5;else if(t.isDone())return n.push(r.slot(i.bind())),bt.done(n.bind())}if(5===s){for(void 0===o&&(o=r.parseBlockExpression(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())n.push(r.slot(i.bind(),o.bind())),i=void 0,o=void 0,s=6;else if(o.isError())return o}if(6===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(44===u||59===u||fo.isNewline(u)){t=t.step(),s=1;continue}if(35!==u)return bt.done(n.bind());t=t.step(),s=7}else if(t.isDone())return bt.done(n.bind())}if(7===s){for(;t.isCont();){if(u=t.head(),fo.isNewline(u)){s=1;continue t}t=t.step()}if(t.isDone()){s=1;continue}}break}return new e(r,n,i,o,s)},e}(bt),lo=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.recon=e,o.keyParser=r,o.valueParser=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.keyParser,this.valueParser,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o)if(t.isCont()){if(64!==(s=t.head()))return bt.error(ot.expected(64,t));t=t.step(),o=2}else if(t.isDone())return bt.error(ot.expected(64,t));if(2===o){if(void 0===n){if(t.isCont())if(34===(s=t.head())||39===s)n=r.parseString(t);else{if(!fo.isIdentStartChar(s))return bt.error(ot.expected("attribute name",t));n=r.parseIdent(t)}else if(t.isDone())return bt.error(ot.expected("attribute name",t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())o=3;else if(n.isError())return n.asError()}if(3===o)if(t.isCont()&&40===t.head())t=t.step(),o=4;else if(!t.isEmpty())return bt.done(r.attr(n.bind()));if(4===o){for(;t.isCont()&&(s=t.head(),fo.isWhitespace(s));)t=t.step();if(t.isCont()){if(41===s)return t=t.step(),bt.done(r.attr(n.bind()));o=5}else if(t.isDone())return bt.error(ot.expected(")",t))}if(5===o){for(void 0===i&&(i=r.parseBlock(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())o=6;else if(i.isError())return i.asError()}if(6===o){for(;t.isCont()&&(s=t.head(),fo.isWhitespace(s));)t=t.step();if(t.isCont())return 41===s?(t=t.step(),bt.done(r.attr(n.bind(),i.bind()))):bt.error(ot.expected(")",t));if(t.isDone())return bt.error(ot.expected(")",t))}return new e(r,n,i,o)},e}(bt),yo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.fieldParser=n,s.valueParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s)if(t.isCont())if(64===(u=t.head()))i=r.parseAttr(t),s=2;else if(123===u)n=n||r.recordBuilder(),o=r.parseRecord(t,n),s=5;else if(91===u)n=n||r.recordBuilder(),o=r.parseMarkup(t,n),s=5;else if(fo.isIdentStartChar(u))o=r.parseIdent(t),s=4;else if(34===u||39===u)o=r.parseString(t),s=4;else if(96===u)o=r.parseRawString(t),s=4;else if(45===u||u>=48&&u<=57)o=r.parseNumber(t),s=4;else if(37===u)o=r.parseData(t),s=4;else{if(36!==u)return void 0===n?bt.done(r.extant()):bt.done(n.bind());o=r.parseSelector(t),s=4}else if(t.isDone())return void 0===n?bt.done(r.extant()):bt.done(n.bind());if(2===s){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())(n=n||r.valueBuilder()).push(i.bind()),i=void 0,s=3;else if(i.isError())return i.asError()}if(3===s){for(;t.isCont()&&fo.isSpace(t.head());)t=t.step();if(t.isCont()){s=1;continue}if(t.isDone())return bt.done(n.bind())}if(4===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())(n=n||r.valueBuilder()).push(r.item(o.bind())),o=void 0,s=6;else if(o.isError())return o}if(5===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())o=void 0,s=6;else if(o.isError())return o}if(6===s){for(;t.isCont()&&fo.isSpace(t.head());)t=t.step();if(t.isCont()){if(64!==t.head())return bt.done(n.bind());s=1}else if(t.isDone())return bt.done(n.bind())}break}return new e(r,n,i,o,s)},e}(bt),vo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.fieldParser=n,s.valueParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont())if(64===(u=t.head()))i=r.parseAttr(t),s=2;else if(123===u)void 0!==n?(o=r.parseRecord(t,n),s=5):(o=r.parseRecord(t),s=4);else{if(91!==u)return void 0===n?bt.done(r.extant()):bt.done(n.bind());void 0!==n?(o=r.parseMarkup(t,n),s=5):(o=r.parseMarkup(t),s=4)}else if(t.isDone())return void 0===n?bt.done(r.extant()):bt.done(n.bind());if(2===s){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())(n=n||r.valueBuilder()).push(i.bind()),i=void 0,s=3;else if(i.isError())return i.asError()}if(3===s)if(t.isCont())if(123===(u=t.head()))o=r.parseRecord(t,n),s=5;else{if(91!==u)return bt.done(n.bind());o=r.parseMarkup(t,n),s=5}else if(t.isDone())return bt.done(n.bind());if(4===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())return(n=n||r.valueBuilder()).push(r.item(o.bind())),bt.done(n.bind());if(o.isError())return o}if(5===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())return bt.done(n.bind());if(o.isError())return o}return new e(r,n,i,o,s)},e}(bt),mo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.keyParser=n,s.valueParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.keyParser,this.valueParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont()){if(123!==(u=t.head()))return bt.error(ot.expected(123,t));t=t.step(),s=2}else if(t.isDone())return bt.error(ot.expected(123,t));t:for(;;){if(2===s){for(;t.isCont()&&(u=t.head(),fo.isWhitespace(u));)t=t.step();if(t.isCont()){if(n=n||r.recordBuilder(),125===u)return t=t.step(),bt.done(n.bind());35===u?(t=t.step(),s=8):s=3}else if(t.isDone())return bt.error(ot.expected(125,t))}if(3===s){for(void 0===i&&(i=r.parseBlockExpression(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=4;else if(i.isError())return i}if(4===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont())58===u?(t=t.step(),s=5):(n.push(r.item(i.bind())),i=void 0,s=7);else if(t.isDone())return bt.error(ot.expected(125,t))}if(5===s){for(;t.isCont()&&fo.isSpace(t.head());)t=t.step();if(t.isCont())s=6;else if(t.isDone())return n.push(r.slot(i.bind())),bt.done(n.bind())}if(6===s){for(void 0===o&&(o=r.parseBlockExpression(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())n.push(r.slot(i.bind(),o.bind())),i=void 0,o=void 0,s=7;else if(o.isError())return o}if(7===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(44===u||59===u||fo.isNewline(u)){t=t.step(),s=2;continue}if(35!==u)return 125===u?(t=t.step(),bt.done(n.bind())):bt.error(ot.expected("'}', ';', ',', or newline",t));t=t.step(),s=8}else if(t.isDone())return bt.error(ot.expected(125,t))}if(8===s){for(;t.isCont();){if(u=t.head(),fo.isNewline(u)){s=2;continue t}t=t.step()}if(t.isDone()){s=2;continue}}break}return new e(r,n,i,o,s)},e}(bt),wo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.textOutput=n,s.valueParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.textOutput,this.valueParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont()){if(91!==(u=t.head()))return bt.error(ot.expected(91,t));t=t.step(),s=2}else if(t.isDone())return bt.error(ot.expected(91,t));for(;;){if(2===s){for(;t.isCont()&&64!==(u=t.head())&&91!==u&&92!==u&&93!==u&&123!==u&&125!==u;)t=t.step(),(i=i||r.textOutput()).write(u);if(t.isCont()){if(93===u)return t=t.step(),n=n||r.recordBuilder(),void 0!==i&&n.push(r.item(i.bind())),bt.done(n.bind());if(64===u)n=n||r.recordBuilder(),void 0!==i&&(n.push(r.item(i.bind())),i=void 0),o=r.parseInlineItem(t),s=3;else if(123===u)n=n||r.recordBuilder(),void 0!==i&&(n.push(r.item(i.bind())),i=void 0),o=r.parseRecord(t,n),s=4;else if(91===u)n=n||r.recordBuilder(),void 0!==i&&(n.push(r.item(i.bind())),i=void 0),o=r.parseMarkup(t,n),s=4;else{if(92!==u)return bt.error(ot.unexpected(t));t=t.step(),s=5}}else if(t.isDone())return bt.error(ot.unexpected(t))}if(3===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){n.push(r.item(o.bind())),o=void 0,s=2;continue}if(o.isError())return o}if(4===s){for(;o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){o=void 0,s=2;continue}if(o.isError())return o}if(5===s){if(t.isCont()){if(u=t.head(),i=i||r.textOutput(),34===u||36===u||39===u||47===u||64===u||91===u||92===u||93===u||123===u||125===u)t=t.step(),i.write(u),s=2;else if(98===u)t=t.step(),i.write(8),s=2;else if(102===u)t=t.step(),i.write(12),s=2;else if(110===u)t=t.step(),i.write(10),s=2;else if(114===u)t=t.step(),i.write(13),s=2;else{if(116!==u)return bt.error(ot.expected("escape character",t));t=t.step(),i.write(9),s=2}continue}if(t.isDone())return bt.error(ot.expected("escape character",t))}break}return new e(r,n,i,o,s)},e}(bt),go=function(t){function e(e,r,n){var i=t.call(this)||this;return i.recon=e,i.base64Parser=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.base64Parser,this.step)},e.parse=function(t,r,n,i){void 0===i&&(i=1);if(1===i)if(t.isCont()){if(37!==t.head())return bt.error(ot.expected(37,t));t=t.step(),i=2}else if(t.isDone())return bt.error(ot.expected(37,t));if(2===i){for(void 0===n&&(n=Wt.standard().parse(t,r.dataOutput()));n.isCont()&&!t.isEmpty();)n=n.feed(t);if(n.isDone())return n;if(n.isError())return n}return new e(r,n,i)},e}(bt),bo=function(t){function e(e,r,n){var i=t.call(this)||this;return i.recon=e,i.output=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.output,this.step)},e.parse=function(t,r,n,i){void 0===i&&(i=1);var o=0;if(1===i)if(t.isCont()){if(o=t.head(),!fo.isIdentStartChar(o))return bt.error(ot.expected("identifier",t));t=t.step(),n=(n=n||r.textOutput()).write(o),i=2}else if(t.isDone())return bt.error(ot.expected("identifier",t));if(2===i){for(;t.isCont()&&(o=t.head(),fo.isIdentChar(o));)t=t.step(),n.write(o);if(!t.isEmpty())return bt.done(r.ident(n.bind()))}return new e(r,n,i)},e}(bt),xo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.output=r,s.quote=n,s.code=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.output,this.quote,this.code,this.step)},e.parse=function(t,r,n,i,o,s){void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),fo.isWhitespace(u));)t=t.step();if(t.isCont()){if(34!==u&&39!==u||i!==u&&0!==i)return bt.error(ot.expected("string",t));t=t.step(),n=n||r.textOutput(),i=u,s=2}else if(t.isDone())return bt.error(ot.expected("string",t))}t:for(;;){if(2===s){for(;t.isCont()&&(u=t.head())>=32&&u!==i&&92!==u;)t=t.step(),n=n.write(u);if(t.isCont()){if(u===i)return t=t.step(),bt.done(n.bind());if(92!==u)return bt.error(ot.expected(i,t));t=t.step(),s=3}else if(t.isDone())return bt.error(ot.expected(i,t))}if(3===s)if(t.isCont()){if(34===(u=t.head())||36===u||39===u||47===u||64===u||91===u||92===u||93===u||123===u||125===u){t=t.step(),n=n.write(u),s=2;continue}if(98===u){t=t.step(),n=n.write(8),s=2;continue}if(102===u){t=t.step(),n=n.write(12),s=2;continue}if(110===u){t=t.step(),n=n.write(10),s=2;continue}if(114===u){t=t.step(),n=n.write(13),s=2;continue}if(116===u){t=t.step(),n=n.write(9),s=2;continue}if(117!==u)return bt.error(ot.expected("escape character",t));t=t.step(),s=4}else if(t.isDone())return bt.error(ot.expected("escape character",t));if(s>=4)for(;;){if(t.isCont()){if(u=t.head(),jt.isDigit(u)){if(t=t.step(),o=16*o+jt.decodeDigit(u),s<=6){s+=1;continue}n=n.write(o),o=0,s=2;continue t}return bt.error(ot.expected("hex digit",t))}if(t.isDone())return bt.error(ot.expected("hex digit",t));break}break}return new e(r,n,i,o,s)},e}(bt),Oo=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.recon=e,o.output=r,o.count=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.output,this.count,this.step)},e.parse=function(t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),fo.isWhitespace(s));)t=t.step();if(t.isCont()&&96===s)t=t.step(),i=1,o=2;else if(t.isDone())return bt.error(ot.expected("raw string",t))}if(2===o)if(t.isCont())96===t.head()?(t=t.step(),i=2,o=3):(n=n||r.textOutput(),o=4);else if(t.isDone())return bt.error(ot.expected("raw string",t));if(3===o)if(t.isCont()){if(96!==t.head())return n=n||r.textOutput(),bt.done(n.bind());t=t.step(),n=n||r.textOutput(),i=3,o=4}else if(t.isDone())return n=n||r.textOutput(),bt.done(n.bind());for(;;){if(4===o){for(;t.isCont()&&(s=t.head(),(1!==i||s>=32)&&96!==s&&92!==s);)t=t.step(),n=n.write(s);if(t.isCont())if(92===s)t=t.step(),o=5;else{if(96!==s)return bt.error(ot.expected(96,t));if(t=t.step(),1===i)return bt.done(n.bind());o=6}else if(t.isDone())return bt.error(ot.expected(96,t))}if(5===o){if(t.isCont()){s=t.head(),t=t.step(),92!==s&&96!==s&&(n=n.write(92)),n=n.write(s),o=4;continue}if(t.isDone())return bt.error(ot.expected("escape character",t))}if(6===o)if(t.isCont()){if(96!==t.head()){n=n.write(96),o=4;continue}t=t.step(),o=7}else if(t.isDone())return bt.error(ot.message("unclosed raw string",t));if(7===o){if(t.isCont()){if(96===t.head())return t=t.step(),bt.done(n.bind());n=(n=n.write(96)).write(96),o=4;continue}if(t.isDone())return bt.error(ot.message("unclosed raw string",t))}break}return new e(r,n,i,o)},e}(bt),Co=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.sign=r,s.value=n,s.mode=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.sign,this.value,this.mode,this.step)},e.parse=function(t,r,n,i,o,s){void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=2),void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),fo.isWhitespace(u));)t=t.step();if(t.isCont())45===u&&(t=t.step(),n=-1),s=2;else if(t.isDone())return bt.error(ot.expected("number",t))}if(2===s)if(t.isCont())if(48===(u=t.head()))t=t.step(),s=4;else{if(!(u>=49&&u<=57))return bt.error(ot.expected("digit",t));t=t.step(),i=n*(u-48),s=3}else if(t.isDone())return bt.error(ot.expected("digit",t));if(3===s){for(;t.isCont()&&(u=t.head())>=48&&u<=57;){var a=10*i+n*(u-48);if(!(-9007199254740991<=a&&a<=9007199254740992))return bt.error(ot.message("integer overflow",t));i=a,t=t.step()}if(t.isCont())s=4;else if(t.isDone())return bt.done(r.num(i))}if(4===s){if(t.isCont()){if(u=t.head(),o>0&&46===u||o>1&&(69===u||101===u)){var p=rt.stringOutput();return p=n<0&&0===i?p.write(45).write(48):p.write(""+i),Eo.parse(t,r,p,o)}return 120===u&&n>0&&0===i?(t=t.step(),Po.parse(t,r)):bt.done(r.num(i))}if(t.isDone())return bt.done(r.num(i))}return new e(r,n,i,o,s)},e.parseInteger=function(t,r){return e.parse(t,r,void 0,void 0,0)},e.parseDecimal=function(t,r){return e.parse(t,r,void 0,void 0,1)},e}(bt),Eo=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.recon=e,o.output=r,o.mode=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.output,this.mode,this.step)},e.parse=function(t,r,n,i,o){void 0===i&&(i=2),void 0===o&&(o=1);var s=0;if(1===o)if(t.isCont())if(46===(s=t.head()))t=t.step(),n=n.write(s),o=2;else{if(!(i>1)||69!==s&&101!==s)return bt.error(ot.expected("decimal or exponent",t));t=t.step(),n=n.write(s),o=5}else if(t.isDone())return bt.error(ot.expected("decimal or exponent",t));if(2===o)if(t.isCont()){if(!((s=t.head())>=48&&s<=57))return bt.error(ot.expected("digit",t));t=t.step(),n=n.write(s),o=3}else if(t.isDone())return bt.error(ot.expected("digit",t));if(3===o){for(;t.isCont()&&(s=t.head())>=48&&s<=57;)t=t.step(),n=n.write(s);if(t.isCont()){if(!(i>1))return bt.done(r.num(n.bind()));o=4}else if(t.isDone())return bt.done(r.num(n.bind()))}if(4===o){if(69!==(s=t.head())&&101!==s)return bt.done(r.num(n.bind()));t=t.step(),n=n.write(s),o=5}if(5===o)if(t.isCont())43!==(s=t.head())&&45!==s||(t=t.step(),n=n.write(s)),o=6;else if(t.isDone())return bt.error(ot.unexpected(t));if(6===o)if(t.isCont()){if(!((s=t.head())>=48&&s<=57))return bt.error(ot.expected("digit",t));t=t.step(),n=n.write(s),o=7}else if(t.isDone())return bt.error(ot.expected("digit",t));if(7===o){for(;t.isCont()&&(s=t.head())>=48&&s<=57;)t=t.step(),n=n.write(s);if(!t.isEmpty())return bt.done(r.num(n.bind()))}return new e(r,n,i,o)},e}(bt),Po=function(t){function e(e,r,n){var i=t.call(this)||this;return i.recon=e,i.value=r,i.size=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.value,this.size)},e.parse=function(t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=0);for(var o=0;t.isCont()&&(o=t.head(),jt.isDigit(o));)t=t.step(),n=16*n+jt.decodeDigit(o),i+=1;return t.isEmpty()?new e(r,n,i):i>0?i<=8?bt.done(r.uint32(n)):bt.done(r.uint64(n)):bt.error(ot.expected("hex digit",t))},e}(bt),So=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.bindingsParser=n,s.templateParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.bindingsParser,this.templateParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);if(1===s){for(void 0===i&&(i=r.parseConditionalOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s)if(t.isCont()){if(62!==t.head())return i;t=t.step(),s=3}else if(t.isDone())return i;if(3===s){for(void 0===o&&(o=r.parseConditionalOperator(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var u=i.bind(),a=o.bind();return bt.done(r.lambda(u,a))}if(o.isError())return o.asError()}return new e(r,n,i,o,s)},e}(bt),ko=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.recon=e,u.builder=r,u.ifParser=n,u.thenParser=i,u.elseParser=o,u.step=s,u}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.ifParser,this.thenParser,this.elseParser,this.step)},e.parse=function(t,r,n,i,o,s,u){void 0===u&&(u=1);var a=0;if(1===u){for(void 0===i&&(i=r.parseOrOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),fo.isSpace(a));)t=t.step();if(t.isCont()){if(63!==a)return i;t=t.step(),u=3}else if(t.isDone())return i}if(3===u){for(void 0===o&&(o=r.parseConditionalOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())u=4;else if(o.isError())return o.asError()}if(4===u){for(;t.isCont()&&(a=t.head(),fo.isSpace(a));)t=t.step();if(t.isCont()){if(58!==a)return bt.error(ot.expected(58,t));t=t.step(),u=5}else if(t.isDone())return bt.error(ot.expected(58,t))}if(5===u){for(void 0===s&&(s=r.parseConditionalOperator(t,n));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var p=i.bind(),h=o.bind(),f=s.bind();return bt.done(r.conditional(p,h,f))}if(s.isError())return s.asError()}return new e(r,n,i,o,s,u)},e}(bt),Mo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.lhsParser=n,s.rhsParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);for(;;){if(1===s){for(void 0===i&&(i=r.parseAndOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s)if(t.isCont()){if(124!==t.head())return i;t=t.step(),s=3}else if(t.isDone())return i;if(3===s){for(void 0===o&&(o=r.parseAndOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var u=i.bind(),a=o.bind();i=bt.done(r.or(u,a)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,n,i,o,s)},e}(bt),Ao=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.lhsParser=n,s.rhsParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);for(;;){if(1===s){for(void 0===i&&(i=r.parseBitwiseOrOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s)if(t.isCont()){if(38!==t.head())return i;t=t.step(),s=3}else if(t.isDone())return i;if(3===s){for(void 0===o&&(o=r.parseBitwiseOrOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var u=i.bind(),a=o.bind();i=bt.done(r.and(u,a)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,n,i,o,s)},e}(bt),Do=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.lhsParser=n,s.rhsParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(void 0===i&&(i=r.parseBitwiseXorOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(124!==u)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s)if(t.isCont()){if(124===(u=t.head()))return i;s=4}else if(t.isDone())return bt.error(ot.unexpected(t));if(4===s){for(void 0===o&&(o=r.parseBitwiseXorOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=i.bind(),p=o.bind();i=bt.done(r.bitwiseOr(a,p)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,n,i,o,s)},e}(bt),Io=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.lhsParser=n,s.rhsParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(void 0===i&&(i=r.parseBitwiseAndOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(94!==u)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s){for(void 0===o&&(o=r.parseBitwiseAndOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=i.bind(),p=o.bind();i=bt.done(r.bitwiseXor(a,p)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,n,i,o,s)},e}(bt),To=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.lhsParser=n,s.rhsParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(void 0===i&&(i=r.parseComparisonOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}if(2===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(38!==u)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s)if(t.isCont()){if(38===(u=t.head()))return i;s=4}else if(t.isDone())return bt.error(ot.unexpected(t));if(4===s){for(void 0===o&&(o=r.parseComparisonOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=i.bind(),p=o.bind();i=bt.done(r.bitwiseAnd(a,p)),o=void 0,s=2;continue}if(o.isError())return o.asError()}break}return new e(r,n,i,o,s)},e}(bt),Vo=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.recon=e,u.builder=r,u.lhsParser=n,u.operator=i,u.rhsParser=o,u.step=s,u}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s,u){void 0===u&&(u=1);var a=0;if(1===u){for(void 0===i&&(i=r.parseAttrExpression(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),fo.isSpace(a));)t=t.step();if(t.isCont())if(33===a)t=t.step(),u=3;else if(60===a)t=t.step(),u=4;else if(62===a)t=t.step(),u=5;else{if(61!==a)return i;t=t.step(),u=6}else if(t.isDone())return i}if(3===u)if(t.isCont())61===(a=t.head())?(t=t.step(),o="!=",u=7):(o="!",u=7);else if(t.isDone())return bt.error(ot.unexpected(t));if(4===u)if(t.isCont())61===(a=t.head())?(t=t.step(),o="<=",u=7):(o="<",u=7);else if(t.isDone())return bt.error(ot.unexpected(t));if(5===u)if(t.isCont())61===(a=t.head())?(t=t.step(),o=">=",u=7):(o=">",u=7);else if(t.isDone())return bt.error(ot.unexpected(t));if(6===u)if(t.isCont())if(61===(a=t.head()))t=t.step(),o="==",u=7;else{if(62===a)return i;o="=",u=7}else if(t.isDone())return bt.error(ot.unexpected(t));if(7===u){for(void 0===s&&(s=r.parseAttrExpression(t,n));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var p=i.bind(),h=s.bind();return"<"===o?bt.done(r.lt(p,h)):"<="===o?bt.done(r.le(p,h)):"=="===o?bt.done(r.eq(p,h)):"!="===o?bt.done(r.ne(p,h)):">="===o?bt.done(r.ge(p,h)):">"===o?bt.done(r.gt(p,h)):bt.error(ot.message(o,t))}if(s.isError())return s.asError()}return new e(r,n,i,o,s,u)},e}(bt),jo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.fieldParser=n,s.valueParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);for(var u=0;;){if(1===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont())if(64===u)s=2;else if(123===u||91===u)n=n||r.recordBuilder(),s=5;else if(40===u)s=4;else{if(!(33===u||34===u||36===u||37===u||39===u||43===u||45===u||u>=48&&u<=57||96===u||126===u||fo.isIdentStartChar(u)))return void 0===n?bt.done(r.extant()):bt.done(n.bind());s=3}else if(t.isDone())return void 0===n?bt.done(r.extant()):bt.done(n.bind())}if(2===s){for(void 0===i&&(i=r.parseAttr(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone()){(n=n||r.recordBuilder()).push(i.bind()),i=void 0,s=1;continue}if(i.isError())return i.asError()}if(3===s){for(void 0===o&&(o=r.parseAdditiveOperator(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())(n=n||r.valueBuilder()).push(r.item(o.bind())),o=void 0,s=6;else if(o.isError())return o.asError()}if(4===s){for(void 0===o&&(o=r.parseAdditiveOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())void 0===n&&(n=r.valueBuilder()).push(r.item(o.bind())),o=void 0,s=6;else if(o.isError())return o.asError()}if(5===s){for(void 0===o&&(o=r.parseAdditiveOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())o=void 0,s=6;else if(o.isError())return o.asError()}if(6===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(64===u){s=1;continue}return bt.done(n.bind())}if(t.isDone())return bt.done(n.bind())}break}return new e(r,n,i,o,s)},e}(bt),qo=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.recon=e,u.builder=r,u.lhsParser=n,u.operator=i,u.rhsParser=o,u.step=s,u}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s,u){void 0===u&&(u=1);for(var a=0;;){if(1===u){for(void 0===i&&(i=r.parseMultiplicativeOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),fo.isSpace(a));)t=t.step();if(t.isCont())if(43===a)t=t.step(),o="+",u=3;else{if(45!==a)return i;t=t.step(),o="-",u=3}else if(t.isDone())return i}if(3===u){for(void 0===s&&(s=r.parseMultiplicativeOperator(t,n));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var p=i.bind(),h=s.bind();if("+"===o)i=bt.done(r.plus(p,h));else{if("-"!==o)return bt.error(ot.message(o,t));i=bt.done(r.minus(p,h))}s=void 0,o=void 0,u=2;continue}if(s.isError())return s.asError()}break}return new e(r,n,i,o,s,u)},e}(bt),Ro=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.recon=e,u.builder=r,u.lhsParser=n,u.operator=i,u.rhsParser=o,u.step=s,u}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},e.parse=function(t,r,n,i,o,s,u){void 0===u&&(u=1);for(var a=0;;){if(1===u){for(void 0===i&&(i=r.parsePrefixOperator(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())u=2;else if(i.isError())return i.asError()}if(2===u){for(;t.isCont()&&(a=t.head(),fo.isSpace(a));)t=t.step();if(t.isCont())if(42===a)t=t.step(),o="*",u=3;else if(47===a)t=t.step(),o="/",u=3;else{if(37!==a)return i;t=t.step(),o="%",u=3}else if(t.isDone())return i}if(3===u){for(void 0===s&&(s=r.parsePrefixOperator(t,n));s.isCont()&&!t.isEmpty();)s=s.feed(t);if(s.isDone()){var p=i.bind(),h=s.bind();if("*"===o)i=bt.done(r.times(p,h));else if("/"===o)i=bt.done(r.divide(p,h));else{if("%"!==o)return bt.error(ot.message(o,t));i=bt.done(r.modulo(p,h))}s=void 0,o=void 0,u=2;continue}if(s.isError())return s.asError()}break}return new e(r,n,i,o,s,u)},e}(bt),Uo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.operator=n,s.operandParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.operator,this.operandParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(33===u)t=t.step(),i="!";else if(126===u)t=t.step(),i="~";else if(45===u)t=t.step(),i="-";else{if(43!==u)return r.parseInvokeOperator(t,n);t=t.step(),i="+"}s=2}else if(t.isDone())return r.parseInvokeOperator(t,n)}if(2===s){for(void 0===o&&(o=r.parsePrefixOperator(t,n));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone()){var a=o.bind();return r.isDistinct(a)?"!"===i?bt.done(r.not(a)):"~"===i?bt.done(r.bitwiseNot(a)):"-"===i?bt.done(r.negative(a)):"+"===i?bt.done(r.positive(a)):bt.error(ot.message(i,t)):bt.error(ot.expected("value",t))}if(o.isError())return o.asError()}return new e(r,n,i,o,s)},e}(bt),No=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.exprParser=n,s.argsParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.exprParser,this.argsParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(void 0===i&&(i=r.parsePrimary(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())s=2;else if(i.isError())return i.asError()}for(;;){if(2===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(40!==u)return i;t=t.step(),s=3}else if(t.isDone())return i}if(3===s){for(;t.isCont()&&(u=t.head(),fo.isWhitespace(u));)t=t.step();if(t.isCont()){if(41===u){t=t.step();var a=i.bind();i=bt.done(r.invoke(a,r.extant())),s=2;continue}s=4}else if(t.isDone())return bt.error(ot.expected(41,t))}if(4===s){for(void 0===o&&(o=r.parseBlock(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())s=5;else if(o.isError())return o.asError()}if(5===s){for(;t.isCont()&&(u=t.head(),fo.isWhitespace(u));)t=t.step();if(t.isCont()){if(41===u){t=t.step();a=i.bind();var p=o.bind();i=bt.done(r.invoke(a,p)),o=void 0,s=2;continue}return bt.error(ot.expected(41,t))}if(t.isDone())return bt.error(ot.expected(41,t))}break}return new e(r,n,i,o,s)},e}(bt),zo=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.recon=e,o.builder=r,o.exprParser=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.exprParser,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),fo.isSpace(s));)t=t.step();t.isCont()?40===s?(t=t.step(),o=3):o=2:t.isDone()&&(o=2)}if(2===o){for(void 0===i&&(i=r.parseLiteral(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())return i;if(i.isError())return i.asError()}if(3===o){for(void 0===i&&(i=r.parseBlockExpression(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())o=4;else if(i.isError())return i.asError()}for(;;){if(4===o){for(;t.isCont()&&(s=t.head(),fo.isSpace(s));)t=t.step();if(t.isCont()){if(44!==s)return 41===s?(t=t.step(),void 0!==i?i:bt.done(n.bind())):bt.error(ot.expected(41,t));t=t.step(),void 0!==i&&(void 0===n&&(n=r.recordBuilder()).push(r.item(i.bind())),i=void 0),o=5}else if(t.isDone())return bt.error(ot.expected(41,t))}if(5===o){for(void 0===i&&(i=r.parseBlockExpression(t,n));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone()){i=void 0,o=4;continue}if(i.isError())return i.asError()}break}return new e(r,n,i,o)},e}(bt),Fo=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.recon=e,o.builder=r,o.valueParser=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.valueParser,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),fo.isSpace(s));)t=t.step();if(t.isCont())if(40===s)t=t.step(),o=4;else if(123===s)n=n||r.recordBuilder(),i=r.parseRecord(t,n),o=3;else if(91===s)n=n||r.recordBuilder(),i=r.parseMarkup(t,n),o=3;else if(fo.isIdentStartChar(s))i=r.parseIdent(t),o=2;else if(34===s||39===s)i=r.parseString(t),o=2;else if(96===s)i=r.parseRawString(t),o=2;else if(45===s||s>=48&&s<=57)i=r.parseNumber(t),o=2;else if(37===s)i=r.parseData(t),o=2;else{if(36!==s)return void 0===n?bt.done(r.extant()):bt.done(n.bind());i=r.parseSelector(t),o=2}else if(t.isDone())return void 0===n?bt.done(r.extant()):bt.done(n.bind())}if(2===o){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())return(n=n||r.valueBuilder()).push(r.item(i.bind())),bt.done(n.bind());if(i.isError())return i.asError()}if(3===o){for(;i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())return bt.done(n.bind());if(i.isError())return i.asError()}if(4===o){for(void 0===i&&(i=r.parseBlockExpression(t));i.isCont()&&!t.isEmpty();)i=i.feed(t);if(i.isDone())o=5;else if(i.isError())return i.asError()}if(5===o){for(;t.isCont()&&(s=t.head(),fo.isWhitespace(s));)t=t.step();if(t.isCont())return 41===s?(t=t.step(),(n=n||r.valueBuilder()).push(r.item(i.bind())),bt.done(n.bind())):bt.error(ot.expected(41,t));if(t.isDone())return bt.error(ot.expected(41,t))}return new e(r,n,i,o)},e}(bt),Lo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.builder=r,s.selector=n,s.valueParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.selector,this.valueParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()&&36===u)t=t.step(),i=i||r.selector(),s=2;else if(t.isDone())return bt.error(ot.expected(36,t))}if(2===s)if(t.isCont())91===(u=t.head())?(t=t.step(),s=8):64===u?(t=t.step(),s=7):58===u?(t=t.step(),s=6):42===u?(t=t.step(),s=5):35===u?(t=t.step(),s=4):s=3;else if(t.isDone())return bt.error(ot.unexpected(t));for(;;){if(3===s){for(void 0===o&&(o=r.parseLiteral(t,r.valueBuilder()));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())i=r.get(i,o.bind()),o=void 0,s=10;else if(o.isError())return o.asError()}if(4===s){for(void 0===o&&(o=r.parseInteger(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())i=r.value(r.getItem(i,o.bind())),o=void 0,s=10;else if(o.isError())return o.asError()}if(5===s&&(t.isCont()?58===(u=t.head())?(t=t.step(),i=r.keys(i),s=10):42===u?(t=t.step(),i=r.descendants(i),s=10):(i=r.children(i),s=10):t.isDone()&&(i=r.children(i),s=10)),6===s)if(t.isCont()){if(42!==(u=t.head()))return bt.error(ot.expected(42,t));t=t.step(),i=r.values(i),s=10}else if(t.isDone())return bt.error(ot.expected(42,t));if(7===s){for(void 0===o&&(o=r.parseIdent(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())i=r.getAttr(i,o.bind()),o=void 0,s=10;else if(o.isError())return o.asError()}if(8===s){for(void 0===o&&(o=r.parseBlockExpression(t));o.isCont()&&!t.isEmpty();)o=o.feed(t);if(o.isDone())s=9;else if(o.isError())return o.asError()}if(9===s){for(;t.isCont()&&(u=t.head(),fo.isSpace(u));)t=t.step();if(t.isCont()){if(93!==u)return bt.error(ot.expected(93,t));t=t.step(),i=r.filter(i,o.bind()),o=void 0,s=10}else if(t.isDone())return bt.error(ot.expected(93,t))}if(10===s)if(t.isCont()){if(91===(u=t.head())){t=t.step(),s=8;continue}if(35===u){t=t.step(),s=4;continue}if(46!==u)return void 0!==n?(n.push(r.item(i)),bt.done(n.bind())):bt.done(i);t=t.step(),s=11}else if(t.isDone())return void 0!==n?(n.push(r.item(i)),bt.done(n.bind())):bt.done(i);if(11===s){if(t.isCont()){if(64===(u=t.head())){t=t.step(),s=7;continue}if(58===u){t=t.step(),s=6;continue}if(42===u){t=t.step(),s=5;continue}s=3;continue}if(t.isDone())return bt.error(ot.unexpected(t))}break}return new e(r,n,i,o,s)},e}(bt),Ko=function(){function t(){}return t.prototype.parseBlock=function(t){return co.parse(t,this)},t.prototype.parseAttr=function(t){return lo.parse(t,this)},t.prototype.parseBlockItem=function(t){return yo.parse(t,this)},t.prototype.parseInlineItem=function(t){return vo.parse(t,this)},t.prototype.parseRecord=function(t,e){return mo.parse(t,this,e)},t.prototype.parseMarkup=function(t,e){return wo.parse(t,this,e)},t.prototype.parseData=function(t){return go.parse(t,this)},t.prototype.parseIdent=function(t){return bo.parse(t,this)},t.prototype.parseString=function(t){return xo.parse(t,this)},t.prototype.parseRawString=function(t){return Oo.parse(t,this)},t.prototype.parseNumber=function(t){return Co.parse(t,this)},t.prototype.parseInteger=function(t){return Co.parseInteger(t,this)},t.prototype.parseBlockExpression=function(t,e){return this.parseLambdaFunc(t,e)},t.prototype.parseLambdaFunc=function(t,e){return So.parse(t,this,e)},t.prototype.parseConditionalOperator=function(t,e){return ko.parse(t,this,e)},t.prototype.parseOrOperator=function(t,e){return Mo.parse(t,this,e)},t.prototype.parseAndOperator=function(t,e){return Ao.parse(t,this,e)},t.prototype.parseBitwiseOrOperator=function(t,e){return Do.parse(t,this,e)},t.prototype.parseBitwiseXorOperator=function(t,e){return Io.parse(t,this,e)},t.prototype.parseBitwiseAndOperator=function(t,e){return To.parse(t,this,e)},t.prototype.parseComparisonOperator=function(t,e){return Vo.parse(t,this,e)},t.prototype.parseAttrExpression=function(t,e){return jo.parse(t,this,e)},t.prototype.parseAdditiveOperator=function(t,e){return qo.parse(t,this,e)},t.prototype.parseMultiplicativeOperator=function(t,e){return Ro.parse(t,this,e)},t.prototype.parsePrefixOperator=function(t,e){return Uo.parse(t,this,e)},t.prototype.parseInvokeOperator=function(t,e){return No.parse(t,this,e)},t.prototype.parsePrimary=function(t,e){return zo.parse(t,this,e)},t.prototype.parseLiteral=function(t,e){return Fo.parse(t,this,e)},t.prototype.parseSelector=function(t,e){return Lo.parse(t,this,e)},t.prototype.blockParser=function(){return new co(this)},t.prototype.parseBlockString=function(t){for(var e=rt.stringInput(t);e.isCont()&&fo.isWhitespace(e.head());)e=e.step();var r=this.parseBlock(e);if(r.isDone())for(;e.isCont()&&fo.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t}(),Bo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.isDistinct=function(t){return t.isDistinct()},e.prototype.item=function(t){return t},e.prototype.value=function(t){return t.toValue()},e.prototype.attr=function(t,e){return 1===arguments.length?er.of(t):er.of(t,e)},e.prototype.slot=function(t,e){return 1===arguments.length?$e.of(t):$e.of(t,e)},e.prototype.valueBuilder=function(){return ir.builder()},e.prototype.recordBuilder=function(){return or.create()},e.prototype.dataOutput=function(){return fr.output()},e.prototype.textOutput=function(){return lr.output()},e.prototype.ident=function(t){if(t instanceof lr){var e=t.stringValue();if("true"===e)return mr.from(!0);if("false"===e)return mr.from(!1)}return t},e.prototype.num=function(t){if("number"==typeof t)return yr.from(t);if("string"==typeof t)return yr.from(+t);throw new TypeError(""+t)},e.prototype.uint32=function(t){return yr.uint32(t)},e.prototype.uint64=function(t){return yr.uint64(t)},e.prototype.bool=function(t){return mr.from(t)},e.prototype.selector=function(){return $r.identity()},e.prototype.extant=function(){return ir.extant()},e.prototype.absent=function(){return ir.absent()},e.prototype.conditional=function(t,e,r){return t.conditional(e,r)},e.prototype.or=function(t,e){return new Ir(t,e)},e.prototype.and=function(t,e){return new Tr(t,e)},e.prototype.bitwiseOr=function(t,e){return new Vr(t,e)},e.prototype.bitwiseXor=function(t,e){return new jr(t,e)},e.prototype.bitwiseAnd=function(t,e){return new qr(t,e)},e.prototype.lt=function(t,e){return new Rr(t,e)},e.prototype.le=function(t,e){return new Ur(t,e)},e.prototype.eq=function(t,e){return new Nr(t,e)},e.prototype.ne=function(t,e){return new zr(t,e)},e.prototype.ge=function(t,e){return new Fr(t,e)},e.prototype.gt=function(t,e){return new Lr(t,e)},e.prototype.plus=function(t,e){return new Kr(t,e)},e.prototype.minus=function(t,e){return new Br(t,e)},e.prototype.times=function(t,e){return new Wr(t,e)},e.prototype.divide=function(t,e){return new Hr(t,e)},e.prototype.modulo=function(t,e){return new Xr(t,e)},e.prototype.not=function(t){return new Yr(t)},e.prototype.bitwiseNot=function(t){return new Gr(t)},e.prototype.negative=function(t){return t instanceof yr?t.negative():new _r(t)},e.prototype.positive=function(t){return new Qr(t)},e.prototype.invoke=function(t,e){return new Zr(t,e)},e.prototype.lambda=function(t,e){return t.lambda(e)},e.prototype.get=function(t,e){return t.get(e)},e.prototype.getAttr=function(t,e){return t.getAttr(e)},e.prototype.getItem=function(t,e){return t.getItem(e)},e.prototype.children=function(t){return $r.literal(t).children()},e.prototype.descendants=function(t){return $r.literal(t).descendants()},e.prototype.keys=function(t){return $r.literal(t).keys()},e.prototype.values=function(t){return $r.literal(t).values()},e.prototype.filter=function(t,e){return t.filter(e)},e}(Ko),Wo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.key=r,s.value=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.key,this.value,this.part,this.step)},e.sizeOf=function(t,e,r){var n=0;return n+=1,n+=t.sizeOfValue(e),t.isExtant(t.item(r))||(n+=1,n+=t.sizeOfBlockValue(r),n+=1),n},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()&&(t=t.write(64),s=2),2===s)if((o=void 0===o?r.writeValue(t,n):o.pull(t)).isDone()){if(o=void 0,r.isExtant(r.item(i)))return tt.end();s=3}else if(o.isError())return o.asError();if(3===s&&t.isCont()&&(t=t.write(40),s=4),4===s)if((o=void 0===o?r.writeBlockValue(t,i):o.pull(t)).isDone())o=void 0,s=5;else if(o.isError())return o.asError();return 5===s&&t.isCont()?(t=t.write(41),tt.end()):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e}(tt),Ho=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.key=r,s.value=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.key,this.value,this.part,this.step)},e.sizeOf=function(t,e,r){var n=0;return n+=t.sizeOfValue(e),n+=1,t.isExtant(t.item(r))||(n+=t.sizeOfValue(r)),n},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s)if((o=void 0===o?r.writeValue(t,n):o.pull(t)).isDone())o=void 0,s=2;else if(o.isError())return o.asError();if(2===s&&t.isCont()){if(t=t.write(58),r.isExtant(r.item(i)))return tt.end();s=3}if(3===s){if((o=void 0===o?r.writeValue(t,i):o.pull(t)).isDone())return tt.end();if(o.isError())return o.asError()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e}(tt),Xo=function(t){function e(e,r,n,i,o,s,u,a,p,h,f,c){var l=t.call(this)||this;return l.recon=e,l.items=r,l.inBlock=n,l.inMarkup=i,l.inBraces=o,l.inBrackets=s,l.first=u,l.markupSafe=a,l.item=p,l.next=h,l.part=f,l.step=c,l}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.items,this.inBlock,this.inMarkup,this.inBraces,this.inBrackets,this.first,this.markupSafe,this.item,this.next,this.part,this.step)},e.sizeOf=function(t,r,n,i){for(var o,s=0,u=!1,a=!1,p=!0,h=!0;void 0!==o||r.hasNext();){var f=void 0;void 0===o?f=r.next().value:(f=o,o=void 0),r.hasNext()&&(o=r.next().value),t.isExpression(f)&&(h=!1),a&&t.isAttr(f)&&(u&&(s+=1,u=!1),s+=1,a=!1),t.isAttr(f)?(u?(s+=1,u=!1):a&&(s+=1,a=!1),s+=t.sizeOfItem(f),p=!1):a&&t.isText(f)?(u&&(s+=1,u=!1),s+=t.sizeOfMarkupText(f)):u?(p?p=!1:s+=1,s+=e.sizeOfBlockItem(t,f)):a?t.isRecord(f)&&t.isMarkupSafe(t.items(f))?(s+=t.sizeOfBlock(t.items(f),!1,!0),void 0!==o&&t.isText(o)?(s+=t.sizeOfMarkupText(o),o=void 0):void 0===o||t.isAttr(o)?(s+=1,a=!1):(s+=1,u=!0,p=!0)):(s+=1,s+=t.sizeOfItem(f),u=!0,p=!1):!h||!t.isText(f)||void 0===o||t.isField(o)||t.isText(o)||t.isBool(o)?n&&!u?(p?p=!1:s+=1,s+=e.sizeOfBlockItem(t,f)):i&&t.isText(f)&&void 0===o?(s+=1,s+=t.sizeOfMarkupText(f),s+=1):!i&&t.isValue(f)&&!t.isRecord(f)&&(!p&&void 0===o||void 0!==o&&t.isAttr(o))?(!p&&(t.isText(f)&&t.isIdent(f)||t.isNum(f)||t.isBool(f))&&(s+=1),s+=t.sizeOfItem(f)):(s+=1,s+=t.sizeOfItem(f),u=!0,p=!1):(s+=1,s+=t.sizeOfMarkupText(f),a=!0)}return u&&(s+=1),a&&(s+=1),s},e.sizeOfBlockItem=function(t,e){var r=0;return t.isField(e)?r+=t.sizeOfSlot(t.key(e),t.value(e)):r+=t.sizeOfItem(e),r},e.write=function(t,r,n,i,o,s,u,a,p,h,f,c,l){for(void 0===s&&(s=!1),void 0===u&&(u=!1),void 0===a&&(a=!0),void 0===p&&(p=!0),void 0===l&&(l=1);;){if(1===l){if(void 0===f&&!n.hasNext()){l=10;break}void 0===f?h=n.next().value:(h=f,f=void 0),n.hasNext()&&(f=n.next().value),r.isExpression(h)&&(p=!1),l=2}if(2===l&&t.isCont()&&(u&&r.isAttr(h)?(s&&(t=t.write(125),s=!1),l=3):l=4),3===l&&t.isCont()&&(t=t.write(93),u=!1,l=4),4===l&&t.isCont()&&(r.isAttr(h)?(s?(t=t.write(125),s=!1):u&&(t=t.write(93),u=!1),c=r.writeItem(t,h),a=!1,l=7):u&&r.isText(h)?(s&&(t=t.write(125),s=!1),c=r.writeMarkupText(t,h),l=7):s?(a?a=!1:t=t.write(44),c=e.writeBlockItem(t,r,h),l=7):u?r.isRecord(h)&&r.isMarkupSafe(r.items(h))?(c=r.writeBlock(t,r.items(h),!1,!0),l=5):(t=t.write(123),c=r.writeItem(t,h),s=!0,a=!1,l=7):!p||!r.isText(h)||void 0===f||r.isField(f)||r.isText(f)||r.isBool(f)?i&&!s?(a?a=!1:t=t.write(44),c=e.writeBlockItem(t,r,h),l=7):o&&r.isText(h)&&void 0===f?(t=t.write(91),c=r.writeMarkupText(t,h),l=8):!o&&r.isValue(h)&&!r.isRecord(h)&&(!a&&void 0===f||void 0!==f&&r.isAttr(f))?(!a&&(r.isText(h)&&r.isIdent(h)||r.isNum(h)||r.isBool(h))&&(t=t.write(32)),c=r.writeItem(t,h),l=7):(t=t.write(123),c=r.writeItem(t,h),s=!0,a=!1,l=7):(t=t.write(91),c=r.writeMarkupText(t,h),u=!0,l=7)),5===l)if((c=c.pull(t)).isDone())c=void 0,l=6;else if(c.isError())return c.asError();if(6===l&&t.isCont()){if(void 0===f||!r.isText(f)){if(void 0===f||r.isAttr(f)){t=t.write(93),u=!1,l=1;continue}t=t.write(123),s=!0,a=!0,l=1;continue}c=r.writeMarkupText(t,f),f=void 0,l=7}if(7===l){if((c=c.pull(t)).isDone()){c=void 0,l=1;continue}if(c.isError())return c.asError()}if(8===l)if((c=c.pull(t)).isDone())c=void 0,l=9;else if(c.isError())return c.asError();if(9!==l||!t.isCont())break;t=t.write(93),l=1}if(10===l&&(s?t.isCont()&&(t=t.write(125),l=11):l=11),11===l){if(!u)return tt.end();if(t.isCont())return t=t.write(93),tt.end()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s,u,a,p,h,f,c,l)},e.writeBlockItem=function(t,e,r){return e.isField(r)?e.writeSlot(t,e.key(r),e.value(r)):e.writeItem(t,r)},e}(tt),Yo=function(t){function e(e,r,n,i,o,s,u,a){var p=t.call(this)||this;return p.recon=e,p.items=r,p.inParens=n,p.first=i,p.item=o,p.next=s,p.part=u,p.step=a,p}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.items,this.inParens,this.first,this.item,this.next,this.part,this.step)},e.sizeOf=function(t,e){for(var r,n=0,i=!1,o=!0;void 0!==r||e.hasNext();){var s=void 0;void 0===r?s=e.next().value:(s=r,r=void 0),e.hasNext()&&(r=e.next().value),i||o||(n+=1),t.isAttr(s)?(i&&(n+=1,i=!1),n+=t.sizeOfItem(s),o=!1):i?(o?o=!1:n+=1,n+=t.sizeOfBlockItem(s)):t.isValue(s)&&!t.isRecord(s)&&(!o&&void 0===r||void 0!==r&&t.isAttr(r))?n+=t.sizeOfItem(s):(n+=1,n+=t.sizeOfItem(s),i=!0,o=!1)}return i&&(n+=1),n},e.write=function(t,r,n,i,o,s,u,a,p){for(void 0===i&&(i=!1),void 0===o&&(o=!0),void 0===p&&(p=1);;){if(1===p){if(void 0===u&&!n.hasNext()){p=5;break}void 0===u?s=n.next().value:(s=u,u=void 0),n.hasNext()&&(u=n.next().value),p=2}if(2===p&&t.isCont()&&(i||o||(t=t.write(32)),p=3),3===p&&t.isCont()&&(r.isAttr(s)?(i&&(t=t.write(41),i=!1),a=r.writeItem(t,s),o=!1,p=4):i?(o?o=!1:t=t.write(44),a=r.writeBlockItem(t,s),p=4):r.isValue(s)&&!r.isRecord(s)&&(!o&&void 0===u||void 0!==u&&r.isAttr(u))?(a=r.writeItem(t,s),p=4):(t=t.write(40),a=r.writeItem(t,s),i=!0,o=!1,p=4)),4===p){if((a=a.pull(t)).isDone()){a=void 0,p=1;continue}if(a.isError())return a.asError()}break}if(5===p){if(!i)return tt.end();if(t.isCont())return t=t.write(41),tt.end()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s,u,a,p)},e}(tt),Go=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.text=e,o.index=r,o.escape=n,o.step=i,o}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.text,this.index,this.escape,this.step)},e.sizeOf=function(t){for(var e=0,r=0,n=t.length;r<n;r=t.offsetByCodePoints(r,1)){var i=t.codePointAt(r);void 0===i&&(i=t.charCodeAt(r)),e+=36===i||64===i||91===i||92===i||93===i||123===i||125===i||8===i||12===i||10===i||13===i||9===i?2:i<32?6:Ut.sizeOf(i)}return e},e.write=function(t,r,n,i,o){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=1);for(var s=r.length;t.isCont();)if(1===o){if(!(n<s))return tt.end();var u=r.codePointAt(n);void 0===u&&(u=r.charCodeAt(n)),n=r.offsetByCodePoints(n,1),36===u||64===u||91===u||92===u||93===u||123===u||125===u?(t=t.write(92),i=u,o=2):8===u?(t=t.write(92),i=98,o=2):12===u?(t=t.write(92),i=102,o=2):10===u?(t=t.write(92),i=110,o=2):13===u?(t=t.write(92),i=114,o=2):9===u?(t=t.write(92),i=116,o=2):u<32?(t=t.write(92),i=u,o=3):t=t.write(u)}else 2===o?(t=t.write(i),i=0,o=1):3===o?(t=t.write(117),o=4):4===o?(t=t.write(jt.uppercase.encodeDigit(i>>>12&15)),o=5):5===o?(t=t.write(jt.uppercase.encodeDigit(i>>>8&15)),o=6):6===o?(t=t.write(jt.uppercase.encodeDigit(i>>>4&15)),o=7):7===o&&(t=t.write(jt.uppercase.encodeDigit(15&i)),i=0,o=1);return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o)},e}(tt),_o=function(t){function e(e,r,n){var i=t.call(this)||this;return i.array=e,i.part=r,i.step=n,i}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.array,this.part,this.step)},e.sizeOf=function(t){return 1+(Math.floor(4*t/3)+3&-4)},e.write=function(t,r,n,i){if(void 0===i&&(i=1),1===i&&t.isCont()&&(t=t.write(37),i=2),2===i){if((n=void 0===n?Wt.standard().writeUint8Array(t,r):n.pull(t)).isDone())return n=void 0,tt.end();if(n.isError())return n.asError()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i)},e}(tt),Qo=function(t){function e(e,r){var n=t.call(this)||this;return n.ident=e,n.index=r,n}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.ident,this.index)},e.sizeOf=function(t){return Ut.sizeOf(t)},e.write=function(t,r,n){var i;void 0===n&&(n=0);var o=r.length;if(0===o)return tt.error(new $("empty identifier"));for(0===n&&t.isCont()&&(void 0===(i=r.codePointAt(0))&&(i=r.charCodeAt(0)),fo.isIdentStartChar(i)&&(t=t.write(i),n=r.offsetByCodePoints(0,1)));n<o&&t.isCont();){if(void 0===(i=r.codePointAt(n))&&(i=r.charCodeAt(n)),!fo.isIdentChar(i))return tt.error(new $("invalid identifier"));t=t.write(i),n=r.offsetByCodePoints(n,1)}return n>=o?tt.end():t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n)},e}(tt),Zo=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.string=e,o.index=r,o.escape=n,o.step=i,o}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.string,this.index,this.escape,this.step)},e.sizeOf=function(t){var e=0;e+=1;for(var r=0,n=t.length;r<n;r=t.offsetByCodePoints(r,1)){var i=t.codePointAt(r);void 0===i&&(i=t.charCodeAt(r)),e+=34===i||92===i||8===i||12===i||10===i||13===i||9===i?2:i<32?6:Ut.sizeOf(i)}return e+=1},e.write=function(t,r,n,i,o){void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=1),1===o&&t.isCont()&&(t=t.write(34),o=2);for(var s=r.length;o>=2&&o<=8&&t.isCont();)if(2===o){if(!(n<s)){o=9;break}var u=r.codePointAt(n);void 0===u&&(u=r.charCodeAt(n)),n=r.offsetByCodePoints(n,1),34===u||92===u?(t=t.write(92),i=u,o=3):8===u?(t=t.write(92),i=98,o=3):12===u?(t=t.write(92),i=102,o=3):10===u?(t=t.write(92),i=110,o=3):13===u?(t=t.write(92),i=114,o=3):9===u?(t=t.write(92),i=116,o=3):u<32?(t=t.write("\\"),i=u,o=4):t=t.write(u)}else 3===o?(t=t.write(i),i=0,o=2):4===o?(t=t.write(117),o=5):5===o?(t=t.write(jt.uppercase.encodeDigit(i>>>12&15)),o=6):6===o?(t=t.write(jt.uppercase.encodeDigit(i>>>8&15)),o=7):7===o?(t=t.write(jt.uppercase.encodeDigit(i>>>4&15)),o=8):8===o&&(t=t.write(jt.uppercase.encodeDigit(15&i)),i=0,o=2);return 9===o&&t.isCont()?(t=t.write(34),tt.end()):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o)},e}(tt),Jo=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.bindings=r,s.template=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.bindings,this.template,this.part,this.step)},e.sizeOf=function(t,e,r){var n=0;return n+=t.sizeOfPrimary(e),n+=4,n+=t.sizeOfValue(r)},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s)if((o=void 0===o?r.writePrimary(t,n):o.pull(t)).isDone())o=void 0,s=2;else if(o.isError())return o.asError();if(2===s&&t.isCont()&&(t=t.write(32),s=3),3===s&&t.isCont()&&(t=t.write(61),s=4),4===s&&t.isCont()&&(t=t.write(62),s=5),5===s&&t.isCont()&&(t=t.write(32),s=6),6===s){if((o=void 0===o?r.writeValue(t,i):o.pull(t)).isDone())return tt.end();if(o.isError())return o.asError()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e}(tt),$o=function(t){function e(e,r,n,i,o,s,u){var a=t.call(this)||this;return a.recon=e,a.ifTerm=r,a.thenTerm=n,a.elseTerm=i,a.precedence=o,a.part=s,a.step=u,a}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.ifTerm,this.thenTerm,this.elseTerm,this.precedence,this.part,this.step)},e.sizeOf=function(t,e,r,n,i){var o=0;return t.precedence(e)>0&&t.precedence(e)<=i?(o+=1,o+=t.sizeOfItem(e),o+=1):o+=t.sizeOfItem(e),o+=3,o+=t.sizeOfItem(r),o+=3,o+=t.sizeOfItem(n)},e.write=function(t,r,n,i,o,s,u,a){if(void 0===a&&(a=1),1===a&&(r.precedence(n)>0&&r.precedence(n)<=s?t.isCont()&&(t=t.write(40),a=2):a=2),2===a)if((u=void 0===u?r.writeItem(t,n):u.pull(t)).isDone())u=void 0,a=3;else if(u.isError())return u.asError();if(3===a&&(r.precedence(n)>0&&r.precedence(n)<=s?t.isCont()&&(t=t.write(41),a=4):a=4),4===a&&t.isCont()&&(t=t.write(32),a=5),5===a&&t.isCont()&&(t=t.write(63),a=6),6===a&&t.isCont()&&(t=t.write(32),a=7),7===a)if((u=void 0===u?r.writeItem(t,i):u.pull(t)).isDone())u=void 0,a=8;else if(u.isError())return u.asError();if(8===a&&t.isCont()&&(t=t.write(32),a=9),9===a&&t.isCont()&&(t=t.write(58),a=10),10===a&&t.isCont()&&(t=t.write(32),a=11),11===a){if((u=void 0===u?r.writeItem(t,o):u.pull(t)).isDone())return tt.end();if(u.isError())return u.asError()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s,u,a)},e}(tt),ts=function(t){function e(e,r,n,i,o,s,u){var a=t.call(this)||this;return a.recon=e,a.lhs=r,a.operator=n,a.rhs=i,a.precedence=o,a.part=s,a.step=u,a}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.lhs,this.operator,this.rhs,this.precedence,this.part,this.step)},e.sizeOf=function(t,e,r,n,i){var o=0;return t.precedence(e)<i?(o+=1,o+=t.sizeOfItem(e),o+=1):o+=t.sizeOfItem(e),o+=1,o+=Ut.sizeOf(r),o+=1,t.precedence(n)<i?(o+=1,o+=t.sizeOfItem(n),o+=1):o+=t.sizeOfItem(n),o},e.write=function(t,r,n,i,o,s,u,a){if(void 0===a&&(a=1),1===a&&(r.precedence(n)<s?t.isCont()&&(t=t.write(40),a=2):a=2),2===a)if((u=void 0===u?r.writeItem(t,n):u.pull(t)).isDone())u=void 0,a=3;else if(u.isError())return u.asError();if(3===a&&(r.precedence(n)<s?t.isCont()&&(t=t.write(41),a=4):a=4),4===a&&t.isCont()&&(t=t.write(32),a=5),5===a)if((u=void 0===u?rt.writeString(t,i):u.pull(t)).isDone())u=void 0,a=6;else if(u.isError())return u.asError();if(6===a&&t.isCont()&&(t=t.write(32),a=7),7===a&&(r.precedence(o)<s?t.isCont()&&(t=t.write(40),a=8):a=8),8===a)if((u=void 0===u?r.writeItem(t,o):u.pull(t)).isDone())u=void 0,a=9;else if(u.isError())return u.asError();if(9===a){if(!(r.precedence(o)<s))return tt.end();if(t.isCont())return t=t.write(41),tt.end()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s,u,a)},e}(tt),es=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.recon=e,u.operator=r,u.rhs=n,u.precedence=i,u.part=o,u.step=s,u}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.operator,this.rhs,this.precedence,this.part,this.step)},e.sizeOf=function(t,e,r,n){var i=0;return i+=Ut.sizeOf(e),t.precedence(r)<n?(i+=1,i+=t.sizeOfItem(r),i+=1):i+=t.sizeOfItem(r),i},e.write=function(t,r,n,i,o,s,u){if(void 0===u&&(u=1),1===u)if((s=void 0===s?rt.writeString(t,n):s.pull(t)).isDone())s=void 0,u=2;else if(s.isError())return s.asError();if(2===u&&(r.precedence(i)<o?t.isCont()&&(t=t.write(40),u=3):u=3),3===u)if((s=void 0===s?r.writeItem(t,i):s.pull(t)).isDone())s=void 0,u=4;else if(s.isError())return s.asError();if(4===u){if(!(r.precedence(i)<o))return tt.end();if(t.isCont())return t=t.write(41),tt.end()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s,u)},e}(tt),rs=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.func=r,s.args=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.func,this.args,this.part,this.step)},e.sizeOf=function(t,e,r){var n=0;return n+=t.sizeOfValue(e),n+=1,n+=t.sizeOfBlockValue(r),n+=1},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s)if((o=void 0===o?r.writeValue(t,n):o.pull(t)).isDone())o=void 0,s=2;else if(o.isError())return o.asError();if(2===s&&t.isCont()&&(t=t.write(40),s=3),3===s)if((o=void 0===o?r.writeBlockValue(t,i):o.pull(t)).isDone())o=void 0,s=4;else if(o.isError())return o.asError();return 4===s&&t.isCont()?(t=t.write(41),tt.end()):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e}(tt),ns=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.item=r,s.then=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.item,this.then,this.part,this.step)},e.sizeOf=function(t,e,r){var n=0;return t.precedence(e)<t.precedence(t.item(r))?(n+=1,n+=t.sizeOfItem(e),n+=1):n+=t.sizeOfItem(e),n+=t.sizeOfThen(r)},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s&&(r.precedence(n)<r.precedence(r.item(i))?t.isCont()&&(t=t.write(40),s=2):s=2),2===s)if((o=void 0===o?r.writeItem(t,n):o.pull(t)).isDone())o=void 0,s=3;else if(o.isError())return o.asError();return 3===s&&(r.precedence(n)<r.precedence(r.item(i))?t.isCont()&&(t=t.write(41),s=4):s=4),4===s?r.writeThen(t,i):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e}(tt),is=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.key=r,s.then=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.key,this.then,this.part,this.step)},e.sizeOf=function(t,e,r){var n=1;return t.isRecord(t.item(e))?(n+=1,n+=t.sizeOfBlockValue(e),n+=1):n+=t.sizeOfValue(e),n+=t.sizeOfThen(r)},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()?(t=t.write(36),s=3):2===s&&t.isCont()&&(t=t.write(46),s=3),3===s&&(r.isRecord(r.item(n))?t.isCont()&&(t=t.write(123),s=4):s=4),4===s)if((o=void 0===o?r.isRecord(r.item(n))?r.writeBlockValue(t,n):r.writeValue(t,n):o.pull(t)).isDone())o=void 0,s=5;else if(o.isError())return o.asError();return 5===s&&(r.isRecord(r.item(n))?t.isCont()&&(t=t.write(125),s=6):s=6),6===s?r.writeThen(t,i):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e.writeThen=function(t,r,n,i){return e.write(t,r,n,i,void 0,2)},e}(tt),os=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.key=r,s.then=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.key,this.then,this.part,this.step)},e.sizeOf=function(t,e,r){var n=2;return n+=t.sizeOfValue(e),n+=t.sizeOfThen(r)},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()?(t=t.write(36),s=3):2===s&&t.isCont()&&(t=t.write(46),s=3),3===s&&t.isCont()&&(t=t.write(64),s=4),4===s){if((o=void 0===o?r.writeValue(t,n):o.pull(t)).isDone())return r.writeThen(t,i);if(o.isError())return o.asError()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e.writeThen=function(t,r,n,i){return e.write(t,r,n,i,void 0,2)},e}(tt),ss=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.index=r,s.then=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.index,this.then,this.part,this.step)},e.sizeOf=function(t,e,r){var n=2;return n+=t.sizeOfValue(e),n+=t.sizeOfThen(r)},e.sizeOfThen=function(t,e,r){var n=1;return n+=t.sizeOfValue(e),n+=t.sizeOfThen(r)},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()&&(t=t.write(36),s=2),2===s&&t.isCont()&&(t=t.write(35),s=3),3===s){if((o=void 0===o?r.writeValue(t,n):o.pull(t)).isDone())return r.writeThen(t,i);if(o.isError())return o.asError()}return t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e.writeThen=function(t,r,n,i){return e.write(t,r,n,i,void 0,2)},e}(tt),us=function(t){function e(e,r,n){var i=t.call(this)||this;return i.recon=e,i.then=r,i.step=n,i}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.then,this.step)},e.sizeOf=function(t,e){var r=3;return r+=t.sizeOfThen(e)},e.write=function(t,r,n,i){return void 0===i&&(i=1),1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()&&(t=t.write(42),i=4),4===i&&t.isCont()?(t=t.write(58),r.writeThen(t,n)):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i)},e.writeThen=function(t,r,n){return e.write(t,r,n,2)},e}(tt),as=function(t){function e(e,r,n){var i=t.call(this)||this;return i.recon=e,i.then=r,i.step=n,i}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.then,this.step)},e.sizeOf=function(t,e){var r=3;return r+=t.sizeOfThen(e)},e.write=function(t,r,n,i){return void 0===i&&(i=1),1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()&&(t=t.write(58),i=4),4===i&&t.isCont()?(t=t.write(42),r.writeThen(t,n)):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i)},e.writeThen=function(t,r,n){return e.write(t,r,n,2)},e}(tt),ps=function(t){function e(e,r,n){var i=t.call(this)||this;return i.recon=e,i.then=r,i.step=n,i}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.then,this.step)},e.sizeOf=function(t,e){var r=2;return r+=t.sizeOfThen(e)},e.write=function(t,r,n,i){return void 0===i&&(i=1),1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()?(t=t.write(42),r.writeThen(t,n)):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i)},e.writeThen=function(t,r,n){return e.write(t,r,n,2)},e}(tt),hs=function(t){function e(e,r,n){var i=t.call(this)||this;return i.recon=e,i.then=r,i.step=n,i}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.then,this.step)},e.sizeOf=function(t,e){var r=3;return r+=t.sizeOfThen(e)},e.write=function(t,r,n,i){return void 0===i&&(i=1),1===i&&t.isCont()?(t=t.write(36),i=3):2===i&&t.isCont()&&(t=t.write(46),i=3),3===i&&t.isCont()&&(t=t.write(42),i=4),4===i&&t.isCont()?(t=t.write(42),r.writeThen(t,n)):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i)},e.writeThen=function(t,r,n){return e.write(t,r,n,2)},e}(tt),fs=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.recon=e,s.predicate=r,s.then=n,s.part=i,s.step=o,s}return P(e,t),e.prototype.pull=function(t){return e.write(t,this.recon,this.predicate,this.then,this.part,this.step)},e.sizeOf=function(t,e,r){var n=2;return n+=t.sizeOfValue(e),n+=1,n+=t.sizeOfThen(r)},e.sizeOfThen=function(t,e,r){var n=1;return n+=t.sizeOfValue(e),n+=1,n+=t.sizeOfThen(r)},e.write=function(t,r,n,i,o,s){if(void 0===s&&(s=1),1===s&&t.isCont()&&(t=t.write(36),s=2),2===s&&t.isCont()&&(t=t.write(91),s=3),3===s)if((o=void 0===o?r.writeValue(t,n):o.pull(t)).isDone())o=void 0,s=4;else if(o.isError())return o.asError();return 4===s&&t.isCont()?(t=t.write(93),r.writeThen(t,i)):t.isDone()?tt.error(new $("truncated")):t.isError()?tt.error(t.trap()):new e(r,n,i,o,s)},e.writeThen=function(t,r,n,i){return e.write(t,r,n,i,void 0,2)},e}(tt),cs=function(){function t(){}return t.prototype.sizeOfAttr=function(t,e){return Wo.sizeOf(this,t,e)},t.prototype.writeAttr=function(t,e,r){return Wo.write(t,this,e,r)},t.prototype.sizeOfSlot=function(t,e){return Ho.sizeOf(this,t,e)},t.prototype.writeSlot=function(t,e,r){return Ho.write(t,this,e,r)},t.prototype.sizeOfBlock=function(t,e,r){if(3===arguments.length)return Xo.sizeOf(this,t,e,r);var n=this.items(t);return n.hasNext()?Xo.sizeOf(this,n,this.isBlockSafe(this.items(t)),!1):2},t.prototype.writeBlock=function(t,e,r,n){if(4===arguments.length)return Xo.write(t,this,e,r,n);var i=this.items(e);return i.hasNext()?Xo.write(t,this,i,this.isBlockSafe(this.items(e)),!1):rt.writeString(t,"{}")},t.prototype.sizeOfRecord=function(t){var e=this.items(t);return e.hasNext()?Xo.sizeOf(this,e,!1,!1):2},t.prototype.writeRecord=function(t,e){var r=this.items(e);return r.hasNext()?Xo.write(t,this,r,!1,!1):rt.writeString(t,"{}")},t.prototype.sizeOfPrimary=function(t){if(this.isRecord(this.item(t))){var e=this.items(this.item(t));if(e.hasNext())return Yo.sizeOf(this,e)}else if(!this.isExtant(this.item(t)))return this.sizeOfValue(t);return 2},t.prototype.writePrimary=function(t,e){if(this.isRecord(this.item(e))){var r=this.items(this.item(e));if(r.hasNext())return Yo.write(t,this,r)}else if(!this.isExtant(this.item(e)))return this.writeValue(t,e);return rt.writeString(t,"()")},t.prototype.isBlockSafe=function(t){for(;t.hasNext();)if(this.isAttr(t.next().value))return!1;return!0},t.prototype.isMarkupSafe=function(t){if(!t.hasNext()||!this.isAttr(t.next().value))return!1;for(;t.hasNext();)if(this.isAttr(t.next().value))return!1;return!0},t.prototype.sizeOfMarkupText=function(t){return"string"!=typeof t&&(t=this.string(t)),Go.sizeOf(t)},t.prototype.writeMarkupText=function(t,e){return"string"!=typeof e&&(e=this.string(e)),Go.write(t,e)},t.prototype.sizeOfData=function(t){return _o.sizeOf(t)},t.prototype.writeData=function(t,e){return void 0!==e?_o.write(t,e):rt.writeString(t,"%")},t.prototype.isIdent=function(t){"string"!=typeof t&&(t=this.string(t));var e,r=t.length;if(0===r||void 0!==(e=t.codePointAt(0))&&!fo.isIdentStartChar(e))return!1;for(var n=t.offsetByCodePoints(0,1);n<r;n=t.offsetByCodePoints(n,1))if(void 0===(e=t.codePointAt(n))||!fo.isIdentChar(e))return!1;return!0},t.prototype.sizeOfText=function(t){return this.isIdent(t)?Qo.sizeOf(t):Zo.sizeOf(t)},t.prototype.writeText=function(t,e){return this.isIdent(e)?Qo.write(t,e):Zo.write(t,e)},t.prototype.sizeOfNum=function(t){if(isFinite(t)&&Math.floor(t)===t&&Math.abs(t)<2147483648){var e=it.countDigits(t);return t<0&&(e+=1),e}return(""+t).length},t.prototype.writeNum=function(t,e){return isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<2147483648?it.writeInteger(t,e):rt.writeString(t,""+e)},t.prototype.sizeOfUint32=function(t){return 10},t.prototype.writeUint32=function(t,e){return jt.lowercase.writeIntegerLiteral(t,e,8)},t.prototype.sizeOfUint64=function(t){return 18},t.prototype.writeUint64=function(t,e){return jt.lowercase.writeIntegerLiteral(t,e,16)},t.prototype.sizeOfBool=function(t){return t?4:5},t.prototype.writeBool=function(t,e){return rt.writeString(t,e?"true":"false")},t.prototype.sizeOfLambdaFunc=function(t,e){return Jo.sizeOf(this,t,e)},t.prototype.writeLambdaFunc=function(t,e,r){return Jo.write(t,this,e,r)},t.prototype.sizeOfConditionalOperator=function(t,e,r,n){return $o.sizeOf(this,t,e,r,n)},t.prototype.writeConditionalOperator=function(t,e,r,n,i){return $o.write(t,this,e,r,n,i)},t.prototype.sizeOfInfixOperator=function(t,e,r,n){return ts.sizeOf(this,t,e,r,n)},t.prototype.writeInfixOperator=function(t,e,r,n,i){return ts.write(t,this,e,r,n,i)},t.prototype.sizeOfPrefixOperator=function(t,e,r){return es.sizeOf(this,t,e,r)},t.prototype.writePrefixOperator=function(t,e,r,n){return es.write(t,this,e,r,n)},t.prototype.sizeOfInvokeOperator=function(t,e){return rs.sizeOf(this,t,e)},t.prototype.writeInvokeOperator=function(t,e,r){return rs.write(t,this,e,r)},t.prototype.sizeOfIdentitySelector=function(){return 0},t.prototype.writeIdentitySelector=function(t){return tt.end()},t.prototype.sizeOfThenIdentitySelector=function(){return 0},t.prototype.writeThenIdentitySelector=function(t){return tt.end()},t.prototype.sizeOfLiteralSelector=function(t,e){return ns.sizeOf(this,t,e)},t.prototype.writeLiteralSelector=function(t,e,r){return ns.write(t,this,e,r)},t.prototype.sizeOfThenLiteralSelector=function(t,e){return 0},t.prototype.writeThenLiteralSelector=function(t,e,r){return tt.end()},t.prototype.sizeOfGetSelector=function(t,e){return is.sizeOf(this,t,e)},t.prototype.writeGetSelector=function(t,e,r){return is.write(t,this,e,r)},t.prototype.sizeOfThenGetSelector=function(t,e){return is.sizeOf(this,t,e)},t.prototype.writeThenGetSelector=function(t,e,r){return is.writeThen(t,this,e,r)},t.prototype.sizeOfGetAttrSelector=function(t,e){return os.sizeOf(this,t,e)},t.prototype.writeGetAttrSelector=function(t,e,r){return os.write(t,this,e,r)},t.prototype.sizeOfThenGetAttrSelector=function(t,e){return os.sizeOf(this,t,e)},t.prototype.writeThenGetAttrSelector=function(t,e,r){return os.writeThen(t,this,e,r)},t.prototype.sizeOfGetItemSelector=function(t,e){return ss.sizeOf(this,t,e)},t.prototype.writeGetItemSelector=function(t,e,r){return ss.write(t,this,e,r)},t.prototype.sizeOfThenGetItemSelector=function(t,e){return ss.sizeOfThen(this,t,e)},t.prototype.writeThenGetItemSelector=function(t,e,r){return ss.writeThen(t,this,e,r)},t.prototype.sizeOfKeysSelector=function(t){return us.sizeOf(this,t)},t.prototype.writeKeysSelector=function(t,e){return us.write(t,this,e)},t.prototype.sizeOfThenKeysSelector=function(t){return us.sizeOf(this,t)},t.prototype.writeThenKeysSelector=function(t,e){return us.writeThen(t,this,e)},t.prototype.sizeOfValuesSelector=function(t){return as.sizeOf(this,t)},t.prototype.writeValuesSelector=function(t,e){return as.write(t,this,e)},t.prototype.sizeOfThenValuesSelector=function(t){return as.sizeOf(this,t)},t.prototype.writeThenValuesSelector=function(t,e){return as.writeThen(t,this,e)},t.prototype.sizeOfChildrenSelector=function(t){return ps.sizeOf(this,t)},t.prototype.writeChildrenSelector=function(t,e){return ps.write(t,this,e)},t.prototype.sizeOfThenChildrenSelector=function(t){return ps.sizeOf(this,t)},t.prototype.writeThenChildrenSelector=function(t,e){return ps.writeThen(t,this,e)},t.prototype.sizeOfDescendantsSelector=function(t){return hs.sizeOf(this,t)},t.prototype.writeDescendantsSelector=function(t,e){return hs.write(t,this,e)},t.prototype.sizeOfThenDescendantsSelector=function(t){return hs.sizeOf(this,t)},t.prototype.writeThenDescendantsSelector=function(t,e){return hs.writeThen(t,this,e)},t.prototype.sizeOfFilterSelector=function(t,e){return fs.sizeOf(this,t,e)},t.prototype.writeFilterSelector=function(t,e,r){return fs.write(t,this,e,r)},t.prototype.sizeOfThenFilterSelector=function(t,e){return fs.sizeOfThen(this,t,e)},t.prototype.writeThenFilterSelector=function(t,e,r){return fs.writeThen(t,this,e,r)},t.prototype.sizeOfExtant=function(){return 0},t.prototype.writeExtant=function(t){return tt.end()},t.prototype.sizeOfAbsent=function(){return 0},t.prototype.writeAbsent=function(t){return tt.end()},t}(),ls=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.isField=function(t){return t instanceof Je},e.prototype.isAttr=function(t){return t instanceof er},e.prototype.isSlot=function(t){return t instanceof $e},e.prototype.isValue=function(t){return t instanceof ir},e.prototype.isRecord=function(t){return t instanceof or},e.prototype.isText=function(t){return t instanceof lr},e.prototype.isNum=function(t){return t instanceof yr},e.prototype.isBool=function(t){return t instanceof mr},e.prototype.isExpression=function(t){return t instanceof br},e.prototype.isExtant=function(t){return t instanceof wr},e.prototype.items=function(t){return t.iterator()},e.prototype.item=function(t){return t},e.prototype.key=function(t){return t.key},e.prototype.value=function(t){return t.toValue()},e.prototype.string=function(t){return t.stringValue("")},e.prototype.precedence=function(t){return t.precedence},e.prototype.sizeOfItem=function(t){if(t instanceof Je){if(t instanceof er)return this.sizeOfAttr(t.key,t.value);if(t instanceof $e)return this.sizeOfSlot(t.key,t.value)}else if(t instanceof ir)return this.sizeOfValue(t);throw new $("No Recon serialization for "+t)},e.prototype.writeItem=function(t,e){if(e instanceof Je){if(e instanceof er)return this.writeAttr(t,e.key,e.value);if(e instanceof $e)return this.writeSlot(t,e.key,e.value)}else if(e instanceof ir)return this.writeValue(t,e);return tt.error(new $("No Recon serialization for "+e))},e.prototype.sizeOfValue=function(t){if(t instanceof or)return this.sizeOfRecord(t);if(t instanceof fr)return this.sizeOfData(t.size);if(t instanceof lr)return this.sizeOfText(t.value);if(t instanceof yr)return t.isUint32()?this.sizeOfUint32(t.value):t.isUint64()?this.sizeOfUint64(t.value):this.sizeOfNum(t.value);if(t instanceof mr)return this.sizeOfBool(t.value);if(t instanceof $r)return this.sizeOfSelector(t);if(t instanceof xr)return this.sizeOfOperator(t);if(t instanceof fn)return this.sizeOfFunc(t);if(t instanceof wr)return this.sizeOfExtant();if(t instanceof gr)return this.sizeOfAbsent();throw new $("No Recon serialization for "+t)},e.prototype.writeValue=function(t,e){return e instanceof or?this.writeRecord(t,e):e instanceof fr?this.writeData(t,e.asUint8Array()):e instanceof lr?this.writeText(t,e.value):e instanceof yr?e.isUint32()?this.writeUint32(t,e.value):e.isUint64()?this.writeUint64(t,e.value):this.writeNum(t,e.value):e instanceof mr?this.writeBool(t,e.value):e instanceof $r?this.writeSelector(t,e):e instanceof xr?this.writeOperator(t,e):e instanceof fn?this.writeFunc(t,e):e instanceof wr?this.writeExtant(t):e instanceof gr?this.writeAbsent(t):tt.error(new $("No Recon serialization for "+e))},e.prototype.sizeOfSelector=function(t){if(t instanceof tn)return this.sizeOfIdentitySelector();if(t instanceof hn)return this.sizeOfLiteralSelector(t.item,t.then);if(t instanceof en)return this.sizeOfGetSelector(t.item,t.then);if(t instanceof rn)return this.sizeOfGetAttrSelector(t.item,t.then);if(t instanceof nn)return this.sizeOfGetItemSelector(t.item,t.then);if(t instanceof on)return this.sizeOfKeysSelector(t.then);if(t instanceof sn)return this.sizeOfValuesSelector(t.then);if(t instanceof un)return this.sizeOfChildrenSelector(t.then);if(t instanceof an)return this.sizeOfDescendantsSelector(t.then);if(t instanceof pn)return this.sizeOfFilterSelector(t.predicate,t.then);throw new $("No Recon serialization for "+t)},e.prototype.writeSelector=function(t,e){return e instanceof tn?this.writeIdentitySelector(t):e instanceof hn?this.writeLiteralSelector(t,e.item,e.then):e instanceof en?this.writeGetSelector(t,e.item,e.then):e instanceof rn?this.writeGetAttrSelector(t,e.item,e.then):e instanceof nn?this.writeGetItemSelector(t,e.item,e.then):e instanceof on?this.writeKeysSelector(t,e.then):e instanceof sn?this.writeValuesSelector(t,e.then):e instanceof un?this.writeChildrenSelector(t,e.then):e instanceof an?this.writeDescendantsSelector(t,e.then):e instanceof pn?this.writeFilterSelector(t,e.predicate,e.then):tt.error(new $("No Recon serialization for "+e))},e.prototype.sizeOfOperator=function(t){if(t instanceof Or)return this.sizeOfInfixOperator(t.operand1,t.operator,t.operand2,t.precedence);if(t instanceof Er)return this.sizeOfPrefixOperator(t.operator,t.operand,t.precedence);if(t instanceof Zr)return this.sizeOfInvokeOperator(t.func,t.args);if(t instanceof Sr)return this.sizeOfConditionalOperator(t.ifTerm,t.thenTerm,t.elseTerm,t.precedence);throw new $("No Recon serialization for "+t)},e.prototype.writeOperator=function(t,e){return e instanceof Or?this.writeInfixOperator(t,e.operand1,e.operator,e.operand2,e.precedence):e instanceof Er?this.writePrefixOperator(t,e.operator,e.operand,e.precedence):e instanceof Zr?this.writeInvokeOperator(t,e.func,e.args):e instanceof Sr?this.writeConditionalOperator(t,e.ifTerm,e.thenTerm,e.elseTerm,e.precedence):tt.error(new $("No Recon serialization for "+e))},e.prototype.sizeOfFunc=function(t){if(t instanceof cn)return this.sizeOfLambdaFunc(t.bindings,t.template);if(t instanceof ln)return 0;throw new $("No Recon serialization for "+t)},e.prototype.writeFunc=function(t,e){return e instanceof cn?this.writeLambdaFunc(t,e.bindings,e.template):e instanceof ln?tt.end():tt.error(new $("No Recon serialization for "+e))},e.prototype.sizeOfBlockItem=function(t){if(t instanceof Je)return this.sizeOfItem(t);if(t instanceof ir)return this.sizeOfBlockValue(t);throw new $("No Recon serialization for "+t)},e.prototype.writeBlockItem=function(t,e){return e instanceof Je?this.writeItem(t,e):e instanceof ir?this.writeBlockValue(t,e):tt.error(new $("No Recon serialization for "+e))},e.prototype.sizeOfBlockValue=function(t){return t instanceof or?this.sizeOfBlock(t):this.sizeOfValue(t)},e.prototype.writeBlockValue=function(t,e){return e instanceof or?this.writeBlock(t,e):this.writeValue(t,e)},e.prototype.sizeOfThen=function(t){if(t instanceof $r){if(t instanceof tn)return this.sizeOfThenIdentitySelector();if(t instanceof hn)return this.sizeOfThenLiteralSelector(t.item,t.then);if(t instanceof en)return this.sizeOfThenGetSelector(t.item,t.then);if(t instanceof rn)return this.sizeOfThenGetAttrSelector(t.item,t.then);if(t instanceof nn)return this.sizeOfThenGetItemSelector(t.item,t.then);if(t instanceof on)return this.sizeOfThenKeysSelector(t.then);if(t instanceof sn)return this.sizeOfThenValuesSelector(t.then);if(t instanceof un)return this.sizeOfThenChildrenSelector(t.then);if(t instanceof an)return this.sizeOfThenDescendantsSelector(t.then);if(t instanceof pn)return this.sizeOfThenFilterSelector(t.predicate,t.then)}throw new $("No Recon serialization for "+t)},e.prototype.writeThen=function(t,e){if(e instanceof $r){if(e instanceof tn)return this.writeThenIdentitySelector(t);if(e instanceof hn)return this.writeThenLiteralSelector(t,e.item,e.then);if(e instanceof en)return this.writeThenGetSelector(t,e.item,e.then);if(e instanceof rn)return this.writeThenGetAttrSelector(t,e.item,e.then);if(e instanceof nn)return this.writeThenGetItemSelector(t,e.item,e.then);if(e instanceof on)return this.writeThenKeysSelector(t,e.then);if(e instanceof sn)return this.writeThenValuesSelector(t,e.then);if(e instanceof un)return this.writeThenChildrenSelector(t,e.then);if(e instanceof an)return this.writeThenDescendantsSelector(t,e.then);if(e instanceof pn)return this.writeThenFilterSelector(t,e.predicate,e.then)}return tt.error(new $("No Recon serialization for "+e))},e}(cs),ds=function(t){function e(r){var n=t.call(this,r instanceof ot?r.message:r)||this;return Object.setPrototypeOf(n,e.prototype),n.diagnostic=r instanceof ot?r:null,n}return P(e,t),e.prototype.toString=function(){return null!==this.diagnostic?this.diagnostic.toString():t.prototype.toString.call(this)},e}(Error),ys=function(){function t(t,e,r,n,i){this.scheme=t,this.authority=e,this.path=r,this.query=n,this.fragment=i,this.hashValue=void 0,this.stringValue=void 0}return t.prototype.isDefined=function(){return this.scheme.isDefined()||this.authority.isDefined()||this.path.isDefined()||this.query.isDefined()||this.fragment.isDefined()},t.prototype.isEmpty=function(){return!this.scheme.isDefined()&&!this.authority.isDefined()&&this.path.isEmpty()&&!this.query.isDefined()&&!this.fragment.isDefined()},t.prototype.withScheme=function(t){return(t=vs.fromAny(t))!==this.scheme?this.copy(t,this.authority,this.path,this.query,this.fragment):this},Object.defineProperty(t.prototype,"schemePart",{get:function(){return this.scheme.toString()},enumerable:!1,configurable:!0}),t.prototype.withSchemePart=function(t){return this.withScheme(vs.parse(t))},Object.defineProperty(t.prototype,"schemeName",{get:function(){return this.scheme.name},enumerable:!1,configurable:!0}),t.prototype.withSchemeName=function(t){return this.withScheme(vs.create(t))},t.prototype.withAuthority=function(t){return(t=ms.fromAny(t))!==this.authority?this.copy(this.scheme,t,this.path,this.query,this.fragment):this},Object.defineProperty(t.prototype,"authorityPart",{get:function(){return this.authority.toString()},enumerable:!1,configurable:!0}),t.prototype.withAuthorityPart=function(t){return this.withAuthority(ms.parse(t))},Object.defineProperty(t.prototype,"user",{get:function(){return this.authority.user},enumerable:!1,configurable:!0}),t.prototype.withUser=function(t){return this.withAuthority(this.authority.withUser(t))},Object.defineProperty(t.prototype,"userPart",{get:function(){return this.authority.userPart},enumerable:!1,configurable:!0}),t.prototype.withUserPart=function(t){return this.withAuthority(this.authority.withUserPart(t))},Object.defineProperty(t.prototype,"username",{get:function(){return this.authority.username},enumerable:!1,configurable:!0}),t.prototype.withUsername=function(t,e){return 1===arguments.length?this.withAuthority(this.authority.withUsername(t)):this.withAuthority(this.authority.withUsername(t,e))},Object.defineProperty(t.prototype,"password",{get:function(){return this.authority.password},enumerable:!1,configurable:!0}),t.prototype.withPassword=function(t){return this.withAuthority(this.authority.withPassword(t))},Object.defineProperty(t.prototype,"host",{get:function(){return this.authority.host},enumerable:!1,configurable:!0}),t.prototype.withHost=function(t){return this.withAuthority(this.authority.withHost(t))},Object.defineProperty(t.prototype,"hostPart",{get:function(){return this.authority.hostPart},enumerable:!1,configurable:!0}),t.prototype.withHostPart=function(t){return this.withAuthority(this.authority.withHostPart(t))},Object.defineProperty(t.prototype,"hostAddress",{get:function(){return this.authority.hostAddress},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostName",{get:function(){return this.authority.hostName},enumerable:!1,configurable:!0}),t.prototype.withHostName=function(t){return this.withAuthority(this.authority.withHostName(t))},Object.defineProperty(t.prototype,"hostIPv4",{get:function(){return this.authority.hostIPv4},enumerable:!1,configurable:!0}),t.prototype.withHostIPv4=function(t){return this.withAuthority(this.authority.withHostIPv4(t))},Object.defineProperty(t.prototype,"hostIPv6",{get:function(){return this.authority.hostIPv6},enumerable:!1,configurable:!0}),t.prototype.withHostIPv6=function(t){return this.withAuthority(this.authority.withHostIPv6(t))},Object.defineProperty(t.prototype,"port",{get:function(){return this.authority.port},enumerable:!1,configurable:!0}),t.prototype.withPort=function(t){return this.withAuthority(this.authority.withPort(t))},Object.defineProperty(t.prototype,"portPart",{get:function(){return this.authority.portPart},enumerable:!1,configurable:!0}),t.prototype.withPortPart=function(t){return this.withAuthority(this.authority.withPortPart(t))},Object.defineProperty(t.prototype,"portNumber",{get:function(){return this.authority.portNumber},enumerable:!1,configurable:!0}),t.prototype.withPortNumber=function(t){return this.withAuthority(this.authority.withPortNumber(t))},t.prototype.withPath=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Ps.of.apply(Ps,t);return r!==this.path?this.copy(this.scheme,this.authority,r,this.query,this.fragment):this},Object.defineProperty(t.prototype,"pathPart",{get:function(){return this.path.toString()},enumerable:!1,configurable:!0}),t.prototype.withPathPart=function(t){return this.withPath(Ps.parse(t))},Object.defineProperty(t.prototype,"pathName",{get:function(){return this.path.name},enumerable:!1,configurable:!0}),t.prototype.withPathName=function(t){return this.withPath(this.path.withName(t))},t.prototype.parentPath=function(){return this.path.parent()},t.prototype.basePath=function(){return this.path.base()},t.prototype.parent=function(){return t.create(this.scheme,this.authority,this.path.parent())},t.prototype.base=function(){return t.create(this.scheme,this.authority,this.path.base())},t.prototype.appendedPath=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this.withPath((t=this.path).appended.apply(t,e))},t.prototype.appendedSlash=function(){return this.withPath(this.path.appendedSlash())},t.prototype.appendedSegment=function(t){return this.withPath(this.path.appendedSegment(t))},t.prototype.prependedPath=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this.withPath((t=this.path).prepended.apply(t,e))},t.prototype.prependedSlash=function(){return this.withPath(this.path.prependedSlash())},t.prototype.prependedSegment=function(t){return this.withPath(this.path.prependedSegment(t))},t.prototype.withQuery=function(t){return(t=Is.fromAny(t))!==this.query?this.copy(this.scheme,this.authority,this.path,t,this.fragment):this},Object.defineProperty(t.prototype,"queryPart",{get:function(){return this.query.toString()},enumerable:!1,configurable:!0}),t.prototype.withQueryPart=function(t){return this.withQuery(Is.parse(t))},t.prototype.updatedQuery=function(t,e){return this.withQuery(this.query.updated(t,e))},t.prototype.removedQuery=function(t){return this.withQuery(this.query.removed(t))},t.prototype.appendedQuery=function(t,e){return this.withQuery(this.query.appended(t,e))},t.prototype.prependedQuery=function(t,e){return this.withQuery(this.query.prepended(t,e))},t.prototype.withFragment=function(e){return(e=qs.fromAny(e))!==this.fragment?t.create(this.scheme,this.authority,this.path,this.query,e):this},Object.defineProperty(t.prototype,"fragmentPart",{get:function(){return this.fragment.toString()},enumerable:!1,configurable:!0}),t.prototype.withFragmentPart=function(t){return this.withFragment(qs.parse(t))},Object.defineProperty(t.prototype,"fragmentIdentifier",{get:function(){return this.fragment.identifier},enumerable:!1,configurable:!0}),t.prototype.withFragmentIdentifier=function(t){return this.withFragment(qs.create(t))},t.prototype.endpoint=function(){return this.path.isDefined()||this.query.isDefined()||this.fragment.isDefined()?t.create(this.scheme,this.authority):this},t.prototype.resolve=function(e){var r=t.fromAny(e);return r.scheme.isDefined()?this.copy(r.scheme,r.authority,r.path.removeDotSegments(),r.query,r.fragment):r.authority.isDefined()?this.copy(this.scheme,r.authority,r.path.removeDotSegments(),r.query,r.fragment):r.path.isEmpty()?this.copy(this.scheme,this.authority,this.path,r.query.isDefined()?r.query:this.query,r.fragment):r.path.isAbsolute()?this.copy(this.scheme,this.authority,r.path.removeDotSegments(),r.query,r.fragment):this.copy(this.scheme,this.authority,this.merge(r.path).removeDotSegments(),r.query,r.fragment)},t.prototype.merge=function(t){return this.authority.isDefined()&&this.path.isEmpty()?t.prependedSlash():this.path.isEmpty()?t:this.path.merge(t)},t.prototype.unresolve=function(e){var r=t.fromAny(e);return this.scheme.equals(r.scheme)&&this.authority.equals(r.authority)?t.create(vs.undefined(),ms.undefined(),this.path.unmerge(r.path),r.query,r.fragment):r},t.prototype.copy=function(e,r,n,i,o){return t.create(e,r,n,i,o)},t.prototype.toAny=function(){var t={};return t.scheme=this.scheme.toAny(),this.authority.toAny(t),t.path=this.path.toAny(),t.query=this.query.toAny(),t.fragment=this.fragment.toAny(),t},t.prototype.compareTo=function(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){var t=this.hashValue;return void 0===t&&(t=w.hash(this.toString()),this.hashValue=t),t},t.prototype.debug=function(t){return t=t.write("Uri").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("empty").write(40).write(41)},t.prototype.display=function(t){var e=this.stringValue;return void 0!==e?t=t.write(e):(this.scheme.isDefined()&&(t=t.display(this.scheme).write(58)),this.authority.isDefined()&&(t=t.write(47).write(47).display(this.authority)),t=t.display(this.path),this.query.isDefined()&&(t=t.write(63).display(this.query)),this.fragment.isDefined()&&(t=t.write(35).display(this.fragment))),t},t.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=nt.display(this),this.stringValue=t),t},t.empty=function(){return new t(vs.undefined(),ms.undefined(),Ps.empty(),Is.undefined(),qs.undefined())},t.create=function(e,r,n,i,o){return void 0===e&&(e=vs.undefined()),void 0===r&&(r=ms.undefined()),void 0===n&&(n=Ps.empty()),void 0===i&&(i=Is.undefined()),void 0===o&&(o=qs.undefined()),e.isDefined()||r.isDefined()||n.isDefined()||i.isDefined()||o.isDefined()?new t(e,r,n,i,o):t.empty()},t.fromInit=function(e){var r=vs.fromAny(e.scheme),n=ms.fromAny(void 0!==e.authority?e.authority:e),i=Ps.fromAny(e.path),o=Is.fromAny(e.query),s=qs.fromAny(e.fragment);return r.isDefined()||n.isDefined()||i.isDefined()||o.isDefined()||s.isDefined()?new t(r,n,i,o,s):t.empty()},t.fromAny=function(e){if(null==e)return t.empty();if(e instanceof t)return e;if("object"==typeof e)return t.fromInit(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.scheme=function(e){return e=vs.fromAny(e),t.create(e,void 0,void 0,void 0,void 0)},t.schemePart=function(e){var r=vs.parse(e);return t.create(r,void 0,void 0,void 0,void 0)},t.schemeName=function(e){var r=vs.create(e);return t.create(r,void 0,void 0,void 0,void 0)},t.authority=function(e){return e=ms.fromAny(e),t.create(void 0,e,void 0,void 0,void 0)},t.authorityPart=function(e){var r=ms.parse(e);return t.create(void 0,r,void 0,void 0,void 0)},t.user=function(e){var r=ms.user(e);return t.create(void 0,r,void 0,void 0,void 0)},t.userPart=function(e){var r=ms.userPart(e);return t.create(void 0,r,void 0,void 0,void 0)},t.username=function(e,r){var n=ms.username(e,r);return t.create(void 0,n,void 0,void 0,void 0)},t.password=function(e){var r=ms.password(e);return t.create(void 0,r,void 0,void 0,void 0)},t.host=function(e){var r=ms.host(e);return t.create(void 0,r,void 0,void 0,void 0)},t.hostPart=function(e){var r=ms.hostPart(e);return t.create(void 0,r,void 0,void 0,void 0)},t.hostName=function(e){var r=ms.hostName(e);return t.create(void 0,r,void 0,void 0,void 0)},t.hostIPv4=function(e){var r=ms.hostIPv4(e);return t.create(void 0,r,void 0,void 0,void 0)},t.hostIPv6=function(e){var r=ms.hostIPv6(e);return t.create(void 0,r,void 0,void 0,void 0)},t.port=function(e){var r=ms.port(e);return t.create(void 0,r,void 0,void 0,void 0)},t.portPart=function(e){var r=ms.portPart(e);return t.create(void 0,r,void 0,void 0,void 0)},t.portNumber=function(e){var r=ms.portNumber(e);return t.create(void 0,r,void 0,void 0,void 0)},t.path=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=Ps.of.apply(Ps,e);return t.create(void 0,void 0,n,void 0,void 0)},t.pathPart=function(e){var r=Ps.parse(e);return t.create(void 0,void 0,r,void 0,void 0)},t.query=function(e){return e=Is.fromAny(e),t.create(void 0,void 0,void 0,e,void 0)},t.queryPart=function(e){var r=Is.parse(e);return t.create(void 0,void 0,void 0,r,void 0)},t.fragment=function(e){return e=qs.fromAny(e),t.create(void 0,void 0,void 0,void 0,e)},t.fragmentPart=function(e){var r=qs.parse(e);return t.create(void 0,void 0,void 0,void 0,r)},t.fragmentIdentifier=function(e){var r=qs.create(e);return t.create(void 0,void 0,void 0,void 0,r)},Object.defineProperty(t,"standardParser",{get:function(){return new Ns},enumerable:!1,configurable:!0}),t.parse=function(e){return t.standardParser.parseAbsoluteString(e)},t.pathBuilder=function(){return new As},t.queryBuilder=function(){return new js},t.form=function(){return new Rs(t.empty())},t.isUnreservedChar=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||45===t||46===t||95===t||126===t},t.isSubDelimChar=function(t){return 33===t||36===t||38===t||40===t||41===t||42===t||43===t||44===t||59===t||61===t||39===t},t.isSchemeChar=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||43===t||45===t||46===t},t.isUserInfoChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e},t.isUserChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)},t.isHostChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)},t.isPathChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e||64===e},t.isQueryChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e},t.isParamChar=function(e){return t.isUnreservedChar(e)||33===e||36===e||40===e||41===e||42===e||43===e||44===e||47===e||58===e||59===e||63===e||64===e||39===e},t.isFragmentChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e},t.isAlpha=function(t){return t>=65&&t<=90||t>=97&&t<=122},t.toLowerCase=function(t){return t>=65&&t<=90?t+32:t},t.writeScheme=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=n>0&&t.isSchemeChar(o)||0===n&&t.isAlpha(o)?e.write(o):Z.error(new ds("Invalid scheme: "+r))}return e},t.writeUserInfo=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isUserInfoChar(o)?e.write(o):t.writeEncoded(e,o)}return e},t.writeUser=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isUserChar(o)?e.write(o):t.writeEncoded(e,o)}return e},t.writeHost=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isHostChar(o)?e.write(o):t.writeEncoded(e,o)}return e},t.writeHostLiteral=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isHostChar(o)||58===o?e.write(o):t.writeEncoded(e,o)}return e},t.writePathSegment=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isPathChar(o)?e.write(o):t.writeEncoded(e,o)}return e},t.writeQuery=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isQueryChar(o)?e.write(o):t.writeEncoded(e,o)}return e},t.writeParam=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isParamChar(o)?e.write(o):t.writeEncoded(e,o)}return e},t.writeFragment=function(e,r){for(var n=0,i=r.length;n<i;n+=1){var o=r.charCodeAt(n);e=t.isFragmentChar(o)?e.write(o):t.writeEncoded(e,o)}return e},t.writeEncoded=function(e,r){return 0===r?(e=t.writePctEncoded(e,192),e=t.writePctEncoded(e,128)):r>=0&&r<=127?e=t.writePctEncoded(e,r):r>=128&&r<=2047?(e=t.writePctEncoded(e,192|r>>>6),e=t.writePctEncoded(e,128|63&r)):r>=2048&&r<=65535?(e=t.writePctEncoded(e,224|r>>>12),e=t.writePctEncoded(e,128|r>>>6&63),e=t.writePctEncoded(e,128|63&r)):r>=65536&&r<=1114111?(e=t.writePctEncoded(e,240|r>>>18),e=t.writePctEncoded(e,128|r>>>12&63),e=t.writePctEncoded(e,128|r>>>6&63),e=t.writePctEncoded(e,128|63&r)):(e=t.writePctEncoded(e,239),e=t.writePctEncoded(e,191),e=t.writePctEncoded(e,189)),e},t.writePctEncoded=function(t,e){var r=jt.lowercase;return t=t.write(37).write(r.encodeDigit(e>>>4&15)).write(r.encodeDigit(15&e))},S([e],t,"empty",null),S([e],t,"standardParser",null),S([e],t,"form",null),t}(),vs=function(){function t(t){this.name=t}return t.prototype.isDefined=function(){return 0!==this.name.length},t.prototype.toAny=function(){return 0!==this.name.length?this.name:void 0},t.prototype.compareTo=function(e){return e instanceof t?this.name.localeCompare(e.name):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.name===e.name},t.prototype.hashCode=function(){return w.hash(this.name)},t.prototype.debug=function(t){return t=t.write("UriScheme").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){return t=ys.writeScheme(t,this.name)},t.prototype.toString=function(){return this.name},t.undefined=function(){return new t("")},t.create=function(e){var r=t.cache,n=r.get(e);return void 0!==n?n:r.put(e,new t(e))},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return ys.standardParser.parseSchemeString(t)},Object.defineProperty(t,"cache",{get:function(){return new R(4)},enumerable:!1,configurable:!0}),S([e],t,"undefined",null),S([e],t,"cache",null),t}(),ms=function(){function t(t,e,r){this.user=t,this.host=e,this.port=r,this.hashValue=void 0,this.stringValue=void 0}return t.prototype.isDefined=function(){return this.user.isDefined()||this.host.isDefined()||this.port.isDefined()},t.prototype.withUser=function(t){return(t=ws.fromAny(t))!==this.user?this.copy(t,this.host,this.port):this},Object.defineProperty(t.prototype,"userPart",{get:function(){return this.user.toString()},enumerable:!1,configurable:!0}),t.prototype.withUserPart=function(t){return this.withUser(ws.parse(t))},Object.defineProperty(t.prototype,"username",{get:function(){return this.user.username},enumerable:!1,configurable:!0}),t.prototype.withUsername=function(t,e){return 1===arguments.length?this.withUser(this.user.withUsername(t)):this.withUser(ws.create(t,e))},Object.defineProperty(t.prototype,"password",{get:function(){return this.user.password},enumerable:!1,configurable:!0}),t.prototype.withPassword=function(t){return this.withUser(this.user.withPassword(t))},t.prototype.withHost=function(t){return(t=gs.fromAny(t))!==this.host?this.copy(this.user,t,this.port):this},Object.defineProperty(t.prototype,"hostPart",{get:function(){return this.host.toString()},enumerable:!1,configurable:!0}),t.prototype.withHostPart=function(t){return this.withHost(gs.parse(t))},Object.defineProperty(t.prototype,"hostAddress",{get:function(){return this.host.address},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostName",{get:function(){return this.host.name},enumerable:!1,configurable:!0}),t.prototype.withHostName=function(t){return this.withHost(gs.hostname(t))},Object.defineProperty(t.prototype,"hostIPv4",{get:function(){return this.host.ipv4},enumerable:!1,configurable:!0}),t.prototype.withHostIPv4=function(t){return this.withHost(gs.ipv4(t))},Object.defineProperty(t.prototype,"hostIPv6",{get:function(){return this.host.ipv6},enumerable:!1,configurable:!0}),t.prototype.withHostIPv6=function(t){return this.withHost(gs.ipv6(t))},t.prototype.withPort=function(t){return(t=Es.fromAny(t))!==this.port?this.copy(this.user,this.host,t):this},Object.defineProperty(t.prototype,"portPart",{get:function(){return this.port.toString()},enumerable:!1,configurable:!0}),t.prototype.withPortPart=function(t){return this.withPort(Es.parse(t))},Object.defineProperty(t.prototype,"portNumber",{get:function(){return this.port.number},enumerable:!1,configurable:!0}),t.prototype.withPortNumber=function(t){return this.withPort(Es.create(t))},t.prototype.copy=function(e,r,n){return t.create(e,r,n)},t.prototype.toAny=function(t){return this.isDefined()&&(void 0===t&&(t={}),this.user.toAny(t),this.host.isDefined()&&(t.host=this.host.toAny()),this.port.isDefined()&&(t.port=this.port.toAny())),t},t.prototype.compareTo=function(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){var t=this.hashValue;return void 0===t&&(t=w.hash(this.toString()),this.hashValue=t),t},t.prototype.debug=function(t){return t=t.write("UriAuthority").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){var e=this.stringValue;if(void 0!==e)t=t.write(e);else{var r=this.user;r.isDefined()&&(t=t.display(r).write(64)),t=t.display(this.host);var n=this.port;n.isDefined()&&(t=t.write(58).display(n))}return t},t.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=nt.display(this),this.stringValue=t),t},t.undefined=function(){return new t(ws.undefined(),gs.undefined(),Es.undefined())},t.create=function(e,r,n){return void 0===e&&(e=ws.undefined()),void 0===r&&(r=gs.undefined()),void 0===n&&(n=Es.undefined()),e.isDefined()||r.isDefined()||n.isDefined()?new t(e,r,n):t.undefined()},t.fromInit=function(e){var r=ws.fromAny(void 0!==e.user?e.user:e),n=gs.fromAny(e.host),i=Es.fromAny(e.port);return t.create(r,n,i)},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("object"==typeof e)return t.fromInit(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.user=function(e){return e=ws.fromAny(e),t.create(e,void 0,void 0)},t.userPart=function(e){var r=ws.parse(e);return t.create(r,void 0,void 0)},t.username=function(e,r){var n=ws.create(e,r);return t.create(n,void 0,void 0)},t.password=function(e){var r=ws.create("",e);return t.create(r,void 0,void 0)},t.host=function(e){return e=gs.fromAny(e),t.create(void 0,e,void 0)},t.hostPart=function(e){var r=gs.parse(e);return t.create(void 0,r,void 0)},t.hostName=function(e){var r=gs.hostname(e);return t.create(void 0,r,void 0)},t.hostIPv4=function(e){var r=gs.ipv4(e);return t.create(void 0,r,void 0)},t.hostIPv6=function(e){var r=gs.ipv6(e);return t.create(void 0,r,void 0)},t.port=function(e){return e=Es.fromAny(e),t.create(void 0,void 0,e)},t.portPart=function(e){var r=Es.parse(e);return t.create(void 0,void 0,r)},t.portNumber=function(e){var r=Es.create(e);return t.create(void 0,void 0,r)},t.parse=function(t){return ys.standardParser.parseAuthorityString(t)},S([e],t,"undefined",null),t}(),ws=function(){function t(t,e){this.username=t,this.password=e}return t.prototype.isDefined=function(){return void 0!==this.username},t.prototype.withUsername=function(t){return t!==this.username?this.copy(t,this.password):this},t.prototype.withPassword=function(t){return t!==this.password?this.copy(this.username,t):this},t.prototype.copy=function(e,r){return t.create(e,r)},t.prototype.toAny=function(t){return void 0!==this.username&&(void 0===t&&(t={}),t.username=this.username,void 0!==this.password&&(t.password=this.password)),t},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.username===e.username&&this.password===e.password)},t.prototype.hashCode=function(){return w.hash(this.toString())},t.prototype.debug=function(t){return t=t.write("UriUser").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){return void 0!==this.username&&(t=ys.writeUser(t,this.username),void 0!==this.password&&(t=t.write(58),t=ys.writeUser(t,this.password))),t},t.prototype.toString=function(){return nt.display(this)},t.undefined=function(){return new t(void 0,void 0)},t.create=function(e,r){return void 0!==e||void 0!==r?new t(e,r):t.undefined()},t.fromInit=function(e){return t.create(e.username,e.password)},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("object"==typeof e)return t.fromInit(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return ys.standardParser.parseUserString(t)},S([e],t,"undefined",null),t}(),gs=function(){function t(){}return t.prototype.isDefined=function(){return!0},Object.defineProperty(t.prototype,"name",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ipv4",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ipv6",{get:function(){},enumerable:!1,configurable:!0}),t.prototype.toAny=function(){return this.toString()},t.prototype.compareTo=function(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return w.hash(this.toString())},t.undefined=function(){return new Cs},t.hostname=function(e){var r=t.cache,n=r.get(e);return n instanceof bs?n:r.put(e,new bs(e))},t.ipv4=function(e){var r=t.cache,n=r.get(e);return n instanceof xs?n:r.put(e,new xs(e))},t.ipv6=function(e){var r=t.cache,n=r.get(e);return n instanceof Os?n:r.put(e,new Os(e))},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return ys.standardParser.parseHostString(t)},Object.defineProperty(t,"cache",{get:function(){return new R(16)},enumerable:!1,configurable:!0}),S([e],t,"undefined",null),S([e],t,"cache",null),t}(),bs=function(t){function e(e){var r=t.call(this)||this;return r.address=e,r}return P(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this.address},enumerable:!1,configurable:!0}),e.prototype.debug=function(t){return t=t.write("UriHost").write(46).write("hostname").write(40).debug(this.address).write(41)},e.prototype.display=function(t){return t=ys.writeHost(t,this.address)},e.prototype.toString=function(){return this.address},e}(gs),xs=function(t){function e(e){var r=t.call(this)||this;return r.address=e,r}return P(e,t),Object.defineProperty(e.prototype,"ipv4",{get:function(){return this.address},enumerable:!1,configurable:!0}),e.prototype.debug=function(t){return t=t.write("UriHost").write(46).write("ipv4").write(40).debug(this.address).write(41)},e.prototype.display=function(t){return t=ys.writeHost(t,this.address)},e.prototype.toString=function(){return this.address},e}(gs),Os=function(t){function e(e){var r=t.call(this)||this;return r.address=e,r}return P(e,t),Object.defineProperty(e.prototype,"ipv6",{get:function(){return this.address},enumerable:!1,configurable:!0}),e.prototype.debug=function(t){return t=t.write("UriHost").write(46).write("ipv6").write(40).debug(this.address).write(41)},e.prototype.display=function(t){return t=t.write(91),t=(t=ys.writeHostLiteral(t,this.address)).write(93)},e.prototype.toString=function(){return"["+this.address+"]"},e}(gs),Cs=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.isDefined=function(){return!1},Object.defineProperty(e.prototype,"address",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.debug=function(t){return t=t.write("UriHost").write(46).write("undefined").write(40).write(41)},e.prototype.display=function(t){return t},e.prototype.toString=function(){return""},e}(gs),Es=function(){function t(t){this.number=t}return t.prototype.isDefined=function(){return 0!==this.number},t.prototype.valueOf=function(){return this.number},t.prototype.toAny=function(){return this.number},t.prototype.compareTo=function(e){return e instanceof t?this.number<e.number?-1:this.number>e.number?1:0:NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.number===e.number},t.prototype.hashCode=function(){return w.hash(this.toString())},t.prototype.debug=function(t){return t=t.write("UriPort").write(46),this.isDefined()?(t=t.write("create").write(40),t=nt.displayNumber(t,this.number)):t=t.write("undefined").write(40),t=t.write(41)},t.prototype.display=function(t){return t=nt.displayNumber(t,this.number)},t.prototype.toString=function(){return""+this.number},t.undefined=function(){return new t(0)},t.create=function(e){if(0===e)return t.undefined();if(e>0){var r=t.cache,n=r.get(e);return void 0!==n?n:r.put(e,new t(e))}throw new TypeError(""+e)},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("number"==typeof e)return t.create(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return ys.standardParser.parsePortString(t)},Object.defineProperty(t,"cache",{get:function(){return new R(16)},enumerable:!1,configurable:!0}),S([e],t,"undefined",null),S([e],t,"cache",null),t}(),Ps=function(){function t(){}return Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=this;!e.isEmpty();)t+=1,e=e.tail();return t},enumerable:!1,configurable:!0}),t.prototype.get=function(t){for(var e=0,r=this;!r.isEmpty();){if(!(e<t))return r.head();e+=1,r=r.tail()}},Object.defineProperty(t.prototype,"name",{get:function(){if(this.isEmpty())return"";for(var t=this;;){var e=t.tail();if(e.isEmpty())return t.isRelative()?t.head():"";t=e}},enumerable:!1,configurable:!0}),t.prototype.withName=function(t){var e=new As;return e.addPath(this.base()),e.addSegment(t),e.bind()},t.prototype.foot=function(){if(this.isEmpty())return this;for(var t=this;;){var e=t.tail();if(e.isEmpty())return t;t=e}},t.prototype.isSubpathOf=function(e){e=t.fromAny(e);for(var r=this;!r.isEmpty()&&!e.isEmpty();){if(r.head()!==e.head())return!1;r=r.tail(),e=e.tail()}return e.isEmpty()},t.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(arguments.length>0){var r=new As;return r.addPath(this),r.push.apply(r,t),r.bind()}return this},t.prototype.appendedSlash=function(){var t=new As;return t.addPath(this),t.addSlash(),t.bind()},t.prototype.appendedSegment=function(t){var e=new As;return e.addPath(this),e.addSegment(t),e.bind()},t.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(arguments.length>0){var r=new As;return r.push.apply(r,t),r.addPath(this),r.bind()}return this},t.prototype.prependedSlash=function(){return new ks(this)},t.prototype.prependedSegment=function(e){return this.isEmpty()||this.isAbsolute()?t.segment(e,this):t.segment(e,this.prependedSlash())},t.prototype.resolve=function(t){return t.isEmpty()?this:t.isAbsolute()||this.isEmpty()?t.removeDotSegments():this.merge(t).removeDotSegments()},t.prototype.removeDotSegments=function(){for(var e=this,r=new As;!e.isEmpty();){var n=e.head();if("."===n||".."===n)(e=e.tail()).isEmpty()||(e=e.tail());else if(e.isAbsolute()){var i=e.tail();if(i.isEmpty())r.push(e.head()),e=e.tail();else{var o=i.head();"."===o?(e=i.tail()).isEmpty()&&(e=t.slash()):".."===o?((e=i.tail()).isEmpty()&&(e=t.slash()),r.isEmpty()||r.pop().isAbsolute()||r.isEmpty()||r.pop()):(r.push(n,o),e=i.tail())}}else r.push(e.head()),e=e.tail()}return r.bind()},t.prototype.merge=function(t){if(this.isEmpty())return t;for(var e=new As,r=this;;){var n=r.tail();if(n.isEmpty()){r.isAbsolute()&&e.addSlash();break}r.isAbsolute()?e.addSlash():e.addSegment(r.head()),r=n}return e.addPath(t),e.bind()},t.prototype.unmerge=function(e,r){void 0===r&&(r=e);for(var n=this;;){if(n.isEmpty())return e.isEmpty()||e.tail().isEmpty()?e:e.tail();if(n.isRelative())return e;if(e.isRelative())return e.prependedSlash();var i=n.tail(),o=e.tail();if(!i.isEmpty()&&o.isEmpty())return t.slash();if(i.isEmpty()||o.isEmpty()||i.head()!==o.head())return o;if(i=i.tail(),o=o.tail(),!i.isEmpty()&&o.isEmpty())return r;n=i,e=o}},t.prototype.toAny=function(){for(var t=[],e=this;!e.isEmpty();)t.push(e.head()),e=e.tail();return t},t.prototype.compareTo=function(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return w.hash(this.toString())},t.prototype.display=function(t){for(var e=this;!e.isEmpty();)t=e.isAbsolute()?t.write(47):ys.writePathSegment(t,e.head()),e=e.tail();return t},t.empty=function(){return new Ms},t.slash=function(){return new ks(t.empty())},t.segment=function(e,r){return void 0===r&&(r=t.empty()),e=this.cacheSegment(e),new Ss(e,r)},t.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=new As;return r.push.apply(r,t),r.bind()},t.fromAny=function(e){if(null==e)return t.empty();if(e instanceof t)return e;if(Array.isArray(e))return t.of.apply(t,e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return ys.standardParser.parsePathString(t)},t.builder=function(){return new As},t.pathForm=function(){return new Ds(t.empty())},Object.defineProperty(t,"segmentCache",{get:function(){return new N(64)},enumerable:!1,configurable:!0}),t.cacheSegment=function(t){return t.length<=32?this.segmentCache.put(t):t},S([e],t,"empty",null),S([e],t,"slash",null),S([e],t,"pathForm",null),S([e],t,"segmentCache",null),t}(),Ss=function(t){function e(e,r){var n=t.call(this)||this;return n.segment=e,n.rest=r,n.stringValue=void 0,n}return P(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isAbsolute=function(){return!1},e.prototype.isRelative=function(){return!0},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return this.segment},e.prototype.tail=function(){return this.rest},e.prototype.setTail=function(t){if(t instanceof e)throw new Error("adjacent path segments");this.rest=t},e.prototype.dealias=function(){return new e(this.segment,this.rest)},e.prototype.parent=function(){var t=this.rest;return t.isEmpty()||t.tail().isEmpty()?Ps.empty():new e(this.segment,t.parent())},e.prototype.base=function(){var t=this.rest;return t.isEmpty()?Ps.empty():new e(this.segment,t.base())},e.prototype.prependedSegment=function(t){return Ps.segment(t,this.prependedSlash())},e.prototype.debug=function(t){return t=t.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},e.prototype.display=function(e){var r=this.stringValue;return e=void 0!==r?e.write(r):t.prototype.display.call(this,e)},e.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=nt.display(this),this.stringValue=t),t},e}(Ps),ks=function(t){function e(e){var r=t.call(this)||this;return r.rest=e,r.stringValue=void 0,r}return P(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isAbsolute=function(){return!0},e.prototype.isRelative=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return"/"},e.prototype.tail=function(){return this.rest},e.prototype.setTail=function(t){this.rest=t},e.prototype.dealias=function(){return new e(this.rest)},e.prototype.parent=function(){var t=this.rest;return t.isEmpty()?Ps.empty():t.tail().isEmpty()?Ps.slash():new e(t.parent())},e.prototype.base=function(){var t=this.rest;return t.isEmpty()?this:new e(t.base())},e.prototype.prependedSegment=function(t){return Ps.segment(t,this)},e.prototype.debug=function(t){return t=t.write("UriPath").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},e.prototype.display=function(e){var r=this.stringValue;return e=void 0!==r?e.write(r):t.prototype.display.call(this,e)},e.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=nt.display(this),this.stringValue=t),t},e}(Ps),Ms=function(t){function e(){return t.call(this)||this}return P(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isAbsolute=function(){return!1},e.prototype.isRelative=function(){return!0},e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){throw new Error("empty path")},e.prototype.tail=function(){throw new Error("empty path")},e.prototype.setTail=function(t){throw new Error("empty path")},e.prototype.dealias=function(){return this},e.prototype.parent=function(){return this},e.prototype.base=function(){return this},e.prototype.appended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ps.of.apply(Ps,t)},e.prototype.appendedSlash=function(){return Ps.slash()},e.prototype.appendedSegment=function(t){return Ps.segment(t)},e.prototype.prepended=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ps.of.apply(Ps,t)},e.prototype.prependedSlash=function(){return Ps.slash()},e.prototype.prependedSegment=function(t){return Ps.segment(t)},e.prototype.merge=function(t){return t},e.prototype.debug=function(t){return t=t.write("UriPath").write(46).write("empty").write(40).write(41)},e.prototype.display=function(t){return t},e.prototype.toString=function(){return""},e}(Ps),As=function(){function t(){this.first=Ps.empty(),this.last=null,this.size=0,this.aliased=0}return t.prototype.isEmpty=function(){return 0===this.size},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r+=1){var n=t[r];n instanceof Ps?this.addPath(n):Array.isArray(n)?this.push.apply(this,n):"/"===n?this.addSlash():this.addSegment(n)}},t.prototype.bind=function(){return this.aliased=0,this.first},t.prototype.addSlash=function(){var t=Ps.slash().dealias(),e=this.size;0===e?this.first=t:this.dealias(e-1).setTail(t),this.last=t,this.size=e+1,this.aliased+=1},t.prototype.addSegment=function(t){var e=Ps.segment(t,Ps.empty()),r=this.size;if(0===r)this.first=e;else{var n=this.dealias(r-1);n.isAbsolute()?n.setTail(e):(n.setTail(e.prependedSlash()),r+=1,this.aliased+=1)}this.last=e,this.size=r+1,this.aliased+=1},t.prototype.addPath=function(t){if(!t.isEmpty()){var e=this.size;if(0===e)this.first=t;else{var r=this.dealias(e-1);r.isAbsolute()||t.isAbsolute()?r.setTail(t):(r.setTail(t.prependedSlash()),e+=1,this.aliased+=1)}for(e+=1;;){var n=t.tail();if(n.isEmpty())break;t=n,e+=1}this.last=t,this.size=e}},t.prototype.pop=function(){var t=this.size,e=this.aliased;if(0===t)throw new Error("Empty UriPath");if(1===t){var r=this.first;return this.first=r.tail(),r.tail().isEmpty()&&(this.last=null),this.size=t-1,e>0&&(this.aliased=e-1),r}var n=this.dealias(t-2);return n.setTail(Ps.empty()),this.last=n,this.size=t-1,this.aliased=e-1,n.tail()},t.prototype.dealias=function(t){var e=0,r=null,n=this.first;if(this.aliased<=t){for(;e<this.aliased;)r=n,n=n.tail(),e+=1;for(;e<=t;){var i=n.dealias();0===e?this.first=i:r.setTail(i),r=i,n=n.tail(),e+=1}e===this.size&&(this.last=r),this.aliased=e}else if(0===t)r=this.first;else if(t===this.size-1)r=this.last;else for(;e<=t;)r=n,n=n.tail(),e+=1;return r},t}(),Ds=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return t=Ps.fromAny(t),void 0===e?lr.from(t.toString()):e.concat(lr.from(t.toString()))},e.prototype.cast=function(t,e){var r=t.target;try{var n=r.stringValue();if("string"==typeof n)return Ps.parse(n)}catch(t){}},e}(Sn),Is=function(){function t(){}return Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=this;!e.isEmpty();)t+=1,e=e.tail();return t},enumerable:!1,configurable:!0}),t.prototype.has=function(t){for(var e=this;!e.isEmpty();){if(t===e.key)return!0;e=e.tail()}return!1},t.prototype.get=function(t){for(var e=this;!e.isEmpty();){if(t===e.key)return e.value;e=e.tail()}},t.prototype.updated=function(t,e){for(var r=this,n=new js,i=!1;!r.isEmpty();)t===r.key?(n.addParam(t,e),i=!0):n.addParam(r.key,r.value),r=r.tail();return i||n.addParam(t,e),n.bind()},t.prototype.removed=function(t){for(var e=this,r=new js,n=!1;!e.isEmpty();)t===e.key?n=!0:r.addParam(e.key,e.value),e=e.tail();return n?r.bind():this},t.prototype.appended=function(t,e){var r=new js;return r.addQuery(this),r.add(t,e),r.bind()},t.prototype.prepended=function(t,e){var r=new js;return r.add(t,e),r.addQuery(this),r.bind()},t.prototype.toAny=function(t){if(this.isDefined()){t=t||{};for(var e=this,r=0;!e.isEmpty();){var n=e.key;void 0!==n?t[n]=e.value:t["$"+r]=e.value,e=e.tail(),r+=1}}return t},t.prototype.compareTo=function(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.toString()===e.toString()},t.prototype.hashCode=function(){return w.hash(this.toString())},t.prototype.display=function(t){for(var e=this,r=!0;!e.isEmpty();){r?r=!1:t=t.write(38);var n=e.key;void 0!==n&&(t=(t=ys.writeParam(t,n)).write(61)),t=ys.writeQuery(t,e.value),e=e.tail()}return t},t.undefined=function(){return new Vs},t.param=function(e,r,n){return void 0===n?(n=r,r=e,e=void 0):void 0!==e&&(e=this.cacheKey(e)),void 0===n&&(n=t.undefined()),new Ts(e,r,n)},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("object"==typeof e){var r=new js;return r.add(e),r.bind()}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return ys.standardParser.parseQueryString(t)},t.builder=function(){return new js},Object.defineProperty(t,"keyCache",{get:function(){return new N(64)},enumerable:!1,configurable:!0}),t.cacheKey=function(e){return e.length<=32?t.keyCache.put(e):e},S([e],t,"undefined",null),S([e],t,"keyCache",null),t}(),Ts=function(t){function e(e,r,n){var i=t.call(this)||this;return i.key=e,i.value=r,i.rest=n,i.stringValue=void 0,i}return P(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return[this.key,this.value]},e.prototype.tail=function(){return this.rest},e.prototype.setTail=function(t){this.rest=t},e.prototype.dealias=function(){return new e(this.key,this.value,this.rest)},e.prototype.debug=function(t){return t=t.write("UriQuery").write(46).write("parse").write(40).write(34).display(this).write(34).write(41)},e.prototype.display=function(e){var r=this.stringValue;return e=void 0!==r?e.write(r):t.prototype.display.call(this,e)},e.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=nt.display(this),this.stringValue=t),t},e}(Is),Vs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){throw new Error("undefined query")},Object.defineProperty(e.prototype,"key",{get:function(){throw new Error("undefined query")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw new Error("undefined query")},enumerable:!1,configurable:!0}),e.prototype.tail=function(){throw new Error("undefined query")},e.prototype.setTail=function(t){throw new Error("undefined query")},e.prototype.dealias=function(){return this},e.prototype.updated=function(t,e){return Is.param(t,e,this)},e.prototype.removed=function(t){return this},e.prototype.appended=function(t,e){var r=new js;return r.add(t,e),r.bind()},e.prototype.prepended=function(t,e){var r=new js;return r.add(t,e),r.bind()},e.prototype.debug=function(t){return t=t.write("UriQuery").write(46).write("undefined").write(40).write(41)},e.prototype.display=function(t){return t},e.prototype.toString=function(){return""},e}(Is),js=function(){function t(){this.first=Is.undefined(),this.last=null,this.size=0,this.aliased=0}return t.prototype.isEmpty=function(){return 0===this.size},t.prototype.add=function(t,e){if(void 0!==e)this.addParam(t,e);else if("string"==typeof t)this.addParam(void 0,t);else if(t instanceof Is)this.addQuery(t);else{var r=t;for(var n in r){var i=n,o=r[n];36===n.charCodeAt(0)&&(i=void 0),this.addParam(i,o)}}},t.prototype.bind=function(){return this.aliased=0,this.first},t.prototype.addParam=function(t,e){void 0===e&&(e=t,t=void 0);var r=Is.param(t,e,Is.undefined()),n=this.size;0===n?this.first=r:this.dealias(n-1).setTail(r),this.last=r,this.size=n+1,this.aliased+=1},t.prototype.addQuery=function(t){if(!t.isEmpty()){var e=this.size;for(0===e?this.first=t:this.dealias(e-1).setTail(t),e+=1;;){var r=t.tail();if(r.isEmpty())break;t=r,e+=1}this.last=t,this.size=e}},t.prototype.dealias=function(t){var e=0,r=null,n=this.first;if(this.aliased<=t){for(;e<this.aliased;)r=n,n=n.tail(),e+=1;for(;e<=t;){var i=n.dealias();0===e?this.first=i:r.setTail(i),r=i,n=n.tail(),e+=1}e===this.size&&(this.last=r),this.aliased=e}else if(0===t)r=this.first;else if(t===this.size-1)r=this.last;else for(;e<=t;)r=n,n=n.tail(),e+=1;return r},t}(),qs=function(){function t(t){this.identifier=t,this.stringValue=void 0}return t.prototype.isDefined=function(){return void 0!==this.identifier},t.prototype.toAny=function(){return this.identifier},t.prototype.compareTo=function(e){return e instanceof t?this.toString().localeCompare(e.toString()):NaN},t.prototype.equals=function(e){return this===e||e instanceof t&&this.identifier===e.identifier},t.prototype.hashCode=function(){return w.hash(this.identifier)},t.prototype.debug=function(t){return t=t.write("UriFragment").write(46),t=this.isDefined()?t.write("parse").write(40).write(34).display(this).write(34).write(41):t.write("undefined").write(40).write(41)},t.prototype.display=function(t){var e=this.stringValue;return void 0!==e?t=t.write(e):void 0!==this.identifier&&(t=ys.writeFragment(t,this.identifier)),t},t.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=nt.display(this),this.stringValue=t),t},t.undefined=function(){return new t(void 0)},t.create=function(e){if(void 0!==e){var r=t.cache,n=r.get(e);return void 0!==n?n:r.put(e,new t(e))}return t.undefined()},t.fromAny=function(e){if(null==e)return t.undefined();if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.parse=function(t){return ys.standardParser.parseFragmentString(t)},Object.defineProperty(t,"cache",{get:function(){return new R(32)},enumerable:!1,configurable:!0}),S([e],t,"undefined",null),S([e],t,"cache",null),t}(),Rs=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t,e){return t=ys.fromAny(t),void 0===e?lr.from(t.toString()):e.concat(lr.from(t.toString()))},e.prototype.cast=function(t,e){var r=t.target;try{var n=r.stringValue();if("string"==typeof n)return ys.parse(n)}catch(t){}},e}(Sn),Us=function(){function t(t,e){void 0===e&&(e=32),this.base=t,this.resolveCache=new R(e),this.unresolveCache=new R(e)}return t.prototype.resolve=function(t){t=ys.fromAny(t);var e=this.resolveCache.get(t);return void 0===e&&(e=this.base.resolve(t),this.resolveCache.put(t,e)),e},t.prototype.unresolve=function(t){t=ys.fromAny(t);var e=this.unresolveCache.get(t);return void 0===e&&(e=this.base.unresolve(t),this.unresolveCache.put(t,e)),e},t}(),Ns=function(){function t(){}return t.prototype.absolute=function(t,e,r,n,i){return ys.create(t,e,r,n,i)},t.prototype.scheme=function(t){return vs.create(t)},t.prototype.authority=function(t,e,r){return ms.create(t,e,r)},t.prototype.user=function(t,e){return ws.create(t,e)},t.prototype.hostName=function(t){return gs.hostname(t)},t.prototype.hostIPv4=function(t){return gs.ipv4(t)},t.prototype.hostIPv6=function(t){return gs.ipv6(t)},t.prototype.port=function(t){return Es.create(t)},t.prototype.pathEmpty=function(){return Ps.empty()},t.prototype.pathBuilder=function(){return new As},t.prototype.queryBuilder=function(){return new js},t.prototype.fragment=function(t){return qs.create(t)},t.prototype.absoluteParser=function(){return new zs(this)},t.prototype.parseAbsolute=function(t){return zs.parse(t,this)},t.prototype.parseAbsoluteString=function(t){var e=rt.stringInput(t),r=this.parseAbsolute(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.schemeParser=function(){return new Fs(this)},t.prototype.parseScheme=function(t){return Fs.parse(t,this)},t.prototype.parseSchemeString=function(t){var e=rt.stringInput(t),r=this.parseScheme(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.authorityParser=function(){return new Ls(this)},t.prototype.parseAuthority=function(t){return Ls.parse(t,this)},t.prototype.parseAuthorityString=function(t){var e=rt.stringInput(t),r=this.parseAuthority(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.userParser=function(){return new Ks(this)},t.prototype.parseUser=function(t){return Ks.parse(t,this)},t.prototype.parseUserString=function(t){var e=rt.stringInput(t),r=this.parseUser(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.hostParser=function(){return new Bs(this)},t.prototype.parseHost=function(t){return Bs.parse(t,this)},t.prototype.parseHostString=function(t){var e=rt.stringInput(t),r=this.parseHost(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.hostAddressParser=function(){return new Ws(this)},t.prototype.parseHostAddress=function(t){return Ws.parse(t,this)},t.prototype.hostLiteralParser=function(){return new Hs(this)},t.prototype.parseHostLiteral=function(t){return Hs.parse(t,this)},t.prototype.portParser=function(){return new Xs(this)},t.prototype.parsePort=function(t){return Xs.parse(t,this)},t.prototype.parsePortString=function(t){var e=rt.stringInput(t),r=this.parsePort(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.pathParser=function(t){return new Ys(this,t)},t.prototype.parsePath=function(t,e){return Ys.parse(t,this,e)},t.prototype.parsePathString=function(t){var e=rt.stringInput(t),r=this.parsePath(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.queryParser=function(t){return new Gs(this,t)},t.prototype.parseQuery=function(t,e){return Gs.parse(t,this,e)},t.prototype.parseQueryString=function(t){var e=rt.stringInput(t),r=this.parseQuery(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.prototype.fragmentParser=function(){return new _s(this)},t.prototype.parseFragment=function(t){return _s.parse(t,this)},t.prototype.parseFragmentString=function(t){var e=rt.stringInput(t),r=this.parseFragment(e);return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t}(),zs=function(t){function e(e,r,n,i,o,s,u){var a=t.call(this)||this;return a.uri=e,a.schemeParser=r,a.authorityParser=n,a.pathParser=i,a.queryParser=o,a.fragmentParser=s,a.step=u,a}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.schemeParser,this.authorityParser,this.pathParser,this.queryParser,this.fragmentParser,this.step)},e.parse=function(t,r,n,i,o,s,u,a){void 0===a&&(a=1);var p=0;if(1===a)if(t.isCont()){for(var h=t.clone();h.isCont()&&(p=h.head(),ys.isSchemeChar(p));)h.step();a=h.isCont()&&58===p?2:3}else t.isDone()&&(a=3);if(2===a)if((n=void 0===n?r.parseScheme(t):n.feed(t)).isDone()){if(t.isCont()&&58===t.head())t=t.step(),a=3;else if(!t.isEmpty())return bt.error(ot.expected(58,t))}else if(n.isError())return n.asError();if(3===a)if(t.isCont())47===(p=t.head())?(t=t.step(),a=4):63===p?(t=t.step(),a=7):35===p?(t=t.step(),a=8):a=6;else if(t.isDone())return bt.done(r.absolute(void 0!==n?n.bind():void 0));if(4===a)if(t.isCont()&&47===t.head())t=t.step(),a=5;else if(t.isCont()){var f=r.pathBuilder();f.addSlash(),o=r.parsePath(t,f),a=6}else if(t.isDone())return bt.done(r.absolute(void 0!==n?n.bind():void 0,void 0,Ps.slash()));if(5===a)if((i=void 0===i?r.parseAuthority(t):i.feed(t)).isDone()){if(t.isCont())63===(p=t.head())?(t=t.step(),a=7):35===p?(t=t.step(),a=8):a=6;else if(t.isDone())return bt.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0))}else if(i.isError())return i.asError();if(6===a)if((o=void 0===o?r.parsePath(t):o.feed(t)).isDone()){if(t.isCont()&&63===t.head())t=t.step(),a=7;else if(t.isCont()&&35===t.head())t=t.step(),a=8;else if(!t.isEmpty())return bt.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0,o.bind()))}else if(o.isError())return o.asError();if(7===a)if((s=void 0===s?r.parseQuery(t):s.feed(t)).isDone()){if(t.isCont()&&35===t.head())t=t.step(),a=8;else if(!t.isEmpty())return bt.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0,void 0!==o?o.bind():void 0,s.bind()))}else if(s.isError())return s.asError();if(8===a){if((u=void 0===u?r.parseFragment(t):u.feed(t)).isDone())return bt.done(r.absolute(void 0!==n?n.bind():void 0,void 0!==i?i.bind():void 0,void 0!==o?o.bind():void 0,void 0!==s?s.bind():void 0,u.bind()));if(u.isError())return u.asError()}return new e(r,n,i,o,s,u,a)},e}(bt),Fs=function(t){function e(e,r,n){var i=t.call(this)||this;return i.uri=e,i.output=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.step)},e.parse=function(t,r,n,i){void 0===i&&(i=1);var o=0;if(1===i)if(t.isCont()&&(o=t.head(),ys.isAlpha(o)))t=t.step(),n=(n=n||Ut.decodedString()).write(ys.toLowerCase(o)),i=2;else if(!t.isEmpty())return bt.error(ot.expected("scheme",t));if(2===i){for(;t.isCont()&&(o=t.head(),ys.isSchemeChar(o));)t=t.step(),n.write(ys.toLowerCase(o));if(!t.isEmpty())return bt.done(r.scheme(n.bind()))}return new e(r,n,i)},e}(bt),Ls=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.uri=e,s.userParser=r,s.hostParser=n,s.portParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.userParser,this.hostParser,this.portParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s)if(t.isCont()){for(var a=t.clone();a.isCont()&&(64!==(u=a.head())&&47!==u);)a.step();s=a.isCont()&&64===u?2:3}else t.isDone()&&(s=3);if(2===s)if((n=void 0===n?r.parseUser(t):n.feed(t)).isDone()){if(t.isCont()&&64===t.head())t=t.step(),s=3;else if(!t.isEmpty())return bt.error(ot.expected(64,t))}else if(n.isError())return n.asError();if(3===s)if((i=void 0===i?r.parseHost(t):i.feed(t)).isDone()){if(t.isCont()&&58===t.head())t=t.step(),s=4;else if(!t.isEmpty())return bt.done(r.authority(void 0!==n?n.bind():void 0,i.bind()))}else if(i.isError())return i.asError();if(4===s){if((o=void 0===o?r.parsePort(t):o.feed(t)).isDone())return bt.done(r.authority(void 0!==n?n.bind():void 0,i.bind(),o.bind()));if(o.isError())return o.asError()}return new e(r,n,i,o,s)},e}(bt),Ks=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.uri=e,s.usernameOutput=r,s.passwordOutput=n,s.c1=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.usernameOutput,this.passwordOutput,this.c1,this.step)},e.parse=function(t,r,n,i,o,s){void 0===o&&(o=0),void 0===s&&(s=1);for(var u=0;;){if(1===s){for(n=n||Ut.decodedString();t.isCont()&&(u=t.head(),ys.isUserChar(u));)t=t.step(),n.write(u);if(t.isCont()&&58===u)t=t.step(),s=4;else if(t.isCont()&&37===u)t=t.step(),s=2;else if(!t.isEmpty())return bt.done(r.user(n.bind()))}if(2===s)if(t.isCont()&&(u=t.head(),jt.isDigit(u)))t=t.step(),o=u,s=3;else if(!t.isEmpty())return bt.error(ot.expected("hex digit",t));if(3===s){if(t.isCont()&&(u=t.head(),jt.isDigit(u))){t=t.step(),n.write(jt.decodeDigit(o)<<4|jt.decodeDigit(u)),o=0,s=1;continue}if(!t.isEmpty())return bt.error(ot.expected("hex digit",t))}if(4===s){for(i=i||Ut.decodedString();t.isCont()&&(u=t.head(),ys.isUserInfoChar(u));)t=t.step(),i.write(u);if(t.isCont()&&37===u)t=t.step(),s=5;else if(!t.isEmpty())return bt.done(r.user(n.bind(),i.bind()))}if(5===s)if(t.isCont()&&(u=t.head(),jt.isDigit(u)))t=t.step(),o=u,s=6;else if(!t.isEmpty())return bt.error(ot.expected("hex digit",t));if(6===s){if(t.isCont()&&(u=t.head(),jt.isDigit(u))){t=t.step(),i.write(jt.decodeDigit(o)<<4|jt.decodeDigit(u)),o=0,s=4;continue}if(!t.isEmpty())return bt.error(ot.expected("hex digit",t))}break}return new e(r,n,i,o,s)},e}(bt),Bs=function(t){function e(e){var r=t.call(this)||this;return r.uri=e,r}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri)},e.parse=function(t,r){return t.isCont()?91===t.head()?r.parseHostLiteral(t):r.parseHostAddress(t):t.isDone()?bt.done(r.hostName("")):new e(r)},e}(bt),Ws=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.uri=e,s.output=r,s.c1=n,s.x=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.c1,this.x,this.step)},e.parse=function(t,r,n,i,o,s){void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=1);var u=0;for(n=n||Ut.decodedString();s<=4;){for(;t.isCont()&&(u=t.head(),it.isDigit(u));)t=t.step(),n=n.write(u),o=10*o+it.decodeDigit(u);if(!t.isCont()){if(t.isEmpty())break;return 4===s&&o<=255?bt.done(r.hostIPv4(n.bind())):bt.done(r.hostName(n.bind()))}if(!(46===u&&s<4&&o<=255)){if(!ys.isHostChar(u)&&37!==u&&4===s&&o<=255)return bt.done(r.hostIPv4(n.bind()));o=0,s=5;break}t=t.step(),n=n.write(u),o=0,s+=1}for(;;){if(5===s){for(;t.isCont()&&(u=t.head(),ys.isHostChar(u));)t=t.step(),n.write(ys.toLowerCase(u));if(t.isCont()&&37===u)t=t.step(),s=6;else if(!t.isEmpty())return bt.done(r.hostName(n.bind()))}if(6===s)if(t.isCont()&&(u=t.head(),jt.isDigit(u)))t=t.step(),i=u,s=7;else if(!t.isEmpty())return bt.error(ot.expected("hex digit",t));if(7===s){if(t.isCont()&&(u=t.head(),jt.isDigit(u))){t=t.step(),n.write(jt.decodeDigit(i)<<4|jt.decodeDigit(u)),i=0,s=5;continue}if(!t.isEmpty())return bt.error(ot.expected("hex digit",t))}break}return new e(r,n,i,o,s)},e}(bt),Hs=function(t){function e(e,r,n){var i=t.call(this)||this;return i.uri=e,i.output=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.step)},e.parse=function(t,r,n,i){void 0===i&&(i=1);var o=0;if(1===i)if(t.isCont()&&91===t.head())t=t.step(),i=2;else if(!t.isEmpty())return bt.error(ot.expected(91,t));if(2===i){for(n=n||Ut.decodedString();t.isCont()&&(o=t.head(),ys.isHostChar(o)||58===o);)t=t.step(),n=n.write(ys.toLowerCase(o));if(t.isCont()&&93===o)return t=t.step(),bt.done(r.hostIPv6(n.bind()));if(!t.isEmpty())return bt.error(ot.expected(93,t))}return new e(r,n,i)},e}(bt),Xs=function(t){function e(e,r){var n=t.call(this)||this;return n.uri=e,n.number=r,n}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.number)},e.parse=function(t,r,n){void 0===n&&(n=0);for(var i=0;t.isCont()&&(i=t.head(),it.isDigit(i));)t=t.step(),n=10*n+it.decodeDigit(i);return t.isEmpty()?new e(r,n):bt.done(r.port(n))},e}(bt),Ys=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.uri=e,s.builder=r,s.output=n,s.c1=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.builder,this.output,this.c1,this.step)},e.parse=function(t,r,n,i,o,s){void 0===o&&(o=0),void 0===s&&(s=1);for(var u=0;;){if(1===s){for(;t.isCont()&&(u=t.head(),ys.isPathChar(u));)i=i||Ut.decodedString(),t=t.step(),i=i.write(u);if(t.isCont()&&47===u){t=t.step(),n=n||r.pathBuilder(),void 0!==i&&(n.addSegment(i.bind()),i=void 0),n.addSlash();continue}if(t.isCont()&&37===u)t=t.step(),s=2;else if(!t.isEmpty())return void 0!==i&&(n=n||r.pathBuilder()).addSegment(i.bind()),void 0!==n?bt.done(n.bind()):bt.done(r.pathEmpty())}if(2===s)if(t.isCont()&&(u=t.head(),jt.isDigit(u)))t=t.step(),o=u,s=3;else if(!t.isEmpty())return bt.error(ot.expected("hex digit",t));if(3===s){if(t.isCont()&&(u=t.head(),jt.isDigit(u))){i=i||Ut.decodedString(),t=t.step(),i=i.write(jt.decodeDigit(o)<<4|jt.decodeDigit(u)),o=0,s=1;continue}if(!t.isEmpty())return bt.error(ot.expected("hex digit",t))}break}return new e(r,n,i,o,s)},e}(bt),Gs=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.uri=e,u.builder=r,u.keyOutput=n,u.valueOutput=i,u.c1=o,u.step=s,u}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.builder,this.keyOutput,this.valueOutput,this.c1,this.step)},e.parse=function(t,r,n,i,o,s,u){void 0===s&&(s=0),void 0===u&&(u=1);for(var a=0;;){if(1===u){for(i=i||Ut.decodedString();t.isCont()&&(a=t.head(),ys.isParamChar(a));)t=t.step(),i.write(a);if(t.isCont()&&61===a)t=t.step(),u=4;else{if(t.isCont()&&38===a){t=t.step(),(n=n||r.queryBuilder()).addParam(i.bind()),i=void 0;continue}if(t.isCont()&&37===a)t=t.step(),u=2;else if(!t.isEmpty())return(n=n||r.queryBuilder()).addParam(i.bind()),bt.done(n.bind())}}if(2===u)if(t.isCont()&&(a=t.head(),jt.isDigit(a)))t=t.step(),s=a,u=3;else if(!t.isEmpty())return bt.error(ot.expected("hex digit",t));if(3===u){if(t.isCont()&&(a=t.head(),jt.isDigit(a))){t=t.step(),i.write(jt.decodeDigit(s)<<4|jt.decodeDigit(a)),s=0,u=1;continue}if(!t.isEmpty())return bt.error(ot.expected("hex digit",t))}if(4===u){for(o=o||Ut.decodedString();t.isCont()&&(a=t.head(),ys.isParamChar(a)||61===a);)t=t.step(),o.write(a);if(t.isCont()&&38===a){t=t.step(),(n=n||r.queryBuilder()).addParam(i.bind(),o.bind()),i=void 0,o=void 0,u=1;continue}if(t.isCont()&&37===a)t=t.step(),u=5;else if(!t.isEmpty())return(n=n||r.queryBuilder()).addParam(i.bind(),o.bind()),bt.done(n.bind())}if(5===u)if(t.isCont()&&(a=t.head(),jt.isDigit(a)))t=t.step(),s=a,u=6;else if(!t.isEmpty())return bt.error(ot.expected("hex digit",t));if(6===u){if(t.isCont()&&(a=t.head(),jt.isDigit(a))){t=t.step(),o.write(jt.decodeDigit(s)<<4|jt.decodeDigit(a)),s=0,u=4;continue}if(!t.isEmpty())return bt.error(ot.expected("hex digit",t))}break}return new e(r,n,i,o,s,u)},e}(bt),_s=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.uri=e,o.output=r,o.c1=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.uri,this.output,this.c1,this.step)},e.parse=function(t,r,n,i,o){void 0===i&&(i=0),void 0===o&&(o=1);var s=0;for(n=n||Ut.decodedString();;){if(1===o){for(;t.isCont()&&(s=t.head(),ys.isFragmentChar(s));)t=t.step(),n=n.write(s);if(t.isCont()&&37===s)t=t.step(),o=2;else if(!t.isEmpty())return bt.done(r.fragment(n.bind()))}if(2===o)if(t.isCont()&&(s=t.head(),jt.isDigit(s)))t=t.step(),i=s,o=3;else if(!t.isEmpty())return bt.error(ot.expected("hex digit",t));if(3===o){if(t.isCont()&&(s=t.head(),jt.isDigit(s))){t=t.step(),n=n.write(jt.decodeDigit(i)<<4|jt.decodeDigit(s)),i=0,o=1;continue}if(!t.isEmpty())return bt.error(ot.expected("hex digit",t))}break}return new e(r,n,i,o)},e}(bt),Qs=function(t){function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return P(e,t),e}(Error),Zs=function(){function t(){}return t.prototype.isDefined=function(){return isFinite(this.value)},t.prototype.plus=function(e,r,n){return void 0===r&&(r=this.units),e=t.fromAny(e),t.create(this.toValue(r,n)+e.toValue(r,n),r)},t.prototype.negative=function(e,r){return void 0===e&&(e=this.units),t.create(-this.toValue(e,r),e)},t.prototype.minus=function(e,r,n){return void 0===r&&(r=this.units),e=t.fromAny(e),t.create(this.toValue(r,n)-e.toValue(r,n),r)},t.prototype.times=function(e,r,n){return void 0===r&&(r=this.units),t.create(this.toValue(r,n)*e,r)},t.prototype.divide=function(e,r,n){return void 0===r&&(r=this.units),t.create(this.toValue(r,n)/e,r)},t.prototype.combine=function(e,r,n,i){return void 0===r&&(r=1),void 0===n&&(n=this.units),e=t.fromAny(e),t.create(this.toValue(n,i)+e.toValue(n,i)*r,n)},t.prototype.emValue=function(e){return 0!==this.value?this.pxValue(e)/t.emUnit(e):0},t.prototype.remValue=function(e){return 0!==this.value?this.pxValue(e)/t.remUnit(e):0},t.prototype.pctValue=function(e){return 0!==this.value?this.pxValue(e)/t.pctUnit(e):0},t.prototype.px=function(e){return t.px(this.pxValue(e))},t.prototype.em=function(e){return t.em(this.emValue(e))},t.prototype.rem=function(e){return t.rem(this.remValue(e))},t.prototype.pct=function(e){return t.pct(this.pctValue(e))},t.prototype.toValue=function(t,e){if(void 0===t)return lr.from(this.toString());switch(t){case"px":return this.pxValue(e);case"em":return this.emValue(e);case"rem":return this.remValue(e);case"%":return this.pctValue(e);default:throw new Qs("unknown length units: "+t)}},t.prototype.to=function(t,e){switch(t){case"px":return this.px(e);case"em":return this.em(e);case"rem":return this.rem(e);case"%":return this.pct(e);default:throw new Qs("unknown length units: "+t)}},t.prototype.interpolateTo=function(e){return e instanceof t?nu(this,e):null},t.zero=function(t){switch(t){case void 0:case"px":return Js.zero();case"em":return $s.zero();case"rem":return tu.zero();case"%":return eu.zero();case"":return ru.zero();default:throw new Qs("unknown length units: "+t)}},t.px=function(t){return new Js(t)},t.em=function(t){return new $s(t)},t.rem=function(t){return new tu(t)},t.pct=function(t){return new eu(t)},t.unitless=function(t){return new ru(t)},t.create=function(e,r){switch(r){case void 0:case"px":return t.px(e);case"em":return t.em(e);case"rem":return t.rem(e);case"%":return t.pct(e);case"":return t.unitless(e);default:throw new Qs("unknown length units: "+r)}},t.fromCssValue=function(e){if(e instanceof CSSUnitValue)return t.create(e.value,e.unit);throw new TypeError(""+e)},t.fromAny=function(e,r){if(null==e||e instanceof t)return e;if("number"==typeof e)return t.create(e,r);if("string"==typeof e)return t.parse(e,r);throw new TypeError(""+e)},t.fromValue=function(e){if(2===e.length){var r=e.getItem(0).numberValue(void 0),n=e.getItem(1);if(void 0!==r&&isFinite(r)&&n instanceof er&&n.value===ir.extant())switch(n.key.value){case"px":return t.px(r);case"em":return t.em(r);case"rem":return t.rem(r);case"pct":return t.pct(r)}}return null},t.parse=function(t,e){for(var r=rt.stringInput(t);r.isCont()&&rt.isWhitespace(r.head());)r=r.step();var n=ou.parse(r,e);if(n.isDone())for(;r.isCont()&&rt.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=bt.error(ot.unexpected(r))),n.bind()},t.form=function(){return new iu(void 0,t.zero())},t.isAny=function(e){return e instanceof t||"number"==typeof e||"string"==typeof e},t.emUnit=function(t){if("object"==typeof t&&"number"==typeof t.emUnit)return t.emUnit;if("object"==typeof t&&t.emUnit instanceof Node)for(var e=t.emUnit;null!==e;){if(e instanceof Element){var r=getComputedStyle(e).fontSize;if("string"==typeof r)return parseFloat(r)}e=e.parentNode}throw new Qs("unknown em unit")},t.remUnit=function(t){if("object"==typeof t&&"number"==typeof t.remUnit)return t.remUnit;var e=getComputedStyle(document.documentElement).fontSize;if("string"==typeof e)return parseFloat(e);throw new Qs("unknown rem unit")},t.pctUnit=function(t){if("number"==typeof t)return t;if("object"==typeof t&&"number"==typeof t.pctUnit)return t.pctUnit;throw new Qs("unknown percentage unit")},S([e],t,"form",null),t}(),Js=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"px"},enumerable:!1,configurable:!0}),r.prototype.pxValue=function(t){return this.value},r.prototype.px=function(t){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"px"):null},r.prototype.compareTo=function(t){if(t instanceof Zs){var e=this.value,r=t.pxValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof Zs&&m.equivalent(this.value,t.pxValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Length").write(46).write("px").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"px"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(Zs),$s=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"em"},enumerable:!1,configurable:!0}),r.prototype.pxValue=function(t){return 0!==this.value?this.value*Zs.emUnit(t):0},r.prototype.emValue=function(t){return this.value},r.prototype.em=function(t){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"em"):null},r.prototype.compareTo=function(t){if(t instanceof Zs){var e=this.value,r=t.emValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof Zs&&m.equivalent(this.value,t.emValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Length").write(46).write("em").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"em"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(Zs),tu=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"rem"},enumerable:!1,configurable:!0}),r.prototype.pxValue=function(t){return 0!==this.value?this.value*Zs.remUnit(t):0},r.prototype.remValue=function(t){return this.value},r.prototype.rem=function(t){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"rem"):null},r.prototype.compareTo=function(t){if(t instanceof r){var e=this.value,n=t.remValue();return e<n?-1:e>n?1:isNaN(n)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof r&&m.equivalent(this.value,t.remValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Length").write(46).write("rem").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"rem"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(Zs),eu=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"%"},enumerable:!1,configurable:!0}),r.prototype.pxValue=function(t){return 0!==this.value?this.value*Zs.pctUnit(t)/100:0},r.prototype.pctValue=function(t){return this.value},r.prototype.pct=function(t){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"percent"):null},r.prototype.compareTo=function(t){if(t instanceof Zs){var e=this.value,r=t.pctValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof Zs&&m.equivalent(this.value,t.pctValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Length").write(46).write("pct").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"%"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(Zs),ru=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return""},enumerable:!1,configurable:!0}),r.prototype.pxValue=function(t){throw new Qs("unitless length")},r.prototype.toCssValue=function(){return null},r.prototype.compareTo=function(t){if(t instanceof Zs){var e=this.value,r=t.value;return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof Zs&&m.equivalent(this.value,t.value)},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Length").write(46).write("unitless").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+""},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(Zs),nu=function(t,e){var r=function(t){var e=r[0],n=r[1];return Zs.create(e.value+t*(n.value-e.value),n.units)};return Object.setPrototypeOf(r,nu.prototype),r[0]=t.to(e.units),r[1]=e,r};nu.prototype=Object.create($t.prototype);var iu=function(t){function e(e,r){var n=t.call(this)||this;return n.defaultUnits=e,Object.defineProperty(n,"unit",{value:r,enumerable:!0}),n}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(this.defaultUnits,t):this},e.prototype.mold=function(t){return t=Zs.fromAny(t,this.defaultUnits),lr.from(t.toString())},e.prototype.cast=function(t){var e=t.toValue(),r=null;try{if(void 0!==(r=Zs.fromValue(e))){var n=e.stringValue(void 0);void 0!==n&&(r=Zs.parse(n,this.defaultUnits))}}catch(t){}return null!==r?r:void 0},e}(Sn),ou=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.defaultUnits=e,o.valueParser=r,o.unitsOutput=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.defaultUnits,this.valueParser,this.unitsOutput,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o)if((n=void 0===n?it.parseDecimal(t):n.feed(t)).isDone())o=2;else if(n.isError())return n.asError();if(2===o){for(i=i||rt.stringOutput();t.isCont()&&(s=t.head(),rt.isAlpha(s)||37===s);)t=t.step(),i.push(s);if(!t.isEmpty()){var u=n.bind(),a=i.bind()||r;switch(a){case"px":return bt.done(Zs.px(u));case"em":return bt.done(Zs.em(u));case"rem":return bt.done(Zs.rem(u));case"%":return bt.done(Zs.pct(u));case"":case void 0:return bt.done(Zs.unitless(u));default:return bt.error(ot.message("unknown length units: "+a,t))}}}return new e(r,n,i,o)},e}(bt),su=function(){function t(){}return t.prototype.isDefined=function(){return isFinite(this.value)},t.prototype.plus=function(e,r){return void 0===r&&(r=this.units),e=t.fromAny(e),t.create(this.toValue(r)+e.toValue(r),r)},t.prototype.negative=function(e){return void 0===e&&(e=this.units),t.create(-this.toValue(e),e)},t.prototype.minus=function(e,r){return void 0===r&&(r=this.units),e=t.fromAny(e),t.create(this.toValue(r)-e.toValue(r),r)},t.prototype.times=function(e,r){return void 0===r&&(r=this.units),t.create(this.toValue(r)*e,r)},t.prototype.divide=function(e,r){return void 0===r&&(r=this.units),t.create(this.toValue(r)/e,r)},t.prototype.combine=function(e,r,n){return void 0===r&&(r=1),void 0===n&&(n=this.units),e=t.fromAny(e),t.create(this.toValue(n)+e.toValue(n)*r,n)},t.prototype.norm=function(e,r){return void 0===r&&(r=this.units),e=t.fromAny(e),t.create(this.toValue(r)/e.toValue(r),r)},t.prototype.deg=function(){return t.deg(this.degValue())},t.prototype.rad=function(){return t.rad(this.radValue())},t.prototype.grad=function(){return t.grad(this.gradValue())},t.prototype.turn=function(){return t.turn(this.turnValue())},t.prototype.toValue=function(t){if(void 0===t)return lr.from(this.toString());switch(t){case"deg":return this.degValue();case"rad":return this.radValue();case"grad":return this.gradValue();case"turn":return this.turnValue();default:throw new Error("unknown angle units: "+t)}},t.prototype.to=function(t){switch(t){case"deg":return this.deg();case"rad":return this.rad();case"grad":return this.grad();case"turn":return this.turn();default:throw new Error("unknown angle units: "+t)}},t.prototype.interpolateTo=function(e){return e instanceof t?fu(this,e):null},t.zero=function(t){switch(t){case"deg":return uu.zero();case void 0:case"rad":return au.zero();case"grad":return pu.zero();case"turn":return hu.zero();default:throw new Error("unknown angle units: "+t)}},t.deg=function(t){return new uu(t)},t.rad=function(t){return new au(t)},t.grad=function(t){return new pu(t)},t.turn=function(t){return new hu(t)},t.create=function(e,r){switch(r){case"deg":return t.deg(e);case void 0:case"rad":return t.rad(e);case"grad":return t.grad(e);case"turn":return t.turn(e);default:throw new Error("unknown angle units: "+r)}},t.fromCssValue=function(e){if(e instanceof CSSUnitValue)return t.create(e.value,e.unit);throw new TypeError(""+e)},t.fromAny=function(e,r){if(null==e||e instanceof t)return e;if("number"==typeof e)return t.create(e,r);if("string"==typeof e)return t.parse(e,r);throw new TypeError(""+e)},t.fromValue=function(e){if(2===e.length){var r=e.getItem(0).numberValue(),n=e.getItem(1);if(void 0!==r&&isFinite(r)&&n instanceof er&&n.toValue()===ir.extant())switch(n.key.value){case"deg":return t.deg(r);case"rad":return t.rad(r);case"grad":return t.grad(r);case"turn":return t.turn(r)}}return null},t.parse=function(t,e){for(var r=rt.stringInput(t);r.isCont()&&rt.isWhitespace(r.head());)r=r.step();var n=lu.parse(r,e);if(n.isDone())for(;r.isCont()&&rt.isWhitespace(r.head());)r=r.step();return r.isCont()&&!n.isError()&&(n=bt.error(ot.unexpected(r))),n.bind()},t.form=function(){return new cu(void 0,t.zero())},t.isAny=function(e){return e instanceof t||"number"==typeof e||"string"==typeof e},S([e],t,"form",null),t}(),uu=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"deg"},enumerable:!1,configurable:!0}),r.prototype.degValue=function(){return this.value},r.prototype.gradValue=function(){return 10*this.value/9},r.prototype.radValue=function(){return this.value*Math.PI/180},r.prototype.turnValue=function(){return this.value/360},r.prototype.deg=function(){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"deg"):null},r.prototype.compareTo=function(t){if(t instanceof su){var e=this.value,r=t.degValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof su&&m.equivalent(this.value,t.degValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Angle").write(46).write("deg").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"deg"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(su),au=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"rad"},enumerable:!1,configurable:!0}),r.prototype.degValue=function(){return 180*this.value/Math.PI},r.prototype.gradValue=function(){return 200*this.value/Math.PI},r.prototype.radValue=function(){return this.value},r.prototype.turnValue=function(){return this.value/(2*Math.PI)},r.prototype.rad=function(){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"rad"):null},r.prototype.compareTo=function(t){if(t instanceof su){var e=this.value,r=t.radValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof su&&m.equivalent(this.value,t.radValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Angle").write(46).write("rad").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"rad"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(su),pu=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"grad"},enumerable:!1,configurable:!0}),r.prototype.degValue=function(){return.9*this.value},r.prototype.gradValue=function(){return this.value},r.prototype.radValue=function(){return this.value*Math.PI/200},r.prototype.turnValue=function(){return this.value/400},r.prototype.grad=function(){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"grad"):null},r.prototype.compareTo=function(t){if(t instanceof su){var e=this.value,r=t.gradValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof su&&m.equivalent(this.value,t.gradValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Angle").write(46).write("grad").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"grad"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(su),hu=function(t){function r(e){var r=t.call(this)||this;return r.value=e,r}return P(r,t),Object.defineProperty(r.prototype,"units",{get:function(){return"turn"},enumerable:!1,configurable:!0}),r.prototype.degValue=function(){return 360*this.value},r.prototype.gradValue=function(){return 400*this.value},r.prototype.radValue=function(){return this.value*(2*Math.PI)},r.prototype.turnValue=function(){return this.value},r.prototype.turn=function(){return this},r.prototype.toCssValue=function(){return"undefined"!=typeof CSSUnitValue?new CSSUnitValue(this.value,"turn"):null},r.prototype.compareTo=function(t){if(t instanceof su){var e=this.value,r=t.turnValue();return e<r?-1:e>r?1:isNaN(r)?isNaN(e)?0:-1:isNaN(e)?1:0}return NaN},r.prototype.equivalentTo=function(t,e){return t instanceof su&&m.equivalent(this.value,t.turnValue())},r.prototype.equals=function(t){return t instanceof r&&this.value===t.value},r.prototype.hashCode=function(){return f.mash(f.mix(b.hash(r),m.hash(this.value)))},r.prototype.debug=function(t){return t=t.write("Angle").write(46).write("turn").write(40).debug(this.value).write(41)},r.prototype.toString=function(){return this.value+"turn"},r.zero=function(){return new r(0)},S([e],r,"zero",null),r}(su),fu=function(t,e){var r=function(t){var e=r[0],n=r[1];return su.create(e.value+t*(n.value-e.value),n.units)};return Object.setPrototypeOf(r,fu.prototype),r[0]=t.to(e.units),r[1]=e,r};fu.prototype=Object.create($t.prototype);var cu=function(t){function e(e,r){var n=t.call(this)||this;return n.defaultUnits=e,Object.defineProperty(n,"unit",{value:r,enumerable:!0}),n}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(this.defaultUnits,t):this},e.prototype.mold=function(t){return t=su.fromAny(t,this.defaultUnits),lr.from(t.toString())},e.prototype.cast=function(t){var e=t.toValue(),r=null;try{if(void 0===(r=su.fromValue(e))){var n=e.stringValue(void 0);void 0!==n&&(r=su.parse(n,this.defaultUnits))}}catch(t){}return null!==r?r:void 0},e}(Sn),lu=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.defaultUnits=e,o.valueParser=r,o.unitsOutput=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.defaultUnits,this.valueParser,this.unitsOutput,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o)if((n=void 0===n?it.parseDecimal(t):n.feed(t)).isDone())o=2;else if(n.isError())return n.asError();if(2===o){for(i=i||rt.stringOutput();t.isCont()&&(s=t.head(),rt.isAlpha(s));)t=t.step(),i.push(s);if(!t.isEmpty()){var u=n.bind(),a=i.bind()||r;switch(a){case"deg":return bt.done(su.deg(u));case"":case"rad":return bt.done(su.rad(u));case"grad":return bt.done(su.grad(u));case"turn":return bt.done(su.turn(u));default:return bt.error(ot.message("unknown units: "+a,t))}}}return new e(r,n,i,o)},e}(bt),du=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.isDefined=function(){return isFinite(this.x)&&isFinite(this.y)},t.prototype.plus=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.negative=function(){return new t(-this.x,-this.y)},t.prototype.minus=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.times=function(e){return new t(this.x*e,this.y*e)},t.prototype.toAny=function(){return{x:this.x,y:this.y}},t.prototype.interpolateTo=function(e){return e instanceof t?yu(this,e):null},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&(m.equivalent(this.x,e.x,r)&&m.equivalent(this.y,e.y,r))},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.x===e.x&&this.y===e.y)},t.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(t),m.hash(this.x)),m.hash(this.y)))},t.prototype.debug=function(t){return t=t.write("R2Vector").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(41)},t.prototype.toString=function(){return nt.debug(this)},t.zero=function(){return new t(0,0)},t.of=function(e,r){return new t(e,r)},t.fromInit=function(e){return new t(e.x,e.y)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if(t.isInit(e))return t.fromInit(e);throw new TypeError(""+e)},t.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.x&&"number"==typeof e.y}return!1},t.isAny=function(e){return e instanceof t||t.isInit(e)},S([e],t,"zero",null),t}(),yu=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.x+t*(n.x-e.x),o=e.y+t*(n.y-e.y);return new du(i,o)};return Object.setPrototypeOf(r,yu.prototype),r[0]=t,r[1]=e,r};yu.prototype=Object.create($t.prototype);var vu=function(){function t(){}return t.prototype.union=function(e){return e=t.fromAny(e),new Nu(Math.min(this.xMin,e.xMin),Math.min(this.yMin,e.yMin),Math.max(this.xMax,e.xMax),Math.max(this.yMax,e.yMax))},Object.defineProperty(t.prototype,"bounds",{get:function(){return new Nu(this.xMin,this.yMin,this.xMax,this.yMax)},enumerable:!1,configurable:!0}),t.fromAny=function(e){if(null==e||e instanceof t)return e;if(mu.isInit(e))return mu.fromInit(e);if(mu.isTuple(e))return mu.fromTuple(e);if(Ou.isInit(e))return Ou.fromInit(e);if(Nu.isInit(e))return Nu.fromInit(e);if(Uu.isInit(e))return Uu.fromInit(e);throw new TypeError(""+e)},t.isAny=function(e){return e instanceof t||mu.isInit(e)||mu.isTuple(e)||Ou.isInit(e)||Nu.isInit(e)||Uu.isInit(e)},t}(),mu=function(t){function r(e,r){var n=t.call(this)||this;return n.x=e,n.y=r,n}return P(r,t),r.prototype.isDefined=function(){return isFinite(this.x)&&isFinite(this.y)},Object.defineProperty(r.prototype,"xMin",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"yMin",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"xMax",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"yMax",{get:function(){return this.y},enumerable:!1,configurable:!0}),r.prototype.plus=function(t){return new r(this.x+t.x,this.y+t.y)},r.prototype.minus=function(t){return t instanceof du?new r(this.x-t.x,this.y-t.y):new du(this.x-t.x,this.y-t.y)},r.prototype.contains=function(t,e){return"number"==typeof t?this.x===t&&this.y===e:(t=vu.fromAny(t))instanceof r?this.x===t.x&&this.y===t.y:t instanceof vu&&(this.x<=t.xMin&&t.xMax<=this.x&&this.y<=t.yMin&&t.yMax<=this.y)},r.prototype.intersects=function(t){return(t=vu.fromAny(t)).intersects(this)},r.prototype.transform=function(t){return new r(t.transformX(this.x,this.y),t.transformY(this.x,this.y))},r.prototype.toAny=function(){return{x:this.x,y:this.y}},r.prototype.interpolateTo=function(t){return t instanceof r?wu(this,t):null},r.prototype.equivalentTo=function(t,e){return this===t||t instanceof r&&(m.equivalent(this.x,t.x,e)&&m.equivalent(this.y,t.y,e))},r.prototype.equals=function(t){return this===t||t instanceof r&&(this.x===t.x&&this.y===t.y)},r.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(r),m.hash(this.x)),m.hash(this.y)))},r.prototype.debug=function(t){return t=t.write("R2Point").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(41)},r.prototype.toString=function(){return nt.debug(this)},r.origin=function(){return new r(0,0)},r.undefined=function(){return new r(NaN,NaN)},r.of=function(t,e){return new r(t,e)},r.fromInit=function(t){return new r(t.x,t.y)},r.fromTuple=function(t){return new r(t[0],t[1])},r.fromAny=function(t){if(null==t||t instanceof r)return t;if(r.isInit(t))return r.fromInit(t);if(r.isTuple(t))return r.fromTuple(t);throw new TypeError(""+t)},r.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.x&&"number"==typeof e.y}return!1},r.isTuple=function(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]},r.isAny=function(t){return t instanceof r||r.isInit(t)||r.isTuple(t)},S([e],r,"origin",null),S([e],r,"undefined",null),r}(vu),wu=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.x+t*(n.x-e.x),o=e.y+t*(n.y-e.y);return new mu(i,o)};return Object.setPrototypeOf(r,wu.prototype),r[0]=t,r[1]=e,r};wu.prototype=Object.create($t.prototype);var gu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.draw=function(t){this.drawMove(t),this.drawRest(t)},e.prototype.transformDraw=function(t,e){this.transformDrawMove(t,e),this.transformDrawRest(t,e)},e.prototype.writePath=function(t){return t=this.writeMove(t),t=this.writeRest(t)},e.prototype.toPathString=function(t){var e=rt.stringOutput(t);return(e=this.writePath(e)).toString()},e.linear=function(t,e,r,n){return new Ou(t,e,r,n)},e.quadratic=function(t,e,r,n,i,o){return new Pu(t,e,r,n,i,o)},e.cubic=function(t,e,r,n,i,o,s,u){return new ku(t,e,r,n,i,o,s,u)},e.elliptic=function(t,e,r,n,i,o,s){return new Au(t,e,r,n,i,o,s)},e.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=bu.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},e}(vu),bu=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.x0Parser=e,o.y0Parser=r,o.command=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.x0Parser,this.y0Parser,this.command,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o){for(;t.isCont()&&(s=t.head(),rt.isSpace(s));)t=t.step();if(t.isCont()){if(77!==s&&109!==s)return bt.error(ot.expected("moveto",t));t=t.step(),i=s,o=2}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(2===o){if(void 0===r){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(r=it.parseDecimal(t))}else r=r.feed(t);if(void 0!==r)if(r.isDone())o=3;else if(r.isError())return r.asError()}if(3===o){for(;t.isCont()&&(s=t.head(),rt.isSpace(s));)t=t.step();t.isCont()?(44===s&&(t=t.step()),o=4):t.isEmpty()||(o=4)}if(4===o){if(void 0===n){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(n=it.parseDecimal(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())o=5;else if(n.isError())return n.asError()}if(5===o){for(;t.isCont()&&(s=t.head(),rt.isSpace(s));)t=t.step();if(t.isCont())switch(s){case 76:case 108:case 72:case 104:case 86:case 118:return Eu.parse(t,r,n);case 81:case 113:return Su.parse(t,r,n);case 84:return Su.parse(t,r,n,r,n);case 116:return Su.parse(t,r,n,bt.done(0),bt.done(0));case 67:case 99:return Mu.parse(t,r,n);case 83:return Mu.parse(t,r,n,r,n);case 115:return Mu.parse(t,r,n,bt.done(0),bt.done(0));case 65:case 97:return Du.parse(t,r,n);case 44:t=t.step();case 43:case 45:case 46:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:switch(i){case 77:case 109:return Eu.parseRest(t,i,r,n)}default:return bt.error(ot.expected("draw command",t))}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}return new e(r,n,i,o)},e}(bt),xu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e}(gu),Ou=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.x0=e,o.y0=r,o.x1=n,o.y1=i,o}return P(e,t),e.prototype.isDefined=function(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)},Object.defineProperty(e.prototype,"xMin",{get:function(){return Math.min(this.x0,this.x1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return Math.min(this.y0,this.y1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return Math.max(this.x0,this.x1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return Math.max(this.y0,this.y1)},enumerable:!1,configurable:!0}),e.prototype.interpolateX=function(t){return(1-t)*this.x0+t*this.x1},e.prototype.interpolateY=function(t){return(1-t)*this.y0+t*this.y1},e.prototype.interpolate=function(t){var e=1-t,r=e*this.x0+t*this.x1,n=e*this.y0+t*this.y1;return new mu(r,n)},e.prototype.contains=function(t,r){return"number"==typeof t?e.contains(this.x0,this.y0,this.x1,this.y1,t,r):(t=vu.fromAny(t))instanceof mu?this.containsPoint(t):t instanceof e&&this.containsSegment(t)},e.prototype.containsPoint=function(t){return e.contains(this.x0,this.y0,this.x1,this.y1,t.x,t.y)},e.prototype.containsSegment=function(t){return e.contains(this.x0,this.y0,this.x1,this.y1,t.x0,t.y0)&&e.contains(this.x0,this.y0,this.x1,this.y1,t.x1,t.y1)},e.contains=function(t,e,r,n,i,o){return(t<=i&&i<=r||r<=i&&i<=t)&&(e<=o&&o<=n||n<=o&&o<=e)&&(r-t)*(o-e)==(i-t)*(n-e)},e.prototype.intersects=function(t){return(t=vu.fromAny(t))instanceof mu?this.intersectsPoint(t):t instanceof e?this.intersectsSegment(t):t.intersects(this)},e.prototype.intersectsPoint=function(t){return e.contains(this.x0,this.y0,this.x1,this.y1,t.x,t.y)},e.prototype.intersectsSegment=function(t){return e.intersects(this.x0,this.y0,this.x1-this.x0,this.y1-this.y0,t.x0,t.y0,t.x1-t.x0,t.y1-t.y0)},e.intersects=function(t,e,r,n,i,o,s,u){var a=i-t,p=o-e,h=a*n-p*r,f=r*u-n*s;if(0===h&&0===f){var c=r*r+n*n,l=s*r+u*n,d=(a*r+p*n)/c,y=d+l/c;return l>=0?0<y&&d<1:0<d&&y<1}if(0===f)return!1;var v=(a*u-p*s)/f,m=h/f;return 0<=v&&v<=1&&0<=m&&m<=1},e.prototype.split=function(t){var r=1-t,n=r*this.x0+t*this.x1,i=r*this.y0+t*this.y1;return[new e(this.x0,this.y0,n,i),new e(n,i,this.x1,this.y1)]},e.prototype.transform=function(t){return new e(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0),t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1))},e.prototype.toAny=function(){return{x0:this.x0,y0:this.y0,x1:this.x1,y1:this.y1}},e.prototype.drawMove=function(t){t.moveTo(this.x0,this.y0)},e.prototype.drawRest=function(t){t.lineTo(this.x1,this.y1)},e.prototype.transformDrawMove=function(t,e){t.moveTo(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0))},e.prototype.transformDrawRest=function(t,e){t.lineTo(e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1))},e.prototype.writeMove=function(t){return t=t.write(77),t=(t=nt.displayNumber(t,this.x0)).write(44),t=nt.displayNumber(t,this.y0)},e.prototype.writeRest=function(t){return t=t.write(76),t=(t=nt.displayNumber(t,this.x1)).write(44),t=nt.displayNumber(t,this.y1)},e.prototype.interpolateTo=function(t){return t instanceof e?Cu(this,t):null},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(m.equivalent(this.x0,t.x0,r)&&m.equivalent(this.y0,t.y0,r)&&m.equivalent(this.x1,t.x1,r)&&m.equivalent(this.y1,t.y1,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1)},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(b.hash(e),m.hash(this.x0)),m.hash(this.y0)),m.hash(this.x1)),m.hash(this.y1)))},e.prototype.debug=function(t){return t=t.write("R2Segment").write(46).write("of").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(41)},e.prototype.toString=function(){return nt.debug(this)},e.of=function(t,r,n,i){return new e(t,r,n,i)},e.fromInit=function(t){return new e(t.x0,t.y0,t.x1,t.y1)},e.fromAny=function(t){if(null==t||t instanceof e)return t;if(e.isInit(t))return e.fromInit(t);throw new TypeError(""+t)},e.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.x0&&"number"==typeof e.y0&&"number"==typeof e.x1&&"number"==typeof e.y1}return!1},e.isAny=function(t){return t instanceof e||e.isInit(t)},e}(xu),Cu=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.x0+t*(n.x0-e.x0),o=e.y0+t*(n.y0-e.y0),s=e.x1+t*(n.x1-e.x1),u=e.y1+t*(n.y1-e.y1);return new Ou(i,o,s,u)};return Object.setPrototypeOf(r,Cu.prototype),r[0]=t,r[1]=e,r};Cu.prototype=Object.create($t.prototype);var Eu=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.x0Parser=e,u.y0Parser=r,u.x1Parser=n,u.y1Parser=i,u.command=o,u.step=s,u}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.command,this.step)},e.parse=function(t,r,n,i,o,s,u){void 0===u&&(u=1);var a=0;if(1===u){for(;t.isCont()&&(a=t.head(),rt.isSpace(a));)t=t.step();if(t.isCont())switch(a){case 77:case 109:case 76:case 108:t=t.step(),s=a,u=2;break;case 72:t=t.step(),o=n,s=a,u=2;break;case 104:t=t.step(),o=bt.done(0),s=a,u=2;break;case 86:t=t.step(),i=r,s=a,u=4;break;case 118:t=t.step(),i=bt.done(0),s=a,u=4;break;default:return bt.error(ot.expected("lineto",t))}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(2===u){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=it.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())u=void 0!==o&&o.isDone()?4:3;else if(i.isError())return i.asError()}if(3===u){for(;t.isCont()&&(a=t.head(),rt.isSpace(a));)t=t.step();t.isCont()?(44===a&&(t=t.step()),u=4):t.isEmpty()||(u=4)}if(4===u){if(void 0===o){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(o=it.parseDecimal(t))}else o=o.feed(t);if(void 0!==o){if(o.isDone()){var p=r.bind(),h=n.bind(),f=i.bind(),c=o.bind();return 109!==s&&108!==s&&104!==s&&118!==s||(f+=p,c+=h),bt.done(new Ou(p,h,f,c))}if(o.isError())return o.asError()}}return new e(r,n,i,o,s,u)},e.parseRest=function(t,e,r,n){var i,o,s;switch(e){case 72:o=n,s=2;break;case 104:o=bt.done(0),s=2;break;case 86:i=r,s=4;break;case 118:i=bt.done(0),s=4;break;default:s=2}return this.parse(t,r,n,i,o,e,s)},e}(bt),Pu=function(t){function e(e,r,n,i,o,s){var u=t.call(this)||this;return u.x0=e,u.y0=r,u.x1=n,u.y1=i,u.x2=o,u.y2=s,u}return P(e,t),e.prototype.isDefined=function(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)&&isFinite(this.x2)&&isFinite(this.y2)},Object.defineProperty(e.prototype,"xMin",{get:function(){return Math.min(this.x0,this.x1,this.x2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return Math.min(this.y0,this.y1,this.y2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return Math.max(this.x0,this.x1,this.x2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return Math.max(this.y0,this.y1,this.y2)},enumerable:!1,configurable:!0}),e.prototype.interpolateX=function(t){var e=1-t;return e*(e*this.x0+t*this.x1)+t*(e*this.x1+t*this.x2)},e.prototype.interpolateY=function(t){var e=1-t;return e*(e*this.y0+t*this.y1)+t*(e*this.y1+t*this.y2)},e.prototype.interpolate=function(t){var e=1-t,r=e*this.x0+t*this.x1,n=e*this.y0+t*this.y1,i=e*this.x1+t*this.x2,o=e*this.y1+t*this.y2;return new mu(e*r+t*i,e*n+t*o)},e.prototype.contains=function(t,e){return!1},e.prototype.intersects=function(t){return!1},e.prototype.split=function(t){var r=1-t,n=r*this.x0+t*this.x1,i=r*this.y0+t*this.y1,o=r*this.x1+t*this.x2,s=r*this.y1+t*this.y2,u=r*n+t*o,a=r*i+t*s;return[new e(this.x0,this.y0,n,i,u,a),new e(u,a,o,s,this.x2,this.y2)]},e.prototype.transform=function(t){return new e(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0),t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1),t.transformX(this.x2,this.y2),t.transformY(this.x2,this.y2))},e.prototype.drawMove=function(t){t.moveTo(this.x0,this.y0)},e.prototype.drawRest=function(t){t.quadraticCurveTo(this.x1,this.y1,this.x2,this.y2)},e.prototype.transformDrawMove=function(t,e){t.moveTo(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0))},e.prototype.transformDrawRest=function(t,e){t.quadraticCurveTo(e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1),e.transformX(this.x2,this.y2),e.transformY(this.x2,this.y2))},e.prototype.writeMove=function(t){return t=t.write(77),t=(t=nt.displayNumber(t,this.x0)).write(44),t=nt.displayNumber(t,this.y0)},e.prototype.writeRest=function(t){return t=t.write(81),t=(t=nt.displayNumber(t,this.x1)).write(44),t=(t=nt.displayNumber(t,this.y1)).write(44),t=(t=nt.displayNumber(t,this.x2)).write(44),t=nt.displayNumber(t,this.y2)},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(m.equivalent(this.x0,t.x0,r)&&m.equivalent(this.y0,t.y0,r)&&m.equivalent(this.x1,t.x1,r)&&m.equivalent(this.y1,t.y1,r)&&m.equivalent(this.x2,t.x2,r)&&m.equivalent(this.y2,t.y2,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2)},e.prototype.debug=function(t){return t=t.write("R2Curve").write(46).write("quadratic").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.x2).write(", ").debug(this.y2).write(41)},e.prototype.toString=function(){return nt.debug(this)},e}(xu),Su=function(t){function e(e,r,n,i,o,s,u,a){var p=t.call(this)||this;return p.x0Parser=e,p.y0Parser=r,p.x1Parser=n,p.y1Parser=i,p.x2Parser=o,p.y2Parser=s,p.command=u,p.step=a,p}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.x2Parser,this.y2Parser,this.command,this.step)},e.parse=function(t,r,n,i,o,s,u,a,p){void 0===p&&(p=1);var h=0;if(1===p){for(;t.isCont()&&(h=t.head(),rt.isSpace(h));)t=t.step();if(t.isCont())switch(h){case 81:case 113:t=t.step(),a=h,p=2;break;case 84:case 116:t=t.step(),a=h,p=6;break;default:return bt.error(ot.expected("curveto",t))}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(2===p){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=it.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())p=3;else if(i.isError())return i.asError()}if(3===p){for(;t.isCont()&&(h=t.head(),rt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),p=4):t.isEmpty()||(p=4)}if(4===p){if(void 0===o){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(o=it.parseDecimal(t))}else o=o.feed(t);if(void 0!==o)if(o.isDone())p=5;else if(o.isError())return o.asError()}if(5===p){for(;t.isCont()&&(h=t.head(),rt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),p=6):t.isEmpty()||(p=6)}if(6===p){if(void 0===s){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(s=it.parseDecimal(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())p=7;else if(s.isError())return s.asError()}if(7===p){for(;t.isCont()&&(h=t.head(),rt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),p=8):t.isEmpty()||(p=8)}if(8===p){if(void 0===u){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(u=it.parseDecimal(t))}else u=u.feed(t);if(void 0!==u){if(u.isDone()){var f=r.bind(),c=n.bind(),l=i.bind(),d=o.bind(),y=s.bind(),v=u.bind();return 113!==a&&116!==a||(l+=f,d+=c,y+=f,v+=c),bt.done(new Pu(f,c,l,d,y,v))}if(u.isError())return u.asError()}}return new e(r,n,i,o,s,u,a,p)},e.parseRest=function(t,r,n,i,o,s){var u=84===r||116===r?6:2;return e.parse(t,n,i,o,s,void 0,void 0,r,u)},e}(bt),ku=function(t){function e(e,r,n,i,o,s,u,a){var p=t.call(this)||this;return p.x0=e,p.y0=r,p.x1=n,p.y1=i,p.x2=o,p.y2=s,p.x3=u,p.y3=a,p}return P(e,t),e.prototype.isDefined=function(){return isFinite(this.x0)&&isFinite(this.y0)&&isFinite(this.x1)&&isFinite(this.y1)&&isFinite(this.x2)&&isFinite(this.y2)&&isFinite(this.x3)&&isFinite(this.y3)},Object.defineProperty(e.prototype,"xMin",{get:function(){return Math.min(this.x0,this.x1,this.x2,this.x3)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return Math.min(this.y0,this.y1,this.y2,this.y3)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return Math.max(this.x0,this.x1,this.x2,this.x3)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return Math.max(this.y0,this.y1,this.y2,this.y3)},enumerable:!1,configurable:!0}),e.prototype.interpolateX=function(t){var e=1-t,r=e*this.x0+t*this.x1,n=e*this.x1+t*this.x2;return e*(e*r+t*n)+t*(e*n+t*(e*this.x2+t*this.x3))},e.prototype.interpolateY=function(t){var e=1-t,r=e*this.y0+t*this.y1,n=e*this.y1+t*this.y2;return e*(e*r+t*n)+t*(e*n+t*(e*this.y2+t*this.y3))},e.prototype.interpolate=function(t){var e=1-t,r=e*this.x0+t*this.x1,n=e*this.y0+t*this.y1,i=e*this.x1+t*this.x2,o=e*this.y1+t*this.y2,s=e*this.x2+t*this.x3,u=e*this.y2+t*this.y3;return new mu(e*(e*r+t*i)+t*(e*i+t*s),e*(e*n+t*o)+t*(e*o+t*u))},e.prototype.contains=function(t,e){return!1},e.prototype.intersects=function(t){return!1},e.prototype.split=function(t){var r=1-t,n=r*this.x0+t*this.x1,i=r*this.y0+t*this.y1,o=r*this.x1+t*this.x2,s=r*this.y1+t*this.y2,u=r*this.x2+t*this.x3,a=r*this.y2+t*this.y3,p=r*n+t*o,h=r*i+t*s,f=r*o+t*u,c=r*s+t*a,l=r*p+t*f,d=r*h+t*c;return[new e(this.x0,this.y0,n,i,p,h,l,d),new e(l,d,f,c,u,a,this.x3,this.y3)]},e.prototype.transform=function(t){return new e(t.transformX(this.x0,this.y0),t.transformY(this.x0,this.y0),t.transformX(this.x1,this.y1),t.transformY(this.x1,this.y1),t.transformX(this.x2,this.y2),t.transformY(this.x2,this.y2),t.transformX(this.x3,this.y3),t.transformY(this.x3,this.y3))},e.prototype.drawMove=function(t){t.moveTo(this.x0,this.y0)},e.prototype.drawRest=function(t){t.bezierCurveTo(this.x1,this.y1,this.x2,this.y2,this.x3,this.y3)},e.prototype.transformDrawMove=function(t,e){t.moveTo(e.transformX(this.x0,this.y0),e.transformY(this.x0,this.y0))},e.prototype.transformDrawRest=function(t,e){t.bezierCurveTo(e.transformX(this.x1,this.y1),e.transformY(this.x1,this.y1),e.transformX(this.x2,this.y2),e.transformY(this.x2,this.y2),e.transformX(this.x3,this.y3),e.transformY(this.x3,this.y3))},e.prototype.writeMove=function(t){return t=t.write(77),t=(t=nt.displayNumber(t,this.x0)).write(44),t=nt.displayNumber(t,this.y0)},e.prototype.writeRest=function(t){return t=t.write(67),t=(t=nt.displayNumber(t,this.x1)).write(44),t=(t=nt.displayNumber(t,this.y1)).write(44),t=(t=nt.displayNumber(t,this.x2)).write(44),t=(t=nt.displayNumber(t,this.y2)).write(44),t=(t=nt.displayNumber(t,this.x3)).write(44),t=nt.displayNumber(t,this.y3)},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(m.equivalent(this.x0,t.x0,r)&&m.equivalent(this.y0,t.y0,r)&&m.equivalent(this.x1,t.x1,r)&&m.equivalent(this.y1,t.y1,r)&&m.equivalent(this.x2,t.x2,r)&&m.equivalent(this.y2,t.y2,r)&&m.equivalent(this.x3,t.x3,r)&&m.equivalent(this.y3,t.y3,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2&&this.x3===t.x3&&this.y3===t.y3)},e.prototype.debug=function(t){return t=t.write("R2Curve").write(46).write("cubic").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.x2).write(", ").debug(this.y2).write(", ").debug(this.x3).write(", ").debug(this.y3).write(41)},e.prototype.toString=function(){return nt.debug(this)},e}(xu),Mu=function(t){function e(e,r,n,i,o,s,u,a,p,h){var f=t.call(this)||this;return f.x0Parser=e,f.y0Parser=r,f.x1Parser=n,f.y1Parser=i,f.x2Parser=o,f.y2Parser=s,f.x3Parser=u,f.y3Parser=a,f.command=p,f.step=h,f}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.x0Parser,this.y0Parser,this.x1Parser,this.y1Parser,this.x2Parser,this.y2Parser,this.x3Parser,this.y3Parser,this.command,this.step)},e.parse=function(t,r,n,i,o,s,u,a,p,h,f){void 0===f&&(f=1);var c=0;if(1===f){for(;t.isCont()&&(c=t.head(),rt.isSpace(c));)t=t.step();if(t.isCont())switch(c){case 67:case 99:t=t.step(),h=c,f=2;break;case 83:case 115:t=t.step(),h=c,f=6;break;default:return bt.error(ot.expected("curveto",t))}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(2===f){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=it.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())f=3;else if(i.isError())return i.asError()}if(3===f){for(;t.isCont()&&(c=t.head(),rt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),f=4):t.isEmpty()||(f=4)}if(4===f){if(void 0===o){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(o=it.parseDecimal(t))}else o=o.feed(t);if(void 0!==o)if(o.isDone())f=5;else if(o.isError())return o.asError()}if(5===f){for(;t.isCont()&&(c=t.head(),rt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),f=6):t.isEmpty()||(f=6)}if(6===f){if(void 0===s){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(s=it.parseDecimal(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())f=7;else if(s.isError())return s.asError()}if(7===f){for(;t.isCont()&&(c=t.head(),rt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),f=8):t.isEmpty()||(f=8)}if(8===f){if(void 0===u){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(u=it.parseDecimal(t))}else u=u.feed(t);if(void 0!==u)if(u.isDone())f=9;else if(u.isError())return u.asError()}if(9===f){for(;t.isCont()&&(c=t.head(),rt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),f=10):t.isEmpty()||(f=10)}if(10===f){if(void 0===a){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(a=it.parseDecimal(t))}else a=a.feed(t);if(void 0!==a)if(a.isDone())f=11;else if(a.isError())return a.asError()}if(11===f){for(;t.isCont()&&(c=t.head(),rt.isSpace(c));)t=t.step();t.isCont()?(44===c&&(t=t.step()),f=12):t.isEmpty()||(f=12)}if(12===f){if(void 0===p){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(p=it.parseDecimal(t))}else p=p.feed(t);if(void 0!==p){if(p.isDone()){var l=r.bind(),d=n.bind(),y=i.bind(),v=o.bind(),m=s.bind(),w=u.bind(),g=a.bind(),b=p.bind();return 99!==h&&115!==h||(y+=l,v+=d,m+=l,w+=d,g+=l,b+=d),bt.done(new ku(l,d,y,v,m,w,g,b))}if(p.isError())return p.asError()}}return new e(r,n,i,o,s,u,a,p,h,f)},e.parseRest=function(t,r,n,i,o,s){var u=83===r||115===r?6:2;return e.parse(t,n,i,o,s,void 0,void 0,void 0,void 0,r,u)},e}(bt),Au=function(t){function e(e,r,n,i,o,s,u){var a=t.call(this)||this;return a.cx=e,a.cy=r,a.rx=n,a.ry=i,a.phi=o,a.a0=s,a.da=u,a}return P(e,t),Object.defineProperty(e.prototype,"xMin",{get:function(){return this.cx-Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this.cy-Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return this.cx+Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return this.cy+Math.max(this.rx,this.ry)},enumerable:!1,configurable:!0}),e.prototype.interpolateX=function(t){var e=this.a0+t*this.da,r=this.rx*Math.cos(e),n=this.ry*Math.sin(e),i=this.phi;return 0===i?this.cx+r:this.cx+r*Math.cos(i)-n*Math.sin(i)},e.prototype.interpolateY=function(t){var e=this.a0+t*this.da,r=this.rx*Math.cos(e),n=this.ry*Math.sin(e),i=this.phi;return 0===i?this.cy+n:this.cy+r*Math.sin(i)+n*Math.cos(i)},e.prototype.interpolate=function(t){var e=this.a0+t*this.da,r=this.rx*Math.cos(e),n=this.ry*Math.sin(e),i=this.phi;return 0===i?new mu(this.cx+r,this.cy+n):new mu(this.cx+r*Math.cos(i)-n*Math.sin(i),this.cy+r*Math.sin(i)+n*Math.cos(i))},e.prototype.contains=function(t,e){return!1},e.prototype.intersects=function(t){return!1},e.prototype.split=function(t){var r=this.a0,n=this.da,i=r+t*n;return[new e(this.cx,this.cy,this.rx,this.ry,this.phi,r,i-r),new e(this.cx,this.cy,this.rx,this.ry,this.phi,i,r+n-i)]},e.prototype.transform=function(t){var r=this.a0,n=r+this.da,i=Math.cos(r),o=Math.sin(r),s=Math.cos(n),u=Math.sin(n),a=t.transformX(i,o),p=t.transformY(i,o),h=t.transformX(s,u),f=t.transformY(s,u),c=Math.atan2(p,a),l=Math.atan2(f,h);return new e(t.transformX(this.cx,this.cy),t.transformY(this.cx,this.cy),t.transformX(this.rx,this.ry),t.transformY(this.rx,this.ry),this.phi,c,l-c)},e.prototype.drawMove=function(t){var e=this.toEndpoints(),r=e.x0,n=e.y0;t.moveTo(r,n)},e.prototype.drawRest=function(t){t.ellipse(this.cx,this.cy,this.rx,this.ry,this.phi,this.a0,this.a0+this.da,this.da<0)},e.prototype.transformDrawMove=function(t,e){var r=this.toEndpoints(),n=r.x0,i=r.y0;t.moveTo(e.transformX(n,i),e.transformY(n,i))},e.prototype.transformDrawRest=function(t,e){var r=this.a0,n=r+this.da,i=Math.cos(r),o=Math.sin(r),s=Math.cos(n),u=Math.sin(n),a=e.transformX(i,o),p=e.transformY(i,o),h=e.transformX(s,u),f=e.transformY(s,u),c=Math.atan2(p,a),l=Math.atan2(f,h);t.ellipse(e.transformX(this.cx,this.cy),e.transformY(this.cx,this.cy),e.transformX(this.rx,this.ry),e.transformY(this.rx,this.ry),this.phi,c,l,l-c<0)},e.prototype.writeMove=function(t){var e=this.toEndpoints(),r=e.x0,n=e.y0;return t=t.write(77),t=(t=nt.displayNumber(t,r)).write(44),t=nt.displayNumber(t,n)},e.prototype.writeRest=function(t){var e=this.toEndpoints(),r=e.rx,n=e.ry,i=e.phi,o=e.large,s=e.sweep,u=e.x1,a=e.y1;return t=t.write(65),t=(t=nt.displayNumber(t,r)).write(44),t=(t=nt.displayNumber(t,n)).write(32),t=(t=(t=(t=(t=(t=nt.displayNumber(t,i)).write(32)).write(o?49:48)).write(44)).write(s?49:48)).write(32),t=(t=nt.displayNumber(t,u)).write(44),t=nt.displayNumber(t,a)},e.prototype.toEndpoints=function(){var t=this.cx,e=this.cy,r=this.rx,n=this.ry,i=this.phi,o=this.a0,s=this.da,u=o+s,a=Math.cos(i),p=Math.sin(i),h=Math.cos(o),f=Math.sin(o),c=Math.cos(u),l=Math.sin(u),d=a*r*c-p*n*l+t,y=p*r*c+a*n*l+e;return{x0:a*r*h-p*n*f+t,y0:p*r*h+a*n*f+e,rx:r,ry:n,phi:i,large:Math.abs(s)>Math.PI,sweep:s>0,x1:d,y1:y}},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(m.equivalent(this.cx,t.cx,r)&&m.equivalent(this.cy,t.cy,r)&&m.equivalent(this.rx,t.rx,r)&&m.equivalent(this.ry,t.ry,r)&&m.equivalent(this.phi,t.phi,r)&&m.equivalent(this.a0,t.a0,r)&&m.equivalent(this.da,t.da,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.cx===t.cx&&this.cy===t.cy&&this.rx===t.rx&&this.ry===t.ry&&this.phi===t.phi&&this.a0===t.a0&&this.da===t.da)},e.prototype.debug=function(t){return t=t.write("R2Curve").write(46).write("elliptic").write(40).debug(this.cx).write(", ").debug(this.cy).write(", ").debug(this.rx).write(", ").debug(this.ry).write(", ").debug(this.phi).write(", ").debug(this.a0).write(", ").debug(this.da).write(41)},e.prototype.toString=function(){return nt.debug(this)},e.fromEndpoints=function(t,r,n,i,o,s,u,a,p){var h=Math.cos(o),f=Math.sin(o),c=h*((t-a)/2)+f*((r-p)/2),l=(t-a)/2*-f+h*((r-p)/2),d=n*n,y=i*i,v=c*c,m=l*l,w=Math.sqrt((d*y-d*m-y*v)/(d*m+y*v));s===u&&(w=-w);var g=w*n*l/i,b=-w*i*c/n,x=h*g-f*b+(t+a)/2,O=f*g+h*b+(r+p)/2;function C(t,e,r,n){var i=t*r+e*n,o=t*t+e*e,s=r*r+n*n,u=Math.acos(i/(Math.sqrt(o)*Math.sqrt(s)));return t*n-e*r<0&&(u=-u),u}var E=C(1,0,(c-g)/n,(l-b)/i),P=C((c-g)/n,(l-b)/i,(-c-g)/n,(-l-b)/i)%(2*Math.PI);return!u&&P>0?P-=2*Math.PI:u&&P<0&&(P+=2*Math.PI),new e(x,O,n,i,o,E,P)},e}(gu),Du=function(t){function e(e,r,n,i,o,s,u,a,p,h,f){var c=t.call(this)||this;return c.x0Parser=e,c.y0Parser=r,c.rxParser=n,c.ryParser=i,c.phiParser=o,c.large=s,c.sweep=u,c.x1Parser=a,c.y1Parser=p,c.command=h,c.step=f,c}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.x0Parser,this.y0Parser,this.rxParser,this.ryParser,this.phiParser,this.large,this.sweep,this.x1Parser,this.y1Parser,this.command,this.step)},e.parse=function(t,r,n,i,o,s,u,a,p,h,f,c){void 0===c&&(c=1);var l=0;if(1===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();if(t.isCont())switch(l){case 65:case 97:t=t.step(),f=l,c=2;break;default:return bt.error(ot.expected("arcto",t))}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(2===c){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(i=it.parseDecimal(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())c=3;else if(i.isError())return i.asError()}if(3===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();t.isCont()?(44===l&&(t=t.step()),c=4):t.isEmpty()||(c=4)}if(4===c){if(void 0===o){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(o=it.parseDecimal(t))}else o=o.feed(t);if(void 0!==o)if(o.isDone())c=5;else if(o.isError())return o.asError()}if(5===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();t.isCont()?(44===l&&(t=t.step()),c=6):t.isEmpty()||(c=6)}if(6===c){if(void 0===s){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(s=it.parseDecimal(t))}else s=s.feed(t);if(void 0!==s)if(s.isDone())c=7;else if(s.isError())return s.asError()}if(7===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();t.isCont()?(44===l&&(t=t.step()),c=8):t.isEmpty()||(c=8)}if(8===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();if(t.isCont())if(48===l)t=t.step(),u=!1,c=9;else{if(49!==l)return bt.error(ot.expected("flag",t));t=t.step(),u=!0,c=9}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(9===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();t.isCont()?(44===l&&(t=t.step()),c=10):t.isEmpty()||(c=10)}if(10===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();if(t.isCont())if(48===l)t=t.step(),a=!1,c=11;else{if(49!==l)return bt.error(ot.expected("flag",t));t=t.step(),a=!0,c=11}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(11===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();t.isCont()?(44===l&&(t=t.step()),c=12):t.isEmpty()||(c=12)}if(12===c){if(void 0===p){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(p=it.parseDecimal(t))}else p=p.feed(t);if(void 0!==p)if(p.isDone())c=13;else if(p.isError())return p.asError()}if(13===c){for(;t.isCont()&&(l=t.head(),rt.isSpace(l));)t=t.step();t.isCont()?(44===l&&(t=t.step()),c=14):t.isEmpty()||(c=14)}if(14===c){if(void 0===h){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(h=it.parseDecimal(t))}else h=h.feed(t);if(void 0!==h){if(h.isDone()){var d=r.bind(),y=n.bind(),v=i.bind(),m=o.bind(),w=s.bind()*Math.PI/180,g=p.bind(),b=h.bind();return 97===f&&(g+=d,b+=y),bt.done(Au.fromEndpoints(d,y,v,m,w,u,a,g,b))}if(h.isError())return h.asError()}}return new e(r,n,i,o,s,u,a,p,h,f,c)},e.parseRest=function(t,r,n,i){return e.parse(t,n,i,void 0,void 0,void 0,void 0,void 0,void 0,void 0,r,2)},e}(bt),Iu=function(t){function e(e,r){var n=t.call(this)||this;return n.curves=e,n.closed=r,n.boundingBox=null,n.pathString=void 0,n}return P(e,t),e.prototype.isDefined=function(){return 0!==this.curves.length},e.prototype.isClosed=function(){return this.closed},Object.defineProperty(e.prototype,"xMin",{get:function(){return this.bounds.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this.bounds.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return this.bounds.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return this.bounds.yMax},enumerable:!1,configurable:!0}),e.prototype.interpolateX=function(t){var e=this.curves,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateX(o)}return NaN},e.prototype.interpolateY=function(t){var e=this.curves,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateY(o)}return NaN},e.prototype.interpolate=function(t){var e=this.curves,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolate(o)}return new mu(NaN,NaN)},e.prototype.contains=function(t,e){return!1},e.prototype.intersects=function(t){return!1},e.prototype.split=function(t){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=r[o].split(s),a=u[0],p=u[1],h=new Array(o+1),f=new Array(n-o),c=0;c<o;c+=1)h[c]=r[c];h[o]=a,f[0]=p;for(c=o+1;c<n;c+=1)f[c-o]=r[c];return[new e(h,!1),new e(f,!1)]}return[e.empty(),e.empty()]},e.prototype.subdivide=function(t){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=r[o].split(s),a=u[0],p=u[1],h=new Array(n+1),f=0;f<o;f+=1)h[f]=r[f];h[o]=a,h[o+1]=p;for(f=o+1;f<n;f+=1)h[f+1]=r[f];return new e(h,this.closed)}return e.empty()},e.prototype.transform=function(t){var r=this.curves,n=r.length;if(n>0){for(var i=new Array(n),o=0;o<n;o+=1)i[o]=r[o].transform(t);return new e(i,this.closed)}return e.empty()},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this.boundingBox;if(null===t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=this.curves,s=0,u=o.length;s<u;s+=1){var a=o[s];e=Math.min(e,a.xMin),r=Math.min(r,a.yMin),n=Math.max(a.xMax,n),i=Math.max(a.yMax,i)}t=new Nu(e,r,n,i),this.boundingBox=t}return t},enumerable:!1,configurable:!0}),e.prototype.drawMove=function(t){var e=this.curves;0!==e.length&&e[0].drawMove(t)},e.prototype.drawRest=function(t){for(var e=this.curves,r=this.closed,n=e.length-(r&&void 0!==t.closePath?1:0),i=0;i<n;i+=1)e[i].drawRest(t);r&&void 0!==t.closePath&&t.closePath()},e.prototype.transformDrawMove=function(t,e){var r=this.curves;0!==r.length&&r[0].transformDrawMove(t,e)},e.prototype.transformDrawRest=function(t,e){for(var r=this.curves,n=this.closed,i=r.length-(n&&void 0!==t.closePath?1:0),o=0;o<i;o+=1)r[o].transformDrawRest(t,e);n&&void 0!==t.closePath&&t.closePath()},e.prototype.writeMove=function(t){var e=this.curves;return 0!==e.length&&(t=e[0].writeMove(t)),t},e.prototype.writeRest=function(t){for(var e=this.curves,r=this.closed,n=e.length-(r?1:0),i=0;i<n;i+=1)t=e[i].writeRest(t);return r&&(t=t.write(90)),t},e.prototype.toPathString=function(t){var e;if(void 0!==t||void 0===(e=this.pathString)){var r=rt.stringOutput(t);this.writePath(r),e=r.bind(),void 0===t&&(this.pathString=e)}return e},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(C.equivalent(this.curves,t.curves,r)&&this.closed===t.closed)},e.prototype.equals=function(t){return this===t||t instanceof e&&(C.equal(this.curves,t.curves)&&this.closed===t.closed)},e.prototype.debug=function(t){var e=this.curves,r=e.length;if(t=t.write("R2Spline").write(46),0===r)t=t.write("empty").write(40);else if(0!==r){t=(t=t.write(this.closed?"closed":"open").write(40)).debug(e[0]);for(var n=1;n<r;n+=1)t=t.write(", ").debug(e[n])}return t=t.write(41)},e.prototype.toString=function(){return nt.debug(this)},e.empty=function(){return new e([],!1)},e.open=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e(t,!1)},e.closed=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e(t,!0)},e.builder=function(){return new Tu},e.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=Vu.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},e}(gu),Tu=function(){function t(){this.curves=[],this.closed=!1,this.aliased=!1,this.x0=0,this.y0=0,this.x=0,this.y=0}return t.prototype.dealias=function(){this.aliased&&(this.curves=this.curves.slice(0),this.aliased=!1)},t.prototype.moveTo=function(t,e){this.aliased?(this.curves=[],this.aliased=!1):this.curves.length=0,this.closed=!1,this.x0=t,this.y0=e,this.x=t,this.y=e},t.prototype.closePath=function(){this.dealias(),this.curves.push(new Ou(this.x,this.y,this.x0,this.y0)),this.closed=!0,this.x=this.x0,this.y=this.y0},t.prototype.lineTo=function(t,e){this.dealias(),this.curves.push(new Ou(this.x,this.y,t,e)),this.x=t,this.y=e},t.prototype.quadraticCurveTo=function(t,e,r,n){this.dealias(),this.curves.push(new Pu(this.x,this.y,t,e,r,n)),this.x=r,this.y=n},t.prototype.bezierCurveTo=function(t,e,r,n,i,o){this.dealias(),this.curves.push(new ku(this.x,this.y,t,e,r,n,i,o)),this.x=i,this.y=o},t.prototype.arcTo=function(e,r,n,i,o){this.dealias();var s=this.x,u=this.y,a=e-s,p=r-u,h=n-e,f=i-r,c=Math.atan2(p,a)-Math.PI/2,l=Math.atan2(f,h)-Math.PI/2,d=l-c,y=Math.cos(c),v=Math.sin(c),m=Math.cos(l),w=Math.sin(l),g=s-y,b=u-v,x=e-y,O=r-v,C=e-m,E=r-w,P=n-m,S=i-w,k=t.intersection(g,b,x-g,O-b,C,E,P-C,S-E),M=g+k*(x-g),A=b+k*(O-b);this.curves.push(new Au(M,A,o,o,0,c,d)),this.x=n,this.y=i},t.intersection=function(t,e,r,n,i,o,s,u){var a=i-t,p=o-e,h=a*n-p*r,f=r*u-n*s;if(0===h&&0===f){var c=r*r+n*n,l=s*r+u*n,d=(a*r+p*n)/c,y=d+l/c;return(l>=0?0<y&&d<1:0<d&&y<1)?d:NaN}if(0===f)return NaN;var v=(a*u-p*s)/f,m=h/f;return 0<=v&&v<=1&&0<=m&&m<=1?v:NaN},t.prototype.arc=function(t,e,r,n,i,o){void 0===o&&(o=!1),this.dealias();var s=i-n;!0===o&&s>0?s-=2*Math.PI:!1===o&&s<0&&(s+=2*Math.PI);var u=new Au(t,e,r,r,0,n,s);this.curves.push(u);var a=u.interpolate(1),p=a.x,h=a.y;this.x=p,this.y=h},t.prototype.ellipse=function(t,e,r,n,i,o,s,u){this.dealias();var a=s-o;!0===u&&a>0?a-=2*Math.PI:!1===u&&a<0&&(a+=2*Math.PI);var p=new Au(t,e,r,n,i,o,a);this.curves.push(p);var h=p.interpolate(1),f=h.x,c=h.y;this.x=f,this.y=c},t.prototype.rect=function(t,e,r,n){this.dealias(),this.curves.push(new Ou(t,e,t+r,e),new Ou(t+r,e,t+r,e+n),new Ou(t+r,e+n,t,e+n),new Ou(t,e+n,t,e)),this.x=t,this.y=e},t.prototype.bind=function(){return this.aliased=!0,new Iu(this.curves,this.closed)},t}(),Vu=function(t){function e(e,r,n,i,o,s,u,a){var p=t.call(this)||this;return p.x0Parser=e,p.y0Parser=r,p.xParser=n,p.yParser=i,p.curveParser=o,p.curves=s,p.command=u,p.step=a,p}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.x0Parser,this.y0Parser,this.xParser,this.yParser,this.curveParser,this.curves,this.command,this.step)},e.parse=function(t,r,n,i,o,s,u,a,p){void 0===p&&(p=1);var h=0;if(1===p){for(;t.isCont()&&(h=t.head(),rt.isSpace(h));)t=t.step();if(t.isCont()){if(77!==h&&109!==h)return bt.error(ot.expected("moveto",t));t=t.step(),a=h,p=2}else if(!t.isEmpty())return bt.error(ot.unexpected(t))}if(2===p){if(void 0===r){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(r=it.parseDecimal(t))}else r=r.feed(t);if(void 0!==r)if(r.isDone())i=r,p=3;else if(r.isError())return r.asError()}if(3===p){for(;t.isCont()&&(h=t.head(),rt.isSpace(h));)t=t.step();t.isCont()?(44===h&&(t=t.step()),p=4):t.isEmpty()||(p=4)}if(4===p){if(void 0===n){for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();t.isEmpty()||(n=it.parseDecimal(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())o=n,p=5;else if(n.isError())return n.asError()}for(;;){if(5===p){if(void 0===s){for(;t.isCont()&&(h=t.head(),rt.isSpace(h));)t=t.step();if(t.isCont()){var f=void 0!==u&&0!==u.length?u[u.length-1]:null;switch(h){case 76:case 108:case 72:case 104:case 86:case 118:s=Eu.parse(t,i,o),a=h;break;case 81:case 113:s=Su.parse(t,i,o),a=h;break;case 84:if(f instanceof Pu){var c=f.x2-f.x1,l=f.y2-f.y1,d=i.bind()+c,y=o.bind()+l;s=Su.parse(t,i,o,bt.done(d),bt.done(y))}else s=Su.parse(t,i,o,i,o);a=h;break;case 116:if(f instanceof Pu){c=f.x2-f.x1,l=f.y2-f.y1;s=Su.parse(t,i,o,bt.done(c),bt.done(l))}else s=Su.parse(t,i,o,bt.done(0),bt.done(0));a=h;break;case 67:case 99:s=Mu.parse(t,i,o),a=h;break;case 83:if(f instanceof ku){c=f.x3-f.x2,l=f.y3-f.y2,d=i.bind()+c,y=o.bind()+l;s=Mu.parse(t,i,o,bt.done(d),bt.done(y))}else s=Mu.parse(t,i,o,i,o);a=h;break;case 115:if(f instanceof ku){c=f.x3-f.x2,l=f.y3-f.y2;s=Mu.parse(t,i,o,bt.done(c),bt.done(l))}else s=Mu.parse(t,i,o,bt.done(0),bt.done(0));a=h;break;case 65:case 97:s=Du.parse(t,i,o),a=h;break;case 90:case 122:return t=t.step(),void 0===u&&(u=[]),u.push(new Ou(i.bind(),o.bind(),r.bind(),n.bind())),bt.done(new Iu(u,!0));case 44:t=t.step();case 43:case 45:case 46:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:switch(a){case 77:case 109:case 76:case 108:case 72:case 104:case 86:case 118:s=Eu.parseRest(t,a,i,o);break;case 81:case 113:s=Su.parseRest(t,a,i,o);break;case 84:if(f instanceof Pu){c=f.x2-f.x1,l=f.y2-f.y1,d=i.bind()+c,y=o.bind()+l;s=Su.parseRest(t,a,i,o,bt.done(d),bt.done(y))}else s=Su.parseRest(t,a,i,o,i,o);break;case 116:if(f instanceof Pu){c=f.x2-f.x1,l=f.y2-f.y1;s=Su.parseRest(t,a,i,o,bt.done(c),bt.done(l))}else s=Su.parseRest(t,a,i,o,bt.done(0),bt.done(0));break;case 67:case 99:s=Mu.parseRest(t,a,i,o);break;case 83:if(f instanceof ku){c=f.x3-f.x2,l=f.y3-f.y2,d=i.bind()+c,y=o.bind()+l;s=Mu.parseRest(t,a,i,o,bt.done(d),bt.done(y))}else s=Mu.parseRest(t,a,i,o,i,o);break;case 115:if(f instanceof ku){c=f.x3-f.x2,l=f.y3-f.y2;s=Mu.parseRest(t,a,i,o,bt.done(c),bt.done(l))}else s=Mu.parseRest(t,a,i,o,bt.done(0),bt.done(0));break;case 65:case 97:s=Du.parseRest(t,a,i,o);break;default:return void 0!==u?bt.done(new Iu(u,!1)):bt.done(Iu.empty())}break;default:return void 0!==u?bt.done(new Iu(u,!1)):bt.done(Iu.empty())}}else if(!t.isEmpty())return void 0!==u?bt.done(new Iu(u,!1)):bt.done(Iu.empty())}else s=s.feed(t);if(void 0!==s){if(s.isDone()){var v=s.bind();s=void 0,void 0===u&&(u=[]),u.push(v),i=bt.done(v.interpolateX(1)),o=bt.done(v.interpolateY(1));continue}if(s.isError())return s.asError()}}break}return new e(r,n,i,o,s,u,a,p)},e}(bt),ju=function(t){function e(e){var r=t.call(this)||this;return r.splines=e,r.boundingBox=null,r.pathString=void 0,r}return P(e,t),e.prototype.isDefined=function(){return 0!==this.splines.length},Object.defineProperty(e.prototype,"xMin",{get:function(){return this.bounds.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this.bounds.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return this.bounds.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return this.bounds.yMax},enumerable:!1,configurable:!0}),e.prototype.interpolateX=function(t){var e=this.splines,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateX(o)}return NaN},e.prototype.interpolateY=function(t){var e=this.splines,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateY(o)}return NaN},e.prototype.interpolate=function(t){var e=this.splines,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolate(o)}return new mu(NaN,NaN)},e.prototype.contains=function(t,e){return!1},e.prototype.intersects=function(t){return!1},e.prototype.split=function(t){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=r[o].split(s),a=u[0],p=u[1],h=new Array(o+1),f=new Array(n-o),c=0;c<o;c+=1)h[c]=r[c];h[o]=a,f[0]=p;for(c=o+1;c<n;c+=1)f[c-o]=r[c];return[new e(h),new e(f)]}return[e.empty(),e.empty()]},e.prototype.subdivide=function(t){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=new Array(n),a=0;a<o;a+=1)u[a]=r[a];u[o]=r[o].subdivide(s);for(a=o+1;a<n;a+=1)u[a]=r[a];return new e(u)}return e.empty()},e.prototype.transform=function(t){var r=this.splines,n=r.length;if(n>0){for(var i=new Array(n),o=0;o<n;o+=1)i[o]=r[o].transform(t);return new e(i)}return e.empty()},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this.boundingBox;if(null===t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=this.splines,s=0,u=o.length;s<u;s+=1){var a=o[s];e=Math.min(e,a.xMin),r=Math.min(r,a.yMin),n=Math.max(a.xMax,n),i=Math.max(a.yMax,i)}t=new Nu(e,r,n,i),this.boundingBox=t}return t},enumerable:!1,configurable:!0}),e.prototype.draw=function(t){for(var e=this.splines,r=0,n=e.length;r<n;r+=1)e[r].draw(t)},e.prototype.transformDraw=function(t,e){for(var r=this.splines,n=0,i=r.length;n<i;n+=1)r[n].transformDraw(t,e)},e.prototype.writePath=function(t){var e=this.splines,r=e.length;if(t.settings===W.standard())for(var n=0;n<r;n+=1)t=t.write(e[n].toPathString());else for(n=0;n<r;n+=1)t=e[n].writePath(t);return t},e.prototype.toPathString=function(t){var e;if(void 0!==t||void 0===(e=this.pathString)){var r=rt.stringOutput(t);this.writePath(r),e=r.bind(),void 0===t&&(this.pathString=e)}return e},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&C.equivalent(this.splines,t.splines,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&C.equal(this.splines,t.splines)},e.prototype.debug=function(t){var e=this.splines,r=e.length;if(t=t.write("R2Path").write(46),0===r)t=t.write("empty").write(40);else if(1===r){var n=e[0];t=t.write(n.closed?"closed":"open").write(40);var i=n.curves,o=i.length;if(0!==o){t=t.debug(i[0]);for(var s=1;s<o;s+=1)t=t.write(", ").debug(i[s])}}else{t=(t=t.write("of").write(40)).debug(e[0]);for(s=1;s<r;s+=1)t=t.write(", ").debug(e[s])}return t=t.write(41)},e.prototype.toAttributeString=function(){return this.toPathString()},e.prototype.toString=function(){return nt.debug(this)},e.empty=function(){return new e([])},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e(t)},e.open=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e([new Iu(t,!1)])},e.closed=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e([new Iu(t,!0)])},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.builder=function(){return new qu},e.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=Ru.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},e}(vu),qu=function(){function t(){this.splines=[],this.builder=null}return t.prototype.moveTo=function(t,e){var r=this.builder;if(null!==r){var n=r.bind();n.isDefined()&&this.splines.push(n)}r=new Tu,this.builder=r,r.moveTo(t,e)},t.prototype.closePath=function(){var t=this.builder;if(null===t)throw new Error;t.closePath()},t.prototype.lineTo=function(t,e){var r=this.builder;if(null===r)throw new Error;r.lineTo(t,e)},t.prototype.quadraticCurveTo=function(t,e,r,n){var i=this.builder;if(null===i)throw new Error;i.quadraticCurveTo(t,e,r,n)},t.prototype.bezierCurveTo=function(t,e,r,n,i,o){var s=this.builder;if(null===s)throw new Error;s.bezierCurveTo(t,e,r,n,i,o)},t.prototype.arcTo=function(t,e,r,n,i){var o=this.builder;if(null===o)throw new Error;o.arcTo(t,e,r,n,i)},t.prototype.arc=function(t,e,r,n,i,o){var s=this.builder;if(null===s)throw new Error;s.arc(t,e,r,n,i,o)},t.prototype.ellipse=function(t,e,r,n,i,o,s,u){var a=this.builder;if(null===a)throw new Error;a.ellipse(t,e,r,n,i,o,s,u)},t.prototype.rect=function(t,e,r,n){var i=this.builder;if(null===i)throw new Error;i.rect(t,e,r,n)},t.prototype.bind=function(){var t=this.splines.slice(0),e=this.builder;if(null!==e){var r=e.bind();r.isDefined()&&t.push(r)}return new ju(t)},t}(),Ru=function(t){function e(e,r,n){var i=t.call(this)||this;return i.splineParser=e,i.splines=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.splineParser,this.splines,this.step)},e.parse=function(t,r,n,i){void 0===i&&(i=1);for(var o=0;;){if(1===i){if(void 0===r){for(;t.isCont()&&(o=t.head(),rt.isSpace(o));)t=t.step();if(t.isCont())switch(o){case 77:case 109:r=Vu.parse(t);break;case 110:i=2;break;default:return void 0!==n?bt.done(new ju(n)):bt.done(ju.empty())}else if(!t.isEmpty())return void 0!==n?bt.done(new ju(n)):bt.done(ju.empty())}else r=r.feed(t);if(void 0!==r){if(r.isDone()){var s=r.bind();r=void 0,s.isDefined()&&(void 0===n&&(n=[]),n.push(s));continue}if(r.isError())return r.asError()}}break}if(i>=2&&i<=5)for(;;){if(t.isCont()){if(t.head()==="none".charCodeAt(i-2)){if(t=t.step(),i<5){i+=1;continue}return bt.done(ju.empty())}return bt.error(ot.expected("none",t))}if(!t.isEmpty())return bt.error(ot.unexpected(t));break}return new e(r,n,i)},e}(bt),Uu=function(t){function e(e,r,n){var i=t.call(this)||this;return i.cx=e,i.cy=r,i.r=n,i}return P(e,t),e.prototype.isDefined=function(){return isFinite(this.cx)&&isFinite(this.cy)&&isFinite(this.r)},Object.defineProperty(e.prototype,"xMin",{get:function(){return this.cx-this.r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMin",{get:function(){return this.cy-this.r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xMax",{get:function(){return this.cx+this.r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yMax",{get:function(){return this.cy+this.r},enumerable:!1,configurable:!0}),e.prototype.contains=function(t,r){if("number"==typeof t){var n=t-this.cx,i=r-this.cy;return n*n+i*i<=this.r*this.r}return(t=vu.fromAny(t))instanceof mu?this.containsPoint(t):t instanceof Ou?this.containsSegment(t):t instanceof Nu?this.containsBox(t):t instanceof e&&this.containsCircle(t)},e.prototype.containsPoint=function(t){var e=t.x-this.cx,r=t.y-this.cy;return e*e+r*r<=this.r*this.r},e.prototype.containsSegment=function(t){var e=t.x0-this.cx,r=t.y0-this.cy,n=t.x1-this.cx,i=t.y1-this.cy,o=this.r*this.r;return e*e+r*r<=o&&n*n+i*i<=o},e.prototype.containsBox=function(t){var e=t.xMin-this.cx,r=t.yMin-this.cy,n=t.xMax-this.cx,i=t.yMax-this.cy,o=this.r*this.r;return e*e+r*r<=o&&e*e+i*i<=o&&n*n+r*r<=o&&n*n+i*i<=o},e.prototype.containsCircle=function(t){var e=t.cx-this.cx,r=t.cy-this.cy;return e*e+r*r+t.r*t.r<=this.r*this.r},e.prototype.intersects=function(t){return(t=vu.fromAny(t))instanceof mu?this.intersectsPoint(t):t instanceof Ou?this.intersectsSegment(t):t instanceof Nu?this.intersectsBox(t):t instanceof e?this.intersectsCircle(t):t.intersects(this)},e.prototype.intersectsPoint=function(t){var e=t.x-this.cx,r=t.y-this.cy;return e*e+r*r<=this.r*this.r},e.prototype.intersectsSegment=function(t){var e=this.cx,r=this.cy,n=this.r,i=t.x0,o=t.y0,s=t.x1,u=t.y1,a=s-i,p=u-o,h=Math.sqrt(a*a+p*p),f=a/h,c=p/h,l=(e-i)*c-(r-o)*f;if(l<-n||n<l)return!1;var d=i-e,y=o-r,v=s-e,m=u-r,w=n*n;if(d*d+y*y<=w||v*v+m*m<=w)return!0;var g=f*e+c*r,b=f*i+c*o,x=f*s+c*u;return b<g&&g<=x||x<g&&g<=b},e.prototype.intersectsBox=function(t){var e=(this.cx<t.xMin?t.xMin:t.xMax<this.cx?t.xMax:this.cx)-this.cx,r=(this.cy<t.yMin?t.yMin:t.yMax<this.cy?t.yMax:this.cy)-this.cy;return e*e+r*r<=this.r*this.r},e.prototype.intersectsCircle=function(t){var e=t.cx-this.cx,r=t.cy-this.cy,n=this.r+t.r;return e*e+r*r<=n*n},e.prototype.transform=function(t){var r=t.transformX(this.cx,this.cy),n=t.transformY(this.cx,this.cy),i=t.transformX(this.cx+this.r,this.cy)-r,o=t.transformY(this.cx+this.r,this.cy)-n;return new e(r,n,Math.sqrt(i*i+o*o))},e.prototype.toAny=function(){return{cx:this.cx,cy:this.cy,r:this.r}},e.prototype.interpolateTo=function(t){return t instanceof e?Fu(this,t):null},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(m.equivalent(this.cx,t.cx,r)&&m.equivalent(this.cy,t.cy,r)&&m.equivalent(this.r,t.r,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.cx===t.cx&&this.cy===t.cy&&this.r===t.r)},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(b.hash(e),m.hash(this.cx)),m.hash(this.cy)),m.hash(this.r)))},e.prototype.debug=function(t){return t=t.write("R2Circle").write(46).write("of").write(40).debug(this.cx).write(", ").debug(this.cy).write(", ").debug(this.r).write(41)},e.prototype.toString=function(){return nt.debug(this)},e.of=function(t,r,n){return new e(t,r,n)},e.fromInit=function(t){return new e(t.cx,t.cy,t.r)},e.fromAny=function(t){if(null==t||t instanceof e)return t;if(e.isInit(t))return e.fromInit(t);throw new TypeError(""+t)},e.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.cx&&"number"==typeof e.cy&&"number"==typeof e.r}return!1},e.isAny=function(t){return t instanceof e||e.isInit(t)},e}(vu),Nu=function(t){function r(e,r,n,i){var o=t.call(this)||this;return o.xMin=e,o.yMin=r,o.xMax=n,o.yMax=i,o}return P(r,t),r.prototype.isDefined=function(){return isFinite(this.xMin)&&isFinite(this.yMin)&&isFinite(this.xMax)&&isFinite(this.yMax)},Object.defineProperty(r.prototype,"x",{get:function(){return this.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.xMax-this.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.yMax-this.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.yMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"center",{get:function(){return new mu((this.xMin+this.xMax)/2,(this.yMin+this.yMax)/2)},enumerable:!1,configurable:!0}),r.prototype.contains=function(t,e){return"number"==typeof t?this.xMin<=t&&t<=this.xMax&&this.yMin<=e&&e<=this.yMax:(t=vu.fromAny(t))instanceof vu&&(t instanceof mu?this.containsPoint(t):t instanceof Ou?this.containsSegment(t):t instanceof r?this.containsBox(t):t instanceof Uu?this.containsCircle(t):this.xMin<=t.xMin&&t.xMax<=this.xMax&&this.yMin<=t.yMin&&t.yMax<=this.yMax)},r.prototype.containsPoint=function(t){return this.xMin<=t.x&&t.x<=this.xMax&&this.yMin<=t.y&&t.y<=this.yMax},r.prototype.containsSegment=function(t){return this.xMin<=t.x0&&t.x0<=this.xMax&&this.yMin<=t.y0&&t.y0<=this.yMax&&this.xMin<=t.x1&&t.x1<=this.xMax&&this.yMin<=t.y1&&t.y1<=this.yMax},r.prototype.containsBox=function(t){return this.xMin<=t.xMin&&t.xMax<=this.xMax&&this.yMin<=t.yMin&&t.yMax<=this.yMax},r.prototype.containsCircle=function(t){return this.xMin<=t.cx-t.r&&t.cx+t.r<=this.xMax&&this.yMin<=t.cy-t.r&&t.cy+t.r<=this.yMax},r.prototype.intersects=function(t){return(t=vu.fromAny(t))instanceof mu?this.intersectsPoint(t):t instanceof Ou?this.intersectsSegment(t):t instanceof r?this.intersectsBox(t):t instanceof Uu?this.intersectsCircle(t):t.intersects(this)},r.prototype.intersectsPoint=function(t){return this.xMin<=t.x&&t.x<=this.xMax&&this.yMin<=t.y&&t.y<=this.yMax},r.prototype.intersectsSegment=function(t){var e=this.xMin,n=this.yMin,i=this.xMax,o=this.yMax,s=t.x0,u=t.y0,a=t.x1,p=t.y1;return!(s<e&&a<e||s>i&&a>i||u<n&&p<n||u>o&&p>o)&&(s>e&&s<i&&u>n&&u<o||!!(r.intersectsSegment(s-e,a-e,s,u,a,p)&&r.hitY>n&&r.hitY<o||r.intersectsSegment(u-n,p-n,s,u,a,p)&&r.hitX>e&&r.hitX<i||r.intersectsSegment(s-i,a-i,s,u,a,p)&&r.hitY>n&&r.hitY<o||r.intersectsSegment(u-o,p-o,s,u,a,p)&&r.hitX>e&&r.hitX<i))},r.intersectsSegment=function(t,e,n,i,o,s){if(t!==e||t*e<0){var u=-t/(e-t);return r.hitX=n+(o-n)*u,r.hitY=i+(s-i)*u,!0}return!1},r.prototype.intersectsBox=function(t){return this.xMin<=t.xMax&&t.xMin<=this.xMax&&this.yMin<=t.yMax&&t.yMin<=this.yMax},r.prototype.intersectsCircle=function(t){var e=(t.cx<this.xMin?this.xMin:this.xMax<t.cx?this.xMax:t.cx)-t.cx,r=(t.cy<this.yMin?this.yMin:this.yMax<t.cy?this.yMax:t.cy)-t.cy;return e*e+r*r<=t.r*t.r},r.prototype.union=function(e){return t.prototype.union.call(this,e)},r.prototype.transform=function(t){return new r(t.transformX(this.xMin,this.yMin),t.transformY(this.xMin,this.yMin),t.transformX(this.xMax,this.yMax),t.transformY(this.xMax,this.yMax))},Object.defineProperty(r.prototype,"bounds",{get:function(){return this},enumerable:!1,configurable:!0}),r.prototype.toAny=function(){return{xMin:this.xMin,yMin:this.yMin,xMax:this.xMax,yMax:this.yMax}},r.prototype.interpolateTo=function(t){return t instanceof r?zu(this,t):null},r.prototype.equivalentTo=function(t,e){return this===t||t instanceof r&&(m.equivalent(this.xMin,t.xMin,e)&&m.equivalent(this.yMin,t.yMin,e)&&m.equivalent(this.xMax,t.xMax,e)&&m.equivalent(this.yMax,t.yMax,e))},r.prototype.equals=function(t){return this===t||t instanceof r&&(this.xMin===t.xMin&&this.yMin===t.yMin&&this.xMax===t.xMax&&this.yMax===t.yMax)},r.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(b.hash(r),m.hash(this.xMin)),m.hash(this.yMin)),m.hash(this.xMax)),m.hash(this.yMax)))},r.prototype.debug=function(t){return t=t.write("R2Box").write(46).write("of").write(40).debug(this.xMin).write(", ").debug(this.yMin).write(", ").debug(this.xMax).write(", ").debug(this.yMax).write(41)},r.prototype.toString=function(){return nt.debug(this)},r.undefined=function(){return new r(1/0,1/0,-1/0,-1/0)},r.of=function(t,e,n,i){return void 0===n&&(n=t),void 0===i&&(i=e),new r(t,e,n,i)},r.fromInit=function(t){return new r(t.xMin,t.yMin,t.xMax,t.yMax)},r.fromAny=function(t){if(null==t||t instanceof r)return t;if(r.isInit(t))return r.fromInit(t);throw new TypeError(""+t)},r.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.xMin&&"number"==typeof e.yMin&&"number"==typeof e.xMax&&"number"==typeof e.yMax}return!1},r.isAny=function(t){return t instanceof r||r.isInit(t)},r.hitX=0,r.hitY=0,S([e],r,"undefined",null),r}(vu),zu=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.xMin+t*(n.xMin-e.xMin),o=e.yMin+t*(n.yMin-e.yMin),s=e.xMax+t*(n.xMax-e.xMax),u=e.yMax+t*(n.yMax-e.yMax);return new Nu(i,o,s,u)};return Object.setPrototypeOf(r,zu.prototype),r[0]=t,r[1]=e,r};zu.prototype=Object.create($t.prototype);var Fu=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.cx+t*(n.cx-e.cx),o=e.cy+t*(n.cy-e.cy),s=e.r+t*(n.r-e.r);return new Uu(i,o,s)};return Object.setPrototypeOf(r,Fu.prototype),r[0]=t,r[1]=e,r};Fu.prototype=Object.create($t.prototype);var Lu=function(t){function r(e){var r=t.call(this)||this;return r.shapes=e,r.boundingBox=null,r}return P(r,t),r.prototype.isDefined=function(){return 0!==this.shapes.length},Object.defineProperty(r.prototype,"xMin",{get:function(){return this.bounds.xMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"yMin",{get:function(){return this.bounds.yMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"xMax",{get:function(){return this.bounds.xMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"yMax",{get:function(){return this.bounds.yMax},enumerable:!1,configurable:!0}),r.prototype.contains=function(t,e){return!1},r.prototype.intersects=function(t){return!1},r.prototype.transform=function(t){var e=this.shapes,n=e.length;if(n>0){for(var i=new Array(n),o=0;o<n;o+=1)i[o]=e[o].transform(t);return new r(i)}return r.empty()},Object.defineProperty(r.prototype,"bounds",{get:function(){var t=this.boundingBox;if(null===t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=this.shapes,s=0,u=o.length;s<u;s+=1){var a=o[s];e=Math.min(e,a.xMin),r=Math.min(r,a.yMin),n=Math.max(a.xMax,n),i=Math.max(a.yMax,i)}t=new Nu(e,r,n,i),this.boundingBox=t}return t},enumerable:!1,configurable:!0}),r.prototype.equivalentTo=function(t,e){return this===t||t instanceof r&&C.equivalent(this.shapes,t.shapes,e)},r.prototype.equals=function(t){return this===t||t instanceof r&&C.equal(this.shapes,t.shapes)},r.prototype.debug=function(t){var e=this.shapes,r=e.length;if(t=t.write("R2Group").write(46),0===r)t=t.write("empty").write(40);else{t=(t=t.write("of").write(40)).debug(e[0]);for(var n=1;n<r;n+=1)t=t.write(", ").debug(e[n])}return t=t.write(41)},r.prototype.toString=function(){return nt.debug(this)},r.empty=function(){return new r(C.empty)},r.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new r(t)},S([e],r,"empty",null),r}(vu),Ku=function(){function t(){}return t.prototype.translate=function(e,r){return this.transform(t.translate(e,r))},t.prototype.translateX=function(e){return this.transform(t.translateX(e))},t.prototype.translateY=function(e){return this.transform(t.translateY(e))},t.prototype.scale=function(e,r){return this.transform(t.scale(e,r))},t.prototype.scaleX=function(e){return this.transform(t.scaleX(e))},t.prototype.scaleY=function(e){return this.transform(t.scaleY(e))},t.prototype.rotate=function(e){return this.transform(t.rotate(e))},t.prototype.skew=function(e,r){return this.transform(t.skew(e,r))},t.prototype.skewX=function(e){return this.transform(t.skewX(e))},t.prototype.skewY=function(e){return this.transform(t.skewY(e))},t.prototype.toMatrix=function(){return this.toAffine().toMatrix()},t.prototype.toCssTransformComponent=function(){return null},t.prototype.toCssValue=function(){if("undefined"!=typeof CSSTransformValue){var t=this.toCssTransformComponent();if(null!==t)return new CSSTransformValue([t])}return null},t.prototype.interpolateTo=function(e){return e instanceof t?oa(this.toAffine(),e.toAffine()):null},t.prototype.toAttributeString=function(){return this.toString()},t.identity=function(){return new Hu},t.translate=function(t,e){return t=Zs.fromAny(t),e=Zs.fromAny(e),new Xu(t,e)},t.translateX=function(t){return t=Zs.fromAny(t),new Xu(t,Js.zero())},t.translateY=function(t){return t=Zs.fromAny(t),new Xu(Js.zero(),t)},t.scale=function(t,e){return new _u(t,e)},t.scaleX=function(t){return new _u(t,1)},t.scaleY=function(t){return new _u(1,t)},t.rotate=function(t){return t=su.fromAny(t,"deg"),new Ju(t)},t.skew=function(t,e){return t=su.fromAny(t,"deg"),e=su.fromAny(e,"deg"),new ea(t,e)},t.skewX=function(t){return t=su.fromAny(t,"deg"),new ea(t,uu.zero())},t.skewY=function(t){return t=su.fromAny(t,"deg"),new ea(uu.zero(),t)},t.affine=function(t,e,r,n,i,o){return void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=0),new ia(t,e,r,n,i,o)},t.list=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=[],i=0;i<e.length;i+=1){var o=t.fromAny(e[i]);o instanceof ua?n.push.apply(n,o.transforms):o instanceof Hu||n.push(o)}return new ua(n)},t.fromCssValue=function(e){if(e instanceof CSSTransformValue)return t.fromCssTransform(e);throw new TypeError(""+e)},t.fromCssTransform=function(e){var r=e.length;if(1===r)return t.fromCssTransformComponent(e[0]);for(var n=new Array(r),i=0;i<r;i+=1)n[i]=t.fromCssTransformComponent(e[i]);return new ua(n)},t.fromCssTransformComponent=function(t){if(t instanceof CSSTranslate)return Xu.fromCssTransformComponent(t);if(t instanceof CSSRotate)return Ju.fromCssTransformComponent(t);if(t instanceof CSSScale)return _u.fromCssTransformComponent(t);if(t instanceof CSSSkew)return ea.fromCssTransformComponent(t);if(t instanceof CSSMatrixComponent)return ia.fromCssTransformComponent(t);throw new TypeError(""+t)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.fromValue=function(t){switch(t.tag){case"identity":return Hu.fromValue(t);case"translate":return Xu.fromValue(t);case"scale":return _u.fromValue(t);case"rotate":return Ju.fromValue(t);case"skew":return ea.fromValue(t);case"matrix":return ia.fromValue(t);default:return ua.fromValue(t)}},t.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=pa.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},t.form=function(){return new Bu(t.identity())},t.isAny=function(e){return e instanceof t||"string"==typeof e},S([e],t,"identity",null),S([e],t,"form",null),t}(),Bu=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t){return(t=Ku.fromAny(t)).toValue()},e.prototype.cast=function(t){var e=t.toValue();try{if(e instanceof or){var r=Ku.fromValue(e);return null!==r?r:void 0}var n=e.stringValue(void 0);if(void 0!==n)return Ku.parse(n)}catch(t){}},e}(Sn),Wu=function(t){function e(e){var r=t.call(this)||this;return r.identOutput=e,r}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput)},e.parse=function(t,r){var n=0;for(r=r||rt.stringOutput();t.isCont()&&(n=t.head(),rt.isAlpha(n)||rt.isDigit(n)||45===n);)t=t.step(),r.write(n);if(!t.isEmpty()){var i=r.bind();switch(i){case"translate3d":case"translateX":case"translateY":case"translate":return Gu.parseRest(t,r);case"scaleX":case"scaleY":case"scale":return Zu.parseRest(t,r);case"rotate":return ta.parseRest(t,r);case"skewX":case"skewY":case"skew":return na.parseRest(t,r);case"matrix":return sa.parseRest(t,r);case"none":return bt.done(Ku.identity());default:return bt.error(ot.message("unknown transform function: "+i,t))}}return new e(r)},e}(bt),Hu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.transform=function(t,e){return 1===arguments.length?t:new mu(t,e)},e.prototype.transformX=function(t,e){return t},e.prototype.transformY=function(t,e){return e},e.prototype.inverse=function(){return this},e.prototype.toAffine=function(){return new ia(1,0,0,1,0,0)},e.prototype.toCssValue=function(){return new CSSKeywordValue("identity")},e.prototype.toValue=function(){return or.create(1).attr("identity")},e.prototype.interpolateTo=function(r){return r instanceof e?ee(this):t.prototype.interpolateTo.call(this,r)},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equivalentTo=function(t,r){return t instanceof e},e.prototype.equals=function(t){return t instanceof e},e.prototype.hashCode=function(){return b.hash(e)},e.prototype.debug=function(t){return t=t.write("Transform").write(46).write("identity").write(40).write(41)},e.prototype.toString=function(){return"none"},e.fromValue=function(t){return"identity"===t.tag?Ku.identity():null},e}(Ku),Xu=function(t){function e(e,r){var n=t.call(this)||this;return n.x=e,n.y=r,n.stringValue=void 0,n}return P(e,t),e.prototype.transform=function(t,r){return 1===arguments.length?t instanceof Hu?this:t instanceof e?new e(this.x.plus(t.x),this.y.plus(t.y)):Ku.list(this,t):new mu(this.x.pxValue()+t,this.y.pxValue()+r)},e.prototype.transformX=function(t,e){return this.x.pxValue()+t},e.prototype.transformY=function(t,e){return this.y.pxValue()+e},e.prototype.inverse=function(){return new e(this.x.negative(),this.y.negative())},e.prototype.toAffine=function(){return new ia(1,0,0,1,this.x.pxValue(),this.y.pxValue())},e.prototype.toCssTransformComponent=function(){if("undefined"!=typeof CSSTranslate){var t=this.x.toCssValue(),e=this.y.toCssValue();return new CSSTranslate(t,e)}return null},e.prototype.toValue=function(){return or.create(1).attr("translate",or.create(2).slot("x",this.x.toValue()).slot("y",this.y.toValue()))},e.prototype.interpolateTo=function(r){return r instanceof e?Yu(this,r):t.prototype.interpolateTo.call(this,r)},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equivalentTo=function(t,r){return t instanceof e&&(this.x.equivalentTo(t.x,r)&&this.y.equivalentTo(t.y,r))},e.prototype.equals=function(t){return t instanceof e&&(this.x.equals(t.x)&&this.y.equals(t.y))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.x.hashCode()),this.y.hashCode()))},e.prototype.debug=function(t){return t=t.write("Transform").write(46).write("translate"),t=(t=this.x.isDefined()&&!this.y.isDefined()?t.write("X").write(40).debug(this.x):!this.x.isDefined()&&this.y.isDefined()?t.write("Y").write(40).debug(this.y):t.write(40).debug(this.x).write(", ").debug(this.y)).write(41)},e.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=this.x.isDefined()&&!this.y.isDefined()?"translate("+this.x+",0)":!this.x.isDefined()&&this.y.isDefined()?"translate(0,"+this.y+")":"translate("+this.x+","+this.y+")",this.stringValue=t),t},e.prototype.toAttributeString=function(){return this.x.isDefined()&&!this.y.isDefined()?"translate("+this.x.pxValue()+",0)":!this.x.isDefined()&&this.y.isDefined()?"translate(0,"+this.y.pxValue()+")":"translate("+this.x.pxValue()+","+this.y.pxValue()+")"},e.fromCssTransformComponent=function(t){return new e("number"==typeof t.x?Zs.px(t.x):Zs.fromCssValue(t.x),"number"==typeof t.y?Zs.px(t.y):Zs.fromCssValue(t.y))},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("translate");if(r.isDefined()){var n=Zs.zero(),i=Zs.zero();return r.forEach((function(t,e){var r=t.key.stringValue();void 0!==r?"x"===r?n=t.toValue().cast(Zs.form(),n):"y"===r&&(i=t.toValue().cast(Zs.form(),i)):t instanceof ir&&(0===e?n=t.cast(Zs.form(),n):1===e&&(i=t.cast(Zs.form(),i)))}),this),new e(n,i)}return null},e.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=Gu.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},e}(Ku),Yu=function(t,e){var r=function(t){var e=r[0],n=r[1],i=Zs.create(e.x.value+t*(n.x.value-e.x.value),n.x.units),o=Zs.create(e.y.value+t*(n.y.value-e.y.value),n.y.units);return new Xu(i,o)};return Object.setPrototypeOf(r,Yu.prototype),r[0]=t.x.units===e.x.units&&t.y.units===e.y.units?t:new Xu(t.x.to(e.x.units),t.y.to(e.y.units)),r[1]=e,r};Yu.prototype=Object.create($t.prototype);var Gu=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.identOutput=e,s.xParser=r,s.yParser=n,s.zParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.xParser,this.yParser,this.zParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===s&&(s=1);var u=0;if(1===s){for(r=r||rt.stringOutput();t.isCont()&&(u=t.head(),rt.isAlpha(u)||rt.isDigit(u)||45===u);)t=t.step(),r.write(u);if(!t.isEmpty())switch(a=r.bind()){case"translate3d":case"translateX":case"translateY":case"translate":s=2;break;default:return bt.error(ot.message("unknown transform function: "+a,t))}}if(2===s){for(;t.isCont()&&(u=t.head(),rt.isSpace(u));)t=t.step();if(t.isCont()&&40===u)t.step(),s=3;else if(!t.isEmpty())return bt.error(ot.expected("(",t))}if(3===s){if(void 0===n){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(n=ou.parse(t,"px"))}else n=n.feed(t);if(void 0!==n)if(n.isDone())s=4;else if(n.isError())return n.asError()}if(4===s){for(;t.isCont()&&rt.isSpace(t.head());)t.step();if(t.isCont())if(41===(u=t.head())){switch(t.step(),a=r.bind()){case"translateX":return bt.done(new Xu(n.bind(),Js.zero()));case"translateY":return bt.done(new Xu(Js.zero(),n.bind()));default:return bt.error(ot.message("unknown transform function: "+a,t))}}else{if(44!==u)return bt.error(ot.expected(",",t));t.step(),s=5}else if(t.isDone())return bt.error(ot.unexpected(t))}if(5===s){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(i=ou.parse(t,"px"))}else i=i.feed(t);if(void 0!==i)if(i.isDone())s=6;else if(i.isError())return i.asError()}if(6===s){for(;t.isCont()&&rt.isSpace(t.head());)t.step();if(t.isCont()){if(41===(u=t.head()))return t.step(),"translate"===(a=r.bind())?bt.done(new Xu(n.bind(),i.bind())):bt.error(ot.message("unknown transform function: "+a,t));if(44!==u)return bt.error(ot.expected(",",t));t.step(),s=7}else if(t.isDone())return bt.error(ot.unexpected(t))}if(7===s){if(void 0===o){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(o=ou.parse(t,"px"))}else o=o.feed(t);if(void 0!==o)if(o.isDone())s=8;else if(o.isError())return o.asError()}if(8===s){for(;t.isCont()&&rt.isSpace(t.head());)t.step();var a;if(t.isCont()&&41===t.head())return t.step(),"translate3d"===(a=r.bind())&&0===o.bind().value?bt.done(new Xu(n.bind(),i.bind())):bt.error(ot.message("unknown transform function: "+a,t));if(!t.isEmpty())return bt.error(ot.expected(")",t))}return new e(r,n,i,o,s)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,void 0,2)},e}(bt),_u=function(t){function e(e,r){var n=t.call(this)||this;return n.x=e,n.y=r,n.stringValue=void 0,n}return P(e,t),e.prototype.transform=function(t,e){return 1===arguments.length?t instanceof Hu?this:Ku.list(this,t):new mu(this.x*t,this.y*e)},e.prototype.transformX=function(t,e){return this.x*t},e.prototype.transformY=function(t,e){return this.y*e},e.prototype.inverse=function(){return new e(1/(this.x||1),1/(this.y||1))},e.prototype.toAffine=function(){return new ia(this.x,0,0,this.y,0,0)},e.prototype.toCssTransformComponent=function(){return"undefined"!=typeof CSSTranslate?new CSSScale(this.x,this.y):null},e.prototype.toValue=function(){return or.create(1).attr("scale",or.create(2).slot("x",this.x).slot("y",this.y))},e.prototype.interpolateTo=function(r){return r instanceof e?Qu(this,r):t.prototype.interpolateTo.call(this,r)},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equivalentTo=function(t,r){return t instanceof e&&(m.equivalent(this.x,t.x,r)&&m.equivalent(this.y,t.y,r))},e.prototype.equals=function(t){return t instanceof e&&(this.x===t.x&&this.y===t.y)},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),m.hash(this.x)),m.hash(this.y)))},e.prototype.debug=function(t){return t=t.write("Transform").write(46).write("scale"),t=(t=0!==this.x&&0===this.y?t.write("X").write(40).debug(this.x):0===this.x&&0!==this.y?t.write("Y").write(40).debug(this.y):t.write(40).debug(this.x).write(", ").debug(this.y)).write(41)},e.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=0!==this.x&&0===this.y?"scaleX("+this.x+")":0===this.x&&0!==this.y?"scaleY("+this.y+")":"scale("+this.x+","+this.y+")",this.stringValue=t),t},e.fromCssTransformComponent=function(t){return new e("number"==typeof t.x?t.x:t.x.to("number").value,"number"==typeof t.y?t.y:t.y.to("number").value)},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("scale");if(r.isDefined()){var n=0,i=0;return r.forEach((function(t,e){var r=t.key.stringValue();void 0!==r?"x"===r?n=t.toValue().numberValue(n):"y"===r&&(i=t.toValue().numberValue(i)):t instanceof ir&&(0===e?n=t.numberValue(n):1===e&&(i=t.numberValue(i)))}),this),new e(n,i)}return null},e.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=Zu.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},e}(Ku),Qu=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.x+t*(n.x-e.x),o=e.y+t*(n.y-e.y);return new _u(i,o)};return Object.setPrototypeOf(r,Qu.prototype),r[0]=t,r[1]=e,r};Qu.prototype=Object.create($t.prototype);var Zu=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.identOutput=e,o.xParser=r,o.yParser=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o){for(r=r||rt.stringOutput();t.isCont()&&(s=t.head(),rt.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty())switch(u=r.bind()){case"scaleX":case"scaleY":case"scale":o=2;break;default:return bt.error(ot.message("unknown transform function: "+u,t))}}if(2===o){for(;t.isCont()&&(s=t.head(),rt.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return bt.error(ot.expected("(",t))}if(3===o){if(void 0===n){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(n=it.parseNumber(t))}else n=n.feed(t);if(void 0!==n)if(n.isDone())o=4;else if(n.isError())return n.asError()}if(4===o){for(;t.isCont()&&rt.isSpace(t.head());)t.step();if(t.isCont())if(41===(s=t.head())){switch(t.step(),u=r.bind()){case"scaleX":return bt.done(new _u(n.bind(),1));case"scaleY":return bt.done(new _u(1,n.bind()));default:return bt.error(ot.message("unknown transform function: "+u,t))}}else{if(44!==s)return bt.error(ot.expected(",",t));t.step(),o=5}else if(t.isDone())return bt.error(ot.unexpected(t))}if(5===o){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(i=it.parseNumber(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())o=6;else if(i.isError())return i.asError()}if(6===o){for(;t.isCont()&&rt.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())return t.step(),"scale"===(u=r.bind())?bt.done(new _u(n.bind(),i.bind())):bt.error(ot.message("unknown transform function: "+u,t));if(!t.isEmpty())return bt.error(ot.expected(")",t))}return new e(r,n,i,o)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,2)},e}(bt),Ju=function(t){function e(e){var r=t.call(this)||this;return r.angle=e,r.stringValue=void 0,r}return P(e,t),e.prototype.transform=function(t,e){if(1===arguments.length)return t instanceof Hu?this:Ku.list(this,t);var r=this.angle.radValue(),n=Math.cos(r),i=Math.sin(r);return new mu(t*n-e*i,t*i+e*n)},e.prototype.transformX=function(t,e){var r=this.angle.radValue();return t*Math.cos(r)-e*Math.sin(r)},e.prototype.transformY=function(t,e){var r=this.angle.radValue();return t*Math.sin(r)+e*Math.cos(r)},e.prototype.inverse=function(){return new e(this.angle.negative())},e.prototype.toAffine=function(){var t=this.angle.radValue();return new ia(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0)},e.prototype.toCssTransformComponent=function(){if("undefined"!=typeof CSSTranslate){var t=this.angle.toCssValue();return new CSSRotate(t)}return null},e.prototype.toValue=function(){return or.create(1).attr("rotate",this.angle.toString())},e.prototype.interpolateTo=function(r){return r instanceof e?$u(this,r):t.prototype.interpolateTo.call(this,r)},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equivalentTo=function(t,r){return t instanceof e&&this.angle.equivalentTo(t.angle,r)},e.prototype.equals=function(t){return t instanceof e&&this.angle.equals(t.angle)},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(e),this.angle.hashCode()))},e.prototype.debug=function(t){return t=t.write("Transform").write(46).write("rotate").write(40).debug(this.angle).write(41)},e.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t="rotate("+this.angle+")",this.stringValue=t),t},e.prototype.toAttributeString=function(){return"rotate("+this.angle.degValue()+")"},e.fromCssTransformComponent=function(t){return new e(su.fromCssValue(t.angle))},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("rotate");if(r.isDefined()){var n=su.zero();return r.forEach((function(t,e){"angle"===t.key.stringValue()?n=t.toValue().cast(su.form(),n):t instanceof ir&&0===e&&(n=t.cast(su.form(),n))}),this),new e(n)}return null},e.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=ta.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},e}(Ku),$u=function(t,e){var r=function(t){var e=r[0],n=r[1],i=su.create(e.angle.value+t*(n.angle.value-e.angle.value),n.angle.units);return new Ju(i)};return Object.setPrototypeOf(r,$u.prototype),r[0]=t.angle.units===e.angle.units?t:new Ju(t.angle.to(e.angle.units)),r[1]=e,r};$u.prototype=Object.create($t.prototype);var ta=function(t){function e(e,r,n){var i=t.call(this)||this;return i.identOutput=e,i.angleParser=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.angleParser,this.step)},e.parse=function(t,r,n,i){void 0===i&&(i=1);var o=0;if(1===i){for(r=r||rt.stringOutput();t.isCont()&&(o=t.head(),rt.isAlpha(o));)t=t.step(),r.write(o);if(!t.isEmpty()){if("rotate"!==(s=r.bind()))return bt.error(ot.message("unknown transform function: "+s,t));i=2}}if(2===i){for(;t.isCont()&&(o=t.head(),rt.isSpace(o));)t=t.step();if(t.isCont()&&40===o)t.step(),i=3;else if(!t.isEmpty())return bt.error(ot.expected("(",t))}if(3===i){if(void 0===n){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(n=lu.parse(t,"deg"))}else n=n.feed(t);if(void 0!==n)if(n.isDone())i=4;else if(n.isError())return n.asError()}if(4===i){for(;t.isCont()&&rt.isSpace(t.head());)t.step();var s;if(t.isCont()&&41===t.head())return t.step(),"rotate"===(s=r.bind())?bt.done(new Ju(n.bind())):bt.error(ot.message("unknown transform function: "+s,t));if(!t.isEmpty())return bt.error(ot.expected(")",t))}return new e(r,n,i)},e.parseRest=function(t,r){return e.parse(t,r,void 0,2)},e}(bt),ea=function(t){function e(e,r){var n=t.call(this)||this;return n.x=e,n.y=r,n.stringValue=void 0,n}return P(e,t),e.prototype.transform=function(t,e){return 1===arguments.length?t instanceof Hu?this:Ku.list(this,t):new mu(Math.tan(this.x.radValue())*e+t,Math.tan(this.y.radValue())*t+e)},e.prototype.transformX=function(t,e){return Math.tan(this.x.radValue())*e+t},e.prototype.transformY=function(t,e){return Math.tan(this.y.radValue())*t+e},e.prototype.inverse=function(){return new e(this.x.negative(),this.y.negative())},e.prototype.toAffine=function(){var t=this.x.radValue(),e=this.y.radValue();return new ia(1,Math.tan(e),Math.tan(t),1,0,0)},e.prototype.toCssTransformComponent=function(){if("undefined"!=typeof CSSTranslate){var t=this.x.toCssValue(),e=this.y.toCssValue();return new CSSSkew(t,e)}return null},e.prototype.toValue=function(){return or.create(1).attr("skew",or.create(2).slot("x",this.x.toValue()).slot("y",this.y.toValue()))},e.prototype.interpolateTo=function(r){return r instanceof e?ra(this,r):t.prototype.interpolateTo.call(this,r)},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equivalentTo=function(t,r){return t instanceof e&&(this.x.equivalentTo(t.x,r)&&this.y.equivalentTo(t.y,r))},e.prototype.equals=function(t){return t instanceof e&&(this.x.equals(t.x)&&this.y.equals(t.y))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(e),this.x.hashCode()),this.y.hashCode()))},e.prototype.debug=function(t){return t=t.write("Transform").write(46).write("skew"),t=(t=this.x.isDefined()&&!this.y.isDefined()?t.write("X").write(40).debug(this.x):!this.x.isDefined()&&this.y.isDefined()?t.write("Y").write(40).debug(this.y):t.write(40).debug(this.x).write(", ").debug(this.y)).write(41)},e.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t=this.x.isDefined()&&!this.y.isDefined()?"skewX("+this.x+")":!this.x.isDefined()&&this.y.isDefined()?"skewY("+this.y+")":"skew("+this.x+","+this.y+")",this.stringValue=t),t},e.prototype.toAttributeString=function(){return this.x.isDefined()&&!this.y.isDefined()?"skewX("+this.x.degValue()+")":!this.x.isDefined()&&this.y.isDefined()?"skewY("+this.y.degValue()+")":"skew("+this.x.degValue()+","+this.y.degValue()+")"},e.fromCssTransformComponent=function(t){return new e("number"==typeof t.ax?su.rad(t.ax):su.fromCssValue(t.ax),"number"==typeof t.ay?su.rad(t.ay):su.fromCssValue(t.ay))},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=t.header("skew");if(r.isDefined()){var n=su.zero(),i=su.zero();return r.forEach((function(t,e){var r=t.key.stringValue();void 0!==r?"x"===r?n=t.toValue().cast(su.form(),n):"y"===r&&(i=t.toValue().cast(su.form(),i)):t instanceof ir&&(0===e?n=t.cast(su.form(),n):1===e&&(i=t.cast(su.form(),i)))}),this),new e(n,i)}return null},e.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=na.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},e}(Ku),ra=function(t,e){var r=function(t){var e=r[0],n=r[1],i=su.create(e.x.value+t*(n.x.value-e.x.value),n.x.units),o=su.create(e.y.value+t*(n.y.value-e.y.value),n.y.units);return new ea(i,o)};return Object.setPrototypeOf(r,ra.prototype),r[0]=t.x.units===e.x.units&&t.y.units===e.y.units?t:new ea(t.x.to(e.x.units),t.y.to(e.y.units)),r[1]=e,r};ra.prototype=Object.create($t.prototype);var na=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.identOutput=e,o.xParser=r,o.yParser=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.xParser,this.yParser,this.step)},e.parse=function(t,r,n,i,o){void 0===o&&(o=1);var s=0;if(1===o){for(r=r||rt.stringOutput();t.isCont()&&(s=t.head(),rt.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty())switch(u=r.bind()){case"skewX":case"skewY":case"skew":o=2;break;default:return bt.error(ot.message("unknown transform function: "+u,t))}}if(2===o){for(;t.isCont()&&(s=t.head(),rt.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return bt.error(ot.expected("(",t))}if(3===o){if(void 0===n){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(n=lu.parse(t,"deg"))}else n=n.feed(t);if(void 0!==n)if(n.isDone())o=4;else if(n.isError())return n.asError()}if(4===o){for(;t.isCont()&&rt.isSpace(t.head());)t.step();if(t.isCont())if(41===(s=t.head())){switch(t.step(),u=r.bind()){case"skewX":return bt.done(new ea(n.bind(),uu.zero()));case"skewY":return bt.done(new ea(uu.zero(),n.bind()));default:return bt.error(ot.message("unknown transform function: "+u,t))}}else{if(44!==s)return bt.error(ot.expected(",",t));t.step(),o=5}else if(t.isDone())return bt.error(ot.unexpected(t))}if(5===o){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(i=lu.parse(t,"deg"))}else i=i.feed(t);if(void 0!==i)if(i.isDone())o=6;else if(i.isError())return i.asError()}if(6===o){for(;t.isCont()&&rt.isSpace(t.head());)t.step();var u;if(t.isCont()&&41===t.head())return t.step(),"skew"===(u=r.bind())?bt.done(new ea(n.bind(),i.bind())):bt.error(ot.message("unknown transform function: "+u,t));if(!t.isEmpty())return bt.error(ot.expected(")",t))}return new e(r,n,i,o)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,2)},e}(bt),ia=function(t){function r(e,r,n,i,o,s){var u=t.call(this)||this;return u.x0=e,u.y0=r,u.x1=n,u.y1=i,u.tx=o,u.ty=s,u.stringValue=void 0,u}return P(r,t),r.prototype.transform=function(t,e){return 1===arguments.length?t instanceof Hu?this:this.multiply(t.toAffine()):new mu(this.x0*t+this.x1*e+this.tx,this.y0*t+this.y1*e+this.ty)},r.prototype.transformX=function(t,e){return this.x0*t+this.x1*e+this.tx},r.prototype.transformY=function(t,e){return this.y0*t+this.y1*e+this.ty},r.prototype.inverse=function(){var t=this.x0,e=this.y0,n=this.x1,i=this.y1,o=this.tx,s=this.ty,u=t*i-n*e;if(Math.abs(u)>=Number.MIN_VALUE)return new r(i/u,-e/u,-n/u,t/u,(n*s-i*o)/u,(e*o-t*s)/u);throw new Error("non-invertible affine transform with determinant "+u)},r.prototype.multiply=function(t){return new r(this.x0*t.x0+this.x1*t.y0,this.y0*t.x0+this.y1*t.y0,this.x0*t.x1+this.x1*t.y1,this.y0*t.x1+this.y1*t.y1,this.x0*t.tx+this.x1*t.ty,this.y0*t.tx+this.y1*t.ty)},r.prototype.toAffine=function(){return this},r.prototype.toMatrix=function(){return new DOMMatrix([this.x0,this.y0,this.x1,this.y1,this.tx,this.ty])},r.prototype.toCssTransformComponent=function(){return"undefined"!=typeof CSSTranslate?new CSSMatrixComponent(this.toMatrix()):null},r.prototype.toValue=function(){return or.create(1).attr("matrix",or.create(6).item(this.x0).item(this.y0).item(this.x1).item(this.y1).item(this.tx).item(this.ty))},r.prototype.interpolateTo=function(e){return e instanceof r?oa(this,e):t.prototype.interpolateTo.call(this,e)},r.prototype.conformsTo=function(t){return t instanceof r},r.prototype.equivalentTo=function(t,e){return t instanceof r&&(m.equivalent(this.x0,t.x0,e)&&m.equivalent(this.y0,t.y0,e)&&m.equivalent(this.x1,t.x1,e)&&m.equivalent(this.y1,t.y1,e)&&m.equivalent(this.tx,t.tx,e)&&m.equivalent(this.ty,t.ty,e))},r.prototype.equals=function(t){return t instanceof r&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1&&this.tx===t.tx&&this.ty===t.ty)},r.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(f.mix(f.mix(b.hash(r),m.hash(this.x0)),m.hash(this.y0)),m.hash(this.x1)),m.hash(this.y1)),m.hash(this.tx)),m.hash(this.ty)))},r.prototype.debug=function(t){return t=t.write("Transform").write(46).write("affine").write(40).debug(this.x0).write(", ").debug(this.y0).write(", ").debug(this.x1).write(", ").debug(this.y1).write(", ").debug(this.tx).write(", ").debug(this.ty).write(41)},r.prototype.toString=function(){var t=this.stringValue;return void 0===t&&(t="matrix("+this.x0+","+this.y0+","+this.x1+","+this.y1+","+this.tx+","+this.ty+")",this.stringValue=t),t},r.identity=function(){return new r(1,0,0,1,0,0)},r.fromAny=function(t){if(null==t||t instanceof r)return t;if("string"==typeof t)return r.parse(t);throw new TypeError(""+t)},r.fromMatrix=function(t){return new r(t.a,t.b,t.c,t.d,t.e,t.f)},r.fromCssTransformComponent=function(t){return r.fromMatrix(t.matrix)},r.fromValue=function(t){var e=t.header("matrix");if(e.isDefined()){var n=0,i=0,o=0,s=0,u=0,a=0;return e.forEach((function(t,e){var r=t.key.stringValue();if(void 0!==r)"x0"===r?n=t.toValue().numberValue(n):"y0"===r?i=t.toValue().numberValue(i):"x1"===r?o=t.toValue().numberValue(o):"y1"===r?s=t.toValue().numberValue(s):"tx"===r?u=t.toValue().numberValue(u):"ty"===r&&(a=t.toValue().numberValue(a));else if(t instanceof ir)switch(e){case 0:n=t.numberValue(n);break;case 1:i=t.numberValue(i);break;case 2:o=t.numberValue(o);break;case 3:s=t.numberValue(s);break;case 4:u=t.numberValue(u);break;case 5:a=t.numberValue(a)}}),this),new r(n,i,o,s,u,a)}return null},r.parse=function(t){for(var e=rt.stringInput(t);e.isCont()&&rt.isWhitespace(e.head());)e=e.step();var r=sa.parse(e);if(r.isDone())for(;e.isCont()&&rt.isWhitespace(e.head());)e=e.step();return e.isCont()&&!r.isError()&&(r=bt.error(ot.unexpected(e))),r.bind()},S([e],r,"identity",null),r}(Ku),oa=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.x0+t*(n.x0-e.x0),o=e.y0+t*(n.y0-e.y0),s=e.x1+t*(n.x1-e.x1),u=e.y1+t*(n.y1-e.y1),a=e.tx+t*(n.tx-e.tx),p=e.ty+t*(n.ty-e.ty);return new ia(i,o,s,u,a,p)};return Object.setPrototypeOf(r,oa.prototype),r[0]=t,r[1]=e,r};oa.prototype=Object.create($t.prototype);var sa=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.identOutput=e,o.entries=r,o.entryParser=n,o.step=i,o}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.identOutput,this.entries,this.entryParser,this.step)},e.parse=function(t,r,n,i,o){void 0===n&&(n=[]),void 0===o&&(o=1);var s=0;if(1===o){for(r=r||rt.stringOutput();t.isCont()&&(s=t.head(),rt.isAlpha(s));)t=t.step(),r.write(s);if(!t.isEmpty()){if("matrix"!==(u=r.bind()))return bt.error(ot.message("unknown transform function: "+u,t));o=2}}if(2===o){for(;t.isCont()&&(s=t.head(),rt.isSpace(s));)t=t.step();if(t.isCont()&&40===s)t.step(),o=3;else if(!t.isEmpty())return bt.error(ot.expected("(",t))}for(;;){if(3===o){if(void 0===i){for(;t.isCont()&&rt.isSpace(t.head());)t.step();t.isEmpty()||(i=it.parseNumber(t))}else i=i.feed(t);if(void 0!==i)if(i.isDone())n.push(i.bind()),i=void 0,o=4;else if(i.isError())return i.asError()}if(4===o){for(;t.isCont()&&rt.isSpace(t.head());)t.step();if(t.isCont()){var u;if(41===(s=t.head()))return t.step(),"matrix"===(u=r.bind())?bt.done(Ku.affine.apply(Ku,n)):bt.error(ot.message("unknown transform function: "+u,t));if(n.length>=6)return bt.error(ot.expected(")",t));if(44===s){t.step(),o=3;continue}return bt.error(ot.expected(",",t))}if(t.isDone())return bt.error(ot.unexpected(t))}break}return new e(r,n,i,o)},e.parseRest=function(t,r){return e.parse(t,r,void 0,void 0,2)},e}(bt),ua=function(t){function e(e){var r=t.call(this)||this;return r.transforms=e,r.stringValue=void 0,r}return P(e,t),e.prototype.transform=function(t,e){if(1===arguments.length)return t instanceof Hu?this:Ku.list(this,t);for(var r=this.transforms,n=0,i=r.length;n<i;n+=1){var o=r[n],s=o.transformX(t,e),u=o.transformY(t,e);t=s,e=u}return new mu(t,e)},e.prototype.transformX=function(t,e){for(var r=this.transforms,n=0,i=r.length;n<i;n+=1){var o=r[n],s=o.transformX(t,e),u=o.transformY(t,e);t=s,e=u}return t},e.prototype.transformY=function(t,e){for(var r=this.transforms,n=0,i=r.length;n<i;n+=1){var o=r[n],s=o.transformX(t,e),u=o.transformY(t,e);t=s,e=u}return e},e.prototype.inverse=function(){for(var t=this.transforms,r=t.length,n=new Array(r),i=0;i<r;i+=1)n[i]=t[r-i-1].inverse();return new e(n)},e.prototype.toAffine=function(){for(var t=ia.identity(),e=this.transforms,r=0,n=e.length;r<n;r+=1)t=t.multiply(e[r].toAffine());return t},e.prototype.toCssTransformComponent=function(){return"undefined"!=typeof CSSTranslate?new CSSMatrixComponent(this.toMatrix()):null},e.prototype.toCssValue=function(){if("undefined"!=typeof CSSTransformValue){for(var t=this.transforms,e=t.length,r=new Array(e),n=0,i=t.length;n<i;n+=1){var o=t[n].toCssTransformComponent();if(null===o)return null;r[n]=o}return new CSSTransformValue(r)}return null},e.prototype.toValue=function(){for(var t=this.transforms,e=t.length,r=or.create(e),n=0;n<e;n+=1)r.push(t[n].toValue());return r},e.prototype.interpolateTo=function(r){return r instanceof e?aa(this,r):t.prototype.interpolateTo.call(this,r)},e.prototype.conformsTo=function(t){if(t instanceof e){var r=this.transforms.length;if(r===t.transforms.length){for(var n=0;n<r;n+=1)if(!this.transforms[n].conformsTo(t.transforms[n]))return!1;return!0}}return!1},e.prototype.equivalentTo=function(t,r){if(t instanceof e){var n=this.transforms.length;if(n===t.transforms.length){for(var i=0;i<n;i+=1)if(!this.transforms[i].equivalentTo(t.transforms[i],r))return!1;return!0}}return!1},e.prototype.equals=function(t){if(t instanceof e){var r=this.transforms.length;if(r===t.transforms.length){for(var n=0;n<r;n+=1)if(!this.transforms[n].equals(t.transforms[n]))return!1;return!0}}return!1},e.prototype.hashCode=function(){for(var t=b.hash(e),r=this.transforms,n=0,i=r.length;n<i;n+=1)t=f.mix(t,r[n].hashCode());return f.mash(t)},e.prototype.debug=function(t){t=t.write("Transform").write(46).write("list").write(40);var e=this.transforms,r=e.length;if(r>0){t=t.debug(e[0]);for(var n=1;n<r;n+=1)t=t.write(", ").debug(e[n])}return t=t.write(41)},e.prototype.toString=function(){var t=this.stringValue;if(void 0===t){var e=this.transforms,r=e.length;if(r>0){t=e[0].toString();for(var n=1;n<r;n+=1)t+=" ",t+=e[n].toString()}else t="none";this.stringValue=t}return t},e.prototype.toAttributeString=function(){var t=this.transforms,e=t.length;if(e>0){for(var r=t[0].toAttributeString(),n=1;n<e;n+=1)r+=" ",r+=t[n].toAttributeString();return r}return""},e.fromAny=function(t){if(null==t||t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new TypeError(""+t)},e.fromValue=function(t){var r=[];return t.forEach((function(t){var e=Ku.fromValue(t.toValue());null!==e&&r.push(e)}),this),0!==r.length?new e(r):null},e.parse=function(t){var r=Ku.parse(t);return r instanceof e?r:new e([r])},e}(Ku),aa=function(t,e){var r=function(t){for(var e=r.interpolators,n=e.length,i=new Array(n),o=0;o<n;o+=1)i[o]=e[o](t);return new ua(i)};Object.setPrototypeOf(r,aa.prototype);for(var n=t.transforms,i=e.transforms,o=Math.min(n.length,i.length),s=new Array(o),u=0;u<o;u+=1)s[u]=n[u].interpolateTo(i[u]);return r.interpolators=s,r};aa.prototype=Object.create($t.prototype),Object.defineProperty(aa.prototype,0,{get:function(){for(var t=this.interpolators,e=t.length,r=new Array(e),n=0;n<e;n+=1)r[n]=t[n][0];return new ua(r)},enumerable:!0,configurable:!0}),Object.defineProperty(aa.prototype,1,{get:function(){for(var t=this.interpolators,e=t.length,r=new Array(e),n=0;n<e;n+=1)r[n]=t[n][1];return new ua(r)},enumerable:!0,configurable:!0}),aa.prototype.equals=function(t){if(this===t)return!0;if(t instanceof aa){var e=this.interpolators.length;if(e===t.interpolators.length){for(var r=0;r<e;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1};var pa=function(t){function e(e,r){var n=t.call(this)||this;return n.transform=e,n.transformParser=r,n}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.transform,this.transformParser)},e.parse=function(t,r,n){for(void 0===r&&(r=Ku.identity());;){if(void 0===n){for(;t.isCont()&&rt.isSpace(t.head());)t.step();if(t.isCont())n=Wu.parse(t);else if(t.isDone())return bt.done(r)}if(void 0!==n){if((n=n.feed(t)).isDone()){r=r.transform(n.bind()),n=void 0;continue}if(n.isError())return n.asError()}break}return new e(r,n)},e}(bt),ha={is:function(t){if(null!=t){var e=t;return"function"==typeof e.project&&"function"==typeof e.unproject}return!1}},fa=function(){function t(){}return t.prototype.union=function(e){return e=t.fromAny(e),new xa(Math.min(this.lngMin,e.lngMin),Math.min(this.latMin,e.latMin),Math.max(this.lngMax,e.lngMax),Math.max(this.latMax,e.latMax))},Object.defineProperty(t.prototype,"bounds",{get:function(){return new xa(this.lngMin,this.latMin,this.lngMax,this.latMax)},enumerable:!1,configurable:!0}),t.fromAny=function(e){if(null==e||e instanceof t)return e;if(ca.isInit(e))return ca.fromInit(e);if(ca.isTuple(e))return ca.fromTuple(e);if(ya.isInit(e))return ya.fromInit(e);if(Oa.isInit(e))return Oa.fromInit(e);if(Oa.isTuple(e))return Oa.fromTuple(e);if(xa.isInit(e))return xa.fromInit(e);throw new TypeError(""+e)},t.isAny=function(e){return e instanceof t||ca.isInit(e)||ca.isTuple(e)||ya.isInit(e)||Oa.isInit(e)||xa.isInit(e)},t}(),ca=function(t){function r(e,r){var n=t.call(this)||this;return n.lng=e,n.lat=r,n}return P(r,t),r.prototype.isDefined=function(){return isFinite(this.lng)&&isFinite(this.lat)},Object.defineProperty(r.prototype,"lngMin",{get:function(){return this.lng},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"latMin",{get:function(){return this.lat},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lngMax",{get:function(){return this.lng},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"latMax",{get:function(){return this.lat},enumerable:!1,configurable:!0}),r.prototype.contains=function(t,e){return"number"==typeof t?this.lng===t&&this.lat===e:(t=fa.fromAny(t))instanceof r?this.lng===t.lng&&this.lat===t.lat:t instanceof fa&&(this.lng<=t.lngMin&&t.lngMax<=this.lng&&this.lat<=t.latMin&&t.latMax<=this.lat)},r.prototype.intersects=function(t){return(t=fa.fromAny(t)).intersects(this)},r.prototype.project=function(t){return t.project(this)},r.prototype.normalized=function(){var t=this.lng,e=this.lat,n=r.normalizeLng(t),i=r.normalizeLat(e);return t===n&&e===i?this:new r(n,i)},r.prototype.toAny=function(){return{lng:this.lng,lat:this.lat}},r.prototype.interpolateTo=function(t){return t instanceof r?la(this,t):null},r.prototype.equivalentTo=function(t,e){return this===t||t instanceof r&&(m.equivalent(this.lng,t.lng,e)&&m.equivalent(this.lat,t.lat,e))},r.prototype.equals=function(t){return this===t||t instanceof r&&(this.lng===t.lng&&this.lat===t.lat)},r.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(r),m.hash(this.lng)),m.hash(this.lat)))},r.prototype.debug=function(t){return t=t.write("GeoPoint").write(46).write("of").write(40).debug(this.lng).write(", ").debug(this.lat).write(41)},r.prototype.toString=function(){return nt.debug(this)},r.origin=function(){return new r(0,0)},r.undefined=function(){return new r(NaN,NaN)},r.of=function(t,e){return new r(t,e)},r.fromInit=function(t){return new r(t.lng,t.lat)},r.fromTuple=function(t){return new r(t[0],t[1])},r.fromAny=function(t){if(null==t||t instanceof r)return t;if(r.isInit(t))return r.fromInit(t);if(r.isTuple(t))return r.fromTuple(t);throw new TypeError(""+t)},r.normalized=function(t,e){return t=r.normalizeLng(t),e=r.normalizeLat(e),new r(t,e)},r.normalizeLng=function(t){return t<-180?t=180-(180-t)%360:t>180&&(t=(t-180)%360-180),t},r.normalizeLat=function(t){return t=Math.min(Math.max(-90+i.Epsilon,t),90-i.Epsilon)},r.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.lng&&"number"==typeof e.lat}return!1},r.isTuple=function(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]},r.isAny=function(t){return t instanceof r||r.isInit(t)||r.isTuple(t)},S([e],r,"origin",null),S([e],r,"undefined",null),r}(fa),la=function(t,e){var r=function(t){var e,n=r[0],i=n.lng,o=n.lat,s=r[1],u=s.lng,a=s.lat;if(i>0&&u<0&&i-u>180)e=t<(c=(h=180-i)/(h+(p=180+u)))?i+t/c*h:(t-c)/(f=1-c)*p-180;else if(i<0&&u>0&&u-i>180){var p,h,f,c;if(t<(f=(p=180+i)/(p+(h=180-u))))e=i-t/f*p;else e=180-(t-f)/(c=1-f)*h}else e=i+t*(u-i);return new ca(e,o+t*(a-o))};return Object.setPrototypeOf(r,la.prototype),r[0]=t.normalized(),r[1]=e.normalized(),r};la.prototype=Object.create($t.prototype);var da=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e}(fa),ya=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.lng0=e,o.lat0=r,o.lng1=n,o.lat1=i,o}return P(e,t),e.prototype.isDefined=function(){return isFinite(this.lng0)&&isFinite(this.lat0)&&isFinite(this.lng1)&&isFinite(this.lat1)},Object.defineProperty(e.prototype,"lngMin",{get:function(){return Math.min(this.lng0,this.lng1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latMin",{get:function(){return Math.min(this.lat0,this.lat1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lngMax",{get:function(){return Math.max(this.lng0,this.lng1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latMax",{get:function(){return Math.max(this.lat0,this.lat1)},enumerable:!1,configurable:!0}),e.prototype.interpolateLng=function(t){return(1-t)*this.lng0+t*this.lng1},e.prototype.interpolateLat=function(t){return(1-t)*this.lat0+t*this.lat1},e.prototype.interpolate=function(t){var e=1-t,r=e*this.lng0+t*this.lng1,n=e*this.lat0+t*this.lat1;return new ca(r,n)},e.prototype.contains=function(t,r){return"number"==typeof t?Ou.contains(this.lng0,this.lat0,this.lng1,this.lat1,t,r):(t=fa.fromAny(t))instanceof ca?this.containsPoint(t):t instanceof e&&this.containsSegment(t)},e.prototype.containsPoint=function(t){return Ou.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng,t.lat)},e.prototype.containsSegment=function(t){return Ou.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng0,t.lat0)&&Ou.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng1,t.lat1)},e.prototype.intersects=function(t){return(t=fa.fromAny(t))instanceof ca?this.intersectsPoint(t):t instanceof e?this.intersectsSegment(t):t.intersects(this)},e.prototype.intersectsPoint=function(t){return Ou.contains(this.lng0,this.lat0,this.lng1,this.lat1,t.lng,t.lat)},e.prototype.intersectsSegment=function(t){return Ou.intersects(this.lng0,this.lat0,this.lng1-this.lat0,this.lng1-this.lat0,t.lng0,t.lat0,t.lng1-t.lat0,t.lng1-t.lat0)},e.prototype.split=function(t){var r=1-t,n=r*this.lng0+t*this.lng1,i=r*this.lat0+t*this.lat1;return[new e(this.lng0,this.lat0,n,i),new e(n,i,this.lng1,this.lat1)]},e.prototype.project=function(t){var e=t.project(this.lng0,this.lat0),r=t.project(this.lng1,this.lat1);return new Ou(e.x,e.y,r.x,r.y)},e.prototype.forEachCoord=function(t,e){var r;return void 0!==(r=t.call(e,this.lng0,this.lat0))||void 0!==(r=t.call(e,this.lng1,this.lat1))?r:void 0},e.prototype.forEachCoordRest=function(t,e){var r=t.call(e,this.lng1,this.lat1);if(void 0!==r)return r},e.prototype.toAny=function(){return{lng0:this.lng0,lat0:this.lat0,lng1:this.lng1,lat1:this.lat1}},e.prototype.interpolateTo=function(t){return t instanceof e?va(this,t):null},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(m.equivalent(this.lng0,t.lng0,r)&&m.equivalent(this.lat0,t.lat0,r)&&m.equivalent(this.lng1,t.lng1,r)&&m.equivalent(this.lat1,t.lat1,r))},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lng0===t.lng0&&this.lat0===t.lat0&&this.lng1===t.lng1&&this.lat1===t.lat1)},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(b.hash(e),m.hash(this.lng0)),m.hash(this.lat0)),m.hash(this.lng1)),m.hash(this.lat1)))},e.prototype.debug=function(t){return t=t.write("GeoSegment").write(46).write("of").write(40).debug(this.lng0).write(", ").debug(this.lat0).write(", ").debug(this.lng1).write(", ").debug(this.lat1).write(41)},e.prototype.toString=function(){return nt.debug(this)},e.of=function(t,r,n,i){return new e(t,r,n,i)},e.fromInit=function(t){return new e(t.lng0,t.lat0,t.lng1,t.lat1)},e.fromAny=function(t){if(null==t||t instanceof e)return t;if(e.isInit(t))return e.fromInit(t);throw new TypeError(""+t)},e.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.lng0&&"number"==typeof e.lat0&&"number"==typeof e.lng1&&"number"==typeof e.lat1}return!1},e.isAny=function(t){return t instanceof e||e.isInit(t)},e}(da),va=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.lng0+t*(n.lng0-e.lng0),o=e.lat0+t*(n.lat0-e.lat0),s=e.lng1+t*(n.lng1-e.lng1),u=e.lat1+t*(n.lat1-e.lat1);return new ya(i,o,s,u)};return Object.setPrototypeOf(r,va.prototype),r[0]=t,r[1]=e,r};va.prototype=Object.create($t.prototype);var ma=function(t){function e(e,r){var n=t.call(this)||this;return n.curves=e,n.closed=r,n.boundingBox=null,n}return P(e,t),e.prototype.isDefined=function(){return 0!==this.curves.length},e.prototype.isClosed=function(){return this.closed},Object.defineProperty(e.prototype,"lngMin",{get:function(){return this.bounds.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latMin",{get:function(){return this.bounds.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lngMax",{get:function(){return this.bounds.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latMax",{get:function(){return this.bounds.latMax},enumerable:!1,configurable:!0}),e.prototype.interpolateLng=function(t){var e=this.curves,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateLng(o)}return NaN},e.prototype.interpolateLat=function(t){var e=this.curves,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateLat(o)}return NaN},e.prototype.interpolate=function(t){var e=this.curves,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolate(o)}return new ca(NaN,NaN)},e.prototype.contains=function(t,e){return!1},e.prototype.intersects=function(t){return!1},e.prototype.split=function(t){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=r[o].split(s),a=u[0],p=u[1],h=new Array(o+1),f=new Array(n-o),c=0;c<o;c+=1)h[c]=r[c];h[o]=a,f[0]=p;for(c=o+1;c<n;c+=1)f[c-o]=r[c];return[new e(h,!1),new e(f,!1)]}return[e.empty(),e.empty()]},e.prototype.subdivide=function(t){var r=this.curves,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=r[o].split(s),a=u[0],p=u[1],h=new Array(n+1),f=0;f<o;f+=1)h[f]=r[f];h[o]=a,h[o+1]=p;for(f=o+1;f<n;f+=1)h[f+1]=r[f];return new e(h,this.closed)}return e.empty()},e.prototype.project=function(t){var e=this.curves,r=e.length;if(r>0){var n=0,i=new Array(r),o=e[0];if(o instanceof ya)for(var s=t.project(o.lng0,o.lat0);n<r&&(o=e[n])instanceof ya;){var u=t.project(o.lng1,o.lat1);i[n]=new Ou(s.x,s.y,u.x,u.y),s=u,n+=1}for(;n<r;)o=e[n],i[n]=o.project(t),n+=1;return new Iu(i,this.closed)}return Iu.empty()},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this.boundingBox;if(null===t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=this.curves,s=0,u=o.length;s<u;s+=1){var a=o[s];e=Math.min(e,a.lngMin),r=Math.min(r,a.latMin),n=Math.max(a.lngMax,n),i=Math.max(a.latMax,i)}t=new xa(e,r,n,i),this.boundingBox=t}return t},enumerable:!1,configurable:!0}),e.prototype.forEachCoord=function(t,e){var r=this.curves,n=r.length;if(n>0){var i=r[0],o=i.forEachCoord(t,e);if(void 0!==o)return o;for(var s=1;s<n;s+=1)if(void 0!==(o=(i=r[s]).forEachCoordRest(t,e)))return o}},e.prototype.forEachCoordRest=function(t,e){for(var r=this.curves,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachCoordRest(t,e);if(void 0!==o)return o}},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&(C.equivalent(this.curves,t.curves,r)&&this.closed===t.closed)},e.prototype.equals=function(t){return this===t||t instanceof e&&(C.equal(this.curves,t.curves)&&this.closed===t.closed)},e.prototype.debug=function(t){var e=this.curves,r=e.length;if(t=t.write("GeoSpline").write(46),0===r)t=t.write("empty").write(40);else if(0!==r){t=(t=t.write(this.closed?"closed":"open").write(40)).debug(e[0]);for(var n=1;n<r;n+=1)t=t.write(", ").debug(e[n])}return t=t.write(41)},e.prototype.toString=function(){return nt.debug(this)},e.empty=function(){return new e([],!1)},e.open=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e(t,!1)},e.closed=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e(t,!0)},e.fromPoints=function(t){var r=t.length;if(r>1){for(var n=new Array(r-1),i=ca.fromAny(t[0]),o=i,s=1;s<r;s+=1){var u=ca.fromAny(t[s]);n[s-1]=new ya(o.lng,o.lat,u.lng,u.lat),o=u}return new e(n,i.equals(o))}return e.empty()},e.fromAny=function(t){return null==t||t instanceof e?t:e.isPoints(t)?e.fromPoints(t):fa.fromAny(t)},e.builder=function(){return new wa},e.isPoints=function(t){return Array.isArray(t)&&t.length>=2&&ca.isAny(t[0])},e.isAnySpline=function(t){return t instanceof e||e.isPoints(t)},e}(da),wa=function(){function t(){this.curves=[],this.closed=!1,this.aliased=!1,this.lng0=0,this.lat0=0,this.lng=0,this.lat=0}return t.prototype.dealias=function(){this.aliased&&(this.curves=this.curves.slice(0),this.aliased=!1)},t.prototype.moveTo=function(t,e){this.aliased?(this.curves=[],this.aliased=!1):this.curves.length=0,this.closed=!1,this.lng0=t,this.lat0=e,this.lng=t,this.lat=e},t.prototype.closePath=function(){this.dealias(),this.curves.push(new ya(this.lng,this.lat,this.lng0,this.lat0)),this.closed=!0,this.lng=this.lng0,this.lat=this.lat0},t.prototype.lineTo=function(t,e){this.dealias(),this.curves.push(new ya(this.lng,this.lat,t,e)),this.lng=t,this.lat=e},t.prototype.bind=function(){return this.aliased=!0,new ma(this.curves,this.closed)},t}(),ga=function(t){function e(e){var r=t.call(this)||this;return r.splines=e,r.boundingBox=null,r}return P(e,t),e.prototype.isDefined=function(){return 0!==this.splines.length},Object.defineProperty(e.prototype,"lngMin",{get:function(){return this.bounds.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latMin",{get:function(){return this.bounds.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lngMax",{get:function(){return this.bounds.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"latMax",{get:function(){return this.bounds.latMax},enumerable:!1,configurable:!0}),e.prototype.interpolateLng=function(t){var e=this.splines,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateLng(o)}return NaN},e.prototype.interpolateLat=function(t){var e=this.splines,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolateLat(o)}return NaN},e.prototype.interpolate=function(t){var e=this.splines,r=e.length;if(r>0){var n=1/r,i=Math.min(Math.max(0,Math.floor(t/n)),r),o=t*r-i*n;return e[i].interpolate(o)}return new ca(NaN,NaN)},e.prototype.contains=function(t,e){return!1},e.prototype.intersects=function(t){return!1},e.prototype.split=function(t){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=r[o].split(s),a=u[0],p=u[1],h=new Array(o+1),f=new Array(n-o),c=0;c<o;c+=1)h[c]=r[c];h[o]=a,f[0]=p;for(c=o+1;c<n;c+=1)f[c-o]=r[c];return[new e(h),new e(f)]}return[e.empty(),e.empty()]},e.prototype.subdivide=function(t){var r=this.splines,n=r.length;if(n>0){for(var i=1/n,o=Math.min(Math.max(0,Math.floor(t/i)),n),s=t*n-o*i,u=new Array(n),a=0;a<o;a+=1)u[a]=r[a];u[o]=r[o].subdivide(s);for(a=o+1;a<n;a+=1)u[a]=r[a];return new e(u)}return e.empty()},e.prototype.project=function(t){var e=this.splines,r=e.length;if(r>0){for(var n=new Array(r),i=0;i<r;i+=1)n[i]=e[i].project(t);return new ju(n)}return ju.empty()},Object.defineProperty(e.prototype,"bounds",{get:function(){var t=this.boundingBox;if(null===t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=this.splines,s=0,u=o.length;s<u;s+=1){var a=o[s];e=Math.min(e,a.lngMin),r=Math.min(r,a.latMin),n=Math.max(a.lngMax,n),i=Math.max(a.latMax,i)}t=new xa(e,r,n,i),this.boundingBox=t}return t},enumerable:!1,configurable:!0}),e.prototype.centroid=function(){var t=0,e=0,r=0;return this.forEachCoord((function(n,i){t+=n,e+=i,r+=1}),this),0!==r?new ca(t/r,e/r):ca.undefined()},e.prototype.forEachCoord=function(t,e){for(var r=this.splines,n=0,i=r.length;n<i;n+=1){var o=r[n].forEachCoord(t,e);if(void 0!==o)return o}},e.prototype.equivalentTo=function(t,r){return this===t||t instanceof e&&C.equivalent(this.splines,t.splines,r)},e.prototype.equals=function(t){return this===t||t instanceof e&&C.equal(this.splines,t.splines)},e.prototype.debug=function(t){var e=this.splines,r=e.length;if(t=t.write("GeoPath").write(46),0===r)t=t.write("empty").write(40);else if(1===r){var n=e[0];t=t.write(n.closed?"closed":"open").write(40);var i=n.curves,o=i.length;if(0!==o){t=t.debug(i[0]);for(var s=1;s<o;s+=1)t=t.write(", ").debug(i[s])}}else{t=(t=t.write("of").write(40)).debug(e[0]);for(s=1;s<r;s+=1)t=t.write(", ").debug(e[s])}return t=t.write(41)},e.prototype.toString=function(){return nt.debug(this)},e.empty=function(){return new e([])},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e(t)},e.open=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e([new ma(t,!1)])},e.closed=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return new e([new ma(t,!0)])},e.fromPoints=function(t){return new e([ma.fromPoints(t)])},e.fromSplines=function(t){for(var r=t.length,n=new Array(r),i=0;i<r;i+=1)n[i]=ma.fromAny(t[i]);return new e(n)},e.fromAny=function(t){return null==t||t instanceof e?t:e.isSplines(t)?e.fromSplines(t):ma.isAnySpline(t)?e.of(ma.fromAny(t)):fa.fromAny(t)},e.builder=function(){return new ba},e.isSplines=function(t){return Array.isArray(t)&&t.length>0&&ma.isAnySpline(t[0])},e.isAnyPath=function(t){return t instanceof e||e.isSplines(t)},e}(fa),ba=function(){function t(){this.splines=[],this.builder=null}return t.prototype.moveTo=function(t,e){var r=this.builder;if(null!==r){var n=r.bind();n.isDefined()&&this.splines.push(n)}r=new wa,this.builder=r,r.moveTo(t,e)},t.prototype.closePath=function(){var t=this.builder;if(null===t)throw new Error;t.closePath()},t.prototype.lineTo=function(t,e){var r=this.builder;if(null===r)throw new Error;r.lineTo(t,e)},t.prototype.bind=function(){var t=this.splines.slice(0),e=this.builder;if(null!==e){var r=e.bind();r.isDefined()&&t.push(r)}return new ga(t)},t}(),xa=function(t){function r(e,r,n,i){var o=t.call(this)||this;return o.lngMin=e,o.latMin=r,o.lngMax=n,o.latMax=i,o}return P(r,t),r.prototype.isDefined=function(){return isFinite(this.lngMin)&&isFinite(this.latMin)&&isFinite(this.lngMax)&&isFinite(this.latMax)},Object.defineProperty(r.prototype,"west",{get:function(){return this.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"south",{get:function(){return this.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"east",{get:function(){return this.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"north",{get:function(){return this.latMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"southWest",{get:function(){return new ca(this.lngMin,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"northWest",{get:function(){return new ca(this.lngMin,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"southEast",{get:function(){return new ca(this.lngMax,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"northEast",{get:function(){return new ca(this.lngMax,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"center",{get:function(){return new ca((this.lngMin+this.lngMax)/2,(this.latMin+this.latMax)/2)},enumerable:!1,configurable:!0}),r.prototype.contains=function(t,e){if("number"==typeof t)return this.lngMin<=t&&t<=this.lngMax&&this.latMin<=e&&e<=this.latMax;if(ca.isAny(t))return this.containsPoint(ca.fromAny(t));if(ya.isAny(t))return this.containsSegment(ya.fromAny(t));if(Oa.isAny(t))return this.containsTile(Oa.fromAny(t));if(r.isAny(t))return this.containsBox(r.fromAny(t));throw new TypeError(""+t)},r.prototype.containsPoint=function(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax},r.prototype.containsSegment=function(t){return this.lngMin<=t.lng0&&t.lng0<=this.lngMax&&this.latMin<=t.lat0&&t.lat0<=this.latMax&&this.lngMin<=t.lng1&&t.lng1<=this.lngMax&&this.latMin<=t.lat1&&t.lat1<=this.latMax},r.prototype.containsTile=function(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax},r.prototype.containsBox=function(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax},r.prototype.intersects=function(t){if(ca.isAny(t))return this.intersectsPoint(ca.fromAny(t));if(ya.isAny(t))return this.intersectsSegment(ya.fromAny(t));if(Oa.isAny(t))return this.intersectsTile(Oa.fromAny(t));if(r.isAny(t))return this.intersectsBox(r.fromAny(t));throw new TypeError(""+t)},r.prototype.intersectsPoint=function(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax},r.prototype.intersectsSegment=function(t){var e=this.lngMin,r=this.latMin,n=this.lngMax,i=this.latMax,o=t.lng0,s=t.lat0,u=t.lng1,a=t.lat1;return!(o<e&&u<e||o>n&&u>n||s<r&&a<r||s>i&&a>i)&&(o>e&&o<n&&s>r&&s<i||!!(Nu.intersectsSegment(o-e,u-e,o,s,u,a)&&Nu.hitY>r&&Nu.hitY<i||Nu.intersectsSegment(s-r,a-r,o,s,u,a)&&Nu.hitX>e&&Nu.hitX<n||Nu.intersectsSegment(o-n,u-n,o,s,u,a)&&Nu.hitY>r&&Nu.hitY<i||Nu.intersectsSegment(s-i,a-i,o,s,u,a)&&Nu.hitX>e&&Nu.hitX<n))},r.prototype.intersectsTile=function(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax},r.prototype.intersectsBox=function(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax},r.prototype.union=function(e){return t.prototype.union.call(this,e)},r.prototype.project=function(t){var e=t.project(this.lngMin,this.latMin),r=t.project(this.lngMax,this.latMax),n=e.x,i=e.y,o=r.x,s=r.y;if(n>o){var u=n;n=o,o=u}if(i>s){var a=i;i=s,s=a}return isFinite(n)||(n=-1/0),isFinite(i)||(i=-1/0),isFinite(o)||(o=1/0),isFinite(s)||(s=1/0),new Nu(n,i,o,s)},Object.defineProperty(r.prototype,"bounds",{get:function(){return this},enumerable:!1,configurable:!0}),r.prototype.toAny=function(){return{lngMin:this.lngMin,latMin:this.latMin,lngMax:this.lngMax,latMax:this.latMax}},r.prototype.interpolateTo=function(t){return t instanceof r?Ca(this,t):null},r.prototype.equivalentTo=function(t,e){return this===t||t instanceof r&&(m.equivalent(this.lngMin,t.lngMin,e)&&m.equivalent(this.latMin,t.latMin,e)&&m.equivalent(this.lngMax,t.lngMax,e)&&m.equivalent(this.latMax,t.latMax,e))},r.prototype.equals=function(t){return this===t||t instanceof r&&(this.lngMin===t.lngMin&&this.latMin===t.latMin&&this.lngMax===t.lngMax&&this.latMax===t.latMax)},r.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(b.hash(r),m.hash(this.lngMin)),m.hash(this.latMin)),m.hash(this.lngMax)),m.hash(this.latMax)))},r.prototype.debug=function(t){return t=t.write("GeoBox").write(46).write("of").write(40).debug(this.lngMin).write(", ").debug(this.latMin).write(", ").debug(this.lngMax).write(", ").debug(this.latMax).write(41)},r.prototype.toString=function(){return nt.debug(this)},r.undefined=function(){return new r(1/0,1/0,-1/0,-1/0)},r.globe=function(){return new r(-180,-90,180,90)},r.of=function(t,e,n,i){return void 0===n&&(n=t),void 0===i&&(i=e),new r(t,e,n,i)},r.fromInit=function(t){return new r(t.lngMin,t.latMin,t.lngMax,t.latMax)},r.fromAny=function(t){if(null==t||t instanceof r)return t;if(r.isInit(t))return r.fromInit(t);throw new TypeError(""+t)},r.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.lngMin&&"number"==typeof e.latMin&&"number"==typeof e.lngMax&&"number"==typeof e.latMax}return!1},r.isAny=function(t){return t instanceof r||r.isInit(t)},S([e],r,"undefined",null),S([e],r,"globe",null),r}(fa),Oa=function(t){function r(e,r,n){var i=t.call(this)||this;return i.x=e,i.y=r,i.z=n,i}return P(r,t),Object.defineProperty(r.prototype,"lngMin",{get:function(){return r.unprojectX(this.x/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"latMin",{get:function(){return r.unprojectY(this.y/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lngMax",{get:function(){return r.unprojectX((this.x+1)/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"latMax",{get:function(){return r.unprojectY((this.y+1)/(1<<this.z))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"west",{get:function(){return this.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"south",{get:function(){return this.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"east",{get:function(){return this.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"north",{get:function(){return this.latMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"southWest",{get:function(){return new ca(this.lngMin,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"northWest",{get:function(){return new ca(this.lngMin,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"southEast",{get:function(){return new ca(this.lngMax,this.latMin)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"northEast",{get:function(){return new ca(this.lngMax,this.latMax)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"center",{get:function(){return new ca((this.lngMin+this.lngMax)/2,(this.latMin+this.latMax)/2)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"southWestTile",{get:function(){return new r(2*this.x,2*this.y,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"northWestTile",{get:function(){return new r(2*this.x,2*this.y+1,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"southEastTile",{get:function(){return new r(2*this.x+1,2*this.y,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"northEastTile",{get:function(){return new r(2*this.x+1,2*this.y+1,this.z+1)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"parentTile",{get:function(){return new r(this.x>>1,this.y>>1,this.z-1)},enumerable:!1,configurable:!0}),r.prototype.contains=function(t,e){if("number"==typeof t)return this.lngMin<=t&&t<=this.lngMax&&this.latMin<=e&&e<=this.latMax;if(ca.isAny(t))return this.containsPoint(ca.fromAny(t));if(ya.isAny(t))return this.containsSegment(ya.fromAny(t));if(r.isAny(t))return this.containsTile(r.fromAny(t));if(xa.isAny(t))return this.containsBox(xa.fromAny(t));throw new TypeError(""+t)},r.prototype.containsPoint=function(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax},r.prototype.containsSegment=function(t){return this.lngMin<=t.lng0&&t.lng0<=this.lngMax&&this.latMin<=t.lat0&&t.lat0<=this.latMax&&this.lngMin<=t.lng1&&t.lng1<=this.lngMax&&this.latMin<=t.lat1&&t.lat1<=this.latMax},r.prototype.containsTile=function(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax},r.prototype.containsBox=function(t){return this.lngMin<=t.lngMin&&t.lngMax<=this.lngMax&&this.latMin<=t.latMin&&t.latMax<=this.latMax},r.prototype.intersects=function(t){if(ca.isAny(t))return this.intersectsPoint(ca.fromAny(t));if(ya.isAny(t))return this.intersectsSegment(ya.fromAny(t));if(r.isAny(t))return this.intersectsTile(r.fromAny(t));if(xa.isAny(t))return this.intersectsBox(xa.fromAny(t));throw new TypeError(""+t)},r.prototype.intersectsPoint=function(t){return this.lngMin<=t.lng&&t.lng<=this.lngMax&&this.latMin<=t.lat&&t.lat<=this.latMax},r.prototype.intersectsSegment=function(t){var e=this.lngMin,r=this.latMin,n=this.lngMax,i=this.latMax,o=t.lng0,s=t.lat0,u=t.lng1,a=t.lat1;return!(o<e&&u<e||o>n&&u>n||s<r&&a<r||s>i&&a>i)&&(o>e&&o<n&&s>r&&s<i||!!(Nu.intersectsSegment(o-e,u-e,o,s,u,a)&&Nu.hitY>r&&Nu.hitY<i||Nu.intersectsSegment(s-r,a-r,o,s,u,a)&&Nu.hitX>e&&Nu.hitX<n||Nu.intersectsSegment(o-n,u-n,o,s,u,a)&&Nu.hitY>r&&Nu.hitY<i||Nu.intersectsSegment(s-i,a-i,o,s,u,a)&&Nu.hitX>e&&Nu.hitX<n))},r.prototype.intersectsTile=function(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax},r.prototype.intersectsBox=function(t){return this.lngMin<=t.lngMax&&t.lngMin<=this.lngMax&&this.latMin<=t.latMax&&t.latMin<=this.latMax},r.prototype.project=function(t){var e=t.project(this.lngMin,this.latMin),r=t.project(this.lngMax,this.latMax),n=e.x,i=e.y,o=r.x,s=r.y;if(n>o){var u=n;n=o,o=u}if(i>s){var a=i;i=s,s=a}return isFinite(n)||(n=-1/0),isFinite(i)||(i=-1/0),isFinite(o)||(o=1/0),isFinite(s)||(s=1/0),new Nu(n,i,o,s)},r.prototype.toAny=function(){return{x:this.x,y:this.y,z:this.z}},r.prototype.equivalentTo=function(t,e){return this===t||t instanceof r&&(m.equivalent(this.x,t.x,e)&&m.equivalent(this.y,t.y,e)&&m.equivalent(this.z,t.z,e))},r.prototype.equals=function(t){return this===t||t instanceof r&&(this.x===t.x&&this.y===t.y&&this.z===t.z)},r.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(b.hash(r),m.hash(this.x)),m.hash(this.y)),m.hash(this.z)))},r.prototype.debug=function(t){return t=t.write("GeoTile").write(46).write("of").write(40).debug(this.x).write(", ").debug(this.y).write(", ").debug(this.z).write(41)},r.prototype.toString=function(){return nt.debug(this)},r.root=function(){return new r(0,0,0)},r.of=function(t,e,n){return new r(t,e,n)},r.fromInit=function(t){return new r(t.x,t.y,t.z)},r.fromTuple=function(t){return new r(t[0],t[1],t[2])},r.fromAny=function(t){if(null==t||t instanceof r)return t;if(r.isInit(t))return r.fromInit(t);if(r.isTuple(t))return r.fromTuple(t);throw new TypeError(""+t)},r.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z}return!1},r.isTuple=function(t){return Array.isArray(t)&&3===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&"number"==typeof t[2]},r.isAny=function(t){return t instanceof r||r.isInit(t)||r.isTuple(t)},r.unprojectX=function(t){return(t*Math.PI*2-Math.PI)*(180/Math.PI)},r.unprojectY=function(t){return(2*Math.atan(Math.exp(t*Math.PI*2-Math.PI))-Math.PI/2)*(180/Math.PI)},S([e],r,"root",null),r}(fa),Ca=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.lngMin+t*(n.lngMin-e.lngMin),o=e.latMin+t*(n.latMin-e.latMin),s=e.lngMax+t*(n.lngMax-e.lngMax),u=e.latMax+t*(n.latMax-e.latMax);return new xa(i,o,s,u)};return Object.setPrototypeOf(r,Ca.prototype),r[0]=t,r[1]=e,r};Ca.prototype=Object.create($t.prototype);var Ea=function(t){function r(e){var r=t.call(this)||this;return r.shapes=e,r.boundingBox=null,r}return P(r,t),r.prototype.isDefined=function(){return 0!==this.shapes.length},Object.defineProperty(r.prototype,"lngMin",{get:function(){return this.bounds.lngMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"latMin",{get:function(){return this.bounds.latMin},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lngMax",{get:function(){return this.bounds.lngMax},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"latMax",{get:function(){return this.bounds.latMax},enumerable:!1,configurable:!0}),r.prototype.contains=function(t,e){return!1},r.prototype.intersects=function(t){return!1},r.prototype.project=function(t){var e=this.shapes,r=e.length;if(r>0){for(var n=new Array(r),i=0;i<r;i+=1)n[i]=e[i].project(t);return new Lu(n)}return Lu.empty()},Object.defineProperty(r.prototype,"bounds",{get:function(){var t=this.boundingBox;if(null===t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=this.shapes,s=0,u=o.length;s<u;s+=1){var a=o[s];e=Math.min(e,a.lngMin),r=Math.min(r,a.latMin),n=Math.max(a.lngMax,n),i=Math.max(a.latMax,i)}t=new xa(e,r,n,i),this.boundingBox=t}return t},enumerable:!1,configurable:!0}),r.prototype.equivalentTo=function(t,e){return this===t||t instanceof r&&C.equivalent(this.shapes,t.shapes,e)},r.prototype.equals=function(t){return this===t||t instanceof r&&C.equal(this.shapes,t.shapes)},r.prototype.debug=function(t){var e=this.shapes,r=e.length;if(t=t.write("GeoGroup").write(46),0===r)t=t.write("empty").write(40);else{t=(t=t.write("of").write(40)).debug(e[0]);for(var n=1;n<r;n+=1)t=t.write(", ").debug(e[n])}return t=t.write(41)},r.prototype.toString=function(){return nt.debug(this)},r.empty=function(){return new r(C.empty)},r.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new r(t)},S([e],r,"empty",null),r}(fa),Pa={is:function(t){return Sa.is(t)||ja.is(t)||qa.is(t)},toShape:function(t){return"Feature"===t.type?ja.toShape(t):"FeatureCollection"===t.type?qa.toShapes(t):Sa.toShape(t)}},Sa={is:function(t){if("object"==typeof t&&null!==t){var e=t;return("Point"===e.type||"MultiPoint"===e.type||"LineString"===e.type||"MultiLineString"===e.type||"Polygon"===e.type||"MultiPolygon"===e.type)&&Array.isArray(e.coordinates)||"GeometryCollection"===e.type&&Array.isArray(e.geometries)}return!1},toShape:function(t){if("Point"===t.type)return ka.toShape(t);if("MultiPoint"===t.type)return Ma.toShape(t);if("LineString"===t.type)return Aa.toShape(t);if("MultiLineString"===t.type)return Da.toShape(t);if("Polygon"===t.type)return Ia.toShape(t);if("MultiPolygon"===t.type)return Ta.toShape(t);if("GeometryCollection"===t.type)return Va.toShape(t);throw new TypeError(""+t)}},ka={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"Point"===e.type&&Array.isArray(e.coordinates)}return!1},toShape:function(t){var e=t.coordinates;return new ca(e[0],e[1])}},Ma={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"MultiPoint"===e.type&&Array.isArray(e.coordinates)}return!1},toShape:function(t){for(var e=t.coordinates,r=e.length,n=new Array(r),i=0;i<r;i+=1){var o=e[i];n[i]=new ca(o[0],o[1])}return new Ea(n)}},Aa={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"LineString"===e.type&&Array.isArray(e.coordinates)}return!1},toShape:function(t){var e=t.coordinates,r=e.length;if(r>0){for(var n=new Array(r-1),i=e[0],o=i[0],s=i[1],u=1;u<r;u+=1)i=e[u],n[u-1]=new ya(o,s,o=i[0],s=i[1]);return new ma(n,!1)}return ma.empty()}},Da={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"MultiLineString"===e.type&&Array.isArray(e.coordinates)}return!1},toShape:function(t){for(var e=t.coordinates,r=e.length,n=new Array(r),i=0;i<r;i+=1){var o=e[i],s=o.length;if(s>0){for(var u=new Array(s-1),a=o[0],p=a[0],h=a[1],f=1;f<s;f+=1)a=o[f],u[f-1]=new ya(p,h,p=a[0],h=a[1]);n[i]=new ma(u,!1)}else n[i]=ma.empty()}return new Ea(n)}},Ia={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"Polygon"===e.type&&Array.isArray(e.coordinates)}return!1},toShape:function(t){for(var e=t.coordinates,r=e.length,n=new Array(r),i=0;i<r;i+=1){var o=e[i],s=o.length;if(s>0){for(var u=new Array(s-1),a=o[0],p=a[0],h=a[1],f=1;f<s;f+=1)a=o[f],u[f-1]=new ya(p,h,p=a[0],h=a[1]);n[i]=new ma(u,!0)}else n[i]=ma.empty()}return new ga(n)}},Ta={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"MultiPolygon"===e.type&&Array.isArray(e.coordinates)}return!1},toShape:function(t){for(var e=t.coordinates,r=e.length,n=new Array(r),i=0;i<r;i+=1){for(var o=e[i],s=o.length,u=new Array(s),a=0;a<s;a+=1){var p=o[a],h=p.length;if(h>0){for(var f=new Array(h-1),c=p[0],l=c[0],d=c[1],y=1;y<h;y+=1)c=p[y],f[y-1]=new ya(l,d,l=c[0],d=c[1]);u[a]=new ma(f,!0)}else u[a]=ma.empty()}n[i]=new ga(u)}return new Ea(n)}},Va={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"GeometryCollection"===e.type&&Array.isArray(e.geometries)}return!1},toShape:function(t){for(var e=t.geometries,r=e.length,n=new Array(r),i=0;i<r;i+=1)n[i]=Sa.toShape(e[i]);return new Ea(n)}},ja={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"Feature"===e.type&&Sa.is(e.geometry)&&"object"==typeof e.properties}return!1},toShape:function(t){var e=t.geometry;return null!==e?Sa.toShape(e):null}},qa={is:function(t){if("object"==typeof t&&null!==t){var e=t;return"FeatureCollection"===e.type&&Array.isArray(e.features)}return!1},toShapes:function(t){for(var e=t.features,r=e.length,n=new Array(r),i=0;i<r;i+=1)n[i]=ja.toShape(e[i]);return n}},Ra=function(){function t(t,e){this.name=t,this.offset=e}return t.prototype.isUTC=function(){return 0===this.offset},t.prototype.isLocal=function(){return this.offset===-(new Date).getTimezoneOffset()},t.prototype.equals=function(e){return this===e||e instanceof t&&this.offset===e.offset},t.prototype.hashCode=function(){return f.mash(f.mix(b.hash(t),m.hash(this.offset)))},t.prototype.debug=function(t){return t=t.write("TimeZone").write(46),t=(t="UTC"===this.name&&0===this.offset?t.write("utc").write(40):void 0===this.name?t.write("forOffset").write(40).debug(this.offset):t.write("create").write(40).debug(this.name).write(", ").debug(this.offset)).write(41)},t.prototype.toString=function(){return nt.debug(this)},Object.defineProperty(t,"utc",{get:function(){return new t("UTC",0)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"local",{get:function(){return t.forOffset(-(new Date).getTimezoneOffset())},enumerable:!1,configurable:!0}),t.create=function(e,r){return"UTC"===e&&0===r?t.utc:new t(e,r)},t.forName=function(e){return"UTC"===e?t.utc:null},t.forOffset=function(e){return 0===e?t.utc:new t(void 0,e)},t.fromAny=function(e){if(null==e||e instanceof t)return e;if("string"==typeof e){var r=t.forName(e);if(null!==r)return r}else if("number"==typeof e)return t.forOffset(e);throw new TypeError(""+e)},t.fromValue=function(e){var r=e.stringValue(void 0);if(void 0!==r)return t.forName(r);var n=e.numberValue(void 0);return void 0!==n?t.forOffset(n):null},t.isAny=function(e){return e instanceof t||"string"==typeof e||"number"==typeof e},t.form=function(){return new Ua(t.utc)},S([e],t,"utc",null),S([e],t,"local",null),S([e],t,"form",null),t}(),Ua=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t){var e=(t=Ra.fromAny(t)).name;return void 0!==e?lr.from(e):yr.from(t.offset)},e.prototype.cast=function(t){var e=t.toValue(),r=Ra.fromValue(e);return null!==r?r:void 0},e}(Sn),Na=function(){function t(t,e){void 0===e&&(e=Ra.utc),this.time=t,this.zone=e}return t.prototype.isDefined=function(){return isFinite(new Date(this.time).getTime())},Object.defineProperty(t.prototype,"year",{get:function(){return this.toUTCLocalDate().getUTCFullYear()},enumerable:!1,configurable:!0}),t.prototype.withYear=function(e,r,n,i,o,s,u){var a=this.toUTCLocalDate();return a.setUTCFullYear(e),void 0!==r&&a.setUTCMonth(r),void 0!==n&&a.setUTCDate(n),void 0!==i&&a.setUTCHours(i),void 0!==o&&a.setUTCMinutes(o),void 0!==s&&a.setUTCSeconds(s),void 0!==u&&a.setUTCMilliseconds(u),t.fromUTCLocalDate(a,this.zone)},Object.defineProperty(t.prototype,"month",{get:function(){return this.toUTCLocalDate().getUTCMonth()},enumerable:!1,configurable:!0}),t.prototype.withMonth=function(e,r,n,i,o,s){var u=this.toUTCLocalDate();return u.setUTCMonth(e),void 0!==r&&u.setUTCDate(r),void 0!==n&&u.setUTCHours(n),void 0!==i&&u.setUTCMinutes(i),void 0!==o&&u.setUTCSeconds(o),void 0!==s&&u.setUTCMilliseconds(s),t.fromUTCLocalDate(u,this.zone)},Object.defineProperty(t.prototype,"day",{get:function(){return this.toUTCLocalDate().getUTCDate()},enumerable:!1,configurable:!0}),t.prototype.withDay=function(e,r,n,i,o){var s=this.toUTCLocalDate();return s.setUTCDate(e),void 0!==r&&s.setUTCHours(r),void 0!==n&&s.setUTCMinutes(n),void 0!==i&&s.setUTCSeconds(i),void 0!==o&&s.setUTCMilliseconds(o),t.fromUTCLocalDate(s,this.zone)},Object.defineProperty(t.prototype,"hour",{get:function(){return this.toUTCLocalDate().getUTCHours()},enumerable:!1,configurable:!0}),t.prototype.withHour=function(e,r,n,i){var o=this.toUTCLocalDate();return o.setUTCHours(e),void 0!==r&&o.setUTCMinutes(r),void 0!==n&&o.setUTCSeconds(n),void 0!==i&&o.setUTCMilliseconds(i),t.fromUTCLocalDate(o,this.zone)},Object.defineProperty(t.prototype,"minute",{get:function(){return this.toUTCLocalDate().getUTCMinutes()},enumerable:!1,configurable:!0}),t.prototype.withMinute=function(e,r,n){var i=this.toUTCLocalDate();return i.setUTCMinutes(e),void 0!==r&&i.setUTCSeconds(r),void 0!==n&&i.setUTCMilliseconds(n),t.fromUTCLocalDate(i,this.zone)},Object.defineProperty(t.prototype,"second",{get:function(){return this.toUTCLocalDate().getUTCSeconds()},enumerable:!1,configurable:!0}),t.prototype.withSecond=function(e,r){var n=this.toUTCLocalDate();return n.setUTCSeconds(e),void 0!==r&&n.setUTCMilliseconds(r),t.fromUTCLocalDate(n,this.zone)},Object.defineProperty(t.prototype,"millisecond",{get:function(){return this.toUTCLocalDate().getUTCMilliseconds()},enumerable:!1,configurable:!0}),t.prototype.withMillisecond=function(e){var r=this.toUTCLocalDate();return r.setUTCMilliseconds(e),t.fromUTCLocalDate(r,this.zone)},Object.defineProperty(t.prototype,"weekday",{get:function(){return this.toUTCLocalDate().getUTCDay()},enumerable:!1,configurable:!0}),t.prototype.toUTCLocalDate=function(){return new Date(this.time+6e4*this.zone.offset)},t.prototype.toDate=function(){return new Date(this.time)},t.prototype.valueOf=function(){return this.time},t.prototype.interpolateTo=function(e){return e instanceof t?za(this,e):null},t.prototype.compareTo=function(e){if(e instanceof t){var r=this.time,n=e.time;return r<n?-1:r>n?1:r===n?0:NaN}return NaN},t.prototype.equivalentTo=function(e,r){return this===e||e instanceof t&&m.equivalent(this.time,e.time,r)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.time===e.time&&this.zone.equals(e.zone))},t.prototype.hashCode=function(){return f.mash(f.mix(f.mix(b.hash(t),m.hash(this.time)),this.zone.hashCode()))},t.prototype.display=function(t,e){return void 0===e&&(e=Wa.iso8601),t=e.writeDate(t,this)},t.prototype.toString=function(t){return void 0===t&&(t=Wa.iso8601),t.format(this)},t.current=function(e){return e=void 0!==e?Ra.fromAny(e):Ra.local,new t(Date.now(),e)},t.fromUTCLocalDate=function(e,r){return new t(e.getTime()-6e4*r.offset,r)},t.fromInit=function(e,r){var n=Date.UTC(void 0!==e.year?e.year:1970,void 0!==e.month?e.month:0,void 0!==e.day?e.day:1,void 0!==e.hour?e.hour:0,void 0!==e.minute?e.minute:0,void 0!==e.second?e.second:0,void 0!==e.millisecond?e.millisecond:0);return void 0!==e.zone&&(r=Ra.fromAny(e.zone)),void 0!==r?n+=6e4*(r=Ra.fromAny(r)).offset:r=Ra.utc,new t(n,r)},t.fromAny=function(e,r){if(null==e||e instanceof t)return e;if(e instanceof Date)return r=void 0!==r?Ra.fromAny(r):Ra.utc,new t(e.getTime(),r);if("number"==typeof e)return new t(e,r=void 0!==r?Ra.fromAny(r):Ra.utc);if("string"==typeof e)return t.parse(e,r);if(t.isInit(e))return t.fromInit(e,r);throw new TypeError(""+e)},t.fromValue=function(e){var r,n=e.header("date");n.isDefined()?(e=n,r=!0):r=!1;var i={};return e.forEach((function(t,e){var n=t.key.stringValue(void 0);void 0!==n?"year"===n?i.year=t.toValue().numberValue(i.year):"month"===n?i.month=t.toValue().numberValue(i.month):"day"===n?i.day=t.toValue().numberValue(i.day):"hour"===n?i.hour=t.toValue().numberValue(i.hour):"minute"===n?i.minute=t.toValue().numberValue(i.minute):"second"===n?i.second=t.toValue().numberValue(i.second):"millisecond"===n?i.millisecond=t.toValue().numberValue(i.millisecond):"zone"===n&&(i.zone=t.toValue().cast(Ra.form(),i.zone)):t instanceof ir&&r&&(0===e?i.year=t.numberValue(i.year):1===e?i.month=t.numberValue(i.month):2===e?i.day=t.numberValue(i.day):3===e?i.hour=t.numberValue(i.hour):4===e?i.minute=t.numberValue(i.minute):5===e?i.second=t.numberValue(i.second):6===e?i.millisecond=t.numberValue(i.millisecond):7===e&&(i.zone=t.cast(Ra.form(),i.zone)))})),t.isInit(i)?t.fromInit(i):null},t.parse=function(t,e){return Wa.iso8601.parse(t)},t.time=function(e){if(e instanceof t)return e.time;if(e instanceof Date)return e.getTime();if("number"==typeof e)return e;if("string"==typeof e)return t.parse(e).time;if(t.isInit(e))return t.fromInit(e).time;throw new TypeError(""+e)},t.zone=function(e){return e instanceof t?e.zone:Ra.utc},t.isInit=function(t){if("object"==typeof t&&null!==t){var e=t;return(void 0===e.year||"number"==typeof e.year)&&(void 0===e.month||"number"==typeof e.month)&&(void 0===e.day||"number"==typeof e.day)&&(void 0===e.hour||"number"==typeof e.hour)&&(void 0===e.minute||"number"==typeof e.minute)&&(void 0===e.second||"number"==typeof e.second)&&(void 0===e.millisecond||"number"==typeof e.millisecond)&&(void 0===e.zone||Ra.isAny(e.zone))&&("number"==typeof e.year||"number"==typeof e.month||"number"==typeof e.day||"number"==typeof e.hour||"number"==typeof e.minute||"number"==typeof e.second||"number"==typeof e.millisecond)}return!1},t.isAny=function(e){return e instanceof t||e instanceof Date||"number"==typeof e||"string"==typeof e||t.isInit(e)},t.form=function(){return new Fa(new t(0))},S([e],t,"form",null),t}(),za=function(t,e){var r=function(t){var e=r[0],n=r[1];return new Na(e.time+t*(n.time-e.time),n.zone)};return Object.setPrototypeOf(r,za.prototype),r[0]=t,r[1]=e,r};za.prototype=Object.create($t.prototype);var Fa=function(t){function e(e){var r=t.call(this)||this;return Object.defineProperty(r,"unit",{value:e,enumerable:!0}),r}return P(e,t),e.prototype.withUnit=function(t){return t!==this.unit?new e(t):this},e.prototype.mold=function(t){return t=Na.fromAny(t),lr.from(t.toString())},e.prototype.cast=function(t){var e=null;try{if(void 0===(e=Na.fromValue(t))){var r=t.numberValue(void 0);if(void 0!==r)e=new Na(r);else{var n=t.stringValue(void 0);void 0!==n&&(e=Na.parse(n))}}}catch(t){}return null!==e?e:void 0},e}(Sn),La=function(t){function e(e){var r=t.call(this)||this;return r.dateParser=e,r}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.dateParser)},e.parse=function(t,r){return(r=r.feed(t)).isDone()?bt.done(Na.fromAny(r.bind())):r.isError()?r.asError():new e(r)},e}(bt),Ka=function(){function t(e,r,n,i,o){void 0===e&&(e=t.Periods),void 0===r&&(r=t.Weekdays),void 0===n&&(n=t.ShortWeekdays),void 0===i&&(i=t.Months),void 0===o&&(o=t.ShortMonths),this.periods=e,this.weekdays=r,this.shortWeekdays=n,this.months=i,this.shortMonths=o}return t.standard=function(){return new t},t.Periods=["AM","PM"],t.Weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.ShortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.ShortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],S([e],t,"standard",null),t}(),Ba={standard:function(t){var e;return void 0===t&&(t=Ka.standard()),t===Ka.standard()&&(e=Ba._standard),void 0===e&&(e={Y:Wa.year,m:Wa.monthOfYear,B:Wa.month.withLocale(t),b:Wa.shortMonth.withLocale(t),d:Wa.dayOfMonth,A:Wa.weekday.withLocale(t),a:Wa.shortWeekday.withLocale(t),H:Wa.hour24,I:Wa.hour12,p:Wa.period.withLocale(t),M:Wa.minute,S:Wa.second,L:Wa.millisecond},t===Ka.standard()&&(Ba._standard=e)),e}},Wa=function(){function t(){}return t.prototype.withLocale=function(t){return this},t.prototype.format=function(t){t=Na.fromAny(t);var e=rt.stringOutput();return(e=this.writeDate(e,t)).bind()},t.prototype.parse=function(t){for("string"==typeof t&&(t=rt.stringInput(t));t.isCont()&&rt.isSpace(t.head());)t=t.step();var e=this.parseDate(t,{});if(e.isDone())for(;t.isCont()&&rt.isSpace(t.head());)t=t.step();return t.isCont()&&!e.isError()&&(e=bt.error(ot.unexpected(t))),e.bind()},t.prototype.parseDate=function(t,e){var r=this.parseDateTime(t,e);return r.isDone()?bt.done(Na.fromAny(r.bind())):r.isError()?r.asError():new La(r)},Object.defineProperty(t,"year",{get:function(){return new Ha},enumerable:!1,configurable:!0}),Object.defineProperty(t,"monthOfYear",{get:function(){return new Xa},enumerable:!1,configurable:!0}),Object.defineProperty(t,"month",{get:function(){return new Ya(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shortMonth",{get:function(){return new Ga(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(t,"dayOfMonth",{get:function(){return new _a},enumerable:!1,configurable:!0}),Object.defineProperty(t,"weekday",{get:function(){return new Qa(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shortWeekday",{get:function(){return new Za(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(t,"hour24",{get:function(){return new Ja},enumerable:!1,configurable:!0}),Object.defineProperty(t,"hour12",{get:function(){return new $a},enumerable:!1,configurable:!0}),Object.defineProperty(t,"period",{get:function(){return new tp(Ka.standard())},enumerable:!1,configurable:!0}),Object.defineProperty(t,"minute",{get:function(){return new ep},enumerable:!1,configurable:!0}),Object.defineProperty(t,"second",{get:function(){return new rp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"millisecond",{get:function(){return new np},enumerable:!1,configurable:!0}),t.pattern=function(t,e){return(void 0===e||e instanceof Ka)&&(e=Ba.standard(e)),new ip(t,e)},Object.defineProperty(t,"iso8601",{get:function(){return new ip("%Y-%m-%dT%H:%M:%S.%LZ",Ba.standard())},enumerable:!1,configurable:!0}),t.parseDateNumber=function(t,e,r,n,i,o,s,u){void 0===s&&(s=0),void 0===u&&(u=0);for(var a=0;u<i&&t.isCont()&&(a=t.head(),it.isDigit(a));)t.step(),s=10*s+it.decodeDigit(a),u+=1;return t.isEmpty()?e.cont(void 0!==o?o:{},s,u,t):u>=n?e.term(s,o||{},t):bt.error(ot.expected(r,t))},t.parseDateString=function(t,e,r,n,i){var o=0;for(i=void 0!==i?i:rt.stringOutput();;){if(!t.isCont()||(o=t.head(),!rt.isAlpha(o))){if(!t.isEmpty())return e.term(r,i.bind(),void 0!==n?n:{},t);break}t.step(),i.write(o)}return e.cont(r,void 0!==n?n:{},i,t)},t.writeDateNumber2=function(t,e){var r=48+e%10,n=48+(e/=10)%10;return t=t.write(n).write(r)},t.writeDateNumber3=function(t,e){var r=48+e%10,n=48+(e/=10)%10,i=48+(e/=10)%10;return t=t.write(i).write(n).write(r)},t.writeDateNumber4=function(t,e){var r=48+e%10,n=48+(e/=10)%10,i=48+(e/=10)%10,o=48+(e/=10)%10;return t=t.write(o).write(i).write(n).write(r)},S([e],t,"year",null),S([e],t,"monthOfYear",null),S([e],t,"month",null),S([e],t,"shortMonth",null),S([e],t,"dayOfMonth",null),S([e],t,"weekday",null),S([e],t,"shortWeekday",null),S([e],t,"hour24",null),S([e],t,"hour12",null),S([e],t,"period",null),S([e],t,"minute",null),S([e],t,"second",null),S([e],t,"millisecond",null),S([e],t,"iso8601",null),t}(),Ha=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){return t=Wa.writeDateNumber4(t,e.year)},e.prototype.parseDateTime=function(t,e){return op.parse(t,e)},e}(Wa),Xa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){return t=Wa.writeDateNumber2(t,e.month+1)},e.prototype.parseDateTime=function(t,e){return sp.parse(t,e)},e}(Wa),Ya=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return P(e,t),e.prototype.withLocale=function(t){return t!==this.locale?new e(t):this},e.prototype.writeDate=function(t,e){return t=t.write(this.locale.months[e.month])},e.prototype.parseDateTime=function(t,e){return up.parse(t,this.locale,e)},e}(Wa),Ga=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return P(e,t),e.prototype.withLocale=function(t){return t!==this.locale?new e(t):this},e.prototype.writeDate=function(t,e){return t=t.write(this.locale.shortMonths[e.month])},e.prototype.parseDateTime=function(t,e){return ap.parse(t,this.locale,e)},e}(Wa),_a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){return t=Wa.writeDateNumber2(t,e.day)},e.prototype.parseDateTime=function(t,e){return pp.parse(t,e)},e}(Wa),Qa=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return P(e,t),e.prototype.withLocale=function(t){return t!==this.locale?new e(t):this},e.prototype.writeDate=function(t,e){return t=t.write(this.locale.weekdays[e.weekday])},e.prototype.parseDateTime=function(t,e){return hp.parse(t,this.locale,e)},e}(Wa),Za=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return P(e,t),e.prototype.withLocale=function(t){return t!==this.locale?new e(t):this},e.prototype.writeDate=function(t,e){return t=t.write(this.locale.shortWeekdays[e.weekday])},e.prototype.parseDateTime=function(t,e){return fp.parse(t,this.locale,e)},e}(Wa),Ja=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){return t=Wa.writeDateNumber2(t,e.hour)},e.prototype.parseDateTime=function(t,e){return cp.parse(t,e)},e}(Wa),$a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){var r=e.hour%12;return 0===r&&(r=12),t=Wa.writeDateNumber2(t,r)},e.prototype.parseDateTime=function(t,e){return lp.parse(t,e)},e}(Wa),tp=function(t){function e(e){var r=t.call(this)||this;return r.locale=e,r}return P(e,t),e.prototype.withLocale=function(t){return t!==this.locale?new e(t):this},e.prototype.writeDate=function(t,e){return t=t.write(this.locale.periods[e.hour>=12?1:0])},e.prototype.parseDateTime=function(t,e){return dp.parse(t,this.locale,e)},e}(Wa),ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){return t=Wa.writeDateNumber2(t,e.minute)},e.prototype.parseDateTime=function(t,e){return yp.parse(t,e)},e}(Wa),rp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){return t=Wa.writeDateNumber2(t,e.second)},e.prototype.parseDateTime=function(t,e){return vp.parse(t,e)},e}(Wa),np=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.writeDate=function(t,e){return t=Wa.writeDateNumber3(t,e.millisecond)},e.prototype.parseDateTime=function(t,e){return mp.parse(t,e)},e}(Wa),ip=function(t){function e(e,r){var n=t.call(this)||this;return n.pattern=e,n.specifiers=r,n}return P(e,t),e.prototype.writeDate=function(t,e){for(var r=this.pattern,n=this.specifiers,i=0,o=0,s=r.length;o<s;)if(37===r.charCodeAt(o)){i!==o&&(t=t.write(r.slice(i,o)));var u=n[r.charAt(o+1)];void 0!==u&&(t=u.writeDate(t,e)),i=o+=2}else o+=1;return i!==o&&(t=t.write(r.slice(i,o))),t},e.prototype.parseDateTime=function(t,e){return wp.parse(t,this.pattern,this.specifiers,e)},e}(Wa),op=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.year=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.year,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"full year",4,4,r,n,i)},e.term=function(t,e){return e.year=t,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),sp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.month=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.month,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"month number",2,2,r,n,i)},e.term=function(t,e){return e.month=t-1,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),up=function(t){function e(e,r,n){var i=t.call(this)||this;return i.locale=e,i.date=r,i.output=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,n,i){return Wa.parseDateString(t,e,r,n,i)},e.term=function(t,e,r,n){var i=t.months.indexOf(e);return i>=0?(r.month=i,bt.done(r)):bt.error(ot.message("expected month, but found "+e,n))},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),ap=function(t){function e(e,r,n){var i=t.call(this)||this;return i.locale=e,i.date=r,i.output=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,n,i){return Wa.parseDateString(t,e,r,n,i)},e.term=function(t,e,r,n){var i=t.shortMonths.indexOf(e);return i>=0?(r.month=i,bt.done(r)):bt.error(ot.message("expected short month, but found "+e,n))},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),pp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.day=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.day,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"day of month",2,2,r,n,i)},e.term=function(t,e){return e.day=t,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),hp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.locale=e,i.date=r,i.output=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,n,i){return Wa.parseDateString(t,e,r,n,i)},e.term=function(t,e,r,n){return t.weekdays.indexOf(e)>=0?bt.done(r):bt.error(ot.message("expected weekday, but found "+e,n))},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),fp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.locale=e,i.date=r,i.output=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,n,i){return Wa.parseDateString(t,e,r,n,i)},e.term=function(t,e,r,n){return t.shortWeekdays.indexOf(e)>=0?bt.done(r):bt.error(ot.message("expected short weekday, but found "+e,n))},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),cp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.hour=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.hour,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"hour (24)",2,2,r,n,i)},e.term=function(t,e){return e.hour=t,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),lp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.hour=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.hour,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"hour (12)",2,2,r,n,i)},e.term=function(t,e){return e.hour=(void 0!==e.hour?e.hour:0)+t,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),dp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.locale=e,i.date=r,i.output=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,r,n,i){return Wa.parseDateString(t,e,r,n,i)},e.term=function(t,e,r,n){var i=t.months.indexOf(e);return i>=0?(r.hour=(r.hour||0)+12*i,bt.done(r)):bt.error(ot.message("expected period of day, but found "+e,n))},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),yp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.minute=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.minute,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"minute",2,2,r,n,i)},e.term=function(t,e){return e.minute=t,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),vp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.second=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.second,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"second",2,2,r,n,i)},e.term=function(t,e){return e.second=t,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),mp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.date=e,i.millisecond=r,i.step=n,i}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.millisecond,this.step)},e.parse=function(t,r,n,i){return Wa.parseDateNumber(t,e,"millisecond",1,3,r,n,i)},e.term=function(t,e){return e.millisecond=t,bt.done(e)},e.cont=function(t,r,n){return new e(t,r,n)},e}(bt),wp=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.pattern=e,s.specifiers=r,s.date=n,s.dateParser=i,s.step=o,s}return P(e,t),e.prototype.feed=function(t){return e.parse(t,this.pattern,this.specifiers,this.date,this.dateParser,this.step)},e.parse=function(t,r,n,i,o,s){void 0===i&&(i={}),void 0===s&&(s=0);for(var u=r.length;s<u;){var a=r.charCodeAt(s);if(37===a){if(void 0===o){var p=r.charAt(s+1),h=n[p];if(void 0===h)return bt.error(ot.message("unknown format specifier: "+p,t));o=h.parseDateTime(t,i)}else o=o.feed(t);if(o.isDone()){i=o.bind(),o=void 0,s+=2;continue}if(o.isError())return o.asError()}else{if(t.isCont()){if(t.head()===a){t.step(),s+=1;continue}return bt.error(ot.expected(a,t))}if(!t.isEmpty())return bt.error(ot.unexpected(t))}break}return s===u?bt.done(i):new e(r,n,i,o,s)},e}(bt),gp=function(){function t(){}return t.prototype.next=function(t,e){return this.floor(this.offset(t,e))},t.prototype.ceil=function(t){return t=t instanceof Na?new Na(t.time-1,t.zone):Na.time(t)-1,this.next(this.floor(t),1)},t.prototype.round=function(t){var e=Na.fromAny(t),r=this.floor(e),n=this.ceil(e);return e.time-r.time<n.time-e.time?r:n},t.prototype.range=function(t,e,r){var n=this.ceil(t),i=Na.time(e),o=[];if((r="number"==typeof r?Math.floor(r):1)>0)for(;n.isDefined()&&n.time<i;)o.push(n),n=this.next(n,r);return o},t.prototype.filter=function(t){return new xp(this,t)},Object.defineProperty(t,"year",{get:function(){return new Op},enumerable:!1,configurable:!0}),Object.defineProperty(t,"month",{get:function(){return new Ep},enumerable:!1,configurable:!0}),Object.defineProperty(t,"week",{get:function(){return new Pp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"day",{get:function(){return new Sp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"hour",{get:function(){return new kp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"minute",{get:function(){return new Mp},enumerable:!1,configurable:!0}),Object.defineProperty(t,"second",{get:function(){return new Ap},enumerable:!1,configurable:!0}),Object.defineProperty(t,"millisecond",{get:function(){return new Dp},enumerable:!1,configurable:!0}),t.years=function(e,r,n){return t.year.range(e,r,n)},t.months=function(e,r,n){return t.month.range(e,r,n)},t.weeks=function(e,r,n){return t.week.range(e,r,n)},t.days=function(e,r,n){return t.day.range(e,r,n)},t.hours=function(e,r,n){return t.hour.range(e,r,n)},t.minutes=function(e,r,n){return t.minute.range(e,r,n)},t.seconds=function(e,r,n){return t.second.range(e,r,n)},t.milliseconds=function(e,r,n){return t.millisecond.range(e,r,n)},t.MillisPerSecond=1e3,t.MillisPerMinute=60*t.MillisPerSecond,t.MillisPerHour=60*t.MillisPerMinute,S([e],t,"year",null),S([e],t,"month",null),S([e],t,"week",null),S([e],t,"day",null),S([e],t,"hour",null),S([e],t,"minute",null),S([e],t,"second",null),S([e],t,"millisecond",null),t}(),bp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e}(gp),xp=function(t){function e(e,r){var n=t.call(this)||this;return n.unit=e,n.predicate=r,n}return P(e,t),e.prototype.offset=function(t,e){var r=Na.fromAny(t);for(e=Math.max(1,"number"==typeof e?Math.floor(e):1);e<0;){do{r=this.unit.offset(r,-1)}while(r.isDefined()&&!this.predicate(r));e+=1}for(;e>0;){do{r=this.unit.offset(r,1)}while(r.isDefined()&&!this.predicate(r));e-=1}return r},e.prototype.floor=function(t){for(var e=Na.fromAny(t);(e=this.unit.floor(e)).isDefined()&&!this.predicate(e);)e=new Na(e.time-1,e.zone);return e},e}(gp),Op=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.offset=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r=r.withYear(r.year+e)},e.prototype.next=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withYear(r.year+e).withMonth(0,1).withHour(0,0,0,0)},e.prototype.floor=function(t){return Na.fromAny(t).withMonth(0,1).withHour(0,0,0,0)},e.prototype.ceil=function(t){var e=Na.fromAny(t);return(e=(e=(e=new Na(e.time-1,e.zone)).withMonth(0,1).withHour(0,0,0,0)).withYear(e.year+1)).withMonth(0,1).withHour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Cp(t);throw new Error(""+t)},e}(bp),Cp=function(t){function e(e){var r=t.call(this)||this;return r.stride=e,r}return P(e,t),e.prototype.offset=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withYear(r.year+e*this.stride)},e.prototype.next=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),(r=r.withYear(Math.floor((r.year+e*this.stride)/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)},e.prototype.floor=function(t){var e=Na.fromAny(t);return(e=e.withYear(Math.floor(e.year/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)},e.prototype.ceil=function(t){var e=Na.fromAny(t);return(e=(e=(e=(e=new Na(e.time-1,e.zone)).withYear(Math.floor(e.year/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)).withYear(Math.floor((e.year+this.stride)/this.stride)*this.stride)).withMonth(0,1).withHour(0,0,0,0)},e}(gp),Ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.offset=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withMonth(r.month+e)},e.prototype.next=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),(r=r.withMonth(r.month+e)).withDay(1).withHour(0,0,0,0)},e.prototype.floor=function(t){return Na.fromAny(t).withDay(1).withHour(0,0,0,0)},e.prototype.ceil=function(t){var e=Na.fromAny(t);return(e=(e=(e=new Na(e.time-1,e.zone)).withDay(1).withHour(0,0,0,0)).withMonth(e.month+1)).withDay(1).withHour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new xp(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){var r=e.month;return isFinite(r)&&r%t==0},e}(bp),Pp=function(t){function e(e){void 0===e&&(e=0);var r=t.call(this)||this;return r.day=e,r}return P(e,t),e.prototype.offset=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withDay(r.day+7*e)},e.prototype.next=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),(r=(r=r.withDay(r.day+7*e)).withDay(r.day-(r.weekday+7-this.day)%7)).withHour(0,0,0,0)},e.prototype.floor=function(t){var e=Na.fromAny(t);return(e=e.withDay(e.day-(e.weekday+7-this.day)%7)).withHour(0,0,0,0)},e.prototype.ceil=function(t){var e=Na.fromAny(t);return(e=(e=(e=(e=new Na(e.time-1,e.zone)).withDay(e.day-(e.weekday+7-this.day)%7)).withHour(0,0,0,0)).withDay(e.day+7)).withHour(0,0,0,0)},e}(gp),Sp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.offset=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),r.withDay(r.day+e)},e.prototype.next=function(t,e){var r=Na.fromAny(t);return e=Math.max(1,"number"==typeof e?Math.floor(e):1),(r=r.withDay(r.day+e)).withHour(0,0,0,0)},e.prototype.floor=function(t){return Na.fromAny(t).withHour(0,0,0,0)},e.prototype.ceil=function(t){var e=Na.fromAny(t);return(e=(e=(e=new Na(e.time-1,e.zone)).withHour(0,0,0,0)).withDay(e.day+1)).withHour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new xp(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){var r=e.day;return isFinite(r)&&r%t==0},e}(bp),kp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.offset=function(t,e){var r=Na.zone(t);return t=Na.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*gp.MillisPerHour,new Na(t,r)},e.prototype.next=function(t,e){var r=Na.zone(t);t=Na.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*gp.MillisPerHour;var n=r.offset*gp.MillisPerMinute%gp.MillisPerHour;return n<0&&(n+=gp.MillisPerHour),t=Math.floor((t-n)/gp.MillisPerHour)*gp.MillisPerHour+n,new Na(t,r)},e.prototype.floor=function(t){var e=Na.zone(t);t=Na.time(t);var r=e.offset*gp.MillisPerMinute%gp.MillisPerHour;return r<0&&(r+=gp.MillisPerHour),t=Math.floor((t-r)/gp.MillisPerHour)*gp.MillisPerHour+r,new Na(t,e)},e.prototype.ceil=function(t){var e=Na.zone(t);t=Na.time(t),t-=1;var r=e.offset*gp.MillisPerMinute%gp.MillisPerHour;return r<0&&(r+=gp.MillisPerHour),t=Math.floor((t-r)/gp.MillisPerHour)*gp.MillisPerHour+r+gp.MillisPerHour,t=Math.floor((t-r)/gp.MillisPerHour)*gp.MillisPerHour+r,new Na(t,e)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new xp(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){var r=e.hour;return isFinite(r)&&r%t==0},e}(bp),Mp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.offset=function(t,e){var r=Na.zone(t);return t=Na.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*gp.MillisPerMinute,new Na(t,r)},e.prototype.next=function(t,e){var r=Na.zone(t);return t=Na.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t=Math.floor((t+e*gp.MillisPerMinute)/gp.MillisPerMinute)*gp.MillisPerMinute,new Na(t,r)},e.prototype.floor=function(t){var e=Na.zone(t);return t=Na.time(t),t=Math.floor(t/gp.MillisPerMinute)*gp.MillisPerMinute,new Na(t,e)},e.prototype.ceil=function(t){var e=Na.zone(t);return t=Na.time(t),t=Math.floor((Math.floor((t-1)/gp.MillisPerMinute)*gp.MillisPerMinute+gp.MillisPerMinute)/gp.MillisPerMinute)*gp.MillisPerMinute,new Na(t,e)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new xp(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){var r=e.minute;return isFinite(r)&&r%t==0},e}(bp),Ap=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.offset=function(t,e){var r=Na.zone(t);return t=Na.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*gp.MillisPerSecond,new Na(t,r)},e.prototype.next=function(t,e){var r=Na.zone(t);return t=Na.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*gp.MillisPerSecond,t=Math.floor(t/gp.MillisPerSecond)*gp.MillisPerSecond,new Na(t,r)},e.prototype.floor=function(t){var e=Na.zone(t);return t=Na.time(t),t=Math.floor(t/gp.MillisPerSecond)*gp.MillisPerSecond,new Na(t,e)},e.prototype.ceil=function(t){var e=Na.zone(t);return t=Na.time(t),t=Math.floor((Math.floor((t-1)/gp.MillisPerSecond)*gp.MillisPerSecond+gp.MillisPerSecond)/gp.MillisPerSecond)*gp.MillisPerSecond,new Na(t,e)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new xp(this,e.modulo.bind(void 0,t));throw new Error(""+t)},e.modulo=function(t,e){var r=e.second;return isFinite(r)&&r%t==0},e}(bp),Dp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.offset=function(t,e){var r=Na.zone(t);return t=Na.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new Na(t+=e,r)},e.prototype.next=function(t,e){var r=Na.zone(t);return t=Na.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),new Na(t+=e,r)},e.prototype.floor=function(t){return Na.fromAny(t)},e.prototype.ceil=function(t){return Na.fromAny(t)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new Ip(t);throw new Error(""+t)},e}(bp),Ip=function(t){function e(e){var r=t.call(this)||this;return isFinite(e)||(e=1),r.stride=e,r}return P(e,t),e.prototype.offset=function(t,e){var r=Na.zone(t);return t=Na.time(t),t+=(e=Math.max(1,"number"==typeof e?Math.floor(e):1))*this.stride,new Na(t,r)},e.prototype.next=function(t,e){var r=Na.zone(t);t=Na.time(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1);var n=this.stride;return t=Math.floor((t+e*n)/n)*n,new Na(t,r)},e.prototype.floor=function(t){var e=Na.zone(t);t=Na.time(t);var r=this.stride;return t=Math.floor(t/r)*r,new Na(t,e)},e.prototype.ceil=function(t){var e=Na.zone(t);t=Na.time(t);var r=this.stride;return t=Math.floor((Math.floor((t-1)/r)*r+r)/r)*r,new Na(t,e)},e}(gp),Tp=function(t,e){var r=function(t){var e=r[0].time,n=r[1].time-e;return 0!==n?(t.time-e)/n:0};return Object.setPrototypeOf(r,Tp.prototype),r[0]=t,r[1]=e,r};Tp.prototype=Object.create(Qt.prototype),Object.defineProperty(Tp.prototype,"inverse",{get:function(){return jp(this[0],this[1])},enumerable:!0,configurable:!0}),Tp.prototype.contains=function(t){return t=Na.time(t),this[0].time<=t&&t<=this[1].time},Tp.prototype.interpolateTo=function(t){return t instanceof Tp?Vp(this,t):null},Tp.prototype.canEqual=function(t){return t instanceof Tp},Tp.prototype.equals=function(t){return this===t||t instanceof Tp&&(t.canEqual(this)&&this[0].equals(t[0])&&this[1].equals(t[1]))},Tp.prototype.toString=function(){return"TimeDomain("+this[0]+", "+this[1]+")"};var Vp=function(t,e){var r=function(t){var e=r[0],n=e[0],i=e[1],o=r[1],s=o[0],u=o[1];return Tp(new Na(n.time+t*(s.time-n.time),0===t?n.zone:s.zone),new Na(i.time+t*(u.time-i.time),0===t?i.zone:u.zone))};return Object.setPrototypeOf(r,Vp.prototype),r[0]=t,r[1]=e,r};Vp.prototype=Object.create($t.prototype);var jp=function(t,e){var r=function(t){var e=r[0].time,n=r[1].time;return new Na(e+t*(n-e),0===t?r[0].zone:r[1].zone)};return Object.setPrototypeOf(r,jp.prototype),r[0]=t,r[1]=e,r};jp.prototype=Object.create(Zt.prototype),Object.defineProperty(jp.prototype,"inverse",{get:function(){return Tp(this[0],this[1])},enumerable:!0,configurable:!0}),jp.prototype.interpolateTo=function(t){return t instanceof jp?qp(this,t):null},jp.prototype.canEqual=function(t){return t instanceof jp},jp.prototype.equals=function(t){return this===t||t instanceof jp&&(t.canEqual(this)&&this[0].equals(t[0])&&this[1].equals(t[1]))},jp.prototype.toString=function(){return"TimeRange("+this[0]+", "+this[1]+")"};var qp=function(t,e){var r=function(t){var e=r[0],n=e[0],i=e[1],o=r[1],s=o[0],u=o[1];return jp(new Na(n.time+t*(s.time-n.time),0===t?n.zone:s.zone),new Na(i.time+t*(u.time-i.time),0===t?i.zone:u.zone))};return Object.setPrototypeOf(r,qp.prototype),r[0]=t,r[1]=e,r};qp.prototype=Object.create($t.prototype);var Rp=function(t,e){var r=function(t){return r.range(r.domain(t))};return Object.setPrototypeOf(r,Rp.prototype),r.domain=t,r.range=e,r};Rp.prototype=Object.create(de.prototype),Object.defineProperty(Rp.prototype,"inverse",{get:function(){return _t(this.range.inverse,this.domain.inverse)},enumerable:!0,configurable:!0}),Rp.prototype.withDomain=function(t,e){var r;return 1===arguments.length?r=t:(t=Na.fromAny(t),e=Na.fromAny(e),r=Tp(t,e)),Rp(r,this.range)},Rp.prototype.overRange=function(t,e){var r;return r=1===arguments.length?t:fe(t,e),Rp(this.domain,r)},Rp.prototype.clampDomain=function(t,e,r,n,o){void 0===o&&(o=i.Epsilon);var s=this.domain[0],u=this.domain[1],a=s.time,p=u.time,h=void 0!==t?t.time:void 0,f=void 0!==e?e.time:void 0;void 0!==h&&void 0!==f&&Math.abs(p-a)>f-h?a<p?(a=h,p=f):(p=h,a=f):(void 0!==h&&(a<p&&a<h?(p+=h-a,a=h):p<a&&p<h&&(a+=h-p,p=h)),void 0!==f&&(a<p&&p>f?(a-=p-f,p=f):p<a&&a>f&&(p-=a-f,a=f)));var c=this(s),l=this(u),d=c<l?l-c:c-l,y=Math.abs(d/(p-a));if(void 0!==r&&y<1/r)a=((m=a+p)-(v=d*r))/2,p=(m+v)/2;else if(void 0!==n&&y>1/n){var v,m;a=((m=a+p)-(v=d*n))/2,p=(m+v)/2}return Math.abs(a-s.time)<o&&Math.abs(p-u.time)<o?this:Rp(Tp(new Na(a,s.zone),new Na(p,u.zone)),this.range)},Rp.prototype.solveDomain=function(t,e,r,n,o,s){void 0===s&&(s=i.Epsilon);var u,a=this.domain[1].time-this.domain[0].time,p=this.range[0],h=this.range[1],f=t.time,c=void 0!==r?r.time:void 0;void 0===c||void 0===n||Math.abs(c-f)<s||Math.abs(n-e)<s?u=(h-p)/(0!==a?a:s):(u=(n-e)/(c-f),void 0!==o&&o||u<0==(h-p)/a<0||(u=-u));var l=e-u*f,d=(p-l)/u,y=(h-l)/u;return Math.abs(d-this.domain[0].time)<s&&Math.abs(y-this.domain[1].time)<s?this:Rp(Tp(new Na(d,this.domain[0].zone),new Na(y,this.domain[1].zone)),this.range)},Rp.prototype.interpolateTo=function(t){return t instanceof Rp?Up(this,t):null},Rp.prototype.canEqual=function(t){return t instanceof Rp},Rp.prototype.equals=function(t){return this===t||t instanceof Rp&&(this.domain.equals(t.domain)&&this.range.equals(t.range))},Rp.prototype.toString=function(){return"TimeScale("+this.domain+", "+this.range+")"};var Up=function(t,e){var r=function(t){var e=r[0],n=r[1],i=e.domain,o=i[0].time,s=i[1].time,u=n.domain,a=u[0].time,p=u[1].time,h=Tp(new Na(o+t*(a-o),0===t?i[0].zone:u[0].zone),new Na(s+t*(p-s),0===t?i[1].zone:u[1].zone)),f=e.range,c=f[0],l=f[1],d=n.range,y=d[0],v=d[1],m=fe(c+t*(y-c),l+t*(v-l));return Rp(h,m)};return Object.setPrototypeOf(r,Up.prototype),r[0]=t,r[1]=e,r};Up.prototype=Object.create($t.prototype);var Np=function(){function t(){}return Object.defineProperty(t.prototype,"tag",{get:function(){return this.constructor.tag},enumerable:!1,configurable:!0}),t.prototype.withPrio=function(t){return this},t.prototype.withRate=function(t){return this},t.prototype.toRecon=function(){return fo.toString(this.toValue())},t.prototype.toString=function(){return nt.debug(this)},t.fromValue=function(t){switch(t.tag){case"event":return Bp.fromValue(t);case"command":return Wp.fromValue(t);case"link":return Hp.fromValue(t);case"linked":return Xp.fromValue(t);case"sync":return Yp.fromValue(t);case"synced":return Gp.fromValue(t);case"unlink":return _p.fromValue(t);case"unlinked":return Qp.fromValue(t);case"auth":return Zp.fromValue(t);case"authed":return Jp.fromValue(t);case"deauth":return $p.fromValue(t);case"deauthed":return th.fromValue(t);default:return null}},t.parseRecon=function(e){return t.fromValue(fo.parse(e))},t}();Object.defineProperty(Np.prototype,"prio",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(Np.prototype,"rate",{get:function(){return 0},enumerable:!0,configurable:!0});var zp,Fp=function(t){function e(e){var r=t.call(this)||this;return r.body=e,r}return P(e,t),Object.defineProperty(e.prototype,"node",{get:function(){return ys.empty()},enumerable:!1,configurable:!0}),e.prototype.withNode=function(t){return this},Object.defineProperty(e.prototype,"lane",{get:function(){return ys.empty()},enumerable:!1,configurable:!0}),e.prototype.withLane=function(t){return this},e.prototype.withBody=function(t){return t=ir.fromAny(t),this.copy(t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.constructor===t.constructor&&this.body.equals(t.body))},e.prototype.hashCode=function(){return f.mash(f.mix(b.hash(this.constructor),this.body.hashCode()))},e.prototype.debug=function(t){return t=t.write(this.constructor.name).write(46).write("create").write(40),this.body.isDefined()&&(t=t.debug(this.body)),t=t.write(41)},e.prototype.toValue=function(){return er.of(this.tag).concat(this.body)},e.fromValue=function(t){return t.header(this.tag).isDefined()?new this(t.body()):null},e}(Np),Lp=function(t){function e(e,r,n){var i=t.call(this)||this;return i.node=e,i.lane=r,i.body=n,i}return P(e,t),e.prototype.withNode=function(t){return t=ys.fromAny(t),this.copy(t,this.lane,this.body)},e.prototype.withLane=function(t){return t=ys.fromAny(t),this.copy(this.node,t,this.body)},e.prototype.withBody=function(t){return t=ir.fromAny(t),this.copy(this.node,this.lane,t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.constructor===t.constructor&&this.node.equals(t.node)&&this.lane.equals(t.lane)&&this.body.equals(t.body))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(b.hash(this.constructor),this.node.hashCode()),this.lane.hashCode()),this.body.hashCode()))},e.prototype.debug=function(t){return t=t.write(this.constructor.name).write(46).write("create").write(40).debug(this.node.toString()).write(", ").debug(this.lane.toString()),this.body.isDefined()&&(t=t.write(", ").debug(this.body)),t=t.write(41)},e.prototype.toValue=function(){var t=or.create(2).slot("node",this.node.toString()).slot("lane",this.lane.toString());return er.of(this.tag,t).concat(this.body)},e.fromValue=function(t){var e,r;if(t.header(this.tag).forEach((function(t,n){var i=t.key.stringValue(void 0);void 0!==i?"node"===i?e=ys.parse(t.toValue().stringValue("")):"lane"===i&&(r=ys.parse(t.toValue().stringValue(""))):t instanceof ir&&(0===n?e=ys.parse(t.stringValue("")):1===n&&(r=ys.parse(t.stringValue(""))))})),void 0!==e&&void 0!==r){var n=t.body();return new this(e,r,n)}return null},e}(Np),Kp=function(t){function e(e,r,n,i,o){var s=t.call(this)||this;return s.node=e,s.lane=r,Object.defineProperty(s,"prio",{value:n,writable:!0,enumerable:!0,configurable:!0}),Object.defineProperty(s,"rate",{value:i,writable:!0,enumerable:!0,configurable:!0}),s.body=o,s}return P(e,t),e.prototype.withNode=function(t){return t=ys.fromAny(t),this.copy(t,this.lane,this.prio,this.rate,this.body)},e.prototype.withLane=function(t){return t=ys.fromAny(t),this.copy(this.node,t,this.prio,this.rate,this.body)},e.prototype.withPrio=function(t){return this.copy(this.node,this.lane,t,this.rate,this.body)},e.prototype.withRate=function(t){return this.copy(this.node,this.lane,this.prio,t,this.body)},e.prototype.withBody=function(t){return t=ir.fromAny(t),this.copy(this.node,this.lane,this.prio,this.rate,t)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.constructor===t.constructor&&this.node.equals(t.node)&&this.lane.equals(t.lane)&&this.prio===t.prio&&this.rate===t.rate&&this.body.equals(t.body))},e.prototype.hashCode=function(){return f.mash(f.mix(f.mix(f.mix(f.mix(f.mix(b.hash(this.constructor),this.node.hashCode()),this.lane.hashCode()),m.hash(this.prio)),m.hash(this.rate)),this.body.hashCode()))},e.prototype.debug=function(t){return t=t.write(this.constructor.name).write(46).write("create").write(40).debug(this.node.toString()).write(", ").debug(this.lane.toString()),0===this.prio&&0===this.rate||(t=t.write(", ").debug(this.prio).write(", ").debug(this.rate)),this.body.isDefined()&&(t=t.write(", ").debug(this.body)),t=t.write(41)},e.prototype.toValue=function(){var t=or.create(4).slot("node",this.node.toString()).slot("lane",this.lane.toString());return 0!==this.prio&&t.slot("prio",this.prio),0!==this.rate&&t.slot("rate",this.rate),er.of(this.tag,t).concat(this.body)},e.fromValue=function(t){var e,r,n=0,i=0;if(t.header(this.tag).forEach((function(t,o){var s=t.key.stringValue(void 0);void 0!==s?"node"===s?e=ys.parse(t.toValue().stringValue("")):"lane"===s?r=ys.parse(t.toValue().stringValue("")):"prio"===s?n=t.numberValue(n):"rate"===s&&(i=t.numberValue(i)):t instanceof ir&&(0===o?e=ys.parse(t.stringValue("")):1===o&&(r=ys.parse(t.stringValue(""))))})),void 0!==e&&void 0!==r){var o=t.body();return new this(e,r,n,i,o)}return null},e}(Np),Bp=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return P(e,t),e.prototype.copy=function(t,r,n){return new e(t,r,n)},Object.defineProperty(e,"tag",{get:function(){return"event"},enumerable:!1,configurable:!0}),e.create=function(t,r,n){return void 0===n&&(n=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n=ir.fromAny(n))},e}(Lp),Wp=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return P(e,t),e.prototype.copy=function(t,r,n){return new e(t,r,n)},Object.defineProperty(e,"tag",{get:function(){return"command"},enumerable:!1,configurable:!0}),e.create=function(t,r,n){return void 0===n&&(n=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n=ir.fromAny(n))},e}(Lp),Hp=function(t){function e(e,r,n,i,o){return t.call(this,e,r,n,i,o)||this}return P(e,t),e.prototype.copy=function(t,r,n,i,o){return new e(t,r,n,i,o)},Object.defineProperty(e,"tag",{get:function(){return"link"},enumerable:!1,configurable:!0}),e.create=function(t,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n,i,o=ir.fromAny(o))},e}(Kp),Xp=function(t){function e(e,r,n,i,o){return t.call(this,e,r,n,i,o)||this}return P(e,t),e.prototype.copy=function(t,r,n,i,o){return new e(t,r,n,i,o)},Object.defineProperty(e,"tag",{get:function(){return"linked"},enumerable:!1,configurable:!0}),e.create=function(t,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n,i,o=ir.fromAny(o))},e}(Kp),Yp=function(t){function e(e,r,n,i,o){return t.call(this,e,r,n,i,o)||this}return P(e,t),e.prototype.copy=function(t,r,n,i,o){return new e(t,r,n,i,o)},Object.defineProperty(e,"tag",{get:function(){return"sync"},enumerable:!1,configurable:!0}),e.create=function(t,r,n,i,o){return void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n,i,o=ir.fromAny(o))},e}(Kp),Gp=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return P(e,t),e.prototype.copy=function(t,r,n){return new e(t,r,n)},Object.defineProperty(e,"tag",{get:function(){return"synced"},enumerable:!1,configurable:!0}),e.create=function(t,r,n){return void 0===n&&(n=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n=ir.fromAny(n))},e}(Lp),_p=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return P(e,t),e.prototype.copy=function(t,r,n){return new e(t,r,n)},Object.defineProperty(e,"tag",{get:function(){return"unlink"},enumerable:!1,configurable:!0}),e.create=function(t,r,n){return void 0===n&&(n=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n=ir.fromAny(n))},e}(Lp),Qp=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return P(e,t),e.prototype.copy=function(t,r,n){return new e(t,r,n)},Object.defineProperty(e,"tag",{get:function(){return"unlinked"},enumerable:!1,configurable:!0}),e.create=function(t,r,n){return void 0===n&&(n=ir.absent()),new e(t=ys.fromAny(t),r=ys.fromAny(r),n=ir.fromAny(n))},e}(Lp),Zp=function(t){function e(e){return t.call(this,e)||this}return P(e,t),e.prototype.copy=function(t){return new e(t)},Object.defineProperty(e,"tag",{get:function(){return"auth"},enumerable:!1,configurable:!0}),e.create=function(t){return void 0===t&&(t=ir.absent()),new e(t=ir.fromAny(t))},e}(Fp),Jp=function(t){function e(e){return t.call(this,e)||this}return P(e,t),e.prototype.copy=function(t){return new e(t)},Object.defineProperty(e,"tag",{get:function(){return"authed"},enumerable:!1,configurable:!0}),e.create=function(t){return void 0===t&&(t=ir.absent()),new e(t=ir.fromAny(t))},e}(Fp),$p=function(t){function e(e){return t.call(this,e)||this}return P(e,t),e.prototype.copy=function(t){return new e(t)},Object.defineProperty(e,"tag",{get:function(){return"deauth"},enumerable:!1,configurable:!0}),e.create=function(t){return void 0===t&&(t=ir.absent()),new e(t=ir.fromAny(t))},e}(Fp),th=function(t){function e(e){return t.call(this,e)||this}return P(e,t),e.prototype.copy=function(t){return new e(t)},Object.defineProperty(e,"tag",{get:function(){return"deauthed"},enumerable:!1,configurable:!0}),e.create=function(t){return void 0===t&&(t=ir.absent()),new e(t=ir.fromAny(t))},e}(Fp),eh=function(){},rh=function(t){function e(e,r,n){void 0===n&&(n={});var i=t.call(this)||this;return i.context=e,i.hostUri=r,i.options=n,i.authenticated=!1,i.session=ir.absent(),i.sendBuffer=[],i.downlinks=new xe,i.downlinkCount=0,i.uriCache=new Us(r),i.reconnectTimer=0,i.reconnectTimeout=0,i.idleTimer=0,i}return P(e,t),Object.defineProperty(e.prototype,"credentials",{get:function(){var t;return null!==(t=this.options.credentials)&&void 0!==t?t:ir.absent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unlinkDelay",{get:function(){var t;return null!==(t=this.options.unlinkDelay)&&void 0!==t?t:e.UnlinkDelay},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxReconnectTimeout",{get:function(){var t;return null!==(t=this.options.maxReconnectTimeout)&&void 0!==t?t:e.MaxReconnectTimeout},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idleTimeout",{get:function(){var t;return null!==(t=this.options.idleTimeout)&&void 0!==t?t:e.IdleTimeout},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sendBufferSize",{get:function(){var t;return null!==(t=this.options.sendBufferSize)&&void 0!==t?t:e.SendBufferSize},enumerable:!1,configurable:!0}),e.prototype.isAuthenticated=function(){return this.authenticated},e.prototype.isIdle=function(){return 0===this.sendBuffer.length&&0===this.downlinkCount},e.prototype.resolve=function(t){return this.uriCache.resolve(t)},e.prototype.unresolve=function(t){return this.uriCache.unresolve(t)},e.prototype.authenticate=function(t){if(!(t=ir.fromAny(t)).equals(this.options.credentials))if(this.options.credentials=t,this.isConnected()){var e=new Zp(t);this.push(e)}else this.open()},e.prototype.openDownlink=function(t){this.clearIdle();var e=this.resolve(t.nodeUri),r=t.laneUri;0===this.downlinkCount&&this.open();var n=this.downlinks.get(e);if(void 0===n&&(n=new xe,this.downlinks.set(e,n)),void 0!==n.get(r))throw new Error("duplicate downlink");n.set(r,t),this.downlinkCount+=1,t.openUp(this),this.isConnected()&&t.hostDidConnect(this)},e.prototype.unlinkDownlink=function(t){var e=this.resolve(t.nodeUri),r=t.laneUri,n=this.downlinks.get(e);if(void 0!==n&&n.get(r)&&this.isConnected()){var i=new _p(this.unresolve(e),r,ir.absent());t.onUnlinkRequest(i,this),this.push(i)}},e.prototype.closeDownlink=function(t){var e=this.resolve(t.nodeUri),r=t.laneUri,n=this.downlinks.get(e);void 0!==n&&n.get(r)&&(this.downlinkCount-=1,n.delete(r),n.isEmpty()&&this.downlinks.delete(e),0===this.downlinkCount&&this.watchIdle(),t.closeUp(this))},e.prototype.command=function(t,e,r){t=ys.fromAny(t),t=this.resolve(t),e=ys.fromAny(e),r=ir.fromAny(r);var n=new Wp(this.unresolve(t),e,r);this.push(n)},e.prototype.onEnvelope=function(t){t instanceof Bp?this.onEventMessage(t):t instanceof Wp?this.onCommandMessage(t):t instanceof Hp?this.onLinkRequest(t):t instanceof Xp?this.onLinkedResponse(t):t instanceof Yp?this.onSyncRequest(t):t instanceof Gp?this.onSyncedResponse(t):t instanceof _p?this.onUnlinkRequest(t):t instanceof Qp?this.onUnlinkedResponse(t):t instanceof Zp?this.onAuthRequest(t):t instanceof Jp?this.onAuthedResponse(t):t instanceof $p?this.onDeauthRequest(t):t instanceof th?this.onDeauthedResponse(t):this.onUnknownEnvelope(t)},e.prototype.onEventMessage=function(t){var e=this.resolve(t.node),r=t.lane,n=this.downlinks.get(e);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=t.withNode(e);i.onEventMessage(o,this)}}},e.prototype.onCommandMessage=function(t){},e.prototype.onLinkRequest=function(t){},e.prototype.onLinkedResponse=function(t){var e=this.resolve(t.node),r=t.lane,n=this.downlinks.get(e);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=t.withNode(e);i.onLinkedResponse(o,this)}}},e.prototype.onSyncRequest=function(t){},e.prototype.onSyncedResponse=function(t){var e=this.resolve(t.node),r=t.lane,n=this.downlinks.get(e);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=t.withNode(e);i.onSyncedResponse(o,this)}}},e.prototype.onUnlinkRequest=function(t){},e.prototype.onUnlinkedResponse=function(t){var e=this.resolve(t.node),r=t.lane,n=this.downlinks.get(e);if(void 0!==n){var i=n.get(r);if(void 0!==i){var o=t.withNode(e);i.onUnlinkedResponse(o,this)}}},e.prototype.onAuthRequest=function(t){},e.prototype.onAuthedResponse=function(t){this.authenticated=!0,this.session=t.body,this.context.hostDidAuthenticate(t.body,this)},e.prototype.onDeauthRequest=function(t){},e.prototype.onDeauthedResponse=function(t){this.authenticated=!1,this.session=ir.absent(),this.context.hostDidDeauthenticate(t.body,this)},e.prototype.onUnknownEnvelope=function(t){},e.prototype.onConnect=function(){this.reconnectTimeout=0,this.context.hostDidConnect(this),this.downlinks.forEach((function(t,e){e.forEach((function(t,e){e.hostDidConnect(this)}),this)}),this)},e.prototype.onDisconnect=function(){this.authenticated=!1,this.session=ir.absent(),this.context.hostDidDisconnect(this),this.downlinks.forEach((function(t,e){e.forEach((function(t,e){e.hostDidDisconnect(this)}),this)}),this)},e.prototype.onError=function(t){this.context.hostDidFail(t,this),this.downlinks.forEach((function(e,r){r.forEach((function(e,r){r.hostDidFail(t,this)}),this)}),this)},e.prototype.reconnect=function(){0===this.reconnectTimer&&(0===this.reconnectTimeout?this.reconnectTimeout=Math.floor(500+1e3*Math.random()):this.reconnectTimeout=Math.min(Math.floor(1.8*this.reconnectTimeout),this.maxReconnectTimeout),this.reconnectTimer=setTimeout(this.open.bind(this),this.reconnectTimeout))},e.prototype.clearReconnect=function(){0!==this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=0)},e.prototype.watchIdle=function(){0===this.idleTimer&&this.isConnected()&&this.isIdle()&&(this.idleTimer=setTimeout(this.checkIdle.bind(this),this.idleTimeout))},e.prototype.clearIdle=function(){0!==this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=0)},e.prototype.checkIdle=function(){this.isConnected()&&this.isIdle()&&this.close()},e.prototype.close=function(){this.context.closeHost(this)},e.prototype.closeUp=function(){this.downlinks.forEach((function(t,e){e.forEach((function(t,e){e.closeUp(this)}),this)}),this)},e.UnlinkDelay=0,e.MaxReconnectTimeout=3e4,e.IdleTimeout=1e3,e.SendBufferSize=1024,e}(eh),nh=function(t){function e(e,r,n){void 0===n&&(n={});var i=t.call(this,e,r,n)||this;return i.socket=null,i}return P(e,t),Object.defineProperty(e.prototype,"WebSocket",{get:function(){return void 0!==this.options.WebSocket?this.options.WebSocket:"undefined"!=typeof WebSocket?WebSocket:"function"==typeof require?require("ws"):null},enumerable:!1,configurable:!0}),e.prototype.isConnected=function(){return null!==this.socket&&this.socket.readyState===this.socket.OPEN},e.prototype.open=function(){this.clearReconnect();var t=this.socket;if(null===t){var e=this.WebSocket;if(null===e)throw new Error("WebSocket undefined");var r=this.hostUri,n=r.schemeName;"warp"===n||"swim"===n?r=r.withSchemeName("ws"):"warps"!==n&&"swims"!==n||(r=r.withSchemeName("wss")),t=void 0!==this.options.protocols?new e(r.toString(),this.options.protocols):new e(r.toString()),this.socket=t,t.onopen=this.onWebSocketOpen.bind(this),t.onmessage=this.onWebSocketMessage.bind(this),t.onclose=this.onWebSocketClose.bind(this),t.onerror=this.onWebSocketError.bind(this)}},e.prototype.close=function(){this.clearReconnect(),this.clearIdle(),null!==this.socket?(this.socket.close(),this.context.isOnline()||this.onWebSocketClose()):t.prototype.close.call(this)},e.prototype.push=function(t){if(this.isConnected()){this.clearIdle();var e=t.toRecon();this.socket.send(e),this.watchIdle()}else if(t instanceof Wp){if(!(this.sendBuffer.length<this.sendBufferSize))throw new Error("send buffer overflow");this.sendBuffer.push(t),this.open()}},e.prototype.onWebSocketOpen=function(){if(this.isConnected()){var t=this.credentials;if(t.isDefined()){var e=new Zp(t);this.push(e)}this.onConnect();for(var r=void 0;(r=this.sendBuffer.shift())&&this.isConnected();)this.push(r);this.watchIdle()}else this.close()},e.prototype.onWebSocketMessage=function(t){var e=t.data;if("string"==typeof e){var r=Np.parseRecon(e);null!==r?this.onEnvelope(r):this.onUnknownEnvelope(e)}},e.prototype.onWebSocketClose=function(){var t=this.socket;null!==t&&(t.onopen=null,t.onmessage=null,t.onclose=null,t.onerror=null,this.socket=null),this.onDisconnect(),this.clearIdle(),this.isIdle()?this.close():this.context.isOnline()&&this.reconnect()},e.prototype.onWebSocketError=function(){null!==this.socket&&(this.socket.close(),this.context.isOnline()?this.onError():this.onWebSocketClose())},e}(rh),ih=function(){function t(t,e,r,n,i,o,s){void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=ir.absent()),this.context=t,this.hostUri=e,this.nodeUri=r,this.laneUri=n,this.prio=i,this.rate=o,this.body=s,this.views=C.empty,this.host=null,this.status=0}return t.prototype.keepLinked=function(){for(var t=this.views,e=0,r=t.length;e<r;e+=1)if(t[e].keepLinked())return!0;return!1},t.prototype.keepSynced=function(){for(var t=0,e=this.views.length;t<e;t+=1)if(this.views[t].keepSynced())return!0;return!1},Object.defineProperty(t.prototype,"unlinkDelay",{get:function(){var t=this.host;return null!==t?t.unlinkDelay:0},enumerable:!1,configurable:!0}),t.prototype.isConnected=function(){var t=this.host;return null!==t&&t.isConnected()},t.prototype.isAuthenticated=function(){var t=this.host;return null!==t&&t.isAuthenticated()},t.prototype.isLinked=function(){return 0!=(this.status&t.Linked)},t.prototype.isSynced=function(){return 0!=(this.status&t.Synced)},Object.defineProperty(t.prototype,"session",{get:function(){var t=this.host;return null!==t?t.session:ir.absent()},enumerable:!1,configurable:!0}),t.prototype.addDownlink=function(t){this.views=C.inserted(t,this.views)},t.prototype.removeDownlink=function(t){var e=this.views,r=C.removed(t,e);if(e!==r&&(this.views=r,t.closeUp(),0===r.length)){var n=this.unlinkDelay;n<0?this.unlink():setTimeout(this.doUnlink.bind(this),n)}},t.prototype.onEventMessage=function(t,e){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].onEventMessage(t)},t.prototype.onCommandMessage=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].onCommandMessage(t)},t.prototype.onLinkRequest=function(e){this.status|=t.Linking;for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].onLinkRequest(e)},t.prototype.onLinkedResponse=function(e,r){this.status=this.status&~t.Linking|t.Linked;for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].onLinkedResponse(e)},t.prototype.onSyncRequest=function(e){this.status|=t.Syncing;for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].onSyncRequest(e)},t.prototype.onSyncedResponse=function(e,r){this.status=this.status&~t.Syncing|t.Synced;for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].onSyncedResponse(e)},t.prototype.onUnlinkRequest=function(e,r){this.status=this.status&~(t.Linking|t.Syncing)|t.Unlinking;for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].onUnlinkRequest(e)},t.prototype.onUnlinkedResponse=function(e,r){this.status&=~t.Unlinking;var n=this.views;if(0===n.length||0!==this.status){for(var i=0,o=n.length;i<o;i+=1)n[i].onUnlinkedResponse(e);this.close()}else this.keepSynced()?this.sync():this.link()},t.prototype.hostDidConnect=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].hostDidConnect();this.keepSynced()?this.sync():this.link()},t.prototype.hostDidDisconnect=function(t){this.status=0;for(var e=!1,r=this.views,n=0,i=r.length;n<i;n+=1){var o=r[n];o.hostDidDisconnect(),e=e||o.keepLinked()}e||this.close()},t.prototype.hostDidFail=function(t,e){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].hostDidFail(t)},t.prototype.command=function(t){t=ir.fromAny(t),this.onCommandMessage(t),this.host.command(this.nodeUri,this.laneUri,t)},t.prototype.sync=function(){var t=this.host.unresolve(this.nodeUri),e=new Yp(t,this.laneUri,this.prio,this.rate,this.body);this.onSyncRequest(e),this.host.push(e)},t.prototype.link=function(){var t=this.host.unresolve(this.nodeUri),e=new Hp(t,this.laneUri,this.prio,this.rate,this.body);this.onLinkRequest(e),this.host.push(e)},t.prototype.unlink=function(){this.status=t.Unlinking,this.context.unlinkDownlink(this)},t.prototype.doUnlink=function(){0===this.views.length&&this.unlink()},t.prototype.close=function(){this.context.closeDownlink(this)},t.prototype.openUp=function(t){this.host=t;for(var e=0,r=this.views.length;e<r;e+=1)this.views[e].openUp(t)},t.prototype.closeUp=function(){var t=this.views;this.views=C.empty;for(var e=0,r=t.length;e<r;e+=1)t[e].closeUp()},t.Linking=1,t.Linked=2,t.Syncing=4,t.Synced=8,t.Unlinking=16,t}();t.DownlinkFlags=void 0,(zp=t.DownlinkFlags||(t.DownlinkFlags={}))[zp.KeepLinked=1]="KeepLinked",zp[zp.KeepSynced=2]="KeepSynced",zp[zp.KeepLinkedSynced=3]="KeepLinkedSynced";var oh=function(){function t(t,e,r,n,i,o,s,u,a,p,h){var f,c,l,d,y,v,m,w,g,b,x,O,E;void 0===n&&(n=ys.empty()),void 0===i&&(i=ys.empty()),void 0===o&&(o=ys.empty()),void 0===s&&(s=0),void 0===u&&(u=0),void 0===a&&(a=ir.absent()),void 0===p&&(p=0),void 0===h?h=C.empty:Array.isArray(h)||(h=[E=h]),void 0!==r&&(n=void 0!==r.hostUri?ys.fromAny(r.hostUri):n,i=void 0!==r.nodeUri?ys.fromAny(r.nodeUri):i,o=void 0!==r.laneUri?ys.fromAny(r.laneUri):o,s=void 0!==r.prio?r.prio:s,u=void 0!==r.rate?r.rate:u,a=void 0!==r.body?ir.fromAny(r.body):a,E=null!=E?E:{},h=C.inserted(E,h),E.onEvent=null!==(f=r.onEvent)&&void 0!==f?f:E.onEvent,E.onCommand=null!==(c=r.onCommand)&&void 0!==c?c:E.onCommand,E.willLink=null!==(l=r.willLink)&&void 0!==l?l:E.willLink,E.didLink=null!==(d=r.didLink)&&void 0!==d?d:E.didLink,E.willSync=null!==(y=r.willSync)&&void 0!==y?y:E.willSync,E.didSync=null!==(v=r.didSync)&&void 0!==v?v:E.didSync,E.willUnlink=null!==(m=r.willUnlink)&&void 0!==m?m:E.willUnlink,E.didUnlink=null!==(w=r.didUnlink)&&void 0!==w?w:E.didUnlink,E.didConnect=null!==(g=r.didConnect)&&void 0!==g?g:E.didConnect,E.didDisconnect=null!==(b=r.didDisconnect)&&void 0!==b?b:E.didDisconnect,E.didClose=null!==(x=r.didClose)&&void 0!==x?x:E.didClose,E.didFail=null!==(O=r.didFail)&&void 0!==O?O:E.didFail),this.context=t,this.owner=e,this.ownHostUri=n,this.ownNodeUri=i,this.ownLaneUri=o,this.ownPrio=s,this.ownRate=u,this.ownBody=a,this.flags=p,this.model=null,this.observers=h}return t.prototype.hostUri=function(t){return void 0===t?this.ownHostUri:(t=ys.fromAny(t),this.copy(this.context,this.owner,t,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers))},t.prototype.nodeUri=function(t){return void 0===t?this.ownNodeUri:(t=ys.fromAny(t),this.copy(this.context,this.owner,this.ownHostUri,t,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers))},t.prototype.laneUri=function(t){return void 0===t?this.ownLaneUri:(t=ys.fromAny(t),this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,t,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers))},t.prototype.prio=function(t){return void 0===t?this.ownPrio:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,t,this.ownRate,this.ownBody,this.flags,this.observers)},t.prototype.rate=function(t){return void 0===t?this.ownRate:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,t,this.ownBody,this.flags,this.observers)},t.prototype.body=function(t){return void 0===t?this.ownBody:(t=ir.fromAny(t),this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,t,this.flags,this.observers))},t.prototype.keepLinked=function(t){if(void 0===t)return 0!=(1&this.flags);var e=t?1|this.flags:-2&this.flags;return this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,e,this.observers)},t.prototype.keepSynced=function(t){if(void 0===t)return 0!=(2&this.flags);var e=t?2|this.flags:-3&this.flags;return this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,e,this.observers)},t.prototype.observe=function(t){return this.observers=C.inserted(t,this.observers),this},t.prototype.unobserve=function(t){for(var e=this.observers,r=e.length,n=0;n<r;n+=1){var i=e[n],o=i===t;if(!o)for(var s in i)if(i[s]===t){o=!0;break}if(o){if(r>1){for(var u=new Array(r-1),a=0;a<n;a+=1)u[a]=e[a];for(a=n+1;a<r;a+=1)u[a-1]=e[a];this.observers=u}else this.observers=C.empty;break}}return this},t.prototype.onEvent=function(t){return this.observe({onEvent:t})},t.prototype.onCommand=function(t){return this.observe({onCommand:t})},t.prototype.willLink=function(t){return this.observe({willLink:t})},t.prototype.didLink=function(t){return this.observe({didLink:t})},t.prototype.willSync=function(t){return this.observe({willSync:t})},t.prototype.didSync=function(t){return this.observe({didSync:t})},t.prototype.willUnlink=function(t){return this.observe({willUnlink:t})},t.prototype.didUnlink=function(t){return this.observe({didUnlink:t})},t.prototype.didConnect=function(t){return this.observe({didConnect:t})},t.prototype.didDisconnect=function(t){return this.observe({didDisconnect:t})},t.prototype.didClose=function(t){return this.observe({didClose:t})},t.prototype.didFail=function(t){return this.observe({didFail:t})},t.prototype.isConnected=function(){var t=this.model;return null!==t&&t.isConnected()},t.prototype.isAuthenticated=function(){var t=this.model;return null!==t&&t.isAuthenticated()},t.prototype.isLinked=function(){var t=this.model;return null!==t&&t.isLinked()},t.prototype.isSynced=function(){var t=this.model;return null!==t&&t.isSynced()},Object.defineProperty(t.prototype,"session",{get:function(){var t=this.model;return null!==t?t.session:ir.absent()},enumerable:!1,configurable:!0}),t.prototype.onEventMessage=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.onEvent&&i.onEvent(t.body,this)}},t.prototype.onCommandMessage=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.onCommand&&i.onCommand(t,this)}},t.prototype.onLinkRequest=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willLink&&i.willLink(this)}},t.prototype.onLinkedResponse=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didLink&&i.didLink(this)}},t.prototype.onSyncRequest=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willSync&&i.willSync(this)}},t.prototype.onSyncedResponse=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didSync&&i.didSync(this)}},t.prototype.onUnlinkRequest=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willUnlink&&i.willUnlink(this)}},t.prototype.onUnlinkedResponse=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didUnlink&&i.didUnlink(this)}},t.prototype.hostDidConnect=function(){for(var t=this.observers,e=0,r=t.length;e<r;e+=1){var n=t[e];void 0!==n.didConnect&&n.didConnect(this)}},t.prototype.hostDidDisconnect=function(){for(var t=this.observers,e=0,r=t.length;e<r;e+=1){var n=t[e];void 0!==n.didDisconnect&&n.didDisconnect(this)}},t.prototype.hostDidFail=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didFail&&i.didFail(t,this)}},t.prototype.command=function(t){this.model.command(t)},t.prototype.close=function(){var t=this.owner;null!==t&&t.removeDownlink(this);var e=this.model;null!==e&&e.removeDownlink(this)},t.prototype.openUp=function(t){},t.prototype.closeUp=function(){for(var t=this.observers,e=0,r=t.length;e<r;e+=1){var n=t[e];void 0!==n.didClose&&n.didClose(this)}},t.initForm=function(){return new sh},S([e],t,"initForm",null),t}(),sh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e.prototype.mold=function(t){if(void 0!==t){var e=or.create();return void 0!==t.hostUri&&e.slot("host",ys.fromAny(t.hostUri).toString()),void 0!==t.nodeUri&&e.slot("node",ys.fromAny(t.nodeUri).toString()),void 0!==t.laneUri&&e.slot("lane",ys.fromAny(t.laneUri).toString()),void 0!==t.prio&&e.slot("prio",t.prio),void 0!==t.rate&&e.slot("rate",t.rate),void 0!==t.body&&e.slot("body",t.body),void 0!==t.type&&e.slot("type",t.type),or.of(er.of("link",e))}return Qe.extant()},e.prototype.cast=function(t){var e=t.toValue().get("link");if(e.isDefined()){var r={},n=e.get("host");n.isDefined()&&(r.hostUri=n.cast(ys.form()));var i=e.get("node");i.isDefined()&&(r.nodeUri=i.cast(ys.form()));var o=e.get("lane");o.isDefined()&&(r.laneUri=o.cast(ys.form()));var s=e.get("prio");s.isDefined()&&(r.prio=s.numberValue());var u=e.get("rate");u.isDefined()&&(r.rate=u.numberValue());var a=e.get("body");a.isDefined()&&(r.body=a);var p=e.get("type");return p.isDefined()&&(r.type=p.stringValue()),r}},e}(Sn);Object.defineProperty(sh.prototype,"tag",{get:function(){return"link"},enumerable:!0,configurable:!0});var uh=function(t){function e(e,r,n,i,o,s,u){return t.call(this,e,r,n,i,o,s,u)||this}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"event"},enumerable:!1,configurable:!0}),e}(ih),ah=function(t){function e(e,r,n,i,o,s,u,a,p,h,f){return void 0===h&&(h=1),t.call(this,e,r,n,i,o,s,u,a,p,h,f)||this}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"event"},enumerable:!1,configurable:!0}),e.prototype.copy=function(t,r,n,i,o,s,u,a,p,h){return new e(t,r,void 0,n,i,o,s,u,a,p,h)},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.open=function(){var t=this.ownLaneUri;if(t.isEmpty())throw new Error("no lane");var e=this.ownNodeUri;if(e.isEmpty())throw new Error("no node");var r=this.ownHostUri;r.isEmpty()&&(r=e.endpoint(),e=r.unresolve(e));var n=this.context.getDownlink(r,e,t);if(void 0!==n){if(!(n instanceof uh))throw new Error("downlink type mismatch");n.addDownlink(this)}else(n=new uh(this.context,r,e,t,this.ownPrio,this.ownRate,this.ownBody)).addDownlink(this),this.context.openDownlink(n);return this.model=n,null!==this.owner&&this.owner.addDownlink(this),this},e}(oh),ph=function(t){function e(e,r,n,i,o,s,u,a){void 0===a&&(a=new ke);var p=t.call(this,e,r,n,i,o,s,u)||this;return p.state=a,p}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"list"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.state.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.state.isEmpty()},e.prototype.get=function(t,e){return this.state.get(t,e)||ir.absent()},e.prototype.getEntry=function(t,e){return this.state.getEntry(t,e)},e.prototype.set=function(t,e,r){if(void 0!==r&&(t=this.state.lookup(r,t))<0)throw new RangeError(""+r);if(t<0||t>=this.state.length)throw new RangeError(""+t);e=this.listWillUpdate(t,e);var n=this.state.getEntry(t);this.state.set(t,e),this.listDidUpdate(t,e,n[1]);var i=or.create(2).slot("key",n[0]).slot("index",t);return this.command(er.of("update",i).concat(e)),this},e.prototype.insert=function(t,e,r){if(t<0||t>this.state.length)throw new RangeError(""+t);e=this.listWillUpdate(t,e),this.state.insert(t,e,r);var n=this.state.getEntry(t);this.listDidUpdate(t,e,ir.absent());var i=or.create(2).slot("key",n[0]).slot("index",t);return this.command(er.of("update",i).concat(e)),this},e.prototype.remove=function(t,e){if(void 0!==e&&(t=this.state.lookup(e,t))<0)throw new RangeError(""+e);if(t<0||t>this.state.length)throw new RangeError(""+t);this.listWillRemove(t);var r=this.state.getEntry(t);this.state.remove(t),this.listDidRemove(t,r[1]);var n=or.create(2).slot("key",r[0]).slot("index",t);return this.command(or.create(1).attr("remove",n)),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r+=1){var n=this.state.length+r,i=this.listWillUpdate(n,t[r]);this.state.insert(n,i);var o=this.state.getEntry(n);this.listDidUpdate(n,i,ir.absent());var s=or.create(2).slot("key",o[0]).slot("index",n);this.command(er.of("update",s).concat(i))}return this.state.length},e.prototype.pop=function(){var t=this.state.length-1;if(t>=0){this.listWillRemove(t);var e=this.state.getEntry(t);this.state.remove(t),this.listDidRemove(t,e[1]);var r=or.create(2).slot("key",e[0]).slot("index",t);return this.command(or.create(1).attr("remove",r)),e[1]}return ir.absent()},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1;r>=0;r-=1){var n=this.listWillUpdate(0,t[r]);this.state.insert(0,n);var i=this.state.getEntry(0);this.listDidUpdate(0,n,ir.absent());var o=or.create(2).slot("key",i[0]).slot("index",0);this.command(er.of("update",o).concat(n))}return this.state.length},e.prototype.shift=function(){if(this.state.length>0){this.listWillRemove(0);var t=this.state.getEntry(0);this.state.remove(0),this.listDidRemove(0,t[1]);var e=or.create(2).slot("key",t[0]).slot("index",0);return this.command(or.create(1).attr("remove",e)),t[1]}return ir.absent()},e.prototype.move=function(t,e,r){if(void 0!==r&&(t=this.state.lookup(r,t))<0)throw new RangeError(""+r);if(t<0||t>=this.state.length)throw new RangeError(""+t);if(e<0||e>=this.state.length)throw new RangeError(""+e);if(t!==e){var n=this.state.getEntry(t);this.listWillMove(t,e,n[1]),this.state.remove(t).insert(e,n[1],n[0]),this.listDidMove(t,e,n[1]);var i=or.create(2).slot("key",n[0]).slot("from",t).slot("to",e);this.command(or.create(1).attr("move",i))}return this},e.prototype.splice=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t<0&&(t=this.state.length+t),t=Math.min(Math.max(0,t),this.state.length),void 0===e&&(e=this.state.length-t);for(var i=[],o=t,s=t+e;o<s;o+=1){this.listWillRemove(t);var u=this.state.getEntry(t);i.push(u[1]),this.state.remove(t),this.listDidRemove(t,u[1]);var a=or.create(2).slot("key",u[0]).slot("index",t);this.command(or.create(1).attr("remove",a))}for(o=0;o<r.length;o+=1){var p=t+o,h=this.listWillUpdate(p,r[o]);this.state.insert(p,h);var f=this.state.getEntry(p);this.listDidUpdate(p,h,ir.absent());a=or.create(2).slot("key",f[0]).slot("index",p);this.command(er.of("update",a).concat(h))}return i},e.prototype.clear=function(){this.listWillClear(),this.state.clear(),this.listDidClear(),this.command(or.create(1).attr("clear"))},e.prototype.forEach=function(t,e){return this.state.forEach(t,e)},e.prototype.values=function(){return this.state.values()},e.prototype.keys=function(){return this.state.keys()},e.prototype.entries=function(){return this.state.entries()},e.prototype.snapshot=function(){return this.state.clone()},e.prototype.setState=function(t){this.state=t},e.prototype.onEventMessage=function(e,r){t.prototype.onEventMessage.call(this,e,r);var n=e.body,i=n.tag;if("update"===i){var o=n.head().toValue();(s=this.state.lookup(o.get("key"),o.get("index").numberValue()))>=0?this.onUpdateEvent(s,n.body(),o.get("key")):this.onInsertEvent(o.get("index").numberValue(0),n.body(),o.get("key"))}else if("move"===i){o=n.head().toValue();(s=this.state.lookup(o.get("key"),o.get("from").numberValue()))>=0&&this.onMoveEvent(s,o.get("to").numberValue(0),o.get("key"))}else if("remove"===i){var s;o=n.head().toValue();(s=this.state.lookup(o.get("key"),o.get("index").numberValue()))>=0&&this.onRemoveEvent(s,o.get("key"))}else if("drop"===i){o=n.head();this.onDropEvent(o.numberValue(0))}else if("take"===i){o=n.head();this.onTakeEvent(o.numberValue(0))}else"clear"===i&&this.onClearEvent()},e.prototype.onInsertEvent=function(t,e,r){e=this.listWillUpdate(t,e),this.state.insert(t,e,r),this.listDidUpdate(t,e,ir.absent())},e.prototype.onUpdateEvent=function(t,e,r){e=this.listWillUpdate(t,e);var n=this.state.get(t)||ir.absent();this.state.set(t,e),this.listDidUpdate(t,e,n)},e.prototype.onMoveEvent=function(t,e,r){if(t!==(e=Math.min(Math.max(0,e),this.state.length))){var n=this.state.get(t)||ir.absent();this.listWillMove(t,e,n),this.state.remove(t).insert(e,n,r),this.listDidMove(t,e,n)}},e.prototype.onRemoveEvent=function(t,e){this.listWillRemove(t);var r=this.state.get(t)||ir.absent();this.state.remove(t),this.listDidRemove(t,r)},e.prototype.onDropEvent=function(t){this.listWillDrop(t),this.state.drop(t),this.listDidDrop(t)},e.prototype.onTakeEvent=function(t){this.listWillTake(t),this.state.take(t),this.listDidTake(t)},e.prototype.onClearEvent=function(){this.listWillClear(),this.state.clear(),this.listDidClear()},e.prototype.listWillUpdate=function(t,e){for(var r=this.views,n=0,i=r.length;n<i;n+=1)e=r[n].listWillUpdate(t,e);return e},e.prototype.listDidUpdate=function(t,e,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].listDidUpdate(t,e,r)},e.prototype.listWillMove=function(t,e,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].listWillMove(t,e,r)},e.prototype.listDidMove=function(t,e,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].listDidMove(t,e,r)},e.prototype.listWillRemove=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].listWillRemove(t)},e.prototype.listDidRemove=function(t,e){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].listDidRemove(t,e)},e.prototype.listWillDrop=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].listWillDrop(t)},e.prototype.listDidDrop=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].listDidDrop(t)},e.prototype.listWillTake=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].listWillTake(t)},e.prototype.listDidTake=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].listDidTake(t)},e.prototype.listWillClear=function(){for(var t=this.views,e=0,r=t.length;e<r;e+=1)t[e].listWillClear()},e.prototype.listDidClear=function(){for(var t=this.views,e=0,r=t.length;e<r;e+=1)t[e].listDidClear()},e}(ih),hh=function(t){function e(e,r,n,i,o,s,u,a,p,h,f,c,l){var d,y,v,m,w,g,b,x,O,C,E,P;void 0===h&&(h=3),void 0===l&&(l=null);var S=t.call(this,e,r,n,i,o,s,u,a,p,h,f)||this;if(void 0!==n){var k=S.observers[S.observers.length-1];k.willUpdate=null!==(d=n.willUpdate)&&void 0!==d?d:k.willUpdate,k.didUpdate=null!==(y=n.didUpdate)&&void 0!==y?y:k.didUpdate,k.willMove=null!==(v=n.willMove)&&void 0!==v?v:k.willMove,k.didMove=null!==(m=n.didMove)&&void 0!==m?m:k.didMove,k.willRemove=null!==(w=n.willRemove)&&void 0!==w?w:k.willRemove,k.didRemove=null!==(g=n.didRemove)&&void 0!==g?g:k.didRemove,k.willDrop=null!==(b=n.willDrop)&&void 0!==b?b:k.willDrop,k.didDrop=null!==(x=n.didDrop)&&void 0!==x?x:k.didDrop,k.willTake=null!==(O=n.willTake)&&void 0!==O?O:k.willTake,k.didTake=null!==(C=n.didTake)&&void 0!==C?C:k.didTake,k.willClear=null!==(E=n.willClear)&&void 0!==E?E:k.willClear,k.didClear=null!==(P=n.didClear)&&void 0!==P?P:k.didClear,c=void 0!==n.valueForm?n.valueForm:c}return S.ownValueForm=void 0!==c?c:Sn.forValue(),S.state0=l,S}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"list"},enumerable:!1,configurable:!0}),e.prototype.copy=function(t,r,n,i,o,s,u,a,p,h,f,c){return 10===arguments.length&&(f=this.ownValueForm,c=this.state0),new e(t,r,void 0,n,i,o,s,u,a,p,h,f,c)},e.prototype.valueForm=function(t){return void 0===t?this.ownValueForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,t,this.state0)},Object.defineProperty(e.prototype,"length",{get:function(){return this.model.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.model.isEmpty()},e.prototype.get=function(t,e){return this.model.get(t,e).coerce(this.ownValueForm)},e.prototype.getEntry=function(t,e){var r=this.model.getEntry(t,e);if(void 0!==r)return[r[0].coerce(this.ownValueForm),r[1]]},e.prototype.set=function(t,e,r){var n=this.ownValueForm.mold(e);return this.model.set(t,n,r),this},e.prototype.insert=function(t,e,r){var n=this.ownValueForm.mold(e);return this.model.insert(t,n,r),this},e.prototype.remove=function(t,e){return this.model.remove(t,e),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=new Array(t.length),n=0;n<t.length;n+=1)r[n]=this.ownValueForm.mold(t[n]);return this.model.push.apply(this.model,r)},e.prototype.pop=function(){return this.model.pop().coerce(this.ownValueForm)},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=new Array(t.length),n=0;n<t.length;n+=1)r[n]=this.ownValueForm.mold(t[n]);return this.model.unshift.apply(this.model,r)},e.prototype.shift=function(){return this.model.shift().coerce(this.ownValueForm)},e.prototype.move=function(t,e,r){return this.model.move(t,e,r),this},e.prototype.splice=function(t,e){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var o=new Array(n.length),s=0;s<n.length;s+=1)o[s]=this.ownValueForm.mold(n[s]);var u=(r=this.model).splice.apply(r,k([t,e],o,!1)),a=new Array(u.length);for(s=0;s<u.length;s+=1)a[s]=u[s].coerce(this.ownValueForm);return a},e.prototype.clear=function(){this.model.clear()},e.prototype.forEach=function(t,e){return this.ownValueForm===Sn.forValue()?this.model.state.forEach(t,e):this.model.state.forEach((function(r,n,i){var o=r.coerce(this.ownValueForm);return t.call(e,o,n,i)}),this)},e.prototype.values=function(){var t=this.model.values();return this.ownValueForm===Sn.forValue()?t:new Rn(t,this.ownValueForm)},e.prototype.keys=function(){return this.model.keys()},e.prototype.entries=function(){var t=this.model.entries();return this.ownValueForm===Sn.forValue()?t:new Un(t,Sn.forValue(),this.ownValueForm)},e.prototype.snapshot=function(){return this.model.snapshot()},e.prototype.setState=function(t){this.model.setState(t)},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.willUpdate=function(t){return this.observe({willUpdate:t})},e.prototype.didUpdate=function(t){return this.observe({didUpdate:t})},e.prototype.willMove=function(t){return this.observe({willMove:t})},e.prototype.didMove=function(t){return this.observe({didMove:t})},e.prototype.willRemove=function(t){return this.observe({willRemove:t})},e.prototype.didRemove=function(t){return this.observe({didRemove:t})},e.prototype.willDrop=function(t){return this.observe({willDrop:t})},e.prototype.didDrop=function(t){return this.observe({didDrop:t})},e.prototype.willTake=function(t){return this.observe({willTake:t})},e.prototype.didTake=function(t){return this.observe({didTake:t})},e.prototype.willClear=function(t){return this.observe({willClear:t})},e.prototype.didClear=function(t){return this.observe({didClear:t})},e.prototype.listWillUpdate=function(t,e){for(var r,n=this.observers,i=0,o=n.length;i<o;i+=1){var s=n[i];if(void 0!==s.willUpdate){void 0===r&&(r=e.coerce(this.ownValueForm));var u=s.willUpdate(t,r,this);void 0!==u&&(r=u,e=this.ownValueForm.mold(r))}}return e},e.prototype.listDidUpdate=function(t,e,r){for(var n,i,o=this.observers,s=0,u=o.length;s<u;s+=1){var a=o[s];void 0!==a.didUpdate&&(void 0===n&&(n=e.coerce(this.ownValueForm)),void 0===i&&(i=r.coerce(this.ownValueForm)),a.didUpdate(t,n,i,this))}},e.prototype.listWillMove=function(t,e,r){for(var n,i=this.observers,o=0,s=i.length;o<s;o+=1){var u=i[o];void 0!==u.willMove&&(void 0===n&&(n=r.coerce(this.ownValueForm)),u.willMove(t,e,n,this))}},e.prototype.listDidMove=function(t,e,r){for(var n,i=this.observers,o=0,s=i.length;o<s;o+=1){var u=i[o];void 0!==u.didMove&&(void 0===n&&(n=r.coerce(this.ownValueForm)),u.didMove(t,e,n,this))}},e.prototype.listWillRemove=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willRemove&&i.willRemove(t,this)}},e.prototype.listDidRemove=function(t,e){for(var r,n=this.observers,i=0,o=n.length;i<o;i+=1){var s=n[i];void 0!==s.didRemove&&(void 0===r&&(r=e.coerce(this.ownValueForm)),s.didRemove(t,r,this))}},e.prototype.listWillDrop=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willDrop&&i.willDrop(t,this)}},e.prototype.listDidDrop=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didDrop&&i.didDrop(t,this)}},e.prototype.listWillTake=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willTake&&i.willTake(t,this)}},e.prototype.listDidTake=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didTake&&i.didTake(t,this)}},e.prototype.listWillClear=function(){for(var t=this.observers,e=0,r=t.length;e<r;e+=1){var n=t[e];void 0!==n.willClear&&n.willClear(this)}},e.prototype.listDidClear=function(){for(var t=this.observers,e=0,r=t.length;e<r;e+=1){var n=t[e];void 0!==n.didClear&&n.didClear(this)}},e.prototype.initialState=function(t){return void 0===t?this.state0:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownValueForm,t)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this.model.state.forEach((function(t,e){this.listDidUpdate(e,t,ir.absent())}),this),this.onSyncedResponse()},e.prototype.open=function(){var t,e=this.ownLaneUri;if(e.isEmpty())throw new Error("no lane");var r=this.ownNodeUri;if(r.isEmpty())throw new Error("no node");var n=this.ownHostUri;n.isEmpty()&&(n=r.endpoint(),r=n.unresolve(r));var i=this.context.getDownlink(n,r,e);if(void 0!==i){if(!(i instanceof ph))throw new Error("downlink type mismatch");i.addDownlink(this),this.model=i,setTimeout(this.didAliasModel.bind(this))}else(i=new ph(this.context,n,r,e,this.ownPrio,this.ownRate,this.ownBody,null!==(t=this.state0)&&void 0!==t?t:void 0)).addDownlink(this),this.context.openDownlink(i),this.model=i;return null!==this.owner&&this.owner.addDownlink(this),this},e}(oh),fh=function(t){function e(e,r,n,i,o,s,u,a){void 0===a&&(a=new xe);var p=t.call(this,e,r,n,i,o,s,u)||this;return p.state=a,p}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"map"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.state.size},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.state.isEmpty()},e.prototype.has=function(t){return this.state.has(t)},e.prototype.get=function(t){var e;return null!==(e=this.state.get(t))&&void 0!==e?e:ir.absent()},e.prototype.getEntry=function(t){return this.state.getEntry(t)},e.prototype.set=function(t,e){var r;e=this.mapWillUpdate(t,e);var n=null!==(r=this.state.get(t))&&void 0!==r?r:ir.absent();this.state.set(t,e),this.mapDidUpdate(t,e,n);var i=or.create(1).slot("key",t);return this.command(er.of("update",i).concat(e)),this},e.prototype.delete=function(t){var e;if(this.state.has(t)){this.mapWillRemove(t);var r=null!==(e=this.state.get(t))&&void 0!==e?e:ir.absent();this.state.delete(t),this.mapDidRemove(t,r);var n=or.create(1).slot("key",t);return this.command(or.create(1).attr("remove",n)),!0}return!1},e.prototype.drop=function(t){return this.mapWillDrop(t),this.state.drop(t),this.mapDidDrop(t),this.command(or.create(1).attr("drop",t)),this},e.prototype.take=function(t){return this.mapWillTake(t),this.state.take(t),this.mapDidTake(t),this.command(or.create(1).attr("take",t)),this},e.prototype.clear=function(){this.mapWillClear(),this.state.clear(),this.mapDidClear(),this.command(or.create(1).attr("clear"))},e.prototype.forEach=function(t,e){return this.state.forEach(t,e)},e.prototype.keys=function(){return this.state.keys()},e.prototype.values=function(){return this.state.values()},e.prototype.entries=function(){return this.state.entries()},e.prototype.snapshot=function(){return this.state.clone()},e.prototype.setState=function(t){this.state=t},e.prototype.onEventMessage=function(e,r){t.prototype.onEventMessage.call(this,e,r);var n=e.body,i=n.tag;if("update"===i){var o=n.head().toValue();this.onUpdateEvent(o.get("key"),n.body())}else if("remove"===i){o=n.head().toValue();this.onRemoveEvent(o.get("key"))}else if("drop"===i){o=n.head().toValue();this.onDropEvent(o.numberValue(0))}else if("take"===i){o=n.head().toValue();this.onTakeEvent(o.numberValue(0))}else"clear"===i&&this.onClearEvent()},e.prototype.onUpdateEvent=function(t,e){var r;e=this.mapWillUpdate(t,e);var n=null!==(r=this.state.get(t))&&void 0!==r?r:ir.absent();this.state.set(t,e),this.mapDidUpdate(t,e,n)},e.prototype.onRemoveEvent=function(t){var e;this.mapWillRemove(t);var r=null!==(e=this.state.get(t))&&void 0!==e?e:ir.absent();this.state.delete(t),this.mapDidRemove(t,r)},e.prototype.onDropEvent=function(t){this.mapWillDrop(t),this.state.drop(t),this.mapDidDrop(t)},e.prototype.onTakeEvent=function(t){this.mapWillTake(t),this.state.take(t),this.mapDidTake(t)},e.prototype.onClearEvent=function(){this.mapWillClear(),this.state.clear(),this.mapDidClear()},e.prototype.mapWillUpdate=function(t,e){for(var r=this.views,n=0,i=r.length;n<i;n+=1)e=r[n].mapWillUpdate(t,e);return e},e.prototype.mapDidUpdate=function(t,e,r){for(var n=this.views,i=0,o=n.length;i<o;i+=1)n[i].mapDidUpdate(t,e,r)},e.prototype.mapWillRemove=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].mapWillRemove(t)},e.prototype.mapDidRemove=function(t,e){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].mapDidRemove(t,e)},e.prototype.mapWillDrop=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].mapWillDrop(t)},e.prototype.mapDidDrop=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].mapDidDrop(t)},e.prototype.mapWillTake=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].mapWillTake(t)},e.prototype.mapDidTake=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)e[r].mapDidTake(t)},e.prototype.mapWillClear=function(){for(var t=this.views,e=0,r=t.length;e<r;e+=1)t[e].mapWillClear()},e.prototype.mapDidClear=function(){for(var t=this.views,e=0,r=t.length;e<r;e+=1)t[e].mapDidClear()},e}(ih),ch=function(t){function e(e,r,n,i,o,s,u,a,p,h,f,c,l,d){var y,v,m,w,g,b,x,O,E,P;void 0===h&&(h=3),void 0===d&&(d=null);var S=t.call(this,e,r,n,i,o,s,u,a,p,h,f)||this;if(void 0!==n){var k=S.observers[S.observers.length-1];k.willUpdate=null!==(y=n.willUpdate)&&void 0!==y?y:k.willUpdate,k.didUpdate=null!==(v=n.didUpdate)&&void 0!==v?v:k.didUpdate,k.willRemove=null!==(m=n.willRemove)&&void 0!==m?m:k.willRemove,k.didRemove=null!==(w=n.didRemove)&&void 0!==w?w:k.didRemove,k.willDrop=null!==(g=n.willDrop)&&void 0!==g?g:k.willDrop,k.didDrop=null!==(b=n.didDrop)&&void 0!==b?b:k.didDrop,k.willTake=null!==(x=n.willTake)&&void 0!==x?x:k.willTake,k.didTake=null!==(O=n.didTake)&&void 0!==O?O:k.didTake,k.willClear=null!==(E=n.willClear)&&void 0!==E?E:k.willClear,k.didClear=null!==(P=n.didClear)&&void 0!==P?P:k.didClear,c=void 0!==n.keyForm?n.keyForm:c,l=void 0!==n.valueForm?n.valueForm:l}return S.ownKeyForm=void 0!==c?c:Sn.forValue(),S.ownValueForm=void 0!==l?l:Sn.forValue(),S.state0=d,S.input=null,S.effects=new xe,S.outlets=new xe,S.outputs=C.empty,S.version=-1,S}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"map"},enumerable:!1,configurable:!0}),e.prototype.copy=function(t,r,n,i,o,s,u,a,p,h,f,c,l){return 10===arguments.length&&(l=this.state0,f=this.ownKeyForm,c=this.ownValueForm),new e(t,r,void 0,n,i,o,s,u,a,p,h,f,c,l)},e.prototype.keyForm=function(t){return void 0===t?this.ownKeyForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,t,this.ownValueForm,this.state0)},e.prototype.valueForm=function(t){return void 0===t?this.ownValueForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownKeyForm,t,this.state0)},Object.defineProperty(e.prototype,"size",{get:function(){return this.model.size},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.model.isEmpty()},e.prototype.has=function(t){var e=this.ownKeyForm.mold(t);return this.model.has(e)},e.prototype.get=function(t){if(void 0===t)return this;var e=this.ownKeyForm.mold(t);return this.model.get(e).coerce(this.ownValueForm)},e.prototype.getEntry=function(t){var e=this.model.getEntry(t);if(void 0!==e)return[e[0].coerce(this.ownKeyForm),e[1].coerce(this.ownValueForm)]},e.prototype.firstKey=function(){var t=this.model.state.firstKey();if(void 0!==t){var e=this.ownKeyForm.cast(t);if(void 0!==e)return e}return this.ownKeyForm.unit},e.prototype.firstValue=function(){var t=this.model.state.firstValue();if(void 0!==t){var e=this.ownValueForm.cast(t);if(void 0!==e)return e}return this.ownValueForm.unit},e.prototype.firstEntry=function(){var t=this.model.state.firstEntry();if(void 0!==t)return[this.ownKeyForm.cast(t[0]),this.ownValueForm.cast(t[1])]},e.prototype.lastKey=function(){var t=this.model.state.lastKey();if(void 0!==t){var e=this.ownKeyForm.cast(t);if(void 0!==e)return e}return this.ownKeyForm.unit},e.prototype.lastValue=function(){var t=this.model.state.lastValue();if(void 0!==t){var e=this.ownValueForm.cast(t);if(void 0!==e)return e}return this.ownValueForm.unit},e.prototype.lastEntry=function(){var t=this.model.state.lastEntry();if(void 0!==t)return[this.ownKeyForm.cast(t[0]),this.ownValueForm.cast(t[1])]},e.prototype.nextKey=function(t){var e=this.ownKeyForm.mold(t),r=this.model.state.nextKey(e);if(void 0!==r){var n=this.ownKeyForm.cast(r);if(void 0!==n)return n}return this.ownKeyForm.unit},e.prototype.nextValue=function(t){var e=this.ownKeyForm.mold(t),r=this.model.state.nextValue(e);if(void 0!==r){var n=this.ownValueForm.cast(r);if(void 0!==n)return n}return this.ownValueForm.unit},e.prototype.nextEntry=function(t){var e=this.ownKeyForm.mold(t),r=this.model.state.nextEntry(e);if(void 0!==r)return[this.ownKeyForm.cast(r[0]),this.ownValueForm.cast(r[1])]},e.prototype.previousKey=function(t){var e=this.ownKeyForm.mold(t),r=this.model.state.previousKey(e);if(void 0!==r){var n=this.ownKeyForm.cast(r);if(void 0!==n)return n}return this.ownKeyForm.unit},e.prototype.previousValue=function(t){var e=this.ownKeyForm.mold(t),r=this.model.state.previousValue(e);if(void 0!==r){var n=this.ownValueForm.cast(r);if(void 0!==n)return n}return this.ownValueForm.unit},e.prototype.previousEntry=function(t){var e=this.ownKeyForm.mold(t),r=this.model.state.previousEntry(e);if(void 0!==r)return[this.ownKeyForm.cast(r[0]),this.ownValueForm.cast(r[1])]},e.prototype.set=function(t,e){var r=this.ownKeyForm.mold(t),n=this.ownValueForm.mold(e);return this.model.set(r,n),this},e.prototype.delete=function(t){var e=this.ownKeyForm.mold(t);return this.model.delete(e)},e.prototype.drop=function(t){return this.model.drop(t),this},e.prototype.take=function(t){return this.model.take(t),this},e.prototype.clear=function(){this.model.clear()},e.prototype.forEach=function(t,e){return this.ownKeyForm===Sn.forValue()&&this.ownValueForm===Sn.forValue()?this.model.state.forEach(t,e):this.model.state.forEach((function(r,n){var i=r.coerce(this.ownKeyForm),o=n.coerce(this.ownValueForm);return t.call(e,i,o)}),this)},e.prototype.keys=function(){var t=this.model.keys();return this.ownKeyForm===Sn.forValue()?t:new Rn(t,this.ownKeyForm)},e.prototype.values=function(){var t=this.model.values();return this.ownValueForm===Sn.forValue()?t:new Rn(t,this.ownValueForm)},e.prototype.entries=function(){var t=this.model.entries();return this.ownKeyForm===Sn.forValue()&&this.ownValueForm===Sn.forValue()?t:new Un(t,this.ownKeyForm,this.ownValueForm)},e.prototype.snapshot=function(){return this.model.snapshot()},e.prototype.setState=function(t){this.model.setState(t)},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.willUpdate=function(t){return this.observe({willUpdate:t})},e.prototype.didUpdate=function(t){return this.observe({didUpdate:t})},e.prototype.willRemove=function(t){return this.observe({willRemove:t})},e.prototype.didRemove=function(t){return this.observe({didRemove:t})},e.prototype.willDrop=function(t){return this.observe({willDrop:t})},e.prototype.didDrop=function(t){return this.observe({didDrop:t})},e.prototype.willTake=function(t){return this.observe({willTake:t})},e.prototype.didTake=function(t){return this.observe({didTake:t})},e.prototype.willClear=function(t){return this.observe({willClear:t})},e.prototype.didClear=function(t){return this.observe({didClear:t})},e.prototype.mapWillUpdate=function(t,e){for(var r,n,i=this.observers,o=0,s=i.length;o<s;o+=1){var u=i[o];if(void 0!==u.willUpdate){void 0===r&&(r=t.coerce(this.ownKeyForm)),void 0===n&&(n=e.coerce(this.ownValueForm));var a=u.willUpdate(r,n,this);void 0!==a&&(n=a,e=this.ownValueForm.mold(n))}}return e},e.prototype.mapDidUpdate=function(t,e,r){for(var n,i,o=t.coerce(this.ownKeyForm),s=this.observers,u=0,a=s.length;u<a;u+=1){var p=s[u];void 0!==p.didUpdate&&(void 0===n&&(n=e.coerce(this.ownValueForm)),void 0===i&&(i=r.coerce(this.ownValueForm)),p.didUpdate(o,n,i,this))}this.decohereInputKey(o,0),this.recohereInput(0)},e.prototype.mapWillRemove=function(t){for(var e,r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.willRemove&&(void 0===e&&(e=t.coerce(this.ownKeyForm)),o.willRemove(e,this))}},e.prototype.mapDidRemove=function(t,e){for(var r,n=t.coerce(this.ownKeyForm),i=this.observers,o=0,s=i.length;o<s;o+=1){var u=i[o];void 0!==u.didRemove&&(void 0===r&&(r=e.coerce(this.ownValueForm)),u.didRemove(n,r,this))}this.decohereInputKey(n,1),this.recohereInput(0)},e.prototype.mapWillDrop=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willDrop&&i.willDrop(t,this)}},e.prototype.mapDidDrop=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didDrop&&i.didDrop(t,this)}},e.prototype.mapWillTake=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.willTake&&i.willTake(t,this)}},e.prototype.mapDidTake=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didTake&&i.didTake(t,this)}},e.prototype.mapWillClear=function(){for(var t=this.observers,e=0,r=t.length;e<r;e+=1){var n=t[e];void 0!==n.willClear&&n.willClear(this)}},e.prototype.mapDidClear=function(){for(var t=this.observers,e=0,r=t.length;e<r;e+=1){var n=t[e];void 0!==n.didClear&&n.didClear(this)}},e.prototype.initialState=function(t){return void 0===t?this.state0:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownKeyForm,this.ownValueForm,t)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this.model.state.forEach((function(t,e){this.mapDidUpdate(t,e,ir.absent())}),this),this.onSyncedResponse()},e.prototype.open=function(){var t,e=this.ownLaneUri;if(e.isEmpty())throw new Error("no lane");var r=this.ownNodeUri;if(r.isEmpty())throw new Error("no node");var n=this.ownHostUri;n.isEmpty()&&(n=r.endpoint(),r=n.unresolve(r));var i=this.context.getDownlink(n,r,e);if(void 0!==i){if(!(i instanceof fh))throw new Error("downlink type mismatch");i.addDownlink(this),this.model=i,setTimeout(this.didAliasModel.bind(this))}else(i=new fh(this.context,n,r,e,this.ownPrio,this.ownRate,this.ownBody,null!==(t=this.state0)&&void 0!==t?t:void 0)).addDownlink(this),this.context.openDownlink(i),this.model=i;return null!==this.owner&&this.owner.addDownlink(this),this},e.prototype.keyIterator=function(){return this.keys()},e.prototype.bindInput=function(t){if(!Kn.is(t))throw new TypeError(""+t);var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},e.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},e.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},e.prototype.outlet=function(t){var e=this.outlets,r=e.get(t);return void 0===r&&(r=new Qn(this,t),this.outlets=e.updated(t,r)),r},e.prototype.outputIterator=function(){return M.array(this.outputs)},e.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},e.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},e.prototype.unbindOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){e[r].unbindInput()}},e.prototype.disconnectOutputs=function(){var t=this.outlets;t.isEmpty()&&(this.outlets=new xe,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this.outputs;this.outputs=C.empty;for(var r=0,n=e.length;r<n;r+=1){var i=e[r];i.unbindInput(),i.disconnectOutputs()}},e.prototype.decohereOutputKey=function(t,e){this.decohereKey(t,e)},e.prototype.decohereInputKey=function(t,e){this.decohereKey(t,e)},e.prototype.decohereKey=function(t,e){var r=this.effects;if(r.get(t)!==e){this.willDecohereKey(t,e),this.effects=r.updated(t,e),this.version=-1,this.onDecohereKey(t,e);for(var n=this.outputs,i=0,o=n.length;i<o;i+=1){var s=n[i];Ln.is(s)?s.decohereOutputKey(t,e):s.decohereOutput()}var u=this.outlets.get(t);void 0!==u&&u.decohereInput(),this.didDecohereKey(t,e)}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),this.version=-1,this.onDecohere();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1){t[e].decohereOutput()}this.outlets.forEach((function(t,e){e.decohereInput()}),this),this.didDecohere()}},e.prototype.recohereOutputKey=function(t,e){this.recohereKey(t,e)},e.prototype.recohereInputKey=function(t,e){this.recohereKey(t,e)},e.prototype.recohereKey=function(t,e){if(this.version<0){var r=this.effects,n=r.get(t);if(void 0!==n){this.willRecohereKey(t,n,e),this.effects=r.removed(t),null!==this.input&&this.input.recohereInputKey(t,e),this.onRecohereKey(t,n,e);for(var i=this.outputs,o=0,s=i.length;o<s;o+=1){var u=i[o];Ln.is(u)&&u.recohereOutputKey(t,e)}var a=this.outlets.get(t);void 0!==a&&a.recohereInput(e),this.didRecohereKey(t,n,e)}}},e.prototype.recohereOutput=function(t){this.recohere(t)},e.prototype.recohereInput=function(t){this.recohere(t)},e.prototype.recohere=function(t){if(this.version<0){this.willRecohere(t),this.effects.forEach((function(e){this.recohereKey(e,t)}),this),this.version=t,this.onRecohere(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1){e[r].recohereOutput(t)}this.didRecohere(t)}},e.prototype.willDecohereKey=function(t,e){},e.prototype.onDecohereKey=function(t,e){},e.prototype.didDecohereKey=function(t,e){},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohereKey=function(t,e,r){},e.prototype.onRecohereKey=function(t,e,r){if(0===e){var n=this.input;if(null!==n){var i=n.get(t);void 0!==i?this.set(t,i):this.delete(t)}}else 1===e&&this.delete(t)},e.prototype.didRecohereKey=function(t,e,r){},e.prototype.willRecohere=function(t){},e.prototype.onRecohere=function(t){},e.prototype.didRecohere=function(t){},e}(oh);Bn.define(ch.prototype);var lh=function(t){function e(e,r,n,i,o,s,u,a){void 0===a&&(a=ir.absent());var p=t.call(this,e,r,n,i,o,s,u)||this;return p.state=a,p}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"value"},enumerable:!1,configurable:!0}),e.prototype.get=function(){return this.state},e.prototype.set=function(t){t=this.valueWillSet(t);var e=this.state;this.setState(t),this.valueDidSet(t,e),this.command(t)},e.prototype.setState=function(t){this.state=t},e.prototype.onEventMessage=function(e,r){t.prototype.onEventMessage.call(this,e,r),this.onSetEvent(e.body)},e.prototype.onSetEvent=function(t){t=this.valueWillSet(t);var e=this.state;this.setState(t),this.valueDidSet(t,e)},e.prototype.valueWillSet=function(t){for(var e=this.views,r=0,n=e.length;r<n;r+=1)t=e[r].valueWillSet(t);return t},e.prototype.valueDidSet=function(t,e){for(var r=this.views,n=0,i=r.length;n<i;n+=1)r[n].valueDidSet(t,e)},e}(ih),dh=function(t){function e(e,r,n,i,o,s,u,a,p,h,f,c,l){var d,y;void 0===h&&(h=3),void 0===l&&(l=ir.absent());var v=t.call(this,e,r,n,i,o,s,u,a,p,h,f)||this;if(void 0!==n){var m=v.observers[v.observers.length-1];m.willSet=null!==(d=n.willSet)&&void 0!==d?d:m.willSet,m.didSet=null!==(y=n.didSet)&&void 0!==y?y:m.didSet,c=void 0!==n.valueForm?n.valueForm:c}return v.ownValueForm=void 0!==c?c:Sn.forValue(),v.state0=l,v.input=null,v.outputs=C.empty,v.version=-1,v}return P(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"value"},enumerable:!1,configurable:!0}),e.prototype.copy=function(t,r,n,i,o,s,u,a,p,h,f,c){return 10===arguments.length&&(c=this.state0,f=this.ownValueForm),new e(t,r,void 0,n,i,o,s,u,a,p,h,f,c)},e.prototype.valueForm=function(t){return void 0===t?this.ownValueForm:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,t,this.state0)},e.prototype.get=function(){return this.model.get().coerce(this.ownValueForm)},e.prototype.set=function(t){var e=this.ownValueForm.mold(t);this.model.set(e)},e.prototype.setState=function(t){this.model.setState(t)},e.prototype.observe=function(e){return t.prototype.observe.call(this,e)},e.prototype.willSet=function(t){return this.observe({willSet:t})},e.prototype.didSet=function(t){return this.observe({didSet:t})},e.prototype.valueWillSet=function(t){for(var e,r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];if(void 0!==o.willSet){void 0===e&&(e=t.coerce(this.ownValueForm));var s=o.willSet(e,this);void 0!==s&&(e=s,t=this.ownValueForm.mold(e))}}return t},e.prototype.valueDidSet=function(t,e){for(var r,n,i=this.observers,o=0,s=i.length;o<s;o+=1){var u=i[o];void 0!==u.didSet&&(void 0===r&&(r=t.coerce(this.ownValueForm)),void 0===n&&(n=e.coerce(this.ownValueForm)),u.didSet(r,n,this))}this.decohere(),this.recohere(0)},e.prototype.initialState=function(t){return void 0===t?this.state0:this.copy(this.context,this.owner,this.ownHostUri,this.ownNodeUri,this.ownLaneUri,this.ownPrio,this.ownRate,this.ownBody,this.flags,this.observers,this.ownValueForm,t)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this.valueDidSet(this.model.get(),ir.absent()),this.onSyncedResponse()},e.prototype.open=function(){var t=this.ownLaneUri;if(t.isEmpty())throw new Error("no lane");var e=this.ownNodeUri;if(e.isEmpty())throw new Error("no node");var r=this.ownHostUri;r.isEmpty()&&(r=e.endpoint(),e=r.unresolve(e));var n=this.context.getDownlink(r,e,t);if(void 0!==n){if(!(n instanceof lh))throw new Error("downlink type mismatch");n.addDownlink(this),this.model=n,setTimeout(this.didAliasModel.bind(this))}else(n=new lh(this.context,r,e,t,this.ownPrio,this.ownRate,this.ownBody,this.state0)).addDownlink(this),this.context.openDownlink(n),this.model=n;return null!==this.owner&&this.owner.addDownlink(this),this},e.prototype.bindInput=function(t){var e=this.input;e!==t&&(null!==e&&e.unbindOutput(this),this.input=t,null!==t&&t.bindOutput(this))},e.prototype.unbindInput=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null)},e.prototype.disconnectInputs=function(){var t=this.input;null!==t&&(t.unbindOutput(this),this.input=null,t.disconnectInputs())},e.prototype.outputIterator=function(){return M.array(this.outputs)},e.prototype.bindOutput=function(t){this.outputs=C.inserted(t,this.outputs)},e.prototype.unbindOutput=function(t){this.outputs=C.removed(t,this.outputs)},e.prototype.unbindOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){t[e].unbindInput()}},e.prototype.disconnectOutputs=function(){var t=this.outputs;this.outputs=C.empty;for(var e=0,r=t.length;e<r;e+=1){var n=t[e];n.unbindInput(),n.disconnectOutputs()}},e.prototype.decohereOutput=function(){this.decohere()},e.prototype.decohereInput=function(){this.decohere()},e.prototype.decohere=function(){if(this.version>=0){this.willDecohere(),this.version=-1,this.onDecohere();for(var t=this.outputs,e=0,r=t.length;e<r;e+=1)t[e].decohereOutput();this.didDecohere()}},e.prototype.recohereOutput=function(t){this.recohere(t)},e.prototype.recohereInput=function(t){this.recohere(t)},e.prototype.recohere=function(t){if(this.version<0){this.willRecohere(t),this.version=t,null!==this.input&&this.input.recohereInput(t),this.onRecohere(t);for(var e=this.outputs,r=0,n=e.length;r<n;r+=1)e[r].recohereOutput(t);this.didRecohere(t)}},e.prototype.willDecohere=function(){},e.prototype.onDecohere=function(){},e.prototype.didDecohere=function(){},e.prototype.willRecohere=function(t){},e.prototype.onRecohere=function(t){var e=this.input;if(null!==e){var r=e.get();void 0!==r&&this.set(r)}},e.prototype.didRecohere=function(t){},e}(oh);Fn.define(dh.prototype);var yh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return P(e,t),e}(Ti),vh=function(t){function e(e){var r=t.call(this)||this;return r.downlink=e,r}return P(e,t),e.prototype.isEmpty=function(){return this.downlink.isEmpty()},e.prototype.isArray=function(){return!0},e.prototype.isObject=function(){return this.downlink.isEmpty()},Object.defineProperty(e.prototype,"length",{get:function(){return this.downlink.length},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){return void 0===t?this:ir.absent()},e.prototype.getAttr=function(t){return ir.absent()},e.prototype.getSlot=function(t){return ir.absent()},e.prototype.getItem=function(t){t instanceof yr&&(t=t.value);var e=this.downlink.length;return t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0?this.downlink.get(t):Qe.absent()},e.prototype.set=function(t,e){throw new Error("unsupported")},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setSlot=function(t,e){throw new Error("unsupported")},e.prototype.setItem=function(t,e){t instanceof yr&&(t=t.value);var r=this.downlink.length;return t<0&&(t=r+t),(t=Math.min(Math.max(0,t),r-1))>=0&&this.downlink.set(t,ir.fromAny(e)),this},e.prototype.push=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(t=this.downlink).push.apply(t,e)},e.prototype.splice=function(t,e){for(var r,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return(r=this.downlink).splice.apply(r,k([t,e],n,!1))},e.prototype.delete=function(t){return Qe.absent()},e.prototype.clear=function(){this.downlink.clear()},e.prototype.forEach=function(t,e){return this.downlink.forEach(t,e)},e.prototype.keyIterator=function(){return M.empty()},e}(yh),mh=function(t){function e(e){var r=t.call(this)||this;return r.downlink=e,e.observe(r),r}return P(e,t),e.prototype.isEmpty=function(){return this.downlink.isEmpty()},e.prototype.isArray=function(){return this.downlink.isEmpty()},e.prototype.isObject=function(){return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this.downlink.size},enumerable:!1,configurable:!0}),e.prototype.has=function(t){return this.downlink.has(t)},e.prototype.get=function(t){return void 0===t?this:this.downlink.get(t)},e.prototype.getAttr=function(t){return ir.absent()},e.prototype.getSlot=function(t){return this.get(t)},e.prototype.getItem=function(t){t instanceof yr&&(t=t.value);var e=this.downlink.size;if(t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0){var r=this.downlink.getEntry(t);return $e.of(r[0],r[1])}return Qe.absent()},e.prototype.set=function(t,e){return this.downlink.set(t,e),this},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setSlot=function(t,e){return this.set(t,e)},e.prototype.setItem=function(t,e){throw new Error("unsupported")},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];throw new Error("unsupported")},e.prototype.delete=function(t){t=ir.fromAny(t);var e=this.downlink.get(t);return this.downlink.delete(t)?$e.of(t,e):Qe.absent()},e.prototype.clear=function(){this.downlink.clear()},e.prototype.forEach=function(t,e){var r=0;return this.downlink.forEach((function(n,i){var o=t.call(e,$e.of(n,i),r);return r+=1,o}))},e.prototype.keyIterator=function(){return this.downlink.keys()},e.prototype.didUpdate=function(t,e,r){this.decohereInputKey(t,0),this.recohereInput(0)},e.prototype.didRemove=function(t,e){this.decohereInputKey(t,1),this.recohereInput(0)},e.prototype.didDrop=function(t){},e.prototype.didTake=function(t){},e.prototype.didClear=function(){},e}(yh),wh=function(t){function e(e){var r=t.call(this)||this;return r.downlink=e,e.observe(r),r}return P(e,t),e.prototype.isEmpty=function(){var t=this.downlink.get();return t instanceof or?t.isEmpty():!t.isDefined()},e.prototype.isArray=function(){var t=this.downlink.get();return!(t instanceof or)||t.isArray()},e.prototype.isObject=function(){var t=this.downlink.get();return t instanceof or?t.isObject():!t.isDefined()},Object.defineProperty(e.prototype,"length",{get:function(){var t=this.downlink.get();return t instanceof or?t.length:t.isDefined()?1:0},enumerable:!1,configurable:!0}),e.prototype.has=function(t){var e=this.downlink.get();return e instanceof or&&e.has(t)},e.prototype.get=function(t){if(void 0===t)return this;var e=this.downlink.get();return e instanceof or?e.get(t):ir.absent()},e.prototype.getAttr=function(t){var e=this.downlink.get();return e instanceof or?e.getAttr(t):ir.absent()},e.prototype.getSlot=function(t){var e=this.downlink.get();return e instanceof or?e.getSlot(t):ir.absent()},e.prototype.getField=function(t){var e=this.downlink.get();return e instanceof or?e.getField(t):void 0},e.prototype.getItem=function(t){var e=this.downlink.get();return e instanceof or?e.getItem(t):e},e.prototype.set=function(t,e){var r=this.downlink.get();if(!(r instanceof or))throw new Error("unsupported");return r.set(t,e),this},e.prototype.setAttr=function(t,e){var r=this.downlink.get();if(!(r instanceof or))throw new Error("unsupported");return r.setAttr(t,e),this},e.prototype.setSlot=function(t,e){var r=this.downlink.get();if(!(r instanceof or))throw new Error("unsupported");return r.setSlot(t,e),this},e.prototype.setItem=function(t,e){var r=this.downlink.get();return r instanceof or?r.setItem(t,e):this.downlink.set(Qe.fromAny(e).toValue()),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.downlink.get();if(r instanceof or)return r.push.apply(r,t);throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=this.downlink.get();if(i instanceof or)return i.splice.apply(i,k([t,e],r,!1));throw new Error("unsupported")},e.prototype.delete=function(t){var e=this.downlink.get();return e instanceof or?e.delete(t):ir.absent()},e.prototype.clear=function(){var t=this.downlink.get();if(!(t instanceof or))throw new Error("unsupported");t.clear()},e.prototype.forEach=function(t,e){return this.downlink.get().forEach(t,e)},e.prototype.keyIterator=function(){if(this.downlink.get()instanceof or)throw new Error;return M.empty()},e.prototype.didSet=function(t,e){this.decohereInput(),this.recohereInput(0)},e}(yh),gh=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.warp=e,r}return P(e,t),e.prototype.reify=function(t){return t instanceof Je?this.reifyField(t):this.reifyValue(t)},e.prototype.reifyField=function(t){var e=t.value,r=this.reifyValue(e);return e!==r?t.updatedValue(r):t},e.prototype.reifyValue=function(t){return t instanceof Ri?this.reifyModel(t):t},e.prototype.reifyModel=function(t){if("link"===t.tag){var e=new bh(this.warp,t);return e.compile(),e}return t},e}(Ni),bh=function(t){function e(e,r){void 0===e&&(e=null);var n=t.call(this,r)||this;return n.hostUri=n.inoutlet(),n.nodeUri=n.inoutlet(),n.laneUri=n.inoutlet(),n.prio=n.inoutlet(),n.rate=n.inoutlet(),n.bodyValue=n.inoutlet(),n.type=n.inoutlet(),n.state=n.outlet(),n.warp=e,n.downlink=null,n.downlinkRecord=null,n.inputHostUri=void 0,n.inputNodeUri=void 0,n.inputLaneUri=void 0,n.inputPrio=void 0,n.inputRate=void 0,n.inputBody=void 0,n.inputType=void 0,n}return P(e,t),e.prototype.getOutput=function(t){if((t=this.outlet(t))===this.state){if(this.downlink instanceof dh)return this.downlink.get();if(null!==this.downlinkRecord)return this.downlinkRecord}},e.prototype.onRecohere=function(t){var e,r=this.castInput(this.hostUri,Sn.forString()),n=this.castInput(this.nodeUri,Sn.forString()),i=this.castInput(this.laneUri,Sn.forString()),o=this.castInput(this.prio,Sn.forNumber(),0),s=this.castInput(this.rate,Sn.forNumber(),0),u=this.getInput(this.bodyValue),a=this.castInput(this.type,Sn.forString(),void 0);if(r!==this.inputHostUri||n!==this.inputNodeUri||i!==this.inputLaneUri||o!==this.inputPrio||s!==this.inputRate||(void 0===u?void 0!==this.inputBody:!u.equals(this.inputBody))||a!==this.inputType){null!==this.downlink&&(this.downlink.close(),this.downlink=null,this.downlinkRecord=null),this.inputHostUri=r,this.inputNodeUri=n,this.inputLaneUri=i,this.inputPrio=o,this.inputRate=s,this.inputBody=u,this.inputType=a;var p=null!==(e=this.warp)&&void 0!==e?e:Sh;if("map"===a){var h=p.downlinkMap();void 0!==r&&(h=h.hostUri(r)),void 0!==n&&(h=h.nodeUri(n)),void 0!==i&&(h=h.laneUri(i)),0!==o&&(h=h.prio(o)),0!==s&&(h=h.rate(s)),void 0!==u&&(h=h.body(u)),h=h.open(),this.state=h,this.downlink=h,this.downlinkRecord=new mh(h)}else if("value"===a){h=p.downlinkValue();void 0!==r&&(h=h.hostUri(r)),void 0!==n&&(h=h.nodeUri(n)),void 0!==i&&(h=h.laneUri(i)),void 0!==o&&(h=h.prio(o)),void 0!==s&&(h=h.rate(s)),void 0!==u&&(h=h.body(u)),h=h.open(),this.state=h,this.downlink=h}}},e.reifier=function(t){return void 0===t?(void 0===e._reifier&&(e._reifier=new gh),e._reifier):new gh(t)},S([Di],e.prototype,"hostUri",void 0),S([Di],e.prototype,"nodeUri",void 0),S([Di],e.prototype,"laneUri",void 0),S([Di],e.prototype,"prio",void 0),S([Di],e.prototype,"rate",void 0),S([Di("body")],e.prototype,"bodyValue",void 0),S([Di],e.prototype,"type",void 0),S([Ai],e.prototype,"state",void 0),e}(ji),xh=function(){function t(t){this.context=t,this.host=null,this.downlinks=[],this.observers=C.empty}return t.prototype.isConnected=function(){var t=this.host;return null!==t&&t.isConnected()},t.prototype.isAuthenticated=function(){var t=this.host;return null!==t&&t.isAuthenticated()},Object.defineProperty(t.prototype,"session",{get:function(){var t=this.host;return null!==t?t.session:ir.absent()},enumerable:!1,configurable:!0}),t.prototype.authenticate=function(t){this.context.authenticate(this.hostUri,t)},t.prototype.addDownlink=function(t){var e=this.downlinks;0===e.length&&this.open(),e.push(t)},t.prototype.removeDownlink=function(t){var e=this.downlinks,r=e.indexOf(t);r>=0&&(e.splice(r,1),0===e.length&&this.close())},t.prototype.open=function(){this.context.openRef(this)},t.prototype.close=function(){this.context.closeRef(this)},t.prototype.closeUp=function(){var t=this.downlinks;this.downlinks=[];for(var e=0,r=t.length;e<r;e+=1)t[e].close()},t.prototype.observe=function(t){return this.observers=C.inserted(t,this.observers),this},t.prototype.unobserve=function(t){for(var e=this.observers,r=e.length,n=0;n<r;n+=1){var i=e[n],o=i===t;if(!o)for(var s in i)if(i[s]===t){o=!0;break}if(o){if(r>1){for(var u=new Array(r-1),a=0;a<n;a+=1)u[a]=e[a];for(a=n+1;a<r;a+=1)u[a-1]=e[a];this.observers=u}else this.observers=C.empty;break}}return this},t.prototype.didConnect=function(t){return this.observe({didConnect:t})},t.prototype.didAuthenticate=function(t){return this.observe({didAuthenticate:t})},t.prototype.didDeauthenticate=function(t){return this.observe({didDeauthenticate:t})},t.prototype.didDisconnect=function(t){return this.observe({didDisconnect:t})},t.prototype.didFail=function(t){return this.observe({didFail:t})},t.prototype.hostDidConnect=function(t){this.host=t;for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didConnect&&i.didConnect(t,this)}},t.prototype.hostDidAuthenticate=function(t,e){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didAuthenticate&&o.didAuthenticate(t,e,this)}},t.prototype.hostDidDeauthenticate=function(t,e){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didDeauthenticate&&o.didDeauthenticate(t,e,this)}},t.prototype.hostDidDisconnect=function(t){this.host=null;for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didDisconnect&&i.didDisconnect(t,this)}},t.prototype.hostDidFail=function(t,e){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didFail&&o.didFail(t,e,this)}},t}(),Oh=function(t){function e(e,r,n,i){var o=t.call(this,e)||this;return o.hostUri=r,o.nodeUri=n,o.laneUri=i,o}return P(e,t),e.prototype.hostRef=function(t){return t=ys.fromAny(t),new Eh(this.context,t)},e.prototype.nodeRef=function(t){return t=ys.fromAny(t),new Ch(this.context,this.hostUri,t)},e.prototype.laneRef=function(t){return t=ys.fromAny(t),new e(this.context,this.hostUri,this.nodeUri,t)},e.prototype.downlink=function(t){return new ah(this.context,this,t,this.hostUri,this.nodeUri,this.laneUri)},e.prototype.downlinkList=function(t){return new hh(this.context,this,t,this.hostUri,this.nodeUri,this.laneUri)},e.prototype.downlinkMap=function(t){return new ch(this.context,this,t,this.hostUri,this.nodeUri,this.laneUri)},e.prototype.downlinkValue=function(t){return new dh(this.context,this,t,this.hostUri,this.nodeUri,this.laneUri)},e.prototype.command=function(t){this.context.command(this.hostUri,this.nodeUri,this.laneUri,t)},e}(xh),Ch=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.hostUri=r,i.nodeUri=n,i}return P(e,t),e.prototype.hostRef=function(t){return t=ys.fromAny(t),new Eh(this.context,t)},e.prototype.nodeRef=function(t){return t=ys.fromAny(t),new e(this.context,this.hostUri,t)},e.prototype.laneRef=function(t){return t=ys.fromAny(t),new Oh(this.context,this.hostUri,this.nodeUri,t)},e.prototype.downlink=function(t){return new ah(this.context,this,t,this.hostUri,this.nodeUri)},e.prototype.downlinkList=function(t){return new hh(this.context,this,t,this.hostUri,this.nodeUri)},e.prototype.downlinkMap=function(t){return new ch(this.context,this,t,this.hostUri,this.nodeUri)},e.prototype.downlinkValue=function(t){return new dh(this.context,this,t,this.hostUri,this.nodeUri)},e.prototype.command=function(t,e){this.context.command(this.hostUri,this.nodeUri,t,e)},e}(xh),Eh=function(t){function e(e,r){var n=t.call(this,e)||this;return n.hostUri=r,n}return P(e,t),e.prototype.hostRef=function(t){return t=ys.fromAny(t),new e(this.context,t)},e.prototype.nodeRef=function(t){return t=ys.fromAny(t),new Ch(this.context,this.hostUri,t)},e.prototype.laneRef=function(t,e){return t=ys.fromAny(t),e=ys.fromAny(e),new Oh(this.context,this.hostUri,t,e)},e.prototype.downlink=function(t){return new ah(this.context,this,t,this.hostUri)},e.prototype.downlinkList=function(t){return new hh(this.context,this,t,this.hostUri)},e.prototype.downlinkMap=function(t){return new ch(this.context,this,t,this.hostUri)},e.prototype.downlinkValue=function(t){return new dh(this.context,this,t,this.hostUri)},e.prototype.command=function(t,e,r){this.context.command(this.hostUri,t,e,r)},e}(xh),Ph=function(){function t(t){void 0===t&&(t={}),void 0===t.keepOnline&&(t.keepOnline=!0),this.options=t,this.hosts=new xe,this.downlinks=new xe,this.downlinkCount=0,this.refs=[],this.online=!0,this.observers=C.empty,this.onOnline=this.onOnline.bind(this),this.onOffline=this.onOffline.bind(this),this.watchOnline(!!t.keepOnline)}return t.prototype.isOnline=function(t){return void 0===t?this.online:(this.online!==t&&(this.online=t,t&&this.hosts.forEach((function(t,e){e.open()}),this)),this)},t.prototype.keepOnline=function(t){return void 0===t?!!this.options.keepOnline:(this.options.keepOnline!==t&&(this.options.keepOnline=t,this.watchOnline(t)),this)},t.prototype.watchOnline=function(t){"object"==typeof window&&(t?(window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)):(window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline)))},t.prototype.onOnline=function(t){this.isOnline(!0)},t.prototype.onOffline=function(t){this.isOnline(!1)},t.prototype.getHost=function(t){return t=ys.fromAny(t),this.hosts.get(t)},t.prototype.openHost=function(t){t=ys.fromAny(t);var e=this.hosts.get(t);return void 0===e&&(e=new nh(this,t,this.options),this.hosts.set(t,e)),e},t.prototype.closeHost=function(t){void 0!==this.hosts.get(t.hostUri)&&(this.hosts.delete(t.hostUri),t.closeUp())},t.prototype.getDownlink=function(t,e,r){var n=this.downlinks.get(t);if(void 0!==n){var i=n.get(e);if(void 0!==i)return i.get(r)}},t.prototype.openDownlink=function(t){var e=t.hostUri,r=t.nodeUri,n=t.laneUri,i=this.downlinks.get(e);void 0===i&&(i=new xe,this.downlinks.set(e,i));var o=i.get(r);if(void 0===o&&(o=new xe,i.set(r,o)),o.has(n))throw new Error("duplicate downlink");o.set(n,t),this.downlinkCount+=1,this.openHost(e).openDownlink(t)},t.prototype.unlinkDownlink=function(t){var e=t.hostUri,r=this.getHost(e);void 0!==r&&r.unlinkDownlink(t)},t.prototype.closeDownlink=function(t){var e=t.hostUri,r=t.nodeUri,n=t.laneUri,i=this.downlinks.get(e);if(void 0!==i){var o=i.get(r);if(void 0!==o&&o.get(n)){this.downlinkCount-=1,o.delete(n),o.isEmpty()&&(i.delete(r),i.isEmpty()&&this.downlinks.delete(e));var s=this.getHost(e);void 0!==s&&s.closeDownlink(t)}}},t.prototype.downlink=function(t){return new ah(this,null,t)},t.prototype.downlinkList=function(t){return new hh(this,null,t)},t.prototype.downlinkMap=function(t){return new ch(this,null,t)},t.prototype.downlinkValue=function(t){return new dh(this,null,t)},t.prototype.openRef=function(t){this.refs.push(t)},t.prototype.closeRef=function(t){var e=this.refs,r=e.indexOf(t);r>=0&&(e.splice(r,1),t.closeUp())},t.prototype.hostRef=function(t){return t=ys.fromAny(t),new Eh(this,t)},t.prototype.nodeRef=function(t,e){return t=ys.fromAny(t),void 0===e?(t=(e=t).endpoint(),e=t.unresolve(e)):e=ys.fromAny(e),new Ch(this,t,e)},t.prototype.laneRef=function(t,e,r){return t=ys.fromAny(t),e=ys.fromAny(e),void 0===r?(r=e,t=(e=t).endpoint(),e=t.unresolve(e)):r=ys.fromAny(r),new Oh(this,t,e,r)},t.prototype.authenticate=function(t,e){t=ys.fromAny(t),e=ir.fromAny(e),this.openHost(t).authenticate(e)},t.prototype.command=function(t,e,r,n){t=ys.fromAny(t),e=ys.fromAny(e),3===arguments.length?(n=r,r=e,t=(e=t).endpoint(),e=t.unresolve(e)):r=ys.fromAny(r),n=ir.fromAny(n);var i=this.openHost(t);i.command(e,r,n)},t.prototype.close=function(){var t=this.refs;this.refs=[];for(var e=0;e<t.length;e+=1)t[e].closeUp();var r=this.downlinks.clone();this.downlinks.clear(),this.downlinkCount=0,r.forEach((function(t,e){e.forEach((function(e,r){r.forEach((function(e,r){r.closeUp();var n=this.getHost(t);void 0!==n&&n.closeDownlink(r)}),this)}),this)}),this);var n=this.hosts.clone();this.hosts.clear(),n.forEach((function(t,e){e.closeUp()}),this)},t.prototype.observe=function(t){return this.observers=C.inserted(t,this.observers),this},t.prototype.unobserve=function(t){for(var e=this.observers,r=e.length,n=0;n<r;n+=1){var i=e[n],o=i===t;if(!o)for(var s in i)if(i[s]===t){o=!0;break}if(o){if(r>1){for(var u=new Array(r-1),a=0;a<n;a+=1)u[a]=e[a];for(a=n+1;a<r;a+=1)u[a-1]=e[a];this.observers=u}else this.observers=C.empty;break}}return this},t.prototype.didConnect=function(t){return this.observe({didConnect:t})},t.prototype.didAuthenticate=function(t){return this.observe({didAuthenticate:t})},t.prototype.didDeauthenticate=function(t){return this.observe({didDeauthenticate:t})},t.prototype.didDisconnect=function(t){return this.observe({didDisconnect:t})},t.prototype.didFail=function(t){return this.observe({didFail:t})},t.prototype.hostDidConnect=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didConnect&&i.didConnect(t,this)}var o=this.refs;for(r=0,n=o.length;r<n;r+=1){var s=o[r];s.hostUri.equals(t.hostUri)&&s.hostDidConnect(t)}},t.prototype.hostDidAuthenticate=function(t,e){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didAuthenticate&&o.didAuthenticate(t,e,this)}var s=this.refs;for(n=0,i=s.length;n<i;n+=1){var u=s[n];u.hostUri.equals(e.hostUri)&&u.hostDidAuthenticate(t,e)}},t.prototype.hostDidDeauthenticate=function(t,e){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didDeauthenticate&&o.didDeauthenticate(t,e,this)}var s=this.refs;for(n=0,i=s.length;n<i;n+=1){var u=s[n];u.hostUri.equals(e.hostUri)&&u.hostDidDeauthenticate(t,e)}},t.prototype.hostDidDisconnect=function(t){for(var e=this.observers,r=0,n=e.length;r<n;r+=1){var i=e[r];void 0!==i.didDisconnect&&i.didDisconnect(t,this)}var o=this.refs;for(r=0,n=o.length;r<n;r+=1){var s=o[r];s.hostUri.equals(t.hostUri)&&s.hostDidDisconnect(t)}},t.prototype.hostDidFail=function(t,e){for(var r=this.observers,n=0,i=r.length;n<i;n+=1){var o=r[n];void 0!==o.didFail&&o.didFail(t,e,this)}var s=this.refs;for(n=0,i=s.length;n<i;n+=1){var u=s[n];u.hostUri.equals(e.hostUri)&&u.hostDidFail(t,e)}},t}(),Sh=new Ph,kh=Sh.isOnline.bind(Sh),Mh=Sh.keepOnline.bind(Sh),Ah=Sh.downlink.bind(Sh),Dh=Sh.downlinkList.bind(Sh),Ih=Sh.downlinkMap.bind(Sh),Th=Sh.downlinkValue.bind(Sh),Vh=Sh.hostRef.bind(Sh),jh=Sh.nodeRef.bind(Sh),qh=Sh.laneRef.bind(Sh),Rh=Sh.authenticate.bind(Sh),Uh=Sh.command.bind(Sh);t.Absent=gr,t.AbstractInlet=Yn,t.AbstractInoutlet=_n,t.AbstractMapInlet=Zn,t.AbstractMapInletMapOutlet=ei,t.AbstractMapInletOutlet=ti,t.AbstractMapInoutlet=$n,t.AbstractMapOutlet=Jn,t.AbstractOutlet=Gn,t.AbstractRecordOutlet=Ti,t.AbstractRecordStreamlet=ji,t.AbstractStreamlet=Mi,t.AffineTransform=ia,t.AffineTransformInterpolator=oa,t.AffineTransformParser=sa,t.AndOperator=Tr,t.AndOutlet=Wi,t.Angle=su,t.AngleForm=cu,t.AngleInterpolator=fu,t.AngleParser=lu,t.AnyForm=Vn,t.ArrayInterpolator=ie,t.Arrays=C,t.AssertException=T,t.Attr=er,t.AttrInterpolator=rr,t.AuthRequest=Zp,t.AuthedResponse=Jp,t.BTree=xe,t.BTreeContext=be,t.BTreeLeaf=Ce,t.BTreeNode=Ee,t.BTreeNodeCursor=Pe,t.BTreePage=Oe,t.Base10=it,t.Base10IntegerWriter=Ft,t.Base10NumberParser=Nt,t.Base16=jt,t.Base16IntegerWriter=Bt,t.Base16Parser=Lt,t.Base16Writer=Kt,t.Base64=Wt,t.Base64Parser=Yt,t.Base64Writer=Gt,t.BaseRef=xh,t.Binary=Dt,t.BinaryOperator=Or,t.BinaryOperatorInterpolator=Cr,t.BinaryOutlet=Fi,t.BitwiseAndOperator=qr,t.BitwiseAndOutlet=Yi,t.BitwiseNotOperator=Gr,t.BitwiseNotOutlet=so,t.BitwiseOrOperator=Vr,t.BitwiseOrOutlet=Hi,t.BitwiseXorOperator=jr,t.BitwiseXorOutlet=Xi,t.Bool=mr,t.BooleanForm=Tn,t.Booleans=v,t.BridgeFunc=ln,t.ByteOrder=p,t.ByteOutput=kt,t.ByteOutputBuffer=At,t.ByteOutputUint8Array=Mt,t.ChildrenSelector=un,t.CommandMessage=Wp,t.Compare=o,t.ConditionalOperator=Sr,t.ConditionalOperatorInterpolator=kr,t.ConditionalOutlet=Ki,t.Constraint=Xe,t.ConstraintBinding=We,t.ConstraintConstant=Be,t.ConstraintDummy=Re,t.ConstraintError=Ue,t.ConstraintExpression=ze,t.ConstraintGroup=Ye,t.ConstraintInvalid=Ne,t.ConstraintKey=Te,t.ConstraintMap=Ve,t.ConstraintProduct=Ke,t.ConstraintRow=Ge,t.ConstraintSlack=qe,t.ConstraintSolver=_e,t.ConstraintStrength=He,t.ConstraintSum=Fe,t.ConstraintSymbol=je,t.ConstraintTerm=Le,t.Constructors=b,t.ContinuousScale=de,t.Cursor=M,t.CursorArray=I,t.CursorEmpty=A,t.CursorUnary=D,t.Data=fr,t.DataOutput=cr,t.Dataflow=ho,t.DateTime=Na,t.DateTimeForm=Fa,t.DateTimeFormat=Wa,t.DateTimeInterpolator=za,t.DateTimeLocale=Ka,t.DateTimeParser=La,t.DateTimeSpecifiers=Ba,t.DayInterval=Sp,t.DayOfMonthFormat=_a,t.DayOfMonthParser=pp,t.DeauthRequest=$p,t.DeauthedResponse=th,t.DegAngle=uu,t.DescendantsSelector=an,t.Diagnostic=ot,t.DivideOperator=Hr,t.DivideOutlet=no,t.Domain=Qt,t.Downlink=oh,t.DownlinkModel=ih,t.DownlinkRecord=yh,t.DownlinkReifier=gh,t.DownlinkStreamlet=bh,t.Easing=ue,t.EmLength=$s,t.Envelope=Np,t.EqOperator=Nr,t.EqOutlet=Qi,t.Equals=r,t.Equivalent=i,t.EventDownlink=ah,t.EventDownlinkModel=uh,t.EventMessage=Bp,t.Expression=br,t.Extant=wr,t.Field=Je,t.FieldInterpolator=tr,t.FilterFieldsCombinator=fi,t.FilterFieldsOperator=hi,t.FilterSelector=pn,t.FilterTimeInterval=xp,t.Form=Sn,t.FormException=Pn,t.Format=nt,t.FromAny=s,t.Func=fn,t.Functions=g,t.GeOperator=Fr,t.GeOutlet=Ji,t.GeoBox=xa,t.GeoBoxInterpolator=Ca,t.GeoCurve=da,t.GeoGroup=Ea,t.GeoJson=Pa,t.GeoJsonFeature=ja,t.GeoJsonFeatureCollection=qa,t.GeoJsonGeometry=Sa,t.GeoJsonGeometryCollection=Va,t.GeoJsonLineString=Aa,t.GeoJsonMultiLineString=Da,t.GeoJsonMultiPoint=Ma,t.GeoJsonMultiPolygon=Ta,t.GeoJsonPoint=ka,t.GeoJsonPolygon=Ia,t.GeoPath=ga,t.GeoPathBuilder=ba,t.GeoPoint=ca,t.GeoPointInterpolator=la,t.GeoProjection=ha,t.GeoSegment=ya,t.GeoSegmentInterpolator=va,t.GeoShape=fa,t.GeoSpline=ma,t.GeoSplineBuilder=wa,t.GeoTile=Oa,t.GetAttrSelector=rn,t.GetItemSelector=nn,t.GetOutlet=zi,t.GetSelector=en,t.GradAngle=pu,t.GtOperator=Lr,t.GtOutlet=$i,t.HashCode=n,t.HashGenCacheMap=R,t.HashGenCacheSet=N,t.Host=eh,t.HostAddressed=Fp,t.HostRef=Eh,t.Hour12Format=$a,t.Hour12Parser=lp,t.Hour24Format=Ja,t.Hour24Parser=cp,t.HourInterval=kp,t.Identity=c,t.IdentityInterpolator=ee,t.IdentitySelector=tn,t.IdentityTransform=Hu,t.In=function(t,e){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),Mi.decorateInlet.bind(void 0,t);Mi.decorateInlet({},t,e)},t.Inlet=Nn,t.InletDescriptor=Pi,t.Inout=Di,t.Input=Y,t.InputBuffer=at,t.InputBufferDone=ht,t.InputBufferEmpty=pt,t.InputBufferError=ft,t.InputDone=ut,t.InputEmpty=st,t.InputError=G,t.InputException=H,t.InputSettings=X,t.Interpolate=Jt,t.Interpolator=$t,t.InterpolatorInterpolator=oe,t.InterpolatorMap=te,t.Interpreter=Dr,t.InterpreterException=Mr,t.InterpreterSettings=Ar,t.InvokeOperator=Zr,t.InvokeOperatorInterpolator=Jr,t.InvokeOutlet=po,t.Item=Qe,t.ItemForm=jn,t.ItemInterpolator=Ze,t.KeyOutlet=Qn,t.KeysCursor=me,t.KeysSelector=on,t.LambdaFunc=cn,t.LaneAddressed=Lp,t.LaneRef=Oh,t.Lazy=e,t.LeOperator=Ur,t.LeOutlet=_i,t.Length=Zs,t.LengthException=Qs,t.LengthForm=iu,t.LengthInterpolator=nu,t.LengthParser=ou,t.LinearDomain=pe,t.LinearDomainInterpolator=he,t.LinearRange=fe,t.LinearRangeInterpolator=ce,t.LinearScale=ye,t.LinearScaleInterpolator=ve,t.LinkAddressed=Kp,t.LinkRequest=Hp,t.LinkedResponse=Xp,t.ListDownlink=hh,t.ListDownlinkModel=ph,t.ListDownlinkRecord=vh,t.LiteralSelector=hn,t.LtOperator=Rr,t.LtOutlet=Gi,t.MapDownlink=ch,t.MapDownlinkModel=fh,t.MapDownlinkRecord=mh,t.MapFieldValuesCombinator=yi,t.MapFieldValuesOperator=di,t.MapInlet=Ln,t.MapInput=si,t.MapOutlet=Kn,t.MapOutletCombinators=Bn,t.MapOutput=ui,t.MapValueCombinator=li,t.MapValueOperator=ci,t.Mapping=_t,t.Mark=L,t.MathModule=dn,t.MemoizeMapCombinator=pi,t.MemoizeValueCombinator=ai,t.MillisecondFormat=np,t.MillisecondInterval=Dp,t.MillisecondParser=mp,t.MillisecondsInterval=Ip,t.MinusOperator=Br,t.MinusOutlet=eo,t.MinuteFormat=ep,t.MinuteInterval=Mp,t.MinuteParser=yp,t.ModuloOperator=Xr,t.ModuloOutlet=io,t.MonthFormat=Ya,t.MonthInterval=Ep,t.MonthOfYearFormat=Xa,t.MonthOfYearParser=sp,t.MonthParser=up,t.Murmur3=f,t.NeOperator=zr,t.NeOutlet=Zi,t.NegativeOperator=_r,t.NegativeOutlet=uo,t.NodeCursor=ge,t.NodeRef=Ch,t.NotOperator=Yr,t.NotOutlet=oo,t.Num=yr,t.NumInterpolator=vr,t.NumberForm=In,t.NumberInterpolator=ne,t.Numbers=m,t.Objects=x,t.Operator=xr,t.OrOperator=Ir,t.OrOutlet=Bi,t.Out=Ai,t.Outlet=zn,t.OutletCombinators=Fn,t.OutletDescriptor=Si,t.OutletInlet=ri,t.OutletMapInlet=ni,t.Output=Z,t.OutputBuffer=yt,t.OutputBufferDone=mt,t.OutputBufferError=wt,t.OutputBufferFull=vt,t.OutputDone=lt,t.OutputError=dt,t.OutputException=Q,t.OutputFull=ct,t.OutputSettings=W,t.OutputStyle=B,t.Parser=bt,t.ParserDone=xt,t.ParserError=Ot,t.ParserException=gt,t.PatternFormat=ip,t.PatternParser=wp,t.PctLength=eu,t.PeriodFormat=tp,t.PeriodParser=dp,t.PlusOperator=Kr,t.PlusOutlet=to,t.PositiveOperator=Qr,t.PositiveOutlet=ao,t.PxLength=Js,t.R2BezierCurve=xu,t.R2Box=Nu,t.R2BoxInterpolator=zu,t.R2Circle=Uu,t.R2CircleInterpolator=Fu,t.R2CubicCurve=ku,t.R2CubicCurveParser=Mu,t.R2Curve=gu,t.R2CurveParser=bu,t.R2EllipticCurve=Au,t.R2EllipticCurveParser=Du,t.R2Group=Lu,t.R2Path=ju,t.R2PathBuilder=qu,t.R2PathParser=Ru,t.R2Point=mu,t.R2PointInterpolator=wu,t.R2QuadraticCurve=Pu,t.R2QuadraticCurveParser=Su,t.R2Segment=Ou,t.R2SegmentInterpolator=Cu,t.R2SegmentParser=Eu,t.R2Shape=vu,t.R2Spline=Iu,t.R2SplineBuilder=Tu,t.R2SplineParser=Vu,t.R2Vector=du,t.R2VectorInterpolator=yu,t.RadAngle=au,t.Random=a,t.Range=Zt,t.Recon=fo,t.ReconParser=Ko,t.ReconStructureParser=Bo,t.ReconStructureWriter=ls,t.ReconWriter=cs,t.Record=or,t.RecordCursor=ar,t.RecordFieldUpdater=qi,t.RecordInterpolator=ur,t.RecordMap=pr,t.RecordMapView=hr,t.RecordModel=Ri,t.RecordOutlet=Ii,t.RecordScope=Ui,t.RecordStreamlet=Vi,t.ReduceFieldsCombinator=mi,t.ReduceFieldsOperator=vi,t.Reifier=Ni,t.RemLength=tu,t.RemoteHost=rh,t.RotateTransform=Ju,t.RotateTransformInterpolator=$u,t.RotateTransformParser=ta,t.STree=ke,t.STreeContext=Se,t.STreeLeaf=Ae,t.STreeNode=De,t.STreeNodeCursor=Ie,t.STreePage=Me,t.Scale=le,t.ScaleTransform=_u,t.ScaleTransformInterpolator=Qu,t.ScaleTransformParser=Zu,t.SecondFormat=rp,t.SecondInterval=Ap,t.SecondParser=vp,t.Selector=$r,t.Severity=q,t.ShortMonthFormat=Ga,t.ShortMonthParser=ap,t.ShortWeekdayFormat=Za,t.ShortWeekdayParser=fp,t.SkewTransform=ea,t.SkewTransformInterpolator=ra,t.SkewTransformParser=na,t.Slot=$e,t.SlotInterpolator=nr,t.Span=K,t.StepInterpolator=re,t.Streamlet=Xn,t.StreamletException=Wn,t.StreamletInlet=Oi,t.StreamletInoutlet=Ei,t.StreamletOutlet=Ci,t.StreamletScope=Hn,t.StringForm=Dn,t.StringInput=_,t.StringOutput=J,t.StringWriter=et,t.Strings=w,t.SyncRequest=Yp,t.SyncedResponse=Gp,t.Tag=F,t.TagForm=kn,t.Text=lr,t.TextOutput=dr,t.TimeDomain=Tp,t.TimeDomainInterpolator=Vp,t.TimeInterval=gp,t.TimeRange=jp,t.TimeRangeInterpolator=qp,t.TimeScale=Rp,t.TimeScaleInterpolator=Up,t.TimeZone=Ra,t.TimeZoneForm=Ua,t.TimesOperator=Wr,t.TimesOutlet=ro,t.Timing=se,t.ToAny=u,t.Transform=Ku,t.TransformForm=Bu,t.TransformList=ua,t.TransformListInterpolator=aa,t.TransformListParser=pa,t.TransformParser=Wu,t.TranslateTransform=Xu,t.TranslateTransformInterpolator=Yu,t.TranslateTransformParser=Gu,t.TurnAngle=hu,t.Tweening=ae,t.UnaryOperator=Er,t.UnaryOperatorInterpolator=Pr,t.UnaryOutlet=Li,t.Unicode=rt,t.UnitForm=Mn,t.UnitTimeInterval=bp,t.UnitlessLength=ru,t.UnlinkRequest=_p,t.UnlinkedResponse=Qp,t.Uri=ys,t.UriAbsoluteParser=zs,t.UriAuthority=ms,t.UriAuthorityParser=Ls,t.UriCache=Us,t.UriException=ds,t.UriForm=Rs,t.UriFragment=qs,t.UriFragmentParser=_s,t.UriHost=gs,t.UriHostAddressParser=Ws,t.UriHostIPv4=xs,t.UriHostIPv6=Os,t.UriHostLiteralParser=Hs,t.UriHostName=bs,t.UriHostParser=Bs,t.UriHostUndefined=Cs,t.UriParser=Ns,t.UriPath=Ps,t.UriPathBuilder=As,t.UriPathEmpty=Ms,t.UriPathForm=Ds,t.UriPathParser=Ys,t.UriPathSegment=Ss,t.UriPathSlash=ks,t.UriPort=Es,t.UriPortParser=Xs,t.UriQuery=Is,t.UriQueryBuilder=js,t.UriQueryParam=Ts,t.UriQueryParser=Gs,t.UriQueryUndefined=Vs,t.UriScheme=vs,t.UriSchemeParser=Fs,t.UriUser=ws,t.UriUserParser=Ks,t.Utf8=Ut,t.Utf8DecodedOutput=qt,t.Utf8EncodedOutput=Rt,t.UtfErrorMode=It,t.UtfErrorModeFatal=Tt,t.UtfErrorModeReplacement=Vt,t.Value=ir,t.ValueBuilder=sr,t.ValueCursor=Rn,t.ValueDownlink=dh,t.ValueDownlinkModel=lh,t.ValueDownlinkRecord=wh,t.ValueEntryCursor=Un,t.ValueForm=qn,t.ValueInput=ii,t.ValueOutput=oi,t.Values=O,t.ValuesCursor=we,t.ValuesSelector=sn,t.WarpClient=Ph,t.WatchFieldsCombinator=xi,t.WatchFieldsOperator=bi,t.WatchValueCombinator=gi,t.WatchValueOperator=wi,t.WebSocketHost=nh,t.WeekInterval=Pp,t.WeekdayFormat=Qa,t.WeekdayParser=hp,t.Writer=tt,t.WriterDone=Et,t.WriterEnd=Ct,t.WriterError=Pt,t.WriterException=$,t.WriterSequence=St,t.YearFormat=Ha,t.YearInterval=Op,t.YearParser=op,t.YearsInterval=Cp,t.assert=V,t.authenticate=Rh,t.client=Sh,t.command=Uh,t.downlink=Ah,t.downlinkList=Dh,t.downlinkMap=Ih,t.downlinkValue=Th,t.hostRef=Vh,t.isOnline=kh,t.keepOnline=Mh,t.laneRef=qh,t.nodeRef=jh,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=swim-runtime.min.js.map